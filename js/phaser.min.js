/*
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}

 @overview

 Phaser - http://phaser.io

 v2.6.2 "Kore Springs" - Built: Tue Apr 24 2018 09:11:37

 By Richard Davey http://www.photonstorm.com @photonstorm

 Phaser is a fun, free and fast 2D game framework for making HTML5 games
 for desktop and mobile web browsers, supporting Canvas and WebGL rendering.

 Phaser uses Pixi.js for rendering, created by Mat Groves http://matgroves.com @Doormat23
 Phaser uses p2.js for full-body physics, created by Stefan Hedman https://github.com/schteppe/p2.js @schteppe
 Phaser contains a port of N+ Physics, converted by Richard Davey, original by http://www.metanetsoftware.com

 Many thanks to Adam Saltsman (@ADAMATOMIC) for releasing Flixel, from which both Phaser and my love of framework development originate.

 Follow development at http://phaser.io and on our forum

 "If you want your children to be intelligent,  read them fairy tales."
 "If you want them to be more intelligent, read them more fairy tales."
                                                     -- Albert Einstein
      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
 ? 2012 Timo Hausmann

 Permission is hereby granted, free of charge, to any person obtaining
 a copy of this software and associated documentation files (the
 "Software"), to deal in the Software without restriction, including
 without limitation the rights to use, copy, modify, merge, publish,
 distribute, sublicense, and/or sell copies of the Software, and to
 permit persons to whom the Software is furnished to do so, subject to
 the following conditions:

 The above copyright notice and this permission notice shall be
 included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd and Kestrel Moon Studios
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
*/
(function(a){var b;"undefined"===typeof exports?"function"==typeof define&&"object"==typeof define.amd&&define.amd?(b={},define(function(){return b})):b="undefined"!==typeof window?window:a:b=exports;(function(a){if(!b)var b=1E-6;if(!e)var e="undefined"!==typeof Float32Array?Float32Array:Array;if(!f)var f=Math.random;var g={setMatrixArrayType:function(a){e=a}};"undefined"!==typeof a&&(a.glMatrix=g);var h=Math.PI/180;g.toRadian=function(a){return a*h};var k={create:function(){var a=new e(2);a[0]=0;
a[1]=0;return a},clone:function(a){var b=new e(2);b[0]=a[0];b[1]=a[1];return b},fromValues:function(a,b){var c=new e(2);c[0]=a;c[1]=b;return c},copy:function(a,b){a[0]=b[0];a[1]=b[1];return a},set:function(a,b,c){a[0]=b;a[1]=c;return a},add:function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];return a},subtract:function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];return a}};k.sub=k.subtract;k.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];return a};k.mul=k.multiply;k.divide=function(a,b,c){a[0]=b[0]/c[0];
a[1]=b[1]/c[1];return a};k.div=k.divide;k.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);return a};k.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);return a};k.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;return a};k.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;return a};k.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.sqrt(c*c+d*d)};k.dist=k.distance;k.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return c*
c+d*d};k.sqrDist=k.squaredDistance;k.length=function(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)};k.len=k.length;k.squaredLength=function(a){var b=a[0];a=a[1];return b*b+a*a};k.sqrLen=k.squaredLength;k.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];return a};k.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];return a};k.normalize=function(a,b){var c=b[0],d=b[1],c=c*c+d*d;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c);return a};k.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};k.cross=function(a,b,c){b=
b[0]*c[1]-b[1]*c[0];a[0]=a[1]=0;a[2]=b;return a};k.lerp=function(a,b,c,d){var e=b[0];b=b[1];a[0]=e+d*(c[0]-e);a[1]=b+d*(c[1]-b);return a};k.random=function(a,b){b=b||1;var c=2*f()*Math.PI;a[0]=Math.cos(c)*b;a[1]=Math.sin(c)*b;return a};k.transformMat2=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b;a[1]=c[1]*d+c[3]*b;return a};k.transformMat2d=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b+c[4];a[1]=c[1]*d+c[3]*b+c[5];return a};k.transformMat3=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*
d+c[3]*b+c[6];a[1]=c[1]*d+c[4]*b+c[7];return a};k.transformMat4=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[4]*b+c[12];a[1]=c[1]*d+c[5]*b+c[13];return a};k.forEach=function(){var a=k.create();return function(b,c,d,e,f,g){c||(c=2);d||(d=0);for(e=e?Math.min(e*c+d,b.length):b.length;d<e;d+=c)a[0]=b[d],a[1]=b[d+1],f(a,a,g),b[d]=a[0],b[d+1]=a[1];return b}}();k.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};"undefined"!==typeof a&&(a.vec2=k);var l={create:function(){var a=new e(3);a[0]=0;a[1]=0;
a[2]=0;return a},clone:function(a){var b=new e(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b},fromValues:function(a,b,c){var d=new e(3);d[0]=a;d[1]=b;d[2]=c;return d},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];return a},set:function(a,b,c,d){a[0]=b;a[1]=c;a[2]=d;return a},add:function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];return a},subtract:function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];return a}};l.sub=l.subtract;l.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];
a[2]=b[2]*c[2];return a};l.mul=l.multiply;l.divide=function(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];a[2]=b[2]/c[2];return a};l.div=l.divide;l.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);a[2]=Math.min(b[2],c[2]);return a};l.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);a[2]=Math.max(b[2],c[2]);return a};l.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;return a};l.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*
d;return a};l.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return Math.sqrt(c*c+d*d+e*e)};l.dist=l.distance;l.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return c*c+d*d+e*e};l.sqrDist=l.squaredDistance;l.length=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};l.len=l.length;l.squaredLength=function(a){var b=a[0],c=a[1];a=a[2];return b*b+c*c+a*a};l.sqrLen=l.squaredLength;l.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];return a};
l.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];a[2]=1/b[2];return a};l.normalize=function(a,b){var c=b[0],d=b[1],e=b[2],c=c*c+d*d+e*e;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c);return a};l.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};l.cross=function(a,b,c){var d=b[0],e=b[1];b=b[2];var f=c[0],g=c[1];c=c[2];a[0]=e*c-b*g;a[1]=b*f-d*c;a[2]=d*g-e*f;return a};l.lerp=function(a,b,c,d){var e=b[0],f=b[1];b=b[2];a[0]=e+d*(c[0]-e);a[1]=f+d*(c[1]-f);a[2]=b+d*(c[2]-b);return a};l.random=
function(a,b){b=b||1;var c=2*f()*Math.PI,d=2*f()-1,e=Math.sqrt(1-d*d)*b;a[0]=Math.cos(c)*e;a[1]=Math.sin(c)*e;a[2]=d*b;return a};l.transformMat4=function(a,b,c){var d=b[0],e=b[1];b=b[2];var f=c[3]*d+c[7]*e+c[11]*b+c[15],f=f||1;a[0]=(c[0]*d+c[4]*e+c[8]*b+c[12])/f;a[1]=(c[1]*d+c[5]*e+c[9]*b+c[13])/f;a[2]=(c[2]*d+c[6]*e+c[10]*b+c[14])/f;return a};l.transformMat3=function(a,b,c){var d=b[0],e=b[1];b=b[2];a[0]=d*c[0]+e*c[3]+b*c[6];a[1]=d*c[1]+e*c[4]+b*c[7];a[2]=d*c[2]+e*c[5]+b*c[8];return a};l.transformQuat=
function(a,b,c){var d=b[0],e=b[1],f=b[2];b=c[0];var g=c[1],h=c[2];c=c[3];var k=c*d+g*f-h*e,l=c*e+h*d-b*f,m=c*f+b*e-g*d,d=-b*d-g*e-h*f;a[0]=k*c+d*-b+l*-h-m*-g;a[1]=l*c+d*-g+m*-b-k*-h;a[2]=m*c+d*-h+k*-g-l*-b;return a};l.rotateX=function(a,b,c,d){var e=[],f=[];e[0]=b[0]-c[0];e[1]=b[1]-c[1];e[2]=b[2]-c[2];f[0]=e[0];f[1]=e[1]*Math.cos(d)-e[2]*Math.sin(d);f[2]=e[1]*Math.sin(d)+e[2]*Math.cos(d);a[0]=f[0]+c[0];a[1]=f[1]+c[1];a[2]=f[2]+c[2];return a};l.rotateY=function(a,b,c,d){var e=[],f=[];e[0]=b[0]-c[0];
e[1]=b[1]-c[1];e[2]=b[2]-c[2];f[0]=e[2]*Math.sin(d)+e[0]*Math.cos(d);f[1]=e[1];f[2]=e[2]*Math.cos(d)-e[0]*Math.sin(d);a[0]=f[0]+c[0];a[1]=f[1]+c[1];a[2]=f[2]+c[2];return a};l.rotateZ=function(a,b,c,d){var e=[],f=[];e[0]=b[0]-c[0];e[1]=b[1]-c[1];e[2]=b[2]-c[2];f[0]=e[0]*Math.cos(d)-e[1]*Math.sin(d);f[1]=e[0]*Math.sin(d)+e[1]*Math.cos(d);f[2]=e[2];a[0]=f[0]+c[0];a[1]=f[1]+c[1];a[2]=f[2]+c[2];return a};l.forEach=function(){var a=l.create();return function(b,c,d,e,f,g){c||(c=3);d||(d=0);for(e=e?Math.min(e*
c+d,b.length):b.length;d<e;d+=c)a[0]=b[d],a[1]=b[d+1],a[2]=b[d+2],f(a,a,g),b[d]=a[0],b[d+1]=a[1],b[d+2]=a[2];return b}}();l.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"};"undefined"!==typeof a&&(a.vec3=l);var m={create:function(){var a=new e(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a},clone:function(a){var b=new e(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},fromValues:function(a,b,c,d){var f=new e(4);f[0]=a;f[1]=b;f[2]=c;f[3]=d;return f},copy:function(a,b){a[0]=b[0];a[1]=b[1];
a[2]=b[2];a[3]=b[3];return a},set:function(a,b,c,d,e){a[0]=b;a[1]=c;a[2]=d;a[3]=e;return a},add:function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];return a},subtract:function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];return a}};m.sub=m.subtract;m.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];a[2]=b[2]*c[2];a[3]=b[3]*c[3];return a};m.mul=m.multiply;m.divide=function(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];a[2]=b[2]/c[2];a[3]=b[3]/c[3];return a};
m.div=m.divide;m.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);a[2]=Math.min(b[2],c[2]);a[3]=Math.min(b[3],c[3]);return a};m.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);a[2]=Math.max(b[2],c[2]);a[3]=Math.max(b[3],c[3]);return a};m.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;return a};m.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;a[3]=b[3]+c[3]*d;return a};m.distance=function(a,b){var c=
b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],f=b[3]-a[3];return Math.sqrt(c*c+d*d+e*e+f*f)};m.dist=m.distance;m.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],f=b[3]-a[3];return c*c+d*d+e*e+f*f};m.sqrDist=m.squaredDistance;m.length=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)};m.len=m.length;m.squaredLength=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return b*b+c*c+d*d+a*a};m.sqrLen=m.squaredLength;m.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];
a[3]=-b[3];return a};m.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];a[2]=1/b[2];a[3]=1/b[3];return a};m.normalize=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],c=c*c+d*d+e*e+f*f;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c,a[3]=b[3]*c);return a};m.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};m.lerp=function(a,b,c,d){var e=b[0],f=b[1],g=b[2];b=b[3];a[0]=e+d*(c[0]-e);a[1]=f+d*(c[1]-f);a[2]=g+d*(c[2]-g);a[3]=b+d*(c[3]-b);return a};m.random=function(a,b){b=b||1;a[0]=
f();a[1]=f();a[2]=f();a[3]=f();m.normalize(a,a);m.scale(a,a,b);return a};m.transformMat4=function(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];a[0]=c[0]*d+c[4]*e+c[8]*f+c[12]*b;a[1]=c[1]*d+c[5]*e+c[9]*f+c[13]*b;a[2]=c[2]*d+c[6]*e+c[10]*f+c[14]*b;a[3]=c[3]*d+c[7]*e+c[11]*f+c[15]*b;return a};m.transformQuat=function(a,b,c){var d=b[0],e=b[1],f=b[2];b=c[0];var g=c[1],h=c[2];c=c[3];var k=c*d+g*f-h*e,l=c*e+h*d-b*f,m=c*f+b*e-g*d,d=-b*d-g*e-h*f;a[0]=k*c+d*-b+l*-h-m*-g;a[1]=l*c+d*-g+m*-b-k*-h;a[2]=m*c+d*-h+k*-g-
l*-b;return a};m.forEach=function(){var a=m.create();return function(b,c,d,e,f,g){c||(c=4);d||(d=0);for(e=e?Math.min(e*c+d,b.length):b.length;d<e;d+=c)a[0]=b[d],a[1]=b[d+1],a[2]=b[d+2],a[3]=b[d+3],f(a,a,g),b[d]=a[0],b[d+1]=a[1],b[d+2]=a[2],b[d+3]=a[3];return b}}();m.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.vec4=m);g={create:function(){var a=new e(4);a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a},clone:function(a){var b=new e(4);b[0]=a[0];b[1]=a[1];b[2]=
a[2];b[3]=a[3];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a},transpose:function(a,b){if(a===b){var c=b[1];a[1]=b[2];a[2]=c}else a[0]=b[0],a[1]=b[2],a[2]=b[1],a[3]=b[3];return a},invert:function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c*f-e*d;if(!g)return null;g=1/g;a[0]=f*g;a[1]=-d*g;a[2]=-e*g;a[3]=c*g;return a},adjoint:function(a,b){var c=b[0];a[0]=b[3];a[1]=-b[1];a[2]=-b[2];a[3]=c;return a},determinant:function(a){return a[0]*
a[3]-a[2]*a[1]},multiply:function(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];var g=c[0],h=c[1],k=c[2];c=c[3];a[0]=d*g+f*h;a[1]=e*g+b*h;a[2]=d*k+f*c;a[3]=e*k+b*c;return a}};g.mul=g.multiply;g.rotate=function(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];var g=Math.sin(c);c=Math.cos(c);a[0]=d*c+f*g;a[1]=e*c+b*g;a[2]=d*-g+f*c;a[3]=e*-g+b*c;return a};g.scale=function(a,b,c){var d=b[1],e=b[2],f=b[3],g=c[0];c=c[1];a[0]=b[0]*g;a[1]=d*g;a[2]=e*c;a[3]=f*c;return a};g.str=function(a){return"mat2("+a[0]+", "+a[1]+", "+
a[2]+", "+a[3]+")"};g.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2))};g.LDU=function(a,b,c,d){a[2]=d[2]/d[0];c[0]=d[0];c[1]=d[1];c[3]=d[3]-a[2]*c[1];return[a,b,c]};"undefined"!==typeof a&&(a.mat2=g);g={create:function(){var a=new e(6);a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a},clone:function(a){var b=new e(6);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];
a[4]=b[4];a[5]=b[5];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a},invert:function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],k=c*f-d*e;if(!k)return null;k=1/k;a[0]=f*k;a[1]=-d*k;a[2]=-e*k;a[3]=c*k;a[4]=(e*h-f*g)*k;a[5]=(d*g-c*h)*k;return a},determinant:function(a){return a[0]*a[3]-a[1]*a[2]},multiply:function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4];b=b[5];var k=c[0],l=c[1],m=c[2],n=c[3],p=c[4];c=c[5];a[0]=d*k+f*l;a[1]=e*k+g*l;a[2]=d*m+f*n;a[3]=e*
m+g*n;a[4]=d*p+f*c+h;a[5]=e*p+g*c+b;return a}};g.mul=g.multiply;g.rotate=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4];b=b[5];var k=Math.sin(c);c=Math.cos(c);a[0]=d*c+f*k;a[1]=e*c+g*k;a[2]=d*-k+f*c;a[3]=e*-k+g*c;a[4]=h;a[5]=b;return a};g.scale=function(a,b,c){var d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],k=c[0];c=c[1];a[0]=b[0]*k;a[1]=d*k;a[2]=e*c;a[3]=f*c;a[4]=g;a[5]=h;return a};g.translate=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4];b=b[5];var k=c[0];c=c[1];a[0]=d;a[1]=e;a[2]=f;a[3]=
g;a[4]=d*k+f*c+h;a[5]=e*k+g*c+b;return a};g.str=function(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"};g.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)};"undefined"!==typeof a&&(a.mat2d=g);var n={create:function(){var a=new e(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},fromMat4:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[4];a[4]=b[5];a[5]=
b[6];a[6]=b[8];a[7]=b[9];a[8]=b[10];return a},clone:function(a){var b=new e(9);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,b){if(a===b){var c=b[1],d=b[2],e=b[5];a[1]=b[3];a[2]=b[6];a[3]=c;a[5]=b[7];a[6]=d;a[7]=e}else a[0]=
b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a},invert:function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],k=b[6],l=b[7],m=b[8],n=m*g-h*l,p=-m*f+h*k,q=l*f-g*k,u=c*n+d*p+e*q;if(!u)return null;u=1/u;a[0]=n*u;a[1]=(-m*d+e*l)*u;a[2]=(h*d-e*g)*u;a[3]=p*u;a[4]=(m*c-e*k)*u;a[5]=(-h*c+e*f)*u;a[6]=q*u;a[7]=(-l*c+d*k)*u;a[8]=(g*c-d*f)*u;return a},adjoint:function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],k=b[6],l=b[7],m=b[8];a[0]=g*m-h*l;a[1]=
e*l-d*m;a[2]=d*h-e*g;a[3]=h*k-f*m;a[4]=c*m-e*k;a[5]=e*f-c*h;a[6]=f*l-g*k;a[7]=d*k-c*l;a[8]=c*g-d*f;return a},determinant:function(a){var b=a[3],c=a[4],d=a[5],e=a[6],f=a[7],g=a[8];return a[0]*(g*c-d*f)+a[1]*(-g*b+d*e)+a[2]*(f*b-c*e)},multiply:function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],k=b[5],l=b[6],m=b[7];b=b[8];var n=c[0],p=c[1],q=c[2],u=c[3],v=c[4],w=c[5],x=c[6],A=c[7];c=c[8];a[0]=n*d+p*g+q*l;a[1]=n*e+p*h+q*m;a[2]=n*f+p*k+q*b;a[3]=u*d+v*g+w*l;a[4]=u*e+v*h+w*m;a[5]=u*f+v*k+w*b;a[6]=x*
d+A*g+c*l;a[7]=x*e+A*h+c*m;a[8]=x*f+A*k+c*b;return a}};n.mul=n.multiply;n.translate=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],k=b[5],l=b[6],m=b[7];b=b[8];var n=c[0];c=c[1];a[0]=d;a[1]=e;a[2]=f;a[3]=g;a[4]=h;a[5]=k;a[6]=n*d+c*g+l;a[7]=n*e+c*h+m;a[8]=n*f+c*k+b;return a};n.rotate=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],k=b[5],l=b[6],m=b[7];b=b[8];var n=Math.sin(c);c=Math.cos(c);a[0]=c*d+n*g;a[1]=c*e+n*h;a[2]=c*f+n*k;a[3]=c*g-n*d;a[4]=c*h-n*e;a[5]=c*k-n*f;a[6]=l;a[7]=m;a[8]=
b;return a};n.scale=function(a,b,c){var d=c[0];c=c[1];a[0]=d*b[0];a[1]=d*b[1];a[2]=d*b[2];a[3]=c*b[3];a[4]=c*b[4];a[5]=c*b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a};n.fromMat2d=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=0;a[3]=b[2];a[4]=b[3];a[5]=0;a[6]=b[4];a[7]=b[5];a[8]=1;return a};n.fromQuat=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c+c,h=d+d,k=e+e,c=c*g,l=d*g,d=d*h,m=e*g,n=e*h,e=e*k,g=f*g,h=f*h,f=f*k;a[0]=1-d-e;a[3]=l-f;a[6]=m+h;a[1]=l+f;a[4]=1-c-e;a[7]=n-g;a[2]=m-h;a[5]=n+g;a[8]=1-c-d;return a};
n.normalFromMat4=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],k=b[6],l=b[7],m=b[8],n=b[9],p=b[10],q=b[11],u=b[12],v=b[13],w=b[14],x=b[15],A=c*h-d*g,D=c*k-e*g,B=c*l-f*g,C=d*k-e*h,K=d*l-f*h,L=e*l-f*k,M=m*v-n*u,N=m*w-p*u,m=m*x-q*u,O=n*w-p*v,n=n*x-q*v,p=p*x-q*w,q=A*p-D*n+B*O+C*m-K*N+L*M;if(!q)return null;q=1/q;a[0]=(h*p-k*n+l*O)*q;a[1]=(k*m-g*p-l*N)*q;a[2]=(g*n-h*m+l*M)*q;a[3]=(e*n-d*p-f*O)*q;a[4]=(c*p-e*m+f*N)*q;a[5]=(d*m-c*n-f*M)*q;a[6]=(v*L-w*K+x*C)*q;a[7]=(w*B-u*L-x*D)*q;a[8]=(u*K-
v*B+x*A)*q;return a};n.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};n.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};"undefined"!==typeof a&&(a.mat3=n);var p={create:function(){var a=new e(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=
0;a[13]=0;a[14]=0;a[15]=1;return a},clone:function(a){var b=new e(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;
a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},transpose:function(a,b){if(a===b){var c=b[1],d=b[2],e=b[3],f=b[6],g=b[7],h=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=c;a[6]=b[9];a[7]=b[13];a[8]=d;a[9]=f;a[11]=b[14];a[12]=e;a[13]=g;a[14]=h}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a},invert:function(a,b){var c=
b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],k=b[6],l=b[7],m=b[8],n=b[9],p=b[10],q=b[11],u=b[12],v=b[13],w=b[14],x=b[15],A=c*h-d*g,D=c*k-e*g,B=c*l-f*g,C=d*k-e*h,K=d*l-f*h,L=e*l-f*k,M=m*v-n*u,N=m*w-p*u,O=m*x-q*u,U=n*w-p*v,V=n*x-q*v,W=p*x-q*w,J=A*W-D*V+B*U+C*O-K*N+L*M;if(!J)return null;J=1/J;a[0]=(h*W-k*V+l*U)*J;a[1]=(e*V-d*W-f*U)*J;a[2]=(v*L-w*K+x*C)*J;a[3]=(p*K-n*L-q*C)*J;a[4]=(k*O-g*W-l*N)*J;a[5]=(c*W-e*O+f*N)*J;a[6]=(w*B-u*L-x*D)*J;a[7]=(m*L-p*B+q*D)*J;a[8]=(g*V-h*O+l*M)*J;a[9]=(d*O-c*V-f*M)*J;a[10]=
(u*K-v*B+x*A)*J;a[11]=(n*B-m*K-q*A)*J;a[12]=(h*N-g*U-k*M)*J;a[13]=(c*U-d*N+e*M)*J;a[14]=(v*D-u*C-w*A)*J;a[15]=(m*C-n*D+p*A)*J;return a},adjoint:function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],k=b[6],l=b[7],m=b[8],n=b[9],p=b[10],q=b[11],u=b[12],v=b[13],w=b[14],x=b[15];a[0]=h*(p*x-q*w)-n*(k*x-l*w)+v*(k*q-l*p);a[1]=-(d*(p*x-q*w)-n*(e*x-f*w)+v*(e*q-f*p));a[2]=d*(k*x-l*w)-h*(e*x-f*w)+v*(e*l-f*k);a[3]=-(d*(k*q-l*p)-h*(e*q-f*p)+n*(e*l-f*k));a[4]=-(g*(p*x-q*w)-m*(k*x-l*w)+u*(k*q-l*p));a[5]=c*
(p*x-q*w)-m*(e*x-f*w)+u*(e*q-f*p);a[6]=-(c*(k*x-l*w)-g*(e*x-f*w)+u*(e*l-f*k));a[7]=c*(k*q-l*p)-g*(e*q-f*p)+m*(e*l-f*k);a[8]=g*(n*x-q*v)-m*(h*x-l*v)+u*(h*q-l*n);a[9]=-(c*(n*x-q*v)-m*(d*x-f*v)+u*(d*q-f*n));a[10]=c*(h*x-l*v)-g*(d*x-f*v)+u*(d*l-f*h);a[11]=-(c*(h*q-l*n)-g*(d*q-f*n)+m*(d*l-f*h));a[12]=-(g*(n*w-p*v)-m*(h*w-k*v)+u*(h*p-k*n));a[13]=c*(n*w-p*v)-m*(d*w-e*v)+u*(d*p-e*n);a[14]=-(c*(h*w-k*v)-g*(d*w-e*v)+u*(d*k-e*h));a[15]=c*(h*p-k*n)-g*(d*p-e*n)+m*(d*k-e*h);return a},determinant:function(a){var b=
a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],k=a[7],l=a[8],m=a[9],n=a[10],p=a[11],q=a[12],u=a[13],v=a[14];a=a[15];return(b*g-c*f)*(n*a-p*v)-(b*h-d*f)*(m*a-p*u)+(b*k-e*f)*(m*v-n*u)+(c*h-d*g)*(l*a-p*q)-(c*k-e*g)*(l*v-n*q)+(d*k-e*h)*(l*u-m*q)},multiply:function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],k=b[5],l=b[6],m=b[7],n=b[8],p=b[9],q=b[10],u=b[11],v=b[12],w=b[13],x=b[14];b=b[15];var A=c[0],D=c[1],B=c[2],C=c[3];a[0]=A*d+D*h+B*n+C*v;a[1]=A*e+D*k+B*p+C*w;a[2]=A*f+D*l+B*q+C*x;a[3]=A*g+D*m+B*u+
C*b;A=c[4];D=c[5];B=c[6];C=c[7];a[4]=A*d+D*h+B*n+C*v;a[5]=A*e+D*k+B*p+C*w;a[6]=A*f+D*l+B*q+C*x;a[7]=A*g+D*m+B*u+C*b;A=c[8];D=c[9];B=c[10];C=c[11];a[8]=A*d+D*h+B*n+C*v;a[9]=A*e+D*k+B*p+C*w;a[10]=A*f+D*l+B*q+C*x;a[11]=A*g+D*m+B*u+C*b;A=c[12];D=c[13];B=c[14];C=c[15];a[12]=A*d+D*h+B*n+C*v;a[13]=A*e+D*k+B*p+C*w;a[14]=A*f+D*l+B*q+C*x;a[15]=A*g+D*m+B*u+C*b;return a}};p.mul=p.multiply;p.translate=function(a,b,c){var d=c[0],e=c[1];c=c[2];var f,g,h,k,l,m,n,p,q,u,v,w;b===a?(a[12]=b[0]*d+b[4]*e+b[8]*c+b[12],
a[13]=b[1]*d+b[5]*e+b[9]*c+b[13],a[14]=b[2]*d+b[6]*e+b[10]*c+b[14],a[15]=b[3]*d+b[7]*e+b[11]*c+b[15]):(f=b[0],g=b[1],h=b[2],k=b[3],l=b[4],m=b[5],n=b[6],p=b[7],q=b[8],u=b[9],v=b[10],w=b[11],a[0]=f,a[1]=g,a[2]=h,a[3]=k,a[4]=l,a[5]=m,a[6]=n,a[7]=p,a[8]=q,a[9]=u,a[10]=v,a[11]=w,a[12]=f*d+l*e+q*c+b[12],a[13]=g*d+m*e+u*c+b[13],a[14]=h*d+n*e+v*c+b[14],a[15]=k*d+p*e+w*c+b[15]);return a};p.scale=function(a,b,c){var d=c[0],e=c[1];c=c[2];a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;a[3]=b[3]*d;a[4]=b[4]*e;a[5]=b[5]*
e;a[6]=b[6]*e;a[7]=b[7]*e;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};p.rotate=function(a,c,e,f){var g=f[0],h=f[1];f=f[2];var k=Math.sqrt(g*g+h*h+f*f),l,m,n,p,q,P,R,u,v,w,x,A,D,B,C,K,L,M,N,O;if(Math.abs(k)<b)return null;k=1/k;g*=k;h*=k;f*=k;l=Math.sin(e);m=Math.cos(e);n=1-m;e=c[0];k=c[1];p=c[2];q=c[3];P=c[4];R=c[5];u=c[6];v=c[7];w=c[8];x=c[9];A=c[10];D=c[11];B=g*g*n+m;C=h*g*n+f*l;K=f*g*n-h*l;L=g*h*n-f*l;M=h*h*n+m;N=f*h*n+g*l;O=g*f*
n+h*l;g=h*f*n-g*l;h=f*f*n+m;a[0]=e*B+P*C+w*K;a[1]=k*B+R*C+x*K;a[2]=p*B+u*C+A*K;a[3]=q*B+v*C+D*K;a[4]=e*L+P*M+w*N;a[5]=k*L+R*M+x*N;a[6]=p*L+u*M+A*N;a[7]=q*L+v*M+D*N;a[8]=e*O+P*g+w*h;a[9]=k*O+R*g+x*h;a[10]=p*O+u*g+A*h;a[11]=q*O+v*g+D*h;c!==a&&(a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);return a};p.rotateX=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[4],f=b[5],g=b[6],h=b[7],k=b[8],l=b[9],m=b[10],n=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],
a[15]=b[15]);a[4]=e*c+k*d;a[5]=f*c+l*d;a[6]=g*c+m*d;a[7]=h*c+n*d;a[8]=k*c-e*d;a[9]=l*c-f*d;a[10]=m*c-g*d;a[11]=n*c-h*d;return a};p.rotateY=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[0],f=b[1],g=b[2],h=b[3],k=b[8],l=b[9],m=b[10],n=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*c-k*d;a[1]=f*c-l*d;a[2]=g*c-m*d;a[3]=h*c-n*d;a[8]=e*d+k*c;a[9]=f*d+l*c;a[10]=g*d+m*c;a[11]=h*d+n*c;return a};p.rotateZ=function(a,b,c){var d=Math.sin(c);
c=Math.cos(c);var e=b[0],f=b[1],g=b[2],h=b[3],k=b[4],l=b[5],m=b[6],n=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*c+k*d;a[1]=f*c+l*d;a[2]=g*c+m*d;a[3]=h*c+n*d;a[4]=k*c-e*d;a[5]=l*c-f*d;a[6]=m*c-g*d;a[7]=n*c-h*d;return a};p.fromRotationTranslation=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=d+d,k=e+e,l=f+f;b=d*h;var m=d*k,d=d*l,n=e*k,e=e*l,f=f*l,h=g*h,k=g*k,g=g*l;a[0]=1-(n+f);a[1]=m+g;a[2]=d-k;a[3]=0;a[4]=m-g;a[5]=1-(b+f);a[6]=
e+h;a[7]=0;a[8]=d+k;a[9]=e-h;a[10]=1-(b+n);a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a};p.fromQuat=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c+c,h=d+d,k=e+e,c=c*g,l=d*g,d=d*h,m=e*g,n=e*h,e=e*k,g=f*g,h=f*h,f=f*k;a[0]=1-d-e;a[1]=l+f;a[2]=m-h;a[3]=0;a[4]=l-f;a[5]=1-c-e;a[6]=n+g;a[7]=0;a[8]=m+h;a[9]=n-g;a[10]=1-c-d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};p.frustum=function(a,b,c,d,e,f,g){var h=1/(c-b),k=1/(e-d),l=1/(f-g);a[0]=2*f*h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*f*k;
a[6]=0;a[7]=0;a[8]=(c+b)*h;a[9]=(e+d)*k;a[10]=(g+f)*l;a[11]=-1;a[12]=0;a[13]=0;a[14]=g*f*2*l;a[15]=0;return a};p.perspective=function(a,b,c,d,e){b=1/Math.tan(b/2);var f=1/(d-e);a[0]=b/c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(e+d)*f;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*e*d*f;a[15]=0;return a};p.ortho=function(a,b,c,d,e,f,g){var h=1/(b-c),k=1/(d-e),l=1/(f-g);a[0]=-2*h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*k;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*l;a[11]=0;a[12]=(b+c)*h;a[13]=(e+
d)*k;a[14]=(g+f)*l;a[15]=1;return a};p.lookAt=function(a,c,e,f){var g,h,k,l,m,n,q,E,P=c[0],R=c[1];c=c[2];k=f[0];l=f[1];h=f[2];q=e[0];f=e[1];g=e[2];if(Math.abs(P-q)<b&&Math.abs(R-f)<b&&Math.abs(c-g)<b)return p.identity(a);e=P-q;f=R-f;q=c-g;E=1/Math.sqrt(e*e+f*f+q*q);e*=E;f*=E;q*=E;g=l*q-h*f;h=h*e-k*q;k=k*f-l*e;(E=Math.sqrt(g*g+h*h+k*k))?(E=1/E,g*=E,h*=E,k*=E):k=h=g=0;l=f*k-q*h;m=q*g-e*k;n=e*h-f*g;(E=Math.sqrt(l*l+m*m+n*n))?(E=1/E,l*=E,m*=E,n*=E):n=m=l=0;a[0]=g;a[1]=l;a[2]=e;a[3]=0;a[4]=h;a[5]=m;a[6]=
f;a[7]=0;a[8]=k;a[9]=n;a[10]=q;a[11]=0;a[12]=-(g*P+h*R+k*c);a[13]=-(l*P+m*R+n*c);a[14]=-(e*P+f*R+q*c);a[15]=1;return a};p.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};p.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],
2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};"undefined"!==typeof a&&(a.mat4=p);var q={create:function(){var a=new e(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a}};q.rotationTo=function(){var a=l.create(),b=l.fromValues(1,0,0),c=l.fromValues(0,1,0);return function(d,e,f){var g=l.dot(e,f);if(-.999999>g)return l.cross(a,b,e),1E-6>l.length(a)&&l.cross(a,c,e),l.normalize(a,a),q.setAxisAngle(d,a,Math.PI),d;if(.999999<g)return d[0]=
0,d[1]=0,d[2]=0,d[3]=1,d;l.cross(a,e,f);d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=1+g;return q.normalize(d,d)}}();q.setAxes=function(){var a=n.create();return function(b,c,d,e){a[0]=d[0];a[3]=d[1];a[6]=d[2];a[1]=e[0];a[4]=e[1];a[7]=e[2];a[2]=-c[0];a[5]=-c[1];a[8]=-c[2];return q.normalize(b,q.fromMat3(b,a))}}();q.clone=m.clone;q.fromValues=m.fromValues;q.copy=m.copy;q.set=m.set;q.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};q.setAxisAngle=function(a,b,c){c*=.5;var d=Math.sin(c);a[0]=d*b[0];
a[1]=d*b[1];a[2]=d*b[2];a[3]=Math.cos(c);return a};q.add=m.add;q.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];var g=c[0],h=c[1],k=c[2];c=c[3];a[0]=d*c+b*g+e*k-f*h;a[1]=e*c+b*h+f*g-d*k;a[2]=f*c+b*k+d*h-e*g;a[3]=b*c-d*g-e*h-f*k;return a};q.mul=q.multiply;q.scale=m.scale;q.rotateX=function(a,b,c){c*=.5;var d=b[0],e=b[1],f=b[2];b=b[3];var g=Math.sin(c);c=Math.cos(c);a[0]=d*c+b*g;a[1]=e*c+f*g;a[2]=f*c-e*g;a[3]=b*c-d*g;return a};q.rotateY=function(a,b,c){c*=.5;var d=b[0],e=b[1],f=b[2];b=b[3];
var g=Math.sin(c);c=Math.cos(c);a[0]=d*c-f*g;a[1]=e*c+b*g;a[2]=f*c+d*g;a[3]=b*c-e*g;return a};q.rotateZ=function(a,b,c){c*=.5;var d=b[0],e=b[1],f=b[2];b=b[3];var g=Math.sin(c);c=Math.cos(c);a[0]=d*c+e*g;a[1]=e*c-d*g;a[2]=f*c+b*g;a[3]=b*c-f*g;return a};q.calculateW=function(a,b){var c=b[0],d=b[1],e=b[2];a[0]=c;a[1]=d;a[2]=e;a[3]=Math.sqrt(Math.abs(1-c*c-d*d-e*e));return a};q.dot=m.dot;q.lerp=m.lerp;q.slerp=function(a,b,c,d){var e=b[0],f=b[1],g=b[2];b=b[3];var h=c[0],k=c[1],l=c[2];c=c[3];var m,n,p;
n=e*h+f*k+g*l+b*c;0>n&&(n=-n,h=-h,k=-k,l=-l,c=-c);1E-6<1-n?(m=Math.acos(n),p=Math.sin(m),n=Math.sin((1-d)*m)/p,d=Math.sin(d*m)/p):n=1-d;a[0]=n*e+d*h;a[1]=n*f+d*k;a[2]=n*g+d*l;a[3]=n*b+d*c;return a};q.invert=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c*c+d*d+e*e+f*f,g=g?1/g:0;a[0]=-c*g;a[1]=-d*g;a[2]=-e*g;a[3]=f*g;return a};q.conjugate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=b[3];return a};q.length=m.length;q.len=q.length;q.squaredLength=m.squaredLength;q.sqrLen=q.squaredLength;q.normalize=
m.normalize;q.fromMat3=function(a,b){var c=b[0]+b[4]+b[8];if(0<c)c=Math.sqrt(c+1),a[3]=.5*c,c=.5/c,a[0]=(b[5]-b[7])*c,a[1]=(b[6]-b[2])*c,a[2]=(b[1]-b[3])*c;else{var d=0;b[4]>b[0]&&(d=1);b[8]>b[3*d+d]&&(d=2);var e=(d+1)%3,f=(d+2)%3,c=Math.sqrt(b[3*d+d]-b[3*e+e]-b[3*f+f]+1);a[d]=.5*c;c=.5/c;a[3]=(b[3*e+f]-b[3*f+e])*c;a[e]=(b[3*e+d]+b[3*d+e])*c;a[f]=(b[3*f+d]+b[3*d+f])*c}return a};q.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.quat=q)})(b)})(this);
var Q_X=0,Q_Y=1,Q_Z=2,Q_W=3;function dualQuat(){this.real=quat.create();this.real[Q_W]=0;this.imaginary=quat.create();this.imaginary[Q_W]=0;this.tmpQ1=quat.create()}dualQuat.prototype.reset=function(){quat.identity(this.real);this.real[Q_W]=0;quat.identity(this.imaginary);this.imaginary[Q_W]=0;quat.identity(this.tmpQ1)};
dualQuat.prototype.createFromData=function(a,b){this.real=a;this.imaginary=quat.create();this.imaginary[Q_W]=-.5*(b[Q_X]*a[Q_X]+b[Q_Y]*a[Q_Y]+b[Q_Z]*a[Q_Z]);this.imaginary[Q_X]=.5*(b[Q_X]*a[Q_W]+b[Q_Y]*a[Q_Z]-b[Q_Z]*a[Q_Y]);this.imaginary[Q_Y]=.5*(-b[Q_X]*a[Q_Z]+b[Q_Y]*a[Q_W]+b[Q_Z]*a[Q_X]);this.imaginary[Q_Z]=.5*(b[Q_X]*a[Q_Y]-b[Q_Y]*a[Q_X]+b[Q_Z]*a[Q_W])};
dualQuat.prototype.add=function(a,b,c){quat.copy(this.tmpQ1,a.real);quat.scale(this.tmpQ1,this.tmpQ1,b);quat.add(this.real,this.tmpQ1,this.real);quat.copy(this.tmpQ1,a.imaginary);quat.scale(this.tmpQ1,this.tmpQ1,c);quat.add(this.imaginary,this.tmpQ1,this.imaginary)};dualQuat.prototype.normalize=function(){var a=quat.length(this.real);this.real=quat.scale(this.real,this.real,1/a);this.imaginary=quat.scale(this.imaginary,this.imaginary,1/a)};
var v0=vec3.create(),ve=vec3.create(),trans=vec3.create(),tmpVec1=vec3.create(),tmpVec2=vec3.create(),tmpVec0=vec3.create(),aVec=vec3.create(),rot=vec3.create();
dualQuat.prototype.transform=function(a){v0[Q_X]=this.real[Q_X];v0[Q_Y]=this.real[Q_Y];v0[Q_Z]=this.real[Q_Z];ve[Q_X]=this.imaginary[Q_X];ve[Q_Y]=this.imaginary[Q_Y];ve[Q_Z]=this.imaginary[Q_Z];tmpVec1=vec3.scale(tmpVec1,v0,this.imaginary[Q_W]);tmpVec2=vec3.cross(tmpVec2,v0,ve);tmpVec0=vec3.scale(tmpVec0,ve,this.real[Q_W]);aVec=vec3.subtract(aVec,tmpVec0,tmpVec1);trans=vec3.add(trans,aVec,tmpVec2);trans=vec3.scale(trans,trans,2);rot=vec3.transformQuat(rot,a,this.real);return rot=vec3.add(rot,rot,
trans)};
var Utils={setAxisMatrix:function(a,b,c){var d=mat4.create();d[0]=a[Q_X];d[4]=a[Q_Y];d[8]=a[Q_Z];d[1]=b[Q_X];d[5]=b[Q_Y];d[9]=b[Q_Z];d[2]=c[Q_X];d[6]=c[Q_Y];d[10]=c[Q_Z];d[12]=0;d[13]=0;d[14]=0;d[3]=0;d[7]=0;d[11]=0;d[15]=1;return d=mat4.transpose(d,d)},matrixToQuat:function(a){var b=quat.create(),c=a[0],d=a[4],e=a[8],f=a[1],g=a[5],h=a[9],k=a[2],l=a[6];a=a[10];var m=c+g+a;0<m?(c=.5/Math.sqrt(m+1),b[Q_W]=.25/c,b[Q_X]=(l-h)*c,b[Q_Y]=(e-k)*c,b[Q_Z]=(f-d)*c):c>g&&c>a?(c=2*Math.sqrt(1+c-g-a),b[Q_W]=(l-
h)/c,b[Q_X]=.25*c,b[Q_Y]=(d+f)/c,b[Q_Z]=(e+k)/c):g>a?(c=2*Math.sqrt(1+g-c-a),b[Q_W]=(e-k)/c,b[Q_X]=(d+f)/c,b[Q_Y]=.25*c,b[Q_Z]=(h+l)/c):(c=2*Math.sqrt(1+a-c-g),b[Q_W]=(f-d)/c,b[Q_X]=(e+k)/c,b[Q_Y]=(h+l)/c,b[Q_Z]=.25*c);return b},rotateVec_90:function(a){return vec3.fromValues(-a[Q_Y],a[Q_X],a[Q_Z])},calcRotateMat:function(a){a=vec3.clone(a);a=vec3.normalize(a,a);var b=Utils.rotateVec_90(a);a=vec3.fromValues(a[Q_X],a[Q_Y],0);var b=vec3.fromValues(b[Q_X],b[Q_Y],0),c=vec3.fromValues(0,0,1),d=mat4.create();
return d=Utils.setAxisMatrix(a,b,c)},getMatTranslate:function(a){var b=vec3.create();b[Q_X]=a[12];b[Q_Y]=a[13];b[Q_Z]=a[14];return b},addMat:function(a,b){for(var c=mat4.create(),d=0;16>d;d++)c[d]=a[d]+b[d];return c},mulMat:function(a,b){for(var c=mat4.create(),d=0;16>d;d++)c[d]=a[d]*b;return c},clamp:function(a,b,c){return a<b?b:a>c?c:a}},newVec1=vec3.create(),newVec2=vec3.create();
Utils.vecInterp=function(a,b,c){newVec1=vec3.scale(newVec1,a,1-c);newVec2=vec3.scale(newVec2,b,c);a=vec3.create();return a=vec3.add(a,newVec1,newVec2)};Utils.vec2Interp=function(a,b,c){var d=vec2.create(),e=vec2.create(),d=vec2.scale(d,a,1-c),e=vec2.scale(e,b,c);a=vec2.create();return a=vec2.add(a,d,e)};
function MeshBone(a,b,c,d){this.key=a;this.world_rest_angle=0;this.rest_parent_mat=mat4.create();this.rest_parent_inv_mat=mat4.create();this.rest_world_mat=mat4.create();this.rest_world_inv_mat=mat4.create();this.bind_world_mat=mat4.create();this.bind_world_inv_mat=mat4.create();this.parent_world_mat=mat4.create();this.parent_world_inv_mat=mat4.create();this.local_rest_end_pt=this.local_rest_start_pt=null;this.setRestParentMat(d,null);this.setLocalRestStartPt(b);this.setLocalRestEndPt(c);this.setParentWorldInvMat(mat4.create());
this.setParentWorldMat(mat4.create());this.local_binormal_dir=vec3.fromValues(0,0,1);this.tag_id=0;this.children=[]}MeshBone.prototype.setRestParentMat=function(a,b){this.rest_parent_mat=a;null==b?(this.rest_parent_inv_mat=mat4.clone(this.rest_parent_mat),mat4.invert(this.rest_parent_inv_mat,this.rest_parent_inv_mat)):this.rest_parent_inv_mat=mat4.clone(b)};MeshBone.prototype.setParentWorldMat=function(a){this.parent_world_mat=a};
MeshBone.prototype.setParentWorldInvMat=function(a){this.parent_world_inv_mat=a};MeshBone.prototype.getLocalRestStartPt=function(){return this.local_rest_start_pt};MeshBone.prototype.getLocalRestEndPt=function(){return this.local_rest_end_pt};MeshBone.prototype.setLocalRestStartPt=function(a){this.local_rest_start_pt=vec3.create();this.local_rest_start_pt=vec3.transformMat4(this.local_rest_start_pt,a,this.rest_parent_inv_mat);this.calcRestData()};
MeshBone.prototype.setLocalRestEndPt=function(a){this.local_rest_end_pt=vec3.create();this.local_rest_end_pt=vec3.transformMat4(this.local_rest_end_pt,a,this.rest_parent_inv_mat);this.calcRestData()};MeshBone.prototype.calcRestData=function(){if(null!=this.local_rest_start_pt&&null!=this.local_rest_end_pt){var a=this.computeDirs(this.local_rest_start_pt,this.local_rest_end_pt);this.local_rest_dir=a.first;this.local_rest_normal_dir=a.second;this.computeRestLength()}};
MeshBone.prototype.setWorldStartPt=function(a){this.world_start_pt=a};MeshBone.prototype.setWorldEndPt=function(a){this.world_end_pt=a};MeshBone.prototype.fixDQs=function(a){0>quat.dot(this.world_dq.real,a.real)&&(this.world_dq.real=quat.scale(this.world_dq.real,this.world_dq.real,-1),this.world_dq.imaginary=quat.scale(this.world_dq.imaginary,this.world_dq.imaginary,-1));for(a=0;a<this.children.length;a++)this.children[a].fixDQs(this.world_dq)};
MeshBone.prototype.initWorldPts=function(){this.setWorldStartPt(this.getWorldRestStartPt());this.setWorldEndPt(this.getWorldRestEndPt());for(var a=0;a<this.children.length;a++)this.children[a].initWorldPts()};MeshBone.prototype.getWorldRestStartPt=function(){var a=this.rest_parent_mat,b=vec3.create();return b=vec3.transformMat4(b,this.local_rest_start_pt,a)};
MeshBone.prototype.getWorldRestEndPt=function(){var a=this.rest_parent_mat,b=vec3.create();return b=vec3.transformMat4(b,this.local_rest_end_pt,a)};MeshBone.prototype.getWorldRestAngle=function(){return this.world_rest_angle};MeshBone.prototype.getWorldRestPos=function(){return this.world_rest_pos};MeshBone.prototype.getWorldStartPt=function(){return this.world_start_pt};MeshBone.prototype.getWorldEndPt=function(){return this.world_end_pt};MeshBone.prototype.getRestParentMat=function(){return this.rest_parent_mat};
MeshBone.prototype.getRestWorldMat=function(){return this.rest_world_mat};MeshBone.prototype.getWorldDeltaMat=function(){return this.world_delta_mat};MeshBone.prototype.getParentWorldMat=function(){return this.parent_world_mat};MeshBone.prototype.getParentWorldInvMat=function(){return this.parent_world_inv_mat};MeshBone.prototype.getWorldDq=function(){return this.world_dq};
MeshBone.prototype.computeRestParentTransforms=function(){var a=vec3.fromValues(this.local_rest_dir[Q_X],this.local_rest_dir[Q_Y],0),b=vec3.fromValues(this.local_binormal_dir[Q_X],this.local_binormal_dir[Q_Y],this.local_binormal_dir[Q_Z]),c=vec3.fromValues(this.local_rest_normal_dir[Q_X],this.local_rest_normal_dir[Q_Y],0),d=mat4.create();mat4.translate(d,d,this.local_rest_end_pt);var e=mat4.create(),e=Utils.setAxisMatrix(a,c,b),a=mat4.create(),a=mat4.multiply(a,d,e);this.rest_world_mat=mat4.create();
this.rest_world_mat=mat4.multiply(this.rest_world_mat,this.rest_parent_mat,a);this.rest_world_inv_mat=mat4.clone(this.rest_world_mat);this.rest_world_inv_mat=mat4.invert(this.rest_world_inv_mat,this.rest_world_inv_mat);d=vec3.clone(this.getWorldRestEndPt());d=vec3.subtract(d,d,this.getWorldRestStartPt());vec3.normalize(d,d);this.world_rest_pos=this.getWorldRestStartPt();d=mat4.create();d=mat4.translate(d,d,this.getWorldRestStartPt());e=vec3.create();e=vec3.sub(e,this.getWorldRestEndPt(),this.getWorldRestStartPt());
e=Utils.calcRotateMat(e);a=mat4.create();a=mat4.multiply(a,d,e);this.bind_world_mat=mat4.clone(a);this.bind_world_inv_mat=mat4.clone(this.bind_world_mat);this.bind_world_inv_mat=mat4.invert(this.bind_world_inv_mat,this.bind_world_inv_mat);for(d=0;d<this.children.length;d++)e=this.children[d],e.setRestParentMat(this.rest_world_mat,this.rest_world_inv_mat),e.computeRestParentTransforms()};
MeshBone.prototype.computeParentTransforms=function(){for(var a=mat4.create(),a=mat4.translate(a,a,this.getWorldEndPt()),b=vec3.create(),b=vec3.subtract(b,this.getWorldEndpt(),this.getWorldStartPt()),c=Utils.calcRotateMat(b),b=mat4.create(),b=mat4.multiply(b,a,c),a=mat4.clone(b),a=mat4.invert(a,a),c=0;c<children.length;c++){var d=children[c];d.setParentWorldMat(b);d.setParentWorldInvMat(a);d.computeParentTransforms()}};
MeshBone.prototype.computeWorldDeltaTransforms=function(){var a=this.computeDirs(this.world_start_pt,this.world_end_pt),b=vec3.fromValues(a.first[Q_X],a.first[Q_Y],0),c=vec3.fromValues(a.second[Q_X],a.second[Q_Y],0),d=vec3.fromValues(this.local_binormal_dir[Q_X],this.local_binormal_dir[Q_Y],this.local_binormal_dir[Q_Z]),a=mat4.create(),a=Utils.setAxisMatrix(b,c,d),b=mat4.create(),b=mat4.translate(b,b,this.world_start_pt);this.world_delta_mat=mat4.create();this.world_delta_mat=mat4.multiply(this.world_delta_mat,
b,a);this.world_delta_mat=mat4.multiply(this.world_delta_mat,this.world_delta_mat,this.bind_world_inv_mat);b=Utils.matrixToQuat(this.world_delta_mat);a=Utils.getMatTranslate(this.world_delta_mat);this.world_dq=new dualQuat;this.world_dq.createFromData(b,a);for(b=0;b<this.children.length;b++)this.children[b].computeWorldDeltaTransforms()};MeshBone.prototype.addChild=function(a){a.setRestParentMat(this.rest_world_mat,this.rest_world_inv_mat);this.children.push(a)};MeshBone.prototype.getChildren=function(){return this.children};
MeshBone.prototype.hasBone=function(a){for(var b=0;b<this.children.length;b++)if(this.children[b]==a)return!0;return!1};MeshBone.prototype.getChildByKey=function(a){if(this.key===a)return this;for(var b=null,c=0;c<this.children.length;c++){var d=this.children[c].getChildByKey(a);if(null!=d){b=d;break}}return b};MeshBone.prototype.getKey=function(){return this.key};
MeshBone.prototype.getAllBoneKeys=function(){var a=[];a.push(this.getKey());for(var b=0;b<this.children.length;b++)var c=this.children[b].getAllBoneKeys(),a=a.concat(c);return a};MeshBone.prototype.getAllChildren=function(){var a=[];a.push(this);for(var b=0;b<this.children.length;b++)var c=this.children[b].getAllChildren(),a=a.concat(c);return a};
MeshBone.prototype.getBoneDepth=function(a,b){if(a==this)return b;for(var c=0;c<this.children.length;c++){var d=this.children[c].getBoneDepth(a,b+1);if(-1!=d)return d}return-1};MeshBone.prototype.isLeaf=function(){return 0==this.children.length};MeshBone.prototype.deleteChildren=function(){for(var a=0;a<this.children.length;a++)this.children[a].deleteChildren();this.children=[]};MeshBone.prototype.setTagId=function(a){this.tag_id=a};MeshBone.prototype.getTagId=function(){return this.tag_id};
MeshBone.prototype.computeDirs=function(a,b){var c=vec3.create(),c=vec3.subtract(c,b,a),c=vec3.normalize(c,c),d=Utils.rotateVec_90(c),e={};e.first=c;e.second=d;return e};MeshBone.prototype.computeRestLength=function(){var a=vec3.create(),a=vec3.subtract(a,this.local_rest_end_pt,this.local_rest_start_pt);this.rest_length=vec3.length(a)};
function MeshRenderRegion(a,b,c,d,e,f,g){this.store_indices=a;this.store_rest_pts=b;this.store_uvs=c;this.use_uv_warp=this.use_post_displacements=this.use_local_displacements=!1;this.uv_warp_local_offset=vec2.fromValues(0,0);this.uv_warp_global_offset=vec2.fromValues(0,0);this.uv_warp_scale=vec2.fromValues(1,1);this.start_pt_index=d;this.end_pt_index=e;this.start_index=f;this.end_index=g;this.main_bone=null;this.local_displacements=[];this.post_displacements=[];this.uv_warp_ref_uvs=[];this.normal_weight_map=
{};this.fast_normal_weight_map=[];this.fast_bones_map=[];this.relevant_bones_indices=[];this.use_dq=!0;this.tag_id=-1;this.initUvWarp()}MeshRenderRegion.prototype.getIndicesIndex=function(){return this.start_index};MeshRenderRegion.prototype.getRestPtsIndex=function(){return 3*this.start_pt_index};MeshRenderRegion.prototype.getUVsIndex=function(){return 2*this.start_pt_index};MeshRenderRegion.prototype.getNumPts=function(){return this.end_pt_index-this.start_pt_index+1};
MeshRenderRegion.prototype.getStartPtIndex=function(){return this.start_pt_index};MeshRenderRegion.prototype.getEndPtIndex=function(){return this.end_pt_index};MeshRenderRegion.prototype.getNumIndices=function(){return this.end_index-this.start_index+1};MeshRenderRegion.prototype.getStartIndex=function(){return this.start_index};MeshRenderRegion.prototype.getEndIndex=function(){return this.end_index};
var accum_dq=new dualQuat,accum_mat=mat4.create(),final_pt=vec3.create(),tmp1=vec3.create(),tmp2=vec3.create();
MeshRenderRegion.prototype.poseFinalPts=function(a,b,c){for(var d=this.getRestPtsIndex(),e=0;16>e;e++)accum_mat[e]=0;Object.keys(c);e=0;for(c=this.getNumPts();e<c;e++){var f=vec3.set(tmp1,this.store_rest_pts[0+d],this.store_rest_pts[1+d],this.store_rest_pts[2+d]);1==this.use_local_displacements&&(f[Q_X]+=this.local_displacements[e][Q_X],f[Q_Y]+=this.local_displacements[e][Q_Y]);for(var g=0;16>g;g++)accum_mat[g]=0;accum_dq.reset();for(var h=this.relevant_bones_indices[e],k=h.length,g=0;g<k;g++){var l=
h[g],m=this.fast_normal_weight_map[l][e],n=m,l=this.fast_bones_map[l].getWorldDq();accum_dq.add(l,m,n)}accum_dq.normalize();f=vec3.set(tmp2,f[Q_X],f[Q_Y],f[Q_Z]);final_pt=accum_dq.transform(f);1==this.use_post_displacements&&(final_pt[Q_X]+=this.post_displacements[e][Q_X],final_pt[Q_Y]+=this.post_displacements[e][Q_Y]);a[0+b]=final_pt[Q_X];a[1+b]=final_pt[Q_Y];a[2+b]=final_pt[Q_Z];d+=3;b+=3}1==this.use_uv_warp&&this.runUvWarp()};
MeshRenderRegion.prototype.setMainBoneKey=function(a){this.main_bone_key=a};MeshRenderRegion.prototype.determineMainBone=function(a){this.main_bone=a.getChildByKey(this.main_bone_key)};MeshRenderRegion.prototype.setUseDq=function(a){this.use_dq=a};MeshRenderRegion.prototype.setName=function(a){this.name=a};MeshRenderRegion.prototype.getName=function(){return this.name};
MeshRenderRegion.prototype.setUseLocalDisplacements=function(a){this.use_local_displacements=a;if(this.local_displacements.length!=this.getNumPts()&&this.use_local_displacements)for(this.local_displacements=[],a=0;a<this.getNumPts();a++)this.local_displacements.push(vec2.create())};MeshRenderRegion.prototype.getUseLocalDisplacements=function(){return this.use_local_displacements};
MeshRenderRegion.prototype.setUsePostDisplacements=function(a){this.use_post_displacements=a;if(this.post_displacements.length!=this.getNumPts()&&this.use_post_displacements)for(this.post_displacements=[],a=0;a<this.getNumPts();a++)this.post_displacements.push(vec2.create())};MeshRenderRegion.prototype.getUsePostDisplacements=function(){return this.use_post_displacements};
MeshRenderRegion.prototype.getRestLocalPt=function(a){a=this.getRestPtsIndex()+3*a;return vec2.fromValues(this.store_rest_pts[0+a],this.store_rest_pts[1+a])};MeshRenderRegion.prototype.getLocalIndex=function(a){a=this.getIndicesIndex()+a;return this.store_indices[a]};MeshRenderRegion.prototype.clearLocalDisplacements=function(){for(var a=0;a<this.local_displacements.length;a++)this.local_displacements[a]=vec2.create()};
MeshRenderRegion.prototype.clearPostDisplacements=function(){for(var a=0;a<this.post_displacements.length;a++)this.post_displacements[a]=vec2.create()};MeshRenderRegion.prototype.setUseUvWarp=function(a){this.use_uv_warp=a;0==this.use_uv_warp&&this.restoreRefUv()};MeshRenderRegion.prototype.getUseUvWarp=function(){return this.use_uv_warp};MeshRenderRegion.prototype.setUvWarpLocalOffset=function(a){this.uv_warp_local_offset=a};
MeshRenderRegion.prototype.setUvWarpGlobalOffset=function(a){this.uv_warp_global_offset=a};MeshRenderRegion.prototype.setUvWarpScale=function(a){this.uv_warp_scale=a};MeshRenderRegion.prototype.getUvWarpLocalOffset=function(){return this.uv_warp_local_offset};MeshRenderRegion.prototype.getUvWarpGlobalOffset=function(){return this.uv_warp_global_offset};MeshRenderRegion.prototype.getUvWarpScale=function(){return this.uv_warp_scale};
MeshRenderRegion.prototype.runUvWarp=function(){for(var a=this.getUVsIndex(),b=0;b<this.uv_warp_ref_uvs.length;b++){var c=vec2.clone(this.uv_warp_ref_uvs[b]),c=vec2.subtract(c,c,this.uv_warp_local_offset);c[Q_X]*=this.uv_warp_scale[Q_X];c[Q_Y]*=this.uv_warp_scale[Q_Y];c=vec2.add(c,c,this.uv_warp_global_offset);this.store_uvs[0+a]=c[Q_X];this.store_uvs[1+a]=c[Q_Y];a+=2}};
MeshRenderRegion.prototype.restoreRefUv=function(){for(var a=this.getUVsIndex(),b=0;b<this.uv_warp_ref_uvs.length;b++){var c=this.uv_warp_ref_uvs[b];this.store_uvs[0+a]=c[Q_X];this.store_uvs[1+a]=c[Q_Y];a+=2}};MeshRenderRegion.prototype.getTagId=function(){return this.tag_id};MeshRenderRegion.prototype.setTagId=function(a){this.tag_id=a};
MeshRenderRegion.prototype.initFastNormalWeightMap=function(a){this.relevant_bones_indices=[];for(var b in a)this.fast_normal_weight_map.push(this.normal_weight_map[b]);for(var c=0;c<this.getNumPts();c++){for(var d=[],e=0;e<this.fast_normal_weight_map.length;e++).05<this.fast_normal_weight_map[e][c]&&d.push(e);this.relevant_bones_indices.push(d)}for(b in a)this.fast_bones_map.push(a[b])};
MeshRenderRegion.prototype.initUvWarp=function(){var a=this.getUVsIndex();this.uv_warp_ref_uvs=[];for(var b=0;b<this.getNumPts();b++)this.uv_warp_ref_uvs.push(vec2.create()),this.uv_warp_ref_uvs[b]=vec2.fromValues(this.store_uvs[a],this.store_uvs[a+1]),a+=2};function MeshRenderBoneComposition(){this.root_bone=null;this.bones_map={};this.regions=[];this.regions_map={}}MeshRenderBoneComposition.prototype.addRegion=function(a){this.regions.push(a)};
MeshRenderBoneComposition.prototype.setRootBone=function(a){this.root_bone=a};MeshRenderBoneComposition.prototype.getRootBone=function(){return this.root_bone};MeshRenderBoneComposition.prototype.initBoneMap=function(){this.bones_map=MeshRenderBoneComposition.genBoneMap(this.root_bone)};MeshRenderBoneComposition.prototype.initRegionsMap=function(){this.regions_map={};for(var a=0;a<this.regions.length;a++)cur_key=this.regions[a].getName(),this.regions_map[cur_key]=this.regions[a]};
MeshRenderBoneComposition.genBoneMap=function(a){for(var b={},c=a.getAllBoneKeys(),d=0;d<c.length;d++){var e=c[d];b[e]=a.getChildByKey(e)}return b};MeshRenderBoneComposition.prototype.getBonesMap=function(){return this.bones_map};MeshRenderBoneComposition.prototype.getRegionsMap=function(){return this.regions_map};MeshRenderBoneComposition.prototype.getRegions=function(){return this.regions};
MeshRenderBoneComposition.prototype.getRegionWithId=function(a){for(var b=0;b<this.regions.length;b++){var c=this.regions[b];if(c.getTagId()==a)return c}return null};MeshRenderBoneComposition.prototype.resetToWorldRestPts=function(){this.getRootBone().initWorldPts()};MeshRenderBoneComposition.prototype.updateAllTransforms=function(a){a&&this.getRootBone().computeParentTransforms();this.getRootBone().computeWorldDeltaTransforms();this.getRootBone().fixDQs(this.getRootBone().getWorldDq())};
function MeshBoneCache(a){this.key=a}MeshBoneCache.prototype.setWorldStartPt=function(a){this.world_start_pt=a};MeshBoneCache.prototype.setWorldEndPt=function(a){this.world_end_pt=a};MeshBoneCache.prototype.getWorldStartPt=function(){return this.world_start_pt};MeshBoneCache.prototype.getWorldEndPt=function(){return this.world_end_pt};MeshBoneCache.prototype.getKey=function(){return this.key};function MeshDisplacementCache(a){this.key=a;this.local_displacements=[];this.post_displacements=[]}
MeshDisplacementCache.prototype.setLocalDisplacements=function(a){this.local_displacements=a};MeshDisplacementCache.prototype.setPostDisplacements=function(a){this.post_displacements=a};MeshDisplacementCache.prototype.getKey=function(){return this.key};MeshDisplacementCache.prototype.getLocalDisplacements=function(){return this.local_displacements};MeshDisplacementCache.prototype.getPostDisplacements=function(){return this.post_displacements};
function MeshUVWarpCache(a){this.uv_warp_global_offset=vec2.create();this.uv_warp_local_offset=vec2.create();this.uv_warp_scale=vec2.fromValues(-1,-1);this.key=a;this.enabled=!1}MeshUVWarpCache.prototype.setUvWarpLocalOffset=function(a){this.uv_warp_local_offset=a};MeshUVWarpCache.prototype.setUvWarpGlobalOffset=function(a){this.uv_warp_global_offset=a};MeshUVWarpCache.prototype.setUvWarpScale=function(a){this.uv_warp_scale=a};MeshUVWarpCache.prototype.getUvWarpLocalOffset=function(){return this.uv_warp_local_offset};
MeshUVWarpCache.prototype.getUvWarpGlobalOffset=function(){return this.uv_warp_global_offset};MeshUVWarpCache.prototype.getUvWarpScale=function(){return this.uv_warp_scale};MeshUVWarpCache.prototype.getKey=function(){return this.key};MeshUVWarpCache.prototype.setEnabled=function(a){this.enabled=a};MeshUVWarpCache.prototype.getEnabled=function(){return this.enabled};
function MeshBoneCacheManager(){this.is_ready=!1;this.bone_cache_data_ready=this.bone_cache_table=null;this.bone_cache_table=[];this.bone_cache_data_ready=[]}MeshBoneCacheManager.prototype.init=function(a,b){this.start_time=a;this.end_time=b;var c=this.end_time-this.start_time+1;this.bone_cache_table=[];this.bone_cache_data_ready=[];for(var d=0;d<c;d++)this.bone_cache_table.push([]),this.bone_cache_data_ready.push(!1);this.is_ready=!1};MeshBoneCacheManager.prototype.getStartTime=function(){return this.start_time};
MeshBoneCacheManager.prototype.getEndime=function(){return this.end_time};MeshBoneCacheManager.prototype.getIndexByTime=function(a){a-=this.start_time;return a=Utils.clamp(a,0,this.bone_cache_table.length-1)};
MeshBoneCacheManager.prototype.retrieveValuesAtTime=function(a,b){var c=this.getIndexByTime(Math.floor(a)),d=this.getIndexByTime(Math.ceil(a)),e=a-Math.floor(a);if(0!=this.bone_cache_data_ready.length&&0!=this.bone_cache_data_ready[c]&&0!=this.bone_cache_data_ready[d])for(var c=this.bone_cache_table[c],d=this.bone_cache_table[d],f=0,g=c.length;f<g;f++){var h=c[f],k=d[f],l=h.getKey(),m=Utils.vecInterp(h.getWorldStartPt(),k.getWorldStartPt(),e),h=Utils.vecInterp(h.getWorldEndPt(),k.getWorldEndPt(),
e);b[l].setWorldStartPt(m);b[l].setWorldEndPt(h)}};MeshBoneCacheManager.prototype.allReady=function(){if(this.is_ready)return!0;for(var a=this.end_time-this.start_time+1,b=0,c=0;c<this.bone_cache_data_ready.size();c++)this.bone_cache_data_ready[c]&&b++;b==a&&(this.is_ready=!0);return this.is_ready};MeshBoneCacheManager.prototype.makeAllReady=function(){for(var a=0;a<this.bone_cache_data_ready.length;a++)this.bone_cache_data_ready[a]=!0};
function MeshDisplacementCacheManager(){this.is_ready=!1;this.displacement_cache_data_ready=this.displacement_cache_table=null;this.displacement_cache_table=[];this.displacement_cache_data_ready=[]}
MeshDisplacementCacheManager.prototype.init=function(a,b){this.start_time=a;this.end_time=b;var c=this.end_time-this.start_time+1;this.displacement_cache_table=[];this.displacement_cache_data_ready=[];for(var d=0;d<c;d++)this.displacement_cache_table.push([]),this.displacement_cache_data_ready.push(!1);this.is_ready=!1};MeshDisplacementCacheManager.prototype.getStartTime=function(){return this.start_time};MeshDisplacementCacheManager.prototype.getEndime=function(){return this.end_time};
MeshDisplacementCacheManager.prototype.getIndexByTime=function(a){a-=this.start_time;return a=Utils.clamp(a,0,this.displacement_cache_table.length-1)};
MeshDisplacementCacheManager.prototype.retrieveValuesAtTime=function(a,b){var c=this.getIndexByTime(Math.floor(a)),d=this.getIndexByTime(Math.ceil(a)),e=a-Math.floor(a);if(0!=this.displacement_cache_data_ready.length&&0!=this.displacement_cache_data_ready[c]&&0!=this.displacement_cache_data_ready[d])for(var c=this.displacement_cache_table[c],d=this.displacement_cache_table[d],f=0;f<c.length;f++){var g=c[f],h=d[f],k=g.getKey(),k=b[k];if(k.getUseLocalDisplacements()){var l=k.local_displacements;if(g.getLocalDisplacements().length==
l.length&&h.getLocalDisplacements().length==l.length)for(var m=0;m<l.length;m++){var n=Utils.vec2Interp(g.getLocalDisplacements()[m],h.getLocalDisplacements()[m],e);l[m]=n}else for(m=0;m<l.length;m++)l[m]=vec2.create()}if(k.getUsePostDisplacements())if(l=k.post_displacements,g.getPostDisplacements().length==l.length&&h.getPostDisplacements().length==l.length)for(m=0;m<l.length;m++)n=Utils.vec2Interp(g.getPostDisplacements()[m],h.getPostDisplacements()[m],e),l[m]=n;else for(m=0;m<l.length;m++)l.set[m]=
vec2.create()}};MeshDisplacementCacheManager.prototype.allReady=function(){if(this.is_ready)return!0;for(var a=this.end_time-this.start_time+1,b=0,c=0;c<this.displacement_cache_data_ready.length;c++)this.displacement_cache_data_ready[c]&&b++;b==a&&(this.is_ready=!0);return this.is_ready};MeshDisplacementCacheManager.prototype.makeAllReady=function(){for(var a=0;a<this.displacement_cache_data_ready.length;a++)this.displacement_cache_data_ready[a]=!0};
function MeshUVWarpCacheManager(){this.is_ready=!1;this.uv_cache_data_ready=this.uv_cache_table=null;this.uv_cache_table=[];this.uv_cache_data_ready=[]}MeshUVWarpCacheManager.prototype.init=function(a,b){this.start_time=a;this.end_time=b;var c=this.end_time-this.start_time+1;this.uv_cache_table=[];this.uv_cache_data_ready=[];for(var d=0;d<c;d++)this.uv_cache_table.push([]),this.uv_cache_data_ready.push(!1);this.is_ready=!1};MeshUVWarpCacheManager.prototype.getStartTime=function(){return this.start_time};
MeshUVWarpCacheManager.prototype.getEndime=function(){return this.end_time};MeshUVWarpCacheManager.prototype.getIndexByTime=function(a){a-=this.start_time;return a=Utils.clamp(a,0,this.uv_cache_table.length-1)};
MeshUVWarpCacheManager.prototype.retrieveValuesAtTime=function(a,b){var c=this.getIndexByTime(Math.floor(a)),d=this.getIndexByTime(Math.ceil(a));if(0!=this.uv_cache_data_ready.length&&0!=this.uv_cache_data_ready[c]&&0!=this.uv_cache_data_ready[d])for(c=this.uv_cache_table[c],d=0;d<c.length;d++){var e=c[d],f=e.getKey(),f=b[f];if(f.getUseUvWarp()){var g=e.getUvWarpLocalOffset(),h=e.getUvWarpGlobalOffset(),e=e.getUvWarpScale();f.setUvWarpLocalOffset(g);f.setUvWarpGlobalOffset(h);f.setUvWarpScale(e)}}};
MeshUVWarpCacheManager.prototype.allReady=function(){if(this.is_ready)return!0;for(var a=this.end_time-this.start_time+1,b=0,c=0;c<this.uv_cache_data_ready.length;c++)uv_cache_data_ready[c]&&b++;b==a&&(this.is_ready=!0);return this.is_ready};MeshUVWarpCacheManager.prototype.makeAllReady=function(){for(var a=0;a<this.uv_cache_data_ready.length;a++)this.uv_cache_data_ready[a]=!0};
var CreatureModuleUtils={GetAllAnimationNames:function(a){a=a.animation;var b=[],c;for(c in a)b.push(c);return b},getFloatArray:function(a){return a},getIntArray:function(a){return a},ReadPointsArray2DJSON:function(a,b){for(var c=CreatureModuleUtils.getFloatArray(a[b]),d=[],e=c.length/2,f=0;f<e;f++){var g=2*f;d.push(vec2.fromValues(c[0+g],c[1+g]))}return d},ReadFloatArray3DJSON:function(a,b){for(var c=CreatureModuleUtils.getFloatArray(a[b]),d=[],e=c.length/2,f=0;f<e;f++){var g=2*f;d.push(c[0+g]);
d.push(c[1+g]);d.push(0)}return d},ReadBoolJSON:function(a,b){return a[b]},ReadFloatArrayJSON:function(a,b){return a[b]},ReadIntArrayJSON:function(a,b){return a[b]},ReadMatrixJSON:function(a,b){for(var c=CreatureModuleUtils.getFloatArray(a[b]),d=mat4.create(),e=0;16>e;e++)d[e]=c[e];return d},ReadVector2JSON:function(a,b){var c=CreatureModuleUtils.getFloatArray(a[b]);return vec2.fromValues(c[0],c[1])},ReadVector3JSON:function(a,b){var c=CreatureModuleUtils.getFloatArray(a[b]);return vec3.fromValues(c[0],
c[1],0)},CreateBones:function(a,b){var c=null,d=a[b],e={},f={},g;for(g in d){var h=d[g],k=h.id,l=CreatureModuleUtils.ReadMatrixJSON(h,"restParentMat"),m=CreatureModuleUtils.ReadVector3JSON(h,"localRestStartPt"),n=CreatureModuleUtils.ReadVector3JSON(h,"localRestEndPt"),h=CreatureModuleUtils.ReadIntArrayJSON(h,"children"),l=new MeshBone(g,vec3.create(),vec3.create(),l);l.local_rest_start_pt=m;l.local_rest_end_pt=n;l.calcRestData();l.setTagId(k);e[k]={first:l,second:h};for(m=0;m<h.length;m++)n=h[m],
f[n]=n}for(k in e)if(0==k in f){f=e[k];c=f.first;break}for(k in e)for(f=e[k],d=f.first,f=f.second,m=0;m<f.length;m++)n=f[m],d.addChild(e[n].first);return c},CreateRegions:function(a,b,c,d,e){var f=[];a=a[b];for(var g in a){var h=a[g],k=h.id;b=new MeshRenderRegion(c,d,e,h.start_pt_index,h.end_pt_index,h.start_index,h.end_index);b.setName(g);b.setTagId(k);var k=b.normal_weight_map,h=h.weights,l;for(l in h){var m=CreatureModuleUtils.ReadFloatArrayJSON(h,l);k[l]=m}f.push(b)}return f},GetStartEndTimes:function(a,
b){var c=0,d=0,e=!0,f=a[b],g;for(g in f)f=parseInt(g),e?(d=c=f,e=!1):(f>d&&(d=f),f<c&&(c=f));return{first:c,second:d}},FillBoneCache:function(a,b,c,d,e){a=a[b];e.init(c,d);for(var f in a){c=a[f];cache_list=[];for(var g in c){b=c[g];d=CreatureModuleUtils.ReadVector3JSON(b,"start_pt");b=CreatureModuleUtils.ReadVector3JSON(b,"end_pt");var h=new MeshBoneCache(g);h.setWorldStartPt(d);h.setWorldEndPt(b);cache_list.push(h)}c=e.getIndexByTime(f);e.bone_cache_table[c]=cache_list}e.makeAllReady()},FillDeformationCache:function(a,
b,c,d,e){a=a[b];e.init(c,d);for(var f in a){d=a[f];c=[];for(var g in d){b=d[g];var h=new MeshDisplacementCache(g),k=CreatureModuleUtils.ReadBoolJSON(b,"use_local_displacements"),l=CreatureModuleUtils.ReadBoolJSON(b,"use_post_displacements");1==k&&(k=CreatureModuleUtils.ReadPointsArray2DJSON(b,"local_displacements"),h.setLocalDisplacements(k));1==l&&(k=CreatureModuleUtils.ReadPointsArray2DJSON(b,"post_displacements"),h.setPostDisplacements(k));c.push(h)}d=e.getIndexByTime(f);e.displacement_cache_table[d]=
c}e.makeAllReady()},FillUVSwapCache:function(a,b,c,d,e){a=a[b];e.init(c,d);for(var f in a){d=a[f];c=[];for(var g in d){var h=d[g];b=new MeshUVWarpCache(g);var k=CreatureModuleUtils.ReadBoolJSON(h,"enabled");b.setEnabled(k);if(1==k){var k=CreatureModuleUtils.ReadVector2JSON(h,"local_offset"),l=CreatureModuleUtils.ReadVector2JSON(h,"global_offset"),h=CreatureModuleUtils.ReadVector2JSON(h,"scale");b.setUvWarpLocalOffset(k);b.setUvWarpGlobalOffset(l);b.setUvWarpScale(h)}c.push(b)}d=e.getIndexByTime(f);
e.uv_cache_table[d]=c}e.makeAllReady()}};function Creature(a){this.total_num_indices=this.total_num_pts=0;this.render_composition=this.render_colours=this.render_pts=this.global_uvs=this.global_pts=this.global_indices=null;this.boundary_indices=[];this.boundary_min=vec2.create();this.boundary_max=vec2.create();this.LoadFromData(a)}
Creature.prototype.FillRenderColours=function(a,b,c,d){for(var e=0;e<this.total_num_pts;e++){var f=4*e;this.render_colours[0+f]=a;this.render_colours[1+f]=b;this.render_colours[2+f]=c;this.render_colours[3+f]=d}};
Creature.prototype.ComputeBoundaryIndices=function(){for(var a={},b=0;b<this.total_num_pts;b++)a[b]=0;for(var c=this.render_composition.getRegions(),b=0;b<this.global_indices.length;b++){for(var d=this.global_indices[b],e=!1,f=0;f<c.length;f++){var g=c[f],h=g.getStartPtIndex(),g=g.getEndPtIndex();if(d>=h&&d<=g){e=!0;break}}e&&a[d]++}this.boundary_indices=[];for(b=0;b<this.total_num_pts;b++)5>=a[b]&&this.boundary_indices.push(b)};
Creature.prototype.ComputeBoundaryMinMax=function(){0>=this.boundary_indices.length&&this.ComputeBoundaryIndices();for(var a=3*this.boundary_indices[0],a=vec2.fromValues(this.render_pts[a+0],this.render_pts[a+1]),b=vec2.fromValues(a[0],a[1]),c=0;c<this.boundary_indices.length;c++){var d=3*this.boundary_indices[c],e=this.render_pts[d],d=this.render_pts[d+1];a[0]>e&&(a[0]=e);a[1]>d&&(a[1]=d);b[0]<e&&(b[0]=e);b[1]<d&&(b[1]=d)}this.boundary_min=a;this.boundary_max=b};
Creature.prototype.LoadFromData=function(a){var b=a.mesh;this.global_pts=CreatureModuleUtils.ReadFloatArray3DJSON(b,"points");this.total_num_pts=this.global_pts.length/3;this.global_indices=CreatureModuleUtils.ReadIntArrayJSON(b,"indices");this.total_num_indices=this.global_indices.length;this.global_uvs=CreatureModuleUtils.ReadFloatArrayJSON(b,"uvs");this.render_colours=[];for(var c=0;c<4*this.total_num_pts;c++)this.render_colours.push(0);this.FillRenderColours(1,1,1,1);this.render_pts=[];a=CreatureModuleUtils.CreateBones(a,
"skeleton");b=CreatureModuleUtils.CreateRegions(b,"regions",this.global_indices,this.global_pts,this.global_uvs);this.render_composition=new MeshRenderBoneComposition;this.render_composition.setRootBone(a);this.render_composition.getRootBone().computeRestParentTransforms();for(c=0;c<b.length;c++){var d=b[c];d.setMainBoneKey(a.getKey());d.determineMainBone(a);this.render_composition.addRegion(d)}this.render_composition.initBoneMap();this.render_composition.initRegionsMap();for(c=0;c<b.length;c++)d=
b[c],d.initFastNormalWeightMap(this.render_composition.bones_map);this.render_composition.resetToWorldRestPts()};function CreatureAnimation(a,b){this.name=b;this.bones_cache=new MeshBoneCacheManager;this.displacement_cache=new MeshDisplacementCacheManager;this.uv_warp_cache=new MeshUVWarpCacheManager;this.cache_pts=[];this.fill_cache_pts=[];this.LoadFromData(b,a)}
CreatureAnimation.prototype.LoadFromData=function(a,b){var c=b.animation[a],d=CreatureModuleUtils.GetStartEndTimes(c,"bones");this.start_time=d.first;this.end_time=d.second;CreatureModuleUtils.FillBoneCache(c,"bones",this.start_time,this.end_time,this.bones_cache);CreatureModuleUtils.FillDeformationCache(c,"meshes",this.start_time,this.end_time,this.displacement_cache);CreatureModuleUtils.FillUVSwapCache(c,"uv_swaps",this.start_time,this.end_time,this.uv_warp_cache)};
CreatureAnimation.prototype.getIndexByTime=function(a){a-=this.start_time;return a=Utils.clamp(a,0,this.cache_pts.length-1)};CreatureAnimation.prototype.verifyFillCache=function(){this.fill_cache_pts.length==this.end_time-this.start_time+1&&(this.cache_pts=this.fill_cache_pts)};
CreatureAnimation.prototype.poseFromCachePts=function(a,b,c){var d=this.getIndexByTime(Math.floor(a)),e=this.getIndexByTime(Math.ceil(a));a-=Math.floor(a);for(var d=this.cache_pts[d],e=this.cache_pts[e],f=0,g=0,h=0,k=0;k<c;k++)b[f+0]=(1-a)*d[g+0]+a*e[h+0],b[f+1]=(1-a)*d[g+1]+a*e[h+1],b[f+2]=(1-a)*d[g+2]+a*e[h+2],f+=3,g+=3,h+=3};
function CreatureManager(a){this.target_creature=a;this.is_playing=!1;this.run_time=0;this.time_scale=30;this.blending_factor=0;this.should_loop=!0;this.use_custom_time_range=!1;this.custom_end_time=this.custom_start_time=0;this.animations={};this.bones_override_callback=null;this.blend_render_pts=[];this.blend_render_pts.push([]);this.blend_render_pts.push([]);this.do_blending=!1;this.active_blend_animation_names=[];this.active_blend_animation_names.push("");this.active_blend_animation_names.push("")}
CreatureManager.prototype.CreateAnimation=function(a,b){var c=new CreatureAnimation(a,b);this.AddAnimation(c)};CreatureManager.prototype.CreateAllAnimations=function(a){for(var b=CreatureModuleUtils.GetAllAnimationNames(a),c=0;c<b.length;c++)this.CreateAnimation(a,b[c]);this.SetActiveAnimationName(b.get(0))};CreatureManager.prototype.AddAnimation=function(a){this.animations[a.name]=a};CreatureManager.prototype.GetAnimation=function(a){return this.animations[a]};
CreatureManager.prototype.GetCreature=function(){return this.target_creature};CreatureManager.prototype.GetAnimationNames=function(){var a=[],b;for(b in animations)a.push(b);return a};
CreatureManager.prototype.SetActiveAnimationName=function(a,b){if(null==a||0==a in this.animations||1==b&&this.active_animation_name==a)return!1;this.active_animation_name=a;var c=this.animations[this.active_animation_name];this.run_time=c.start_time;for(var d=c.displacement_cache.displacement_cache_table[0],c=c.uv_warp_cache.uv_cache_table[0],e=this.target_creature.render_composition.getRegions(),f=0,g=0;g<e.length;g++){var h=e[g],k=0!=d[f].getLocalDisplacements().length,l=0!=d[f].getPostDisplacements().length;
h.setUseLocalDisplacements(k);h.setUsePostDisplacements(l);h.setUseUvWarp(c[f].getEnabled());f++}return!0};CreatureManager.prototype.GetActiveAnimationName=function(){return this.active_animation_name};CreatureManager.prototype.GetAllAnimations=function(){return this.animations};
CreatureManager.prototype.MakePointCache=function(a){var b=this.getRunTime(),c=this.animations[a];if(!(0<c.length)){for(var d=c.cache_pts,e=c.start_time;e<=c.end_time;e++){this.setRunTime(e);for(var f=[],g=0;g<3*this.target_creature.total_num_pts;g++)f[g]=0;this.PoseCreature(a,f);d.push(f)}this.setRunTime(b)}};
CreatureManager.prototype.FillSinglePointCacheFrame=function(a,b){var c=this.getRunTime(),d=this.animations[a];this.setRunTime(b);for(var e=[],f=0;f<3*this.target_creature.total_num_pts;f++)e[f]=0;this.PoseCreature(a,e);d.fill_cache_pts.push(e);d.verifyFillCache();this.setRunTime(c)};CreatureManager.prototype.GetIsPlaying=function(){return this.is_playing};CreatureManager.prototype.SetShouldLoop=function(a){this.should_loop=a};
CreatureManager.prototype.SetUseCustomTimeRange=function(a){this.use_custom_time_range=a};CreatureManager.prototype.SetCustomTimeRange=function(a,b){this.custom_start_time=a;this.custom_end_time=b};CreatureManager.prototype.SetIsPlaying=function(a){this.is_playing=a};CreatureManager.prototype.ResetToStartTimes=function(){this.run_time=this.animations[active_animation_name].start_time};CreatureManager.prototype.setRunTime=function(a){this.run_time=a;this.correctTime()};
CreatureManager.prototype.increRunTime=function(a){this.run_time+=a;this.correctTime()};CreatureManager.prototype.correctTime=function(){var a=this.animations[this.active_animation_name],b=a.start_time,a=a.end_time;this.use_custom_time_range&&(b=this.custom_start_time,a=this.custom_end_time);this.run_time>a?this.run_time=this.should_loop?b:a:this.run_time<b&&(this.run_time=this.should_loop?a:b)};CreatureManager.prototype.getRunTime=function(){return this.run_time};
CreatureManager.prototype.Update=function(a){this.is_playing&&(this.increRunTime(a*this.time_scale),this.RunCreature())};CreatureManager.prototype.RunAtTime=function(a){this.is_playing&&(this.setRunTime(a),this.RunCreature())};
CreatureManager.prototype.RunCreature=function(){if(this.do_blending){for(var a=0;2>a;a++){var b=this.animations[this.active_blend_animation_names[a]];0<b.cache_pts.length?b.poseFromCachePts(this.getRunTime(),this.blend_render_pts[a],this.target_creature.total_num_pts):this.PoseCreature(this.active_blend_animation_names[a],this.blend_render_pts[a])}for(a=0;a<3*this.target_creature.total_num_pts;a++)this.target_creature.render_pts.set(a,(1-blending_factor)*this.blend_render_pts[0][a]+blending_factor*
this.blend_render_pts[1][a])}else b=this.animations[this.active_animation_name],0<b.cache_pts.length?b.poseFromCachePts(this.getRunTime(),this.target_creature.render_pts,this.target_creature.total_num_pts):this.PoseCreature(this.active_animation_name,this.target_creature.render_pts)};CreatureManager.prototype.SetTimeScale=function(a){this.time_scale=a};
CreatureManager.prototype.SetBlending=function(a){if(this.do_blending=a){if(0==this.blend_render_pts[0].length){a=[];for(var b=0;b<3*target_creature.total_num_pts;b++)a.push(0);this.blend_render_pts.set(0,a)}if(0==this.blend_render_pts[1].length){a=[];for(b=0;b<3*this.target_creature.total_num_pts;b++)a.push(0);this.blend_render_pts[1]=a}}};CreatureManager.prototype.SetBlendingAnimations=function(a,b){this.active_blend_animation_names[0]=a;this.active_blend_animation_names[1]=b};
CreatureManager.prototype.SetBlendingFactor=function(a){this.blending_factor=a};CreatureManager.prototype.IsContactBone=function(a,b){var c=this.target_creature.render_composition.getRootBone();return this.ProcessContactBone(a,b,c)};
CreatureManager.prototype.PoseCreature=function(a,b){var c=this.animations[a],d=c.bones_cache,e=c.displacement_cache,f=c.uv_warp_cache,c=this.target_creature.render_composition,g=c.getBonesMap(),h=c.getRegionsMap();d.retrieveValuesAtTime(this.getRunTime(),g);null!=this.bones_override_callback&&this.bones_override_callback(g);e.retrieveValuesAtTime(this.getRunTime(),h);f.retrieveValuesAtTime(this.getRunTime(),h);d=c.getRegions();e=c.getBonesMap();c.updateAllTransforms(!1);c=0;for(f=d.length;c<f;c++)for(g=
d[c],h=g.getStartPtIndex(),g.poseFinalPts(b,3*h,e),h=3*g.getStartPtIndex(),g=3*g.getEndPtIndex();h<=g;h+=3)b[h+2]=.001*-c};var PIXI=PIXI||{};PIXI.game=null;PIXI.WEBGL_RENDERER=0;PIXI.CANVAS_RENDERER=1;PIXI.VERSION="v2.2.9";PIXI._UID=0;"undefined"!=typeof Float32Array?(PIXI.Float32Array=Float32Array,PIXI.Uint16Array=Uint16Array,PIXI.Uint32Array=Uint32Array,PIXI.ArrayBuffer=ArrayBuffer):(PIXI.Float32Array=Array,PIXI.Uint16Array=Array);PIXI.PI_2=2*Math.PI;PIXI.RAD_TO_DEG=180/Math.PI;
PIXI.DEG_TO_RAD=Math.PI/180;PIXI.RETINA_PREFIX="@2x";
PIXI.DisplayObject=function(){this.position=new PIXI.Point(0,0);this.scale=new PIXI.Point(1,1);this.pivot=new PIXI.Point(0,0);this.rotation=0;this.alpha=1;this.visible=!0;this.hitArea=null;this.renderable=!1;this.parent=null;this.worldAlpha=1;this.worldTransform=new PIXI.Matrix;this.worldPosition=new PIXI.Point(0,0);this.worldScale=new PIXI.Point(1,1);this.worldRotation=0;this.filterArea=null;this._sr=0;this._cr=1;this._bounds=new PIXI.Rectangle(0,0,0,0);this._mask=this._currentBounds=null;this._cacheIsDirty=
this._cacheAsBitmap=!1};PIXI.DisplayObject.prototype.constructor=PIXI.DisplayObject;
PIXI.DisplayObject.prototype={destroy:function(){if(this.children){for(var a=this.children.length;a--;)this.children[a].destroy();this.children=[]}this.filterArea=this.worldTransform=this.parent=this.hitArea=null;this.renderable=!1;this._mask=this._currentBounds=this._bounds=null;this._destroyCachedSprite()},updateTransform:function(a){if(!a&&!this.parent&&!this.game)return this;var b=this.parent;a?b=a:this.parent||(b=this.game.world);a=b.worldTransform;var c=this.worldTransform,d,e,f,g,h,k;if(this.rotation%
PIXI.PI_2){this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation));d=this._cr*this.scale.x;e=this._sr*this.scale.x;f=-this._sr*this.scale.y;g=this._cr*this.scale.y;h=this.position.x;k=this.position.y;if(this.pivot.x||this.pivot.y)h-=this.pivot.x*d+this.pivot.y*f,k-=this.pivot.x*e+this.pivot.y*g;c.a=d*a.a+e*a.c;c.b=d*a.b+e*a.d;c.c=f*a.a+g*a.c;c.d=f*a.b+g*a.d}else d=this.scale.x,g=this.scale.y,h=this.position.x-this.pivot.x*
d,k=this.position.y-this.pivot.y*g,c.a=d*a.a,c.b=d*a.b,c.c=g*a.c,c.d=g*a.d;c.tx=h*a.a+k*a.c+a.tx;c.ty=h*a.b+k*a.d+a.ty;this.worldAlpha=this.alpha*b.worldAlpha;this.worldPosition.set(c.tx,c.ty);this.worldScale.set(this.scale.x*Math.sqrt(c.a*c.a+c.c*c.c),this.scale.y*Math.sqrt(c.b*c.b+c.d*c.d));this.worldRotation=Math.atan2(-c.c,c.d);this._currentBounds=null;this.transformCallback&&this.transformCallback.call(this.transformCallbackContext,c,a);return this},preUpdate:function(){},generateTexture:function(a,
b,c){var d=this.getLocalBounds();a=new PIXI.RenderTexture(d.width|0,d.height|0,c,b,a);PIXI.DisplayObject._tempMatrix.tx=-d.x;PIXI.DisplayObject._tempMatrix.ty=-d.y;a.render(this,PIXI.DisplayObject._tempMatrix);return a},updateCache:function(){this._generateCachedSprite();return this},toGlobal:function(a){this.updateTransform();return this.worldTransform.apply(a)},toLocal:function(a,b){b&&(a=b.toGlobal(a));this.updateTransform();return this.worldTransform.applyInverse(a)},_renderCachedSprite:function(a){this._cachedSprite.worldAlpha=
this.worldAlpha;a.gl?PIXI.Sprite.prototype._renderWebGL.call(this._cachedSprite,a):PIXI.Sprite.prototype._renderCanvas.call(this._cachedSprite,a)},_generateCachedSprite:function(){this._cacheAsBitmap=!1;var a=this.getLocalBounds();a.width=Math.max(1,Math.ceil(a.width));a.height=Math.max(1,Math.ceil(a.height));this.updateTransform();if(this._cachedSprite)this._cachedSprite.texture.resize(a.width,a.height);else{var b=new PIXI.RenderTexture(a.width,a.height);this._cachedSprite=new PIXI.Sprite(b);this._cachedSprite.worldTransform=
this.worldTransform}b=this._filters;this._filters=null;this._cachedSprite.filters=b;PIXI.DisplayObject._tempMatrix.tx=-a.x;PIXI.DisplayObject._tempMatrix.ty=-a.y;this._cachedSprite.texture.render(this,PIXI.DisplayObject._tempMatrix,!0);this._cachedSprite.anchor.x=-(a.x/a.width);this._cachedSprite.anchor.y=-(a.y/a.height);this._filters=b;this._cacheAsBitmap=!0},_destroyCachedSprite:function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)}};
PIXI.DisplayObject.prototype.displayObjectUpdateTransform=PIXI.DisplayObject.prototype.updateTransform;
Object.defineProperties(PIXI.DisplayObject.prototype,{x:{get:function(){return this.position.x},set:function(a){this.position.x=a}},y:{get:function(){return this.position.y},set:function(a){this.position.y=a}},worldVisible:{get:function(){if(this.visible){var a=this.parent;if(a){do{if(!a.visible)return!1;a=a.parent}while(a)}else return this.visible;return!0}return!1}},mask:{get:function(){return this._mask},set:function(a){this._mask&&(this._mask.isMask=!1);if(this._mask=a)this._mask.isMask=!0}},
filters:{get:function(){return this._filters},set:function(a){if(Array.isArray(a)){for(var b=[],c=0;c<a.length;c++)for(var d=a[c].passes,e=0;e<d.length;e++)b.push(d[e]);this._filterBlock={target:this,filterPasses:b}}this._filters=a;this.blendMode&&this.blendMode===PIXI.blendModes.MULTIPLY&&(this.blendMode=PIXI.blendModes.NORMAL)}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(a){this._cacheAsBitmap!==a&&(a?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=
a)}}});PIXI.DisplayObjectContainer=function(){PIXI.DisplayObject.call(this);this.children=[];this.ignoreChildInput=!1};PIXI.DisplayObjectContainer.prototype=Object.create(PIXI.DisplayObject.prototype);PIXI.DisplayObjectContainer.prototype.constructor=PIXI.DisplayObjectContainer;PIXI.DisplayObjectContainer.prototype.addChild=function(a){return this.addChildAt(a,this.children.length)};
PIXI.DisplayObjectContainer.prototype.addChildAt=function(a,b){if(0<=b&&b<=this.children.length)return a.parent&&a.parent.removeChild(a),a.parent=this,this.children.splice(b,0,a),a;throw Error(a+"addChildAt: The index "+b+" supplied is out of bounds "+this.children.length);};
PIXI.DisplayObjectContainer.prototype.swapChildren=function(a,b){if(a!==b){var c=this.getChildIndex(a),d=this.getChildIndex(b);if(0>c||0>d)throw Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[c]=b;this.children[d]=a}};PIXI.DisplayObjectContainer.prototype.getChildIndex=function(a){a=this.children.indexOf(a);if(-1===a)throw Error("The supplied DisplayObject must be a child of the caller");return a};
PIXI.DisplayObjectContainer.prototype.setChildIndex=function(a,b){if(0>b||b>=this.children.length)throw Error("The supplied index is out of bounds");var c=this.getChildIndex(a);this.children.splice(c,1);this.children.splice(b,0,a)};PIXI.DisplayObjectContainer.prototype.getChildAt=function(a){if(0>a||a>=this.children.length)throw Error("getChildAt: Supplied index "+a+" does not exist in the child list, or the supplied DisplayObject must be a child of the caller");return this.children[a]};
PIXI.DisplayObjectContainer.prototype.removeChild=function(a){a=this.children.indexOf(a);if(-1!==a)return this.removeChildAt(a)};PIXI.DisplayObjectContainer.prototype.removeChildAt=function(a){var b=this.getChildAt(a);b&&(b.parent=void 0,this.children.splice(a,1));return b};
PIXI.DisplayObjectContainer.prototype.removeChildren=function(a,b){void 0===a&&(a=0);void 0===b&&(b=this.children.length);var c=b-a;if(0<c&&c<=b){for(var c=this.children.splice(begin,c),d=0;d<c.length;d++)c[d].parent=void 0;return c}if(0===c&&0===this.children.length)return[];throw Error("removeChildren: Range Error, numeric values are outside the acceptable range");};
PIXI.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible&&(this.displayObjectUpdateTransform(),!this._cacheAsBitmap))for(var a=0;a<this.children.length;a++)this.children[a].updateTransform()};PIXI.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform=PIXI.DisplayObjectContainer.prototype.updateTransform;
PIXI.DisplayObjectContainer.prototype.getBounds=function(a){var b=a&&a instanceof PIXI.DisplayObject,c=!0;b?c=a instanceof PIXI.DisplayObjectContainer?a.contains(this):!1:a=this;var d;if(b){var e=a.worldTransform;a.worldTransform=PIXI.identityMatrix;for(d=0;d<a.children.length;d++)a.children[d].updateTransform()}var f=Infinity,g=Infinity,h=-Infinity,k=-Infinity,l,m,n=!1;for(d=0;d<this.children.length;d++)this.children[d].visible&&(n=!0,l=this.children[d].getBounds(),f=f<l.x?f:l.x,g=g<l.y?g:l.y,m=
l.width+l.x,l=l.height+l.y,h=h>m?h:m,k=k>l?k:l);m=this._bounds;if(!n){m=new PIXI.Rectangle;var p=m.x,h=m.width+m.x,k=m.y,n=m.height+m.y;d=this.worldTransform;var q=d.a,t=d.b,r=d.c,F=d.d,H=d.tx,G=d.ty,f=q*h+r*n+H,g=F*n+t*h+G;d=q*p+r*n+H;n=F*n+t*p+G;l=q*p+r*k+H;p=F*k+t*p+G;q=q*h+r*k+H;t=F*k+t*h+G;h=f;k=g;f=d<f?d:f;f=l<f?l:f;f=q<f?q:f;g=n<g?n:g;g=p<g?p:g;g=t<g?t:g;h=d>h?d:h;h=l>h?l:h;h=q>h?q:h;k=n>k?n:k;k=p>k?p:k;k=t>k?t:k}m.x=f;m.y=g;m.width=h-f;m.height=k-g;if(b)for(a.worldTransform=e,d=0;d<a.children.length;d++)a.children[d].updateTransform();
c||(a=a.getBounds(),m.x-=a.x,m.y-=a.y);return m};PIXI.DisplayObjectContainer.prototype.getLocalBounds=function(){return this.getBounds(this)};PIXI.DisplayObjectContainer.prototype.contains=function(a){return a?a===this?!0:this.contains(a.parent):!1};
PIXI.DisplayObjectContainer.prototype._renderWebGL=function(a){if(this.visible&&!(0>=this.alpha))if(this._cacheAsBitmap)this._renderCachedSprite(a);else{var b;if(this._mask||this._filters){this._filters&&(a.spriteBatch.flush(),a.filterManager.pushFilter(this._filterBlock));this._mask&&(a.spriteBatch.stop(),a.maskManager.pushMask(this.mask,a),a.spriteBatch.start());for(b=0;b<this.children.length;b++)this.children[b]._renderWebGL(a);a.spriteBatch.stop();this._mask&&a.maskManager.popMask(this._mask,
a);this._filters&&a.filterManager.popFilter();a.spriteBatch.start()}else for(b=0;b<this.children.length;b++)this.children[b]._renderWebGL(a)}};PIXI.DisplayObjectContainer.prototype._renderCanvas=function(a){if(!1!==this.visible&&0!==this.alpha)if(this._cacheAsBitmap)this._renderCachedSprite(a);else{this._mask&&a.maskManager.pushMask(this._mask,a);for(var b=0;b<this.children.length;b++)this.children[b]._renderCanvas(a);this._mask&&a.maskManager.popMask(a)}};
Object.defineProperty(PIXI.DisplayObjectContainer.prototype,"width",{get:function(){return this.getLocalBounds().width*this.scale.x},set:function(a){var b=this.getLocalBounds().width;this.scale.x=0!==b?a/b:1;this._width=a}});Object.defineProperty(PIXI.DisplayObjectContainer.prototype,"height",{get:function(){return this.getLocalBounds().height*this.scale.y},set:function(a){var b=this.getLocalBounds().height;this.scale.y=0!==b?a/b:1;this._height=a}});
PIXI.Sprite=function(a){PIXI.DisplayObjectContainer.call(this);this.anchor=new PIXI.Point;this.texture=a||PIXI.Texture.emptyTexture;this._height=this._width=0;this.tint=16777215;this.cachedTint=-1;this.tintedTexture=null;this.blendMode=PIXI.blendModes.NORMAL;this.shader=null;this.exists=!0;if(this.texture.baseTexture.hasLoaded)this.onTextureUpdate();this.renderable=!0};PIXI.Sprite.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);PIXI.Sprite.prototype.constructor=PIXI.Sprite;
Object.defineProperty(PIXI.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(a){this.scale.x=a/this.texture.frame.width;this._width=a}});Object.defineProperty(PIXI.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(a){this.scale.y=a/this.texture.frame.height;this._height=a}});
PIXI.Sprite.prototype.setTexture=function(a,b){void 0!==b&&this.texture.baseTexture.destroy();this.texture.baseTexture.skipRender=!1;this.texture=a;this.texture.valid=!0;this.cachedTint=-1};PIXI.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width);this._height&&(this.scale.y=this._height/this.texture.frame.height)};
PIXI.Sprite.prototype.getBounds=function(a){var b=this.texture.frame.width,c=this.texture.frame.height,d=b*(1-this.anchor.x),b=b*-this.anchor.x,e=c*(1-this.anchor.y),f=c*-this.anchor.y,c=a||this.worldTransform,g=c.a,h=c.b,k=c.c;a=c.d;var l=c.tx,m=c.ty,n=c=-Infinity,p=Infinity,q=Infinity;if(0===h&&0===k)0>g&&(g*=-1,c=d,d=-b,b=-c),0>a&&(a*=-1,c=e,e=-f,f=-c),p=g*b+l,c=g*d+l,q=a*f+m,n=a*e+m;else var t=g*b+k*f+l,r=a*f+h*b+m,F=g*d+k*f+l,f=a*f+h*d+m,H=g*d+k*e+l,d=a*e+h*d+m,g=g*b+k*e+l,b=a*e+h*b+m,p=t<p?
t:p,p=F<p?F:p,p=H<p?H:p,p=g<p?g:p,q=r<q?r:q,q=f<q?f:q,q=d<q?d:q,q=b<q?b:q,c=t>c?t:c,c=F>c?F:c,c=H>c?H:c,c=g>c?g:c,n=r>n?r:n,n=f>n?f:n,n=d>n?d:n,n=b>n?b:n;b=this._bounds;b.x=p;b.width=c-p;b.y=q;b.height=n-q;return this._currentBounds=b};
PIXI.Sprite.prototype.getLocalBounds=function(){var a=this.worldTransform;this.worldTransform=PIXI.identityMatrix;for(var b=0;b<this.children.length;b++)this.children[b].updateTransform();var c=this.getBounds();this.worldTransform=a;for(b=0;b<this.children.length;b++)this.children[b].updateTransform();return c};
PIXI.Sprite.prototype._renderWebGL=function(a,b){if(this.visible&&!(0>=this.alpha)&&this.renderable){var c=this.worldTransform;b&&(c=b);if(this._mask||this._filters){c=a.spriteBatch;this._filters&&(c.flush(),a.filterManager.pushFilter(this._filterBlock));this._mask&&(c.stop(),a.maskManager.pushMask(this.mask,a),c.start());c.render(this);for(var d=0;d<this.children.length;d++)this.children[d]._renderWebGL(a);c.stop();this._mask&&a.maskManager.popMask(this._mask,a);this._filters&&a.filterManager.popFilter();
c.start()}else for(a.spriteBatch.render(this),d=0;d<this.children.length;d++)this.children[d]._renderWebGL(a,c)}};
PIXI.Sprite.prototype._renderCanvas=function(a,b){if(!(!this.visible||0===this.alpha||!this.renderable||0>=this.texture.crop.width||0>=this.texture.crop.height)){var c=this.worldTransform;b&&(c=b);this.blendMode!==a.currentBlendMode&&(a.currentBlendMode=this.blendMode,a.context.globalCompositeOperation=PIXI.blendModesCanvas[a.currentBlendMode]);this._mask&&a.maskManager.pushMask(this._mask,a);if(this.texture.valid){var d=this.texture.baseTexture.resolution/a.resolution;a.context.globalAlpha=this.worldAlpha;
a.smoothProperty&&a.scaleMode!==this.texture.baseTexture.scaleMode&&(a.scaleMode=this.texture.baseTexture.scaleMode,a.context[a.smoothProperty]=a.scaleMode===PIXI.scaleModes.LINEAR);var e=this.texture.trim?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width,f=this.texture.trim?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height,g=c.tx*a.resolution+a.shakeX,h=c.ty*a.resolution+a.shakeY;a.roundPixels?(a.context.setTransform(c.a,
c.b,c.c,c.d,g|0,h|0),e|=0,f|=0):a.context.setTransform(c.a,c.b,c.c,c.d,g,h);c=this.texture.crop.width;g=this.texture.crop.height;e/=d;f/=d;if(16777215!==this.tint){if(this.texture.requiresReTint||this.cachedTint!==this.tint)this.tintedTexture=PIXI.CanvasTinter.getTintedTexture(this,this.tint),this.cachedTint=this.tint,this.texture.requiresReTint=!1;a.context.drawImage(this.tintedTexture,0,0,c,g,e,f,c/d,g/d)}else a.context.drawImage(this.texture.baseTexture.source,this.texture.crop.x,this.texture.crop.y,
c,g,e,f,c/d,g/d)}for(d=0;d<this.children.length;d++)this.children[d]._renderCanvas(a);this._mask&&a.maskManager.popMask(a)}};PIXI.SpriteBatch=function(a){PIXI.DisplayObjectContainer.call(this);this.textureThing=a;this.ready=!1};PIXI.SpriteBatch.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);PIXI.SpriteBatch.prototype.constructor=PIXI.SpriteBatch;PIXI.SpriteBatch.prototype.initWebGL=function(a){this.fastSpriteBatch=new PIXI.WebGLFastSpriteBatch(a);this.ready=!0};
PIXI.SpriteBatch.prototype.updateTransform=function(){this.displayObjectUpdateTransform()};PIXI.SpriteBatch.prototype._renderWebGL=function(a){!this.visible||0>=this.alpha||!this.children.length||(this.ready||this.initWebGL(a.gl),this.fastSpriteBatch.gl!==a.gl&&this.fastSpriteBatch.setContext(a.gl),a.spriteBatch.stop(),a.shaderManager.setShader(a.shaderManager.fastShader),this.fastSpriteBatch.begin(this,a),this.fastSpriteBatch.render(this),a.spriteBatch.start())};
PIXI.SpriteBatch.prototype._renderCanvas=function(a){if(this.visible&&!(0>=this.alpha)&&this.children.length){var b=a.context;b.globalAlpha=this.worldAlpha;this.displayObjectUpdateTransform();for(var c=this.worldTransform,d=!0,e=0;e<this.children.length;e++){var f=this.children[e];if(f.visible){var g=f.texture,h=g.frame;b.globalAlpha=this.worldAlpha*f.alpha;if(0===f.rotation%(2*Math.PI))d&&(b.setTransform(c.a,c.b,c.c,c.d,c.tx,c.ty),d=!1),b.drawImage(g.baseTexture.source,h.x,h.y,h.width,h.height,f.anchor.x*
-h.width*f.scale.x+f.position.x+.5+a.shakeX|0,f.anchor.y*-h.height*f.scale.y+f.position.y+.5+a.shakeY|0,h.width*f.scale.x,h.height*f.scale.y);else{d||(d=!0);f.displayObjectUpdateTransform();var k=f.worldTransform,l=k.tx*a.resolution+a.shakeX,m=k.ty*a.resolution+a.shakeY;a.roundPixels?b.setTransform(k.a,k.b,k.c,k.d,l|0,m|0):b.setTransform(k.a,k.b,k.c,k.d,l,m);b.drawImage(g.baseTexture.source,h.x,h.y,h.width,h.height,f.anchor.x*-h.width+.5|0,f.anchor.y*-h.height+.5|0,h.width,h.height)}}}}};
PIXI.hex2rgb=function(a){return[(a>>16&255)/255,(a>>8&255)/255,(a&255)/255]};PIXI.rgb2hex=function(a){return(255*a[0]<<16)+(255*a[1]<<8)+255*a[2]};
PIXI.canUseNewCanvasBlendModes=function(){if(void 0===document)return!1;var a=new Image;a.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/AP804Oa6AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==";var b=new Image;b.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX//wCKxvRFAAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==";var c=PIXI.CanvasPool.create(this,6,1).getContext("2d");c.globalCompositeOperation="multiply";c.drawImage(a,0,0);
c.drawImage(b,2,0);if(!c.getImageData(2,0,1,1))return!1;a=c.getImageData(2,0,1,1).data;PIXI.CanvasPool.remove(this);return 255===a[0]&&0===a[1]&&0===a[2]};PIXI.getNextPowerOfTwo=function(a){if(0<a&&0===(a&a-1))return a;for(var b=1;b<a;)b<<=1;return b};PIXI.isPowerOfTwo=function(a,b){return 0<a&&0===(a&a-1)&&0<b&&0===(b&b-1)};
PIXI.CanvasPool={create:function(a,b,c){var d=PIXI.CanvasPool.getFirst();-1===d?(a={parent:a,canvas:document.createElement("canvas")},PIXI.CanvasPool.pool.push(a),a=a.canvas):(PIXI.CanvasPool.pool[d].parent=a,a=PIXI.CanvasPool.pool[d].canvas);void 0!==b&&(a.width=b,a.height=c);return a},getFirst:function(){for(var a=PIXI.CanvasPool.pool,b=0;b<a.length;b++)if(!a[b].parent)return b;return-1},remove:function(a){for(var b=PIXI.CanvasPool.pool,c=0;c<b.length;c++)b[c].parent===a&&(b[c].parent=null,b[c].canvas.width=
1,b[c].canvas.height=1)},removeByCanvas:function(a){for(var b=PIXI.CanvasPool.pool,c=0;c<b.length;c++)b[c].canvas===a&&(b[c].parent=null,b[c].canvas.width=1,b[c].canvas.height=1)},getTotal:function(){for(var a=PIXI.CanvasPool.pool,b=0,c=0;c<a.length;c++)a[c].parent&&b++;return b},getFree:function(){for(var a=PIXI.CanvasPool.pool,b=0,c=0;c<a.length;c++)a[c].parent||b++;return b}};PIXI.CanvasPool.pool=[];PIXI.initDefaultShaders=function(){};
PIXI.CompileVertexShader=function(a,b){return PIXI._CompileShader(a,b,a.VERTEX_SHADER)};PIXI.CompileFragmentShader=function(a,b){return PIXI._CompileShader(a,b,a.FRAGMENT_SHADER)};PIXI._CompileShader=function(a,b,c){var d=b;Array.isArray(b)&&(d=b.join("\n"));b=a.createShader(c);a.shaderSource(b,d);a.compileShader(b);return a.getShaderParameter(b,a.COMPILE_STATUS)?b:(window.console.log(a.getShaderInfoLog(b)),null)};
PIXI.compileProgram=function(a,b,c){c=PIXI.CompileFragmentShader(a,c);b=PIXI.CompileVertexShader(a,b);var d=a.createProgram();a.attachShader(d,b);a.attachShader(d,c);a.linkProgram(d);a.getProgramParameter(d,a.LINK_STATUS)||(window.console.log(a.getProgramInfoLog(d)),window.console.log("Could not initialise shaders"));return d};
PIXI.PixiShader=function(a){this._UID=PIXI._UID++;this.gl=a;this.program=null;this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"];this.textureCount=0;this.dirty=this.firstRun=!0;this.attributes=[];this.init()};PIXI.PixiShader.prototype.constructor=PIXI.PixiShader;
PIXI.PixiShader.prototype.init=function(){var a=this.gl,b=PIXI.compileProgram(a,this.vertexSrc||PIXI.PixiShader.defaultVertexSrc,this.fragmentSrc);a.useProgram(b);this.uSampler=a.getUniformLocation(b,"uSampler");this.projectionVector=a.getUniformLocation(b,"projectionVector");this.offsetVector=a.getUniformLocation(b,"offsetVector");this.dimensions=a.getUniformLocation(b,"dimensions");this.aVertexPosition=a.getAttribLocation(b,"aVertexPosition");this.aTextureCoord=a.getAttribLocation(b,"aTextureCoord");
this.colorAttribute=a.getAttribLocation(b,"aColor");-1===this.colorAttribute&&(this.colorAttribute=2);this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute];for(var c in this.uniforms)this.uniforms[c].uniformLocation=a.getUniformLocation(b,c);this.initUniforms();this.program=b};
PIXI.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var a=this.gl,b,c;for(c in this.uniforms){b=this.uniforms[c];var d=b.type;"sampler2D"===d?(b._init=!1,null!==b.value&&this.initSampler2D(b)):"mat2"===d||"mat3"===d||"mat4"===d?(b.glMatrix=!0,b.glValueLength=1,"mat2"===d?b.glFunc=a.uniformMatrix2fv:"mat3"===d?b.glFunc=a.uniformMatrix3fv:"mat4"===d&&(b.glFunc=a.uniformMatrix4fv)):(b.glFunc=a["uniform"+d],b.glValueLength="2f"===d||"2i"===d?2:"3f"===d||"3i"===d?3:"4f"===d||"4i"===d?
4:1)}};
PIXI.PixiShader.prototype.initSampler2D=function(a){if(a.value&&a.value.baseTexture&&a.value.baseTexture.hasLoaded){var b=this.gl;b.activeTexture(b["TEXTURE"+this.textureCount]);b.bindTexture(b.TEXTURE_2D,a.value.baseTexture._glTextures[b.id]);if(a.textureData){var c=a.textureData,d=c.magFilter?c.magFilter:b.LINEAR,e=c.minFilter?c.minFilter:b.LINEAR,f=c.wrapS?c.wrapS:b.CLAMP_TO_EDGE,g=c.wrapT?c.wrapT:b.CLAMP_TO_EDGE,h=c.luminance?b.LUMINANCE:b.RGBA;c.repeat&&(g=f=b.REPEAT);b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!!c.flipY);
c.width?b.texImage2D(b.TEXTURE_2D,0,h,c.width?c.width:512,c.height?c.height:2,c.border?c.border:0,h,b.UNSIGNED_BYTE,null):b.texImage2D(b.TEXTURE_2D,0,h,b.RGBA,b.UNSIGNED_BYTE,a.value.baseTexture.source);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,d);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,e);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,f);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,g)}b.uniform1i(a.uniformLocation,this.textureCount);a._init=!0;this.textureCount++}};
PIXI.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var a,b=this.gl,c;for(c in this.uniforms)a=this.uniforms[c],1===a.glValueLength?!0===a.glMatrix?a.glFunc.call(b,a.uniformLocation,a.transpose,a.value):a.glFunc.call(b,a.uniformLocation,a.value):2===a.glValueLength?a.glFunc.call(b,a.uniformLocation,a.value.x,a.value.y):3===a.glValueLength?a.glFunc.call(b,a.uniformLocation,a.value.x,a.value.y,a.value.z):4===a.glValueLength?a.glFunc.call(b,a.uniformLocation,a.value.x,a.value.y,a.value.z,
a.value.w):"sampler2D"===a.type&&(a._init?(b.activeTexture(b["TEXTURE"+this.textureCount]),a.value.baseTexture._dirty[b.id]?PIXI.instances[b.id].updateTexture(a.value.baseTexture):b.bindTexture(b.TEXTURE_2D,a.value.baseTexture._glTextures[b.id]),b.uniform1i(a.uniformLocation,this.textureCount),this.textureCount++):this.initSampler2D(a))};PIXI.PixiShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.attributes=this.gl=this.uniforms=null};
PIXI.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"];
PIXI.PixiFastShader=function(a){this._UID=PIXI._UID++;this.gl=a;this.program=null;this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;",
"uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);","   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;",
"   vColor = aColor;","}"];this.textureCount=0;this.init()};PIXI.PixiFastShader.prototype.constructor=PIXI.PixiFastShader;
PIXI.PixiFastShader.prototype.init=function(){var a=this.gl,b=PIXI.compileProgram(a,this.vertexSrc,this.fragmentSrc);a.useProgram(b);this.uSampler=a.getUniformLocation(b,"uSampler");this.projectionVector=a.getUniformLocation(b,"projectionVector");this.offsetVector=a.getUniformLocation(b,"offsetVector");this.dimensions=a.getUniformLocation(b,"dimensions");this.uMatrix=a.getUniformLocation(b,"uMatrix");this.aVertexPosition=a.getAttribLocation(b,"aVertexPosition");this.aPositionCoord=a.getAttribLocation(b,
"aPositionCoord");this.aScale=a.getAttribLocation(b,"aScale");this.aRotation=a.getAttribLocation(b,"aRotation");this.aTextureCoord=a.getAttribLocation(b,"aTextureCoord");this.colorAttribute=a.getAttribLocation(b,"aColor");-1===this.colorAttribute&&(this.colorAttribute=2);this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,this.aTextureCoord,this.colorAttribute];this.program=b};
PIXI.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.attributes=this.gl=this.uniforms=null};
PIXI.StripShader=function(a){this._UID=PIXI._UID++;this.gl=a;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * alpha;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;",
"void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"];this.init()};PIXI.StripShader.prototype.constructor=PIXI.StripShader;
PIXI.StripShader.prototype.init=function(){var a=this.gl,b=PIXI.compileProgram(a,this.vertexSrc,this.fragmentSrc);a.useProgram(b);this.uSampler=a.getUniformLocation(b,"uSampler");this.projectionVector=a.getUniformLocation(b,"projectionVector");this.offsetVector=a.getUniformLocation(b,"offsetVector");this.colorAttribute=a.getAttribLocation(b,"aColor");this.aVertexPosition=a.getAttribLocation(b,"aVertexPosition");this.aTextureCoord=a.getAttribLocation(b,"aTextureCoord");this.attributes=[this.aVertexPosition,
this.aTextureCoord];this.translationMatrix=a.getUniformLocation(b,"translationMatrix");this.alpha=a.getUniformLocation(b,"alpha");this.program=b};PIXI.StripShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.attribute=this.gl=this.uniforms=null};
PIXI.PrimitiveShader=function(a){this._UID=PIXI._UID++;this.gl=a;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform float flipY;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);",
"   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"];this.init()};PIXI.PrimitiveShader.prototype.constructor=PIXI.PrimitiveShader;
PIXI.PrimitiveShader.prototype.init=function(){var a=this.gl,b=PIXI.compileProgram(a,this.vertexSrc,this.fragmentSrc);a.useProgram(b);this.projectionVector=a.getUniformLocation(b,"projectionVector");this.offsetVector=a.getUniformLocation(b,"offsetVector");this.tintColor=a.getUniformLocation(b,"tint");this.flipY=a.getUniformLocation(b,"flipY");this.aVertexPosition=a.getAttribLocation(b,"aVertexPosition");this.colorAttribute=a.getAttribLocation(b,"aColor");this.attributes=[this.aVertexPosition,this.colorAttribute];
this.translationMatrix=a.getUniformLocation(b,"translationMatrix");this.alpha=a.getUniformLocation(b,"alpha");this.program=b};PIXI.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.attributes=this.gl=this.uniforms=null};
PIXI.ComplexPrimitiveShader=function(a){this._UID=PIXI._UID++;this.gl=a;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","uniform float flipY;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);",
"   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"];this.init()};PIXI.ComplexPrimitiveShader.prototype.constructor=PIXI.ComplexPrimitiveShader;
PIXI.ComplexPrimitiveShader.prototype.init=function(){var a=this.gl,b=PIXI.compileProgram(a,this.vertexSrc,this.fragmentSrc);a.useProgram(b);this.projectionVector=a.getUniformLocation(b,"projectionVector");this.offsetVector=a.getUniformLocation(b,"offsetVector");this.tintColor=a.getUniformLocation(b,"tint");this.color=a.getUniformLocation(b,"color");this.flipY=a.getUniformLocation(b,"flipY");this.aVertexPosition=a.getAttribLocation(b,"aVertexPosition");this.attributes=[this.aVertexPosition,this.colorAttribute];
this.translationMatrix=a.getUniformLocation(b,"translationMatrix");this.alpha=a.getUniformLocation(b,"alpha");this.program=b};PIXI.ComplexPrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.attribute=this.gl=this.uniforms=null};PIXI.glContexts=[];PIXI.instances=[];
PIXI.WebGLRenderer=function(a){this.game=a;PIXI.defaultRenderer||(PIXI.defaultRenderer=this);this.type=PIXI.WEBGL_RENDERER;this.resolution=a.resolution;this.transparent=a.transparent;this.autoResize=!1;this.preserveDrawingBuffer=a.preserveDrawingBuffer;this.clearBeforeRender=a.clearBeforeRender;this.width=a.width;this.height=a.height;this.view=a.canvas;this._contextOptions={alpha:this.transparent,antialias:a.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,
preserveDrawingBuffer:this.preserveDrawingBuffer};this.projection=new PIXI.Point;this.offset=new PIXI.Point;this.shaderManager=new PIXI.WebGLShaderManager;this.spriteBatch=new PIXI.WebGLSpriteBatch;this.maskManager=new PIXI.WebGLMaskManager;this.filterManager=new PIXI.WebGLFilterManager;this.stencilManager=new PIXI.WebGLStencilManager;this.blendModeManager=new PIXI.WebGLBlendModeManager;this.renderSession={};this.renderSession.game=this.game;this.renderSession.gl=this.gl;this.renderSession.drawCount=
0;this.renderSession.shaderManager=this.shaderManager;this.renderSession.maskManager=this.maskManager;this.renderSession.filterManager=this.filterManager;this.renderSession.blendModeManager=this.blendModeManager;this.renderSession.spriteBatch=this.spriteBatch;this.renderSession.stencilManager=this.stencilManager;this.renderSession.renderer=this;this.renderSession.resolution=this.resolution;this.initContext();this.mapBlendModes()};PIXI.WebGLRenderer.prototype.constructor=PIXI.WebGLRenderer;
PIXI.WebGLRenderer.prototype.initContext=function(){var a=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);this.gl=a;if(!a)throw Error("This browser does not support webGL. Try using the canvas renderer");this.glContextId=a.id=PIXI.WebGLRenderer.glContextId++;PIXI.glContexts[this.glContextId]=a;PIXI.instances[this.glContextId]=this;a.disable(a.DEPTH_TEST);a.disable(a.CULL_FACE);a.enable(a.BLEND);this.shaderManager.setContext(a);this.spriteBatch.setContext(a);
this.maskManager.setContext(a);this.filterManager.setContext(a);this.blendModeManager.setContext(a);this.stencilManager.setContext(a);this.renderSession.gl=this.gl;this.resize(this.width,this.height)};
PIXI.WebGLRenderer.prototype.render=function(a){if(!this.contextLost){var b=this.gl;b.viewport(0,0,this.width,this.height);b.bindFramebuffer(b.FRAMEBUFFER,null);this.game.clearBeforeRender&&(b.clearColor(a._bgColor.r,a._bgColor.g,a._bgColor.b,a._bgColor.a),b.clear(b.COLOR_BUFFER_BIT));this.offset.x=this.game.camera._shake.x;this.offset.y=this.game.camera._shake.y;this.renderDisplayObject(a,this.projection)}};
PIXI.WebGLRenderer.prototype.renderDisplayObject=function(a,b,c,d){this.renderSession.blendModeManager.setBlendMode(PIXI.blendModes.NORMAL);this.renderSession.drawCount=0;this.renderSession.flipY=c?-1:1;this.renderSession.projection=b;this.renderSession.offset=this.offset;this.spriteBatch.begin(this.renderSession);this.filterManager.begin(this.renderSession,c);a._renderWebGL(this.renderSession,d);this.spriteBatch.end()};
PIXI.WebGLRenderer.prototype.resize=function(a,b){this.width=a*this.resolution;this.height=b*this.resolution;this.view.width=this.width;this.view.height=this.height;this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px");this.gl.viewport(0,0,this.width,this.height);this.projection.x=this.width/2/this.resolution;this.projection.y=-this.height/2/this.resolution};
PIXI.WebGLRenderer.prototype.updateTexture=function(a){if(!a.hasLoaded)return!1;var b=this.gl;a._glTextures[b.id]||(a._glTextures[b.id]=b.createTexture());b.bindTexture(b.TEXTURE_2D,a._glTextures[b.id]);b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultipliedAlpha);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a.source);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,a.scaleMode===PIXI.scaleModes.LINEAR?b.LINEAR:b.NEAREST);a.mipmap&&PIXI.isPowerOfTwo(a.width,a.height)?(b.texParameteri(b.TEXTURE_2D,
b.TEXTURE_MIN_FILTER,a.scaleMode===PIXI.scaleModes.LINEAR?b.LINEAR_MIPMAP_LINEAR:b.NEAREST_MIPMAP_NEAREST),b.generateMipmap(b.TEXTURE_2D)):b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,a.scaleMode===PIXI.scaleModes.LINEAR?b.LINEAR:b.NEAREST);a._powerOf2?(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT)):(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE));a._dirty[b.id]=
!1;return!0};PIXI.WebGLRenderer.prototype.destroy=function(){this.offset=this.projection=PIXI.glContexts[this.glContextId]=null;this.shaderManager.destroy();this.spriteBatch.destroy();this.maskManager.destroy();this.filterManager.destroy();this.renderSession=this.gl=this.filterManager=this.maskManager=this.spriteBatch=this.shaderManager=null;PIXI.CanvasPool.remove(this);PIXI.instances[this.glContextId]=null;PIXI.WebGLRenderer.glContextId--};
PIXI.WebGLRenderer.prototype.mapBlendModes=function(){var a=this.gl;if(!PIXI.blendModesWebGL){var b=[],c=PIXI.blendModes;b[c.NORMAL]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[c.ADD]=[a.SRC_ALPHA,a.DST_ALPHA];b[c.MULTIPLY]=[a.DST_COLOR,a.ONE_MINUS_SRC_ALPHA];b[c.SCREEN]=[a.SRC_ALPHA,a.ONE];b[c.OVERLAY]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[c.DARKEN]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[c.LIGHTEN]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[c.COLOR_DODGE]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[c.COLOR_BURN]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];
b[c.HARD_LIGHT]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[c.SOFT_LIGHT]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[c.DIFFERENCE]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[c.EXCLUSION]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[c.HUE]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[c.SATURATION]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[c.COLOR]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[c.LUMINOSITY]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];PIXI.blendModesWebGL=b}};PIXI.WebGLRenderer.glContextId=0;PIXI.WebGLBlendModeManager=function(){this.currentBlendMode=99999};
PIXI.WebGLBlendModeManager.prototype.constructor=PIXI.WebGLBlendModeManager;PIXI.WebGLBlendModeManager.prototype.setContext=function(a){this.gl=a};PIXI.WebGLBlendModeManager.prototype.setBlendMode=function(a){if(this.currentBlendMode===a)return!1;this.currentBlendMode=a;(a=PIXI.blendModesWebGL[this.currentBlendMode])&&this.gl.blendFunc(a[0],a[1]);return!0};PIXI.WebGLBlendModeManager.prototype.destroy=function(){this.gl=null};PIXI.WebGLMaskManager=function(){};
PIXI.WebGLMaskManager.prototype.constructor=PIXI.WebGLMaskManager;PIXI.WebGLMaskManager.prototype.setContext=function(a){this.gl=a};PIXI.WebGLMaskManager.prototype.pushMask=function(a,b){var c=b.gl;a.dirty&&PIXI.WebGLGraphics.updateGraphics(a,c);void 0!==a._webGL[c.id]&&void 0!==a._webGL[c.id].data&&0!==a._webGL[c.id].data.length&&b.stencilManager.pushStencil(a,a._webGL[c.id].data[0],b)};
PIXI.WebGLMaskManager.prototype.popMask=function(a,b){var c=this.gl;void 0!==a._webGL[c.id]&&void 0!==a._webGL[c.id].data&&0!==a._webGL[c.id].data.length&&b.stencilManager.popStencil(a,a._webGL[c.id].data[0],b)};PIXI.WebGLMaskManager.prototype.destroy=function(){this.gl=null};PIXI.WebGLStencilManager=function(){this.stencilStack=[];this.reverse=!0;this.count=0};PIXI.WebGLStencilManager.prototype.setContext=function(a){this.gl=a};
PIXI.WebGLStencilManager.prototype.pushStencil=function(a,b,c){var d=this.gl;this.bindGraphics(a,b,c);0===this.stencilStack.length&&(d.enable(d.STENCIL_TEST),d.clear(d.STENCIL_BUFFER_BIT),this.reverse=!0,this.count=0);this.stencilStack.push(b);a=this.count;d.colorMask(!1,!1,!1,!1);d.stencilFunc(d.ALWAYS,0,255);d.stencilOp(d.KEEP,d.KEEP,d.INVERT);1===b.mode?(d.drawElements(d.TRIANGLE_FAN,b.indices.length-4,d.UNSIGNED_SHORT,0),this.reverse?(d.stencilFunc(d.EQUAL,255-a,255),d.stencilOp(d.KEEP,d.KEEP,
d.DECR)):(d.stencilFunc(d.EQUAL,a,255),d.stencilOp(d.KEEP,d.KEEP,d.INCR)),d.drawElements(d.TRIANGLE_FAN,4,d.UNSIGNED_SHORT,2*(b.indices.length-4)),this.reverse?d.stencilFunc(d.EQUAL,255-(a+1),255):d.stencilFunc(d.EQUAL,a+1,255),this.reverse=!this.reverse):(this.reverse?(d.stencilFunc(d.EQUAL,a,255),d.stencilOp(d.KEEP,d.KEEP,d.INCR)):(d.stencilFunc(d.EQUAL,255-a,255),d.stencilOp(d.KEEP,d.KEEP,d.DECR)),d.drawElements(d.TRIANGLE_STRIP,b.indices.length,d.UNSIGNED_SHORT,0),this.reverse?d.stencilFunc(d.EQUAL,
a+1,255):d.stencilFunc(d.EQUAL,255-(a+1),255));d.colorMask(!0,!0,!0,!0);d.stencilOp(d.KEEP,d.KEEP,d.KEEP);this.count++};
PIXI.WebGLStencilManager.prototype.bindGraphics=function(a,b,c){this._currentGraphics=a;var d=this.gl,e=c.projection,f=c.offset,g;1===b.mode?(g=c.shaderManager.complexPrimitiveShader,c.shaderManager.setShader(g),d.uniform1f(g.flipY,c.flipY),d.uniformMatrix3fv(g.translationMatrix,!1,a.worldTransform.toArray(!0)),d.uniform2f(g.projectionVector,e.x,-e.y),d.uniform2f(g.offsetVector,-f.x,-f.y),d.uniform3fv(g.tintColor,PIXI.hex2rgb(a.tint)),d.uniform3fv(g.color,b.color),d.uniform1f(g.alpha,a.worldAlpha*
b.alpha),d.bindBuffer(d.ARRAY_BUFFER,b.buffer),d.vertexAttribPointer(g.aVertexPosition,2,d.FLOAT,!1,8,0)):(g=c.shaderManager.primitiveShader,c.shaderManager.setShader(g),d.uniformMatrix3fv(g.translationMatrix,!1,a.worldTransform.toArray(!0)),d.uniform1f(g.flipY,c.flipY),d.uniform2f(g.projectionVector,e.x,-e.y),d.uniform2f(g.offsetVector,-f.x,-f.y),d.uniform3fv(g.tintColor,PIXI.hex2rgb(a.tint)),d.uniform1f(g.alpha,a.worldAlpha),d.bindBuffer(d.ARRAY_BUFFER,b.buffer),d.vertexAttribPointer(g.aVertexPosition,
2,d.FLOAT,!1,24,0),d.vertexAttribPointer(g.colorAttribute,4,d.FLOAT,!1,24,8));d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,b.indexBuffer)};
PIXI.WebGLStencilManager.prototype.popStencil=function(a,b,c){var d=this.gl;this.stencilStack.pop();this.count--;if(0===this.stencilStack.length)d.disable(d.STENCIL_TEST);else{var e=this.count;this.bindGraphics(a,b,c);d.colorMask(!1,!1,!1,!1);1===b.mode?((this.reverse=!this.reverse)?(d.stencilFunc(d.EQUAL,255-(e+1),255),d.stencilOp(d.KEEP,d.KEEP,d.INCR)):(d.stencilFunc(d.EQUAL,e+1,255),d.stencilOp(d.KEEP,d.KEEP,d.DECR)),d.drawElements(d.TRIANGLE_FAN,4,d.UNSIGNED_SHORT,2*(b.indices.length-4)),d.stencilFunc(d.ALWAYS,
0,255),d.stencilOp(d.KEEP,d.KEEP,d.INVERT),d.drawElements(d.TRIANGLE_FAN,b.indices.length-4,d.UNSIGNED_SHORT,0)):(this.reverse?(d.stencilFunc(d.EQUAL,e+1,255),d.stencilOp(d.KEEP,d.KEEP,d.DECR)):(d.stencilFunc(d.EQUAL,255-(e+1),255),d.stencilOp(d.KEEP,d.KEEP,d.INCR)),d.drawElements(d.TRIANGLE_STRIP,b.indices.length,d.UNSIGNED_SHORT,0));this.reverse?d.stencilFunc(d.EQUAL,e,255):d.stencilFunc(d.EQUAL,255-e,255);d.colorMask(!0,!0,!0,!0);d.stencilOp(d.KEEP,d.KEEP,d.KEEP)}};
PIXI.WebGLStencilManager.prototype.destroy=function(){this.gl=this.stencilStack=null};PIXI.WebGLShaderManager=function(){this.maxAttibs=10;this.attribState=[];this.tempAttribState=[];for(var a=0;a<this.maxAttibs;a++)this.attribState[a]=!1;this.stack=[]};PIXI.WebGLShaderManager.prototype.constructor=PIXI.WebGLShaderManager;
PIXI.WebGLShaderManager.prototype.setContext=function(a){this.gl=a;this.primitiveShader=new PIXI.PrimitiveShader(a);this.complexPrimitiveShader=new PIXI.ComplexPrimitiveShader(a);this.defaultShader=new PIXI.PixiShader(a);this.fastShader=new PIXI.PixiFastShader(a);this.stripShader=new PIXI.StripShader(a);this.setShader(this.defaultShader)};
PIXI.WebGLShaderManager.prototype.setAttribs=function(a){var b;for(b=0;b<this.tempAttribState.length;b++)this.tempAttribState[b]=!1;for(b=0;b<a.length;b++)this.tempAttribState[a[b]]=!0;a=this.gl;for(b=0;b<this.attribState.length;b++)this.attribState[b]!==this.tempAttribState[b]&&(this.attribState[b]=this.tempAttribState[b],this.tempAttribState[b]?a.enableVertexAttribArray(b):a.disableVertexAttribArray(b))};
PIXI.WebGLShaderManager.prototype.setShader=function(a){if(this._currentId===a._UID)return!1;this._currentId=a._UID;this.currentShader=a;this.gl.useProgram(a.program);this.setAttribs(a.attributes);return!0};PIXI.WebGLShaderManager.prototype.destroy=function(){this.tempAttribState=this.attribState=null;this.primitiveShader.destroy();this.complexPrimitiveShader.destroy();this.defaultShader.destroy();this.fastShader.destroy();this.stripShader.destroy();this.gl=null};
PIXI.WebGLSpriteBatch=function(){this.vertSize=5;this.size=2E3;var a=6*this.size;this.vertices=new PIXI.ArrayBuffer(16*this.size*this.vertSize);this.positions=new PIXI.Float32Array(this.vertices);this.colors=new PIXI.Uint32Array(this.vertices);this.indices=new PIXI.Uint16Array(a);for(var b=this.lastIndexCount=0,c=0;b<a;b+=6,c+=4)this.indices[b+0]=c+0,this.indices[b+1]=c+1,this.indices[b+2]=c+2,this.indices[b+3]=c+0,this.indices[b+4]=c+2,this.indices[b+5]=c+3;this.drawing=!1;this.currentBatchSize=
0;this.currentBaseTexture=null;this.dirty=!0;this.textures=[];this.blendModes=[];this.shaders=[];this.sprites=[];this.defaultShader=new PIXI.AbstractFilter(["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"])};
PIXI.WebGLSpriteBatch.prototype.setContext=function(a){this.gl=a;this.vertexBuffer=a.createBuffer();this.indexBuffer=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indices,a.STATIC_DRAW);a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer);a.bufferData(a.ARRAY_BUFFER,this.vertices,a.DYNAMIC_DRAW);this.currentBlendMode=99999;var b=new PIXI.PixiShader(a);b.fragmentSrc=this.defaultShader.fragmentSrc;b.uniforms={};b.init();this.defaultShader.shaders[a.id]=
b};PIXI.WebGLSpriteBatch.prototype.begin=function(a){this.renderSession=a;this.shader=this.renderSession.shaderManager.defaultShader;this.start()};PIXI.WebGLSpriteBatch.prototype.end=function(){this.flush()};
PIXI.WebGLSpriteBatch.prototype.render=function(a,b){var c=a.texture,d=a.worldTransform;b&&(d=b);this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=c.baseTexture);var e=c._uvs;if(e){var f=a.anchor.x,g=a.anchor.y,h,k,l;c.trim?(k=c.trim,f=k.x-f*k.width,h=f+c.crop.width,l=k.y-g*k.height,k=l+c.crop.height):(h=c.frame.width*(1-f),f=c.frame.width*-f,k=c.frame.height*(1-g),l=c.frame.height*-g);var g=4*this.currentBatchSize*this.vertSize,m=c.baseTexture.resolution,c=d.a/m,n=d.b/m,p=d.c/
m,m=d.d/m,q=d.tx,t=d.ty,d=this.colors,r=this.positions;this.renderSession.roundPixels?(r[g]=c*f+p*l+q|0,r[g+1]=m*l+n*f+t|0,r[g+5]=c*h+p*l+q|0,r[g+6]=m*l+n*h+t|0,r[g+10]=c*h+p*k+q|0,r[g+11]=m*k+n*h+t|0,r[g+15]=c*f+p*k+q|0,r[g+16]=m*k+n*f+t|0):(r[g]=c*f+p*l+q,r[g+1]=m*l+n*f+t,r[g+5]=c*h+p*l+q,r[g+6]=m*l+n*h+t,r[g+10]=c*h+p*k+q,r[g+11]=m*k+n*h+t,r[g+15]=c*f+p*k+q,r[g+16]=m*k+n*f+t);r[g+2]=e.x0;r[g+3]=e.y0;r[g+7]=e.x1;r[g+8]=e.y1;r[g+12]=e.x2;r[g+13]=e.y2;r[g+17]=e.x3;r[g+18]=e.y3;e=a.tint;d[g+4]=d[g+
9]=d[g+14]=d[g+19]=(e>>16)+(e&65280)+((e&255)<<16)+(255*a.worldAlpha<<24);this.sprites[this.currentBatchSize++]=a}};
PIXI.WebGLSpriteBatch.prototype.renderTilingSprite=function(a){var b=a.tilingTexture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=b.baseTexture);a._uvs||(a._uvs=new PIXI.TextureUvs);var c=a._uvs,d=b.baseTexture.width,e=b.baseTexture.height;a.tilePosition.x%=d*a.tileScaleOffset.x;a.tilePosition.y%=e*a.tileScaleOffset.y;var f=a.tilePosition.x/(d*a.tileScaleOffset.x),g=a.tilePosition.y/(e*a.tileScaleOffset.y),d=a.width/d/(a.tileScale.x*a.tileScaleOffset.x),e=a.height/e/(a.tileScale.y*
a.tileScaleOffset.y);c.x0=0-f;c.y0=0-g;c.x1=1*d-f;c.y1=0-g;c.x2=1*d-f;c.y2=1*e-g;c.x3=0-f;c.y3=1*e-g;var f=a.tint,f=(f>>16)+(f&65280)+((f&255)<<16)+(255*a.worldAlpha<<24),g=this.positions,e=this.colors,h=a.width,k=a.height,l=a.anchor.x,m=a.anchor.y,d=h*(1-l),h=h*-l,l=k*(1-m),k=k*-m,m=4*this.currentBatchSize*this.vertSize,n=b.baseTexture.resolution,p=a.worldTransform,b=p.a/n,q=p.b/n,t=p.c/n,n=p.d/n,r=p.tx,p=p.ty;g[m++]=b*h+t*k+r;g[m++]=n*k+q*h+p;g[m++]=c.x0;g[m++]=c.y0;e[m++]=f;g[m++]=b*d+t*k+r;g[m++]=
n*k+q*d+p;g[m++]=c.x1;g[m++]=c.y1;e[m++]=f;g[m++]=b*d+t*l+r;g[m++]=n*l+q*d+p;g[m++]=c.x2;g[m++]=c.y2;e[m++]=f;g[m++]=b*h+t*l+r;g[m++]=n*l+q*h+p;g[m++]=c.x3;g[m++]=c.y3;e[m++]=f;this.sprites[this.currentBatchSize++]=a};
PIXI.WebGLSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var a=this.gl,b;if(this.dirty){this.dirty=!1;a.activeTexture(a.TEXTURE0);a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);b=this.defaultShader.shaders[a.id];var c=4*this.vertSize;a.vertexAttribPointer(b.aVertexPosition,2,a.FLOAT,!1,c,0);a.vertexAttribPointer(b.aTextureCoord,2,a.FLOAT,!1,c,8);a.vertexAttribPointer(b.colorAttribute,4,a.UNSIGNED_BYTE,!0,c,16)}this.currentBatchSize>
.5*this.size?a.bufferSubData(a.ARRAY_BUFFER,0,this.vertices):(c=this.positions.subarray(0,4*this.currentBatchSize*this.vertSize),a.bufferSubData(a.ARRAY_BUFFER,0,c));for(var d,e,f=c=0,g=null,h=this.renderSession.blendModeManager.currentBlendMode,k=null,l=!1,m=!1,n,p=0,q=this.currentBatchSize;p<q;p++){n=this.sprites[p];b=n.tilingTexture?n.tilingTexture.baseTexture:n.texture.baseTexture;d=n.blendMode;e=n.shader||this.defaultShader;var l=h!==d,m=k!==e,t=b.skipRender;t&&0<n.children.length&&(t=!1);if(g!==
b&&!t||l||m)this.renderBatch(g,c,f),f=p,c=0,g=b,l&&(h=d,this.renderSession.blendModeManager.setBlendMode(h)),m&&(k=e,b=k.shaders[a.id],b||(b=new PIXI.PixiShader(a),b.fragmentSrc=k.fragmentSrc,b.uniforms=k.uniforms,b.init(),k.shaders[a.id]=b),this.renderSession.shaderManager.setShader(b),b.dirty&&b.syncUniforms(),d=this.renderSession.projection,a.uniform2f(b.projectionVector,d.x,d.y),d=this.renderSession.offset,a.uniform2f(b.offsetVector,d.x,d.y));c++}this.renderBatch(g,c,f);this.currentBatchSize=
0}};PIXI.WebGLSpriteBatch.prototype.renderBatch=function(a,b,c){if(0!==b){var d=this.gl;if(a._dirty[d.id]){if(!this.renderSession.renderer.updateTexture(a))return}else d.bindTexture(d.TEXTURE_2D,a._glTextures[d.id]);d.drawElements(d.TRIANGLES,6*b,d.UNSIGNED_SHORT,12*c);this.renderSession.drawCount++}};PIXI.WebGLSpriteBatch.prototype.stop=function(){this.flush();this.dirty=!0};PIXI.WebGLSpriteBatch.prototype.start=function(){this.dirty=!0};
PIXI.WebGLSpriteBatch.prototype.destroy=function(){this.indices=this.vertices=null;this.gl.deleteBuffer(this.vertexBuffer);this.gl.deleteBuffer(this.indexBuffer);this.gl=this.currentBaseTexture=null};
PIXI.WebGLFastSpriteBatch=function(a){this.vertSize=10;this.size=this.maxSize=6E3;var b=6*this.maxSize;this.vertices=new PIXI.Float32Array(4*this.size*this.vertSize);this.indices=new PIXI.Uint16Array(b);this.indexBuffer=this.vertexBuffer=null;for(var c=this.lastIndexCount=0,d=0;c<b;c+=6,d+=4)this.indices[c+0]=d+0,this.indices[c+1]=d+1,this.indices[c+2]=d+2,this.indices[c+3]=d+0,this.indices[c+4]=d+2,this.indices[c+5]=d+3;this.drawing=!1;this.currentBatchSize=0;this.currentBaseTexture=null;this.currentBlendMode=
0;this.matrix=this.shader=this.renderSession=null;this.setContext(a)};PIXI.WebGLFastSpriteBatch.prototype.constructor=PIXI.WebGLFastSpriteBatch;PIXI.WebGLFastSpriteBatch.prototype.setContext=function(a){this.gl=a;this.vertexBuffer=a.createBuffer();this.indexBuffer=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indices,a.STATIC_DRAW);a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer);a.bufferData(a.ARRAY_BUFFER,this.vertices,a.DYNAMIC_DRAW)};
PIXI.WebGLFastSpriteBatch.prototype.begin=function(a,b){this.renderSession=b;this.shader=this.renderSession.shaderManager.fastShader;this.matrix=a.worldTransform.toArray(!0);this.start()};PIXI.WebGLFastSpriteBatch.prototype.end=function(){this.flush()};
PIXI.WebGLFastSpriteBatch.prototype.render=function(a){a=a.children;var b=a[0];if(b.texture._uvs){this.currentBaseTexture=b.texture.baseTexture;b.blendMode!==this.renderSession.blendModeManager.currentBlendMode&&(this.flush(),this.renderSession.blendModeManager.setBlendMode(b.blendMode));for(var b=0,c=a.length;b<c;b++)this.renderSprite(a[b]);this.flush()}};
PIXI.WebGLFastSpriteBatch.prototype.renderSprite=function(a){if(a.visible){if(a.texture.baseTexture!==this.currentBaseTexture&&!a.texture.baseTexture.skipRender&&(this.flush(),this.currentBaseTexture=a.texture.baseTexture,!a.texture._uvs))return;var b,c=this.vertices,d,e,f,g,h;b=a.texture._uvs;a.texture.trim?(f=a.texture.trim,e=f.x-a.anchor.x*f.width,d=e+a.texture.crop.width,g=f.y-a.anchor.y*f.height,f=g+a.texture.crop.height):(d=a.texture.frame.width*(1-a.anchor.x),e=a.texture.frame.width*-a.anchor.x,
f=a.texture.frame.height*(1-a.anchor.y),g=a.texture.frame.height*-a.anchor.y);h=4*this.currentBatchSize*this.vertSize;c[h++]=e;c[h++]=g;c[h++]=a.position.x;c[h++]=a.position.y;c[h++]=a.scale.x;c[h++]=a.scale.y;c[h++]=a.rotation;c[h++]=b.x0;c[h++]=b.y1;c[h++]=a.alpha;c[h++]=d;c[h++]=g;c[h++]=a.position.x;c[h++]=a.position.y;c[h++]=a.scale.x;c[h++]=a.scale.y;c[h++]=a.rotation;c[h++]=b.x1;c[h++]=b.y1;c[h++]=a.alpha;c[h++]=d;c[h++]=f;c[h++]=a.position.x;c[h++]=a.position.y;c[h++]=a.scale.x;c[h++]=a.scale.y;
c[h++]=a.rotation;c[h++]=b.x2;c[h++]=b.y2;c[h++]=a.alpha;c[h++]=e;c[h++]=f;c[h++]=a.position.x;c[h++]=a.position.y;c[h++]=a.scale.x;c[h++]=a.scale.y;c[h++]=a.rotation;c[h++]=b.x3;c[h++]=b.y3;c[h++]=a.alpha;this.currentBatchSize++;this.currentBatchSize>=this.size&&this.flush()}};
PIXI.WebGLFastSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var a=this.gl;this.currentBaseTexture._glTextures[a.id]||this.renderSession.renderer.updateTexture(this.currentBaseTexture,a);a.bindTexture(a.TEXTURE_2D,this.currentBaseTexture._glTextures[a.id]);if(this.currentBatchSize>.5*this.size)a.bufferSubData(a.ARRAY_BUFFER,0,this.vertices);else{var b=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);a.bufferSubData(a.ARRAY_BUFFER,0,b)}a.drawElements(a.TRIANGLES,
6*this.currentBatchSize,a.UNSIGNED_SHORT,0);this.currentBatchSize=0;this.renderSession.drawCount++}};PIXI.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()};
PIXI.WebGLFastSpriteBatch.prototype.start=function(){var a=this.gl;a.activeTexture(a.TEXTURE0);a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var b=this.renderSession.projection;a.uniform2f(this.shader.projectionVector,b.x,b.y);a.uniformMatrix3fv(this.shader.uMatrix,!1,this.matrix);b=4*this.vertSize;a.vertexAttribPointer(this.shader.aVertexPosition,2,a.FLOAT,!1,b,0);a.vertexAttribPointer(this.shader.aPositionCoord,2,a.FLOAT,!1,b,8);a.vertexAttribPointer(this.shader.aScale,
2,a.FLOAT,!1,b,16);a.vertexAttribPointer(this.shader.aRotation,1,a.FLOAT,!1,b,24);a.vertexAttribPointer(this.shader.aTextureCoord,2,a.FLOAT,!1,b,28);a.vertexAttribPointer(this.shader.colorAttribute,1,a.FLOAT,!1,b,36)};PIXI.WebGLFilterManager=function(){this.filterStack=[];this.offsetY=this.offsetX=0};PIXI.WebGLFilterManager.prototype.constructor=PIXI.WebGLFilterManager;PIXI.WebGLFilterManager.prototype.setContext=function(a){this.gl=a;this.texturePool=[];this.initShaderBuffers()};
PIXI.WebGLFilterManager.prototype.begin=function(a,b){this.renderSession=a;this.defaultShader=a.shaderManager.defaultShader;var c=this.renderSession.projection;this.width=2*c.x;this.height=2*-c.y;this.buffer=b};
PIXI.WebGLFilterManager.prototype.pushFilter=function(a){var b=this.gl,c=this.renderSession.projection,d=this.renderSession.offset;a._filterArea=a.target.filterArea||a.target.getBounds();a._previous_stencil_mgr=this.renderSession.stencilManager;this.renderSession.stencilManager=new PIXI.WebGLStencilManager;this.renderSession.stencilManager.setContext(b);b.disable(b.STENCIL_TEST);this.filterStack.push(a);var e=a.filterPasses[0];this.offsetX+=a._filterArea.x;this.offsetY+=a._filterArea.y;var f=this.texturePool.pop();
f?f.resize(this.width*this.renderSession.resolution,this.height*this.renderSession.resolution):f=new PIXI.FilterTexture(this.gl,this.width*this.renderSession.resolution,this.height*this.renderSession.resolution);b.bindTexture(b.TEXTURE_2D,f.texture);var g=a._filterArea,e=e.padding;g.x-=e;g.y-=e;g.width+=2*e;g.height+=2*e;0>g.x&&(g.x=0);g.width>this.width&&(g.width=this.width);0>g.y&&(g.y=0);g.height>this.height&&(g.height=this.height);b.bindFramebuffer(b.FRAMEBUFFER,f.frameBuffer);b.viewport(0,0,
g.width*this.renderSession.resolution,g.height*this.renderSession.resolution);c.x=g.width/2;c.y=-g.height/2;d.x=-g.x;d.y=-g.y;b.colorMask(!0,!0,!0,!0);b.clearColor(0,0,0,0);b.clear(b.COLOR_BUFFER_BIT);a._glFilterTexture=f};
PIXI.WebGLFilterManager.prototype.popFilter=function(){var a=this.gl,b=this.filterStack.pop(),c=b._filterArea,d=b._glFilterTexture,e=this.renderSession.projection,f=this.renderSession.offset;if(1<b.filterPasses.length){a.viewport(0,0,c.width*this.renderSession.resolution,c.height*this.renderSession.resolution);a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer);this.vertexArray[0]=0;this.vertexArray[1]=c.height;this.vertexArray[2]=c.width;this.vertexArray[3]=c.height;this.vertexArray[4]=0;this.vertexArray[5]=
0;this.vertexArray[6]=c.width;this.vertexArray[7]=0;a.bufferSubData(a.ARRAY_BUFFER,0,this.vertexArray);a.bindBuffer(a.ARRAY_BUFFER,this.uvBuffer);this.uvArray[2]=c.width/this.width;this.uvArray[5]=c.height/this.height;this.uvArray[6]=c.width/this.width;this.uvArray[7]=c.height/this.height;a.bufferSubData(a.ARRAY_BUFFER,0,this.uvArray);var g=this.texturePool.pop();g||(g=new PIXI.FilterTexture(this.gl,this.width*this.renderSession.resolution,this.height*this.renderSession.resolution));g.resize(this.width*
this.renderSession.resolution,this.height*this.renderSession.resolution);a.bindFramebuffer(a.FRAMEBUFFER,g.frameBuffer);a.clear(a.COLOR_BUFFER_BIT);a.disable(a.BLEND);for(var h=0;h<b.filterPasses.length-1;h++){var k=b.filterPasses[h];a.bindFramebuffer(a.FRAMEBUFFER,g.frameBuffer);a.activeTexture(a.TEXTURE0);a.bindTexture(a.TEXTURE_2D,d.texture);this.applyFilterPass(k,c,c.width,c.height);k=d;d=g;g=k}a.enable(a.BLEND);this.texturePool.push(g)}g=b.filterPasses[b.filterPasses.length-1];this.offsetX-=
c.x;this.offsetY-=c.y;var h=this.width,k=this.height,l=0,m=0,n=this.buffer;0===this.filterStack.length?a.colorMask(!0,!0,!0,!0):(n=this.filterStack[this.filterStack.length-1],c=n._filterArea,h=c.width,k=c.height,l=c.x,m=c.y,n=n._glFilterTexture.frameBuffer);e.x=h/2;e.y=-k/2;f.x=l;f.y=m;c=b._filterArea;e=c.x-l;f=c.y-m;a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer);this.vertexArray[0]=e;this.vertexArray[1]=f+c.height;this.vertexArray[2]=e+c.width;this.vertexArray[3]=f+c.height;this.vertexArray[4]=e;
this.vertexArray[5]=f;this.vertexArray[6]=e+c.width;this.vertexArray[7]=f;a.bufferSubData(a.ARRAY_BUFFER,0,this.vertexArray);a.bindBuffer(a.ARRAY_BUFFER,this.uvBuffer);this.uvArray[2]=c.width/this.width;this.uvArray[5]=c.height/this.height;this.uvArray[6]=c.width/this.width;this.uvArray[7]=c.height/this.height;a.bufferSubData(a.ARRAY_BUFFER,0,this.uvArray);a.viewport(0,0,h*this.renderSession.resolution,k*this.renderSession.resolution);a.bindFramebuffer(a.FRAMEBUFFER,n);a.activeTexture(a.TEXTURE0);
a.bindTexture(a.TEXTURE_2D,d.texture);this.renderSession.stencilManager&&this.renderSession.stencilManager.destroy();this.renderSession.stencilManager=b._previous_stencil_mgr;b._previous_stencil_mgr=null;0<this.renderSession.stencilManager.count?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST);this.applyFilterPass(g,c,h,k);this.texturePool.push(d);b._glFilterTexture=null};
PIXI.WebGLFilterManager.prototype.applyFilterPass=function(a,b,c,d){b=this.gl;var e=a.shaders[b.id];e||(e=new PIXI.PixiShader(b),e.fragmentSrc=a.fragmentSrc,e.uniforms=a.uniforms,e.init(),a.shaders[b.id]=e);this.renderSession.shaderManager.setShader(e);b.uniform2f(e.projectionVector,c/2,-d/2);b.uniform2f(e.offsetVector,0,0);a.uniforms.dimensions&&(a.uniforms.dimensions.value[0]=this.width,a.uniforms.dimensions.value[1]=this.height,a.uniforms.dimensions.value[2]=this.vertexArray[0],a.uniforms.dimensions.value[3]=
this.vertexArray[5]);e.syncUniforms();b.bindBuffer(b.ARRAY_BUFFER,this.vertexBuffer);b.vertexAttribPointer(e.aVertexPosition,2,b.FLOAT,!1,0,0);b.bindBuffer(b.ARRAY_BUFFER,this.uvBuffer);b.vertexAttribPointer(e.aTextureCoord,2,b.FLOAT,!1,0,0);b.bindBuffer(b.ARRAY_BUFFER,this.colorBuffer);b.vertexAttribPointer(e.colorAttribute,2,b.FLOAT,!1,0,0);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0);this.renderSession.drawCount++};
PIXI.WebGLFilterManager.prototype.initShaderBuffers=function(){var a=this.gl;this.vertexBuffer=a.createBuffer();this.uvBuffer=a.createBuffer();this.colorBuffer=a.createBuffer();this.indexBuffer=a.createBuffer();this.vertexArray=new PIXI.Float32Array([0,0,1,0,0,1,1,1]);a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer);a.bufferData(a.ARRAY_BUFFER,this.vertexArray,a.STATIC_DRAW);this.uvArray=new PIXI.Float32Array([0,0,1,0,0,1,1,1]);a.bindBuffer(a.ARRAY_BUFFER,this.uvBuffer);a.bufferData(a.ARRAY_BUFFER,
this.uvArray,a.STATIC_DRAW);this.colorArray=new PIXI.Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]);a.bindBuffer(a.ARRAY_BUFFER,this.colorBuffer);a.bufferData(a.ARRAY_BUFFER,this.colorArray,a.STATIC_DRAW);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),a.STATIC_DRAW)};
PIXI.WebGLFilterManager.prototype.destroy=function(){var a=this.gl;this.filterStack=null;for(var b=this.offsetY=this.offsetX=0;b<this.texturePool.length;b++)this.texturePool[b].destroy();this.texturePool=null;a.deleteBuffer(this.vertexBuffer);a.deleteBuffer(this.uvBuffer);a.deleteBuffer(this.colorBuffer);a.deleteBuffer(this.indexBuffer)};
PIXI.FilterTexture=function(a,b,c,d){this.gl=a;this.frameBuffer=a.createFramebuffer();this.texture=a.createTexture();d=d||PIXI.scaleModes.DEFAULT;a.bindTexture(a.TEXTURE_2D,this.texture);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,d===PIXI.scaleModes.LINEAR?a.LINEAR:a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,d===PIXI.scaleModes.LINEAR?a.LINEAR:a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);
a.bindFramebuffer(a.FRAMEBUFFER,this.frameBuffer);a.bindFramebuffer(a.FRAMEBUFFER,this.frameBuffer);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.texture,0);this.renderBuffer=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,this.renderBuffer);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,this.renderBuffer);this.resize(b,c)};PIXI.FilterTexture.prototype.constructor=PIXI.FilterTexture;
PIXI.FilterTexture.prototype.clear=function(){var a=this.gl;a.clearColor(0,0,0,0);a.clear(a.COLOR_BUFFER_BIT)};PIXI.FilterTexture.prototype.resize=function(a,b){if(this.width!==a||this.height!==b){this.width=a;this.height=b;var c=this.gl;c.bindTexture(c.TEXTURE_2D,this.texture);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,a,b,0,c.RGBA,c.UNSIGNED_BYTE,null);c.bindRenderbuffer(c.RENDERBUFFER,this.renderBuffer);c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_STENCIL,a,b)}};
PIXI.FilterTexture.prototype.destroy=function(){var a=this.gl;a.deleteFramebuffer(this.frameBuffer);a.deleteTexture(this.texture);this.texture=this.frameBuffer=null};PIXI.CanvasBuffer=function(a,b){this.width=a;this.height=b;this.canvas=PIXI.CanvasPool.create(this,this.width,this.height);this.context=this.canvas.getContext("2d");this.canvas.width=a;this.canvas.height=b};PIXI.CanvasBuffer.prototype.constructor=PIXI.CanvasBuffer;
PIXI.CanvasBuffer.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0);this.context.clearRect(0,0,this.width,this.height)};PIXI.CanvasBuffer.prototype.resize=function(a,b){this.width=this.canvas.width=a;this.height=this.canvas.height=b};PIXI.CanvasBuffer.prototype.destroy=function(){PIXI.CanvasPool.remove(this)};PIXI.CanvasMaskManager=function(){};PIXI.CanvasMaskManager.prototype.constructor=PIXI.CanvasMaskManager;
PIXI.CanvasMaskManager.prototype.pushMask=function(a,b){var c=b.context;c.save();var d=a.alpha,e=a.worldTransform,f=b.resolution;c.setTransform(e.a*f,e.b*f,e.c*f,e.d*f,e.tx*f,e.ty*f);PIXI.CanvasGraphics.renderGraphicsMask(a,c);c.clip();a.worldAlpha=d};PIXI.CanvasMaskManager.prototype.popMask=function(a){a.context.restore()};PIXI.CanvasTinter=function(){};
PIXI.CanvasTinter.getTintedTexture=function(a,b){var c=a.tintedTexture||PIXI.CanvasPool.create(this);PIXI.CanvasTinter.tintMethod(a.texture,b,c);return c};
PIXI.CanvasTinter.tintWithMultiply=function(a,b,c){var d=c.getContext("2d"),e=a.crop;if(c.width!==e.width||c.height!==e.height)c.width=e.width,c.height=e.height;d.clearRect(0,0,e.width,e.height);d.fillStyle="#"+("00000"+(b|0).toString(16)).substr(-6);d.fillRect(0,0,e.width,e.height);d.globalCompositeOperation="multiply";d.drawImage(a.baseTexture.source,e.x,e.y,e.width,e.height,0,0,e.width,e.height);d.globalCompositeOperation="destination-atop";d.drawImage(a.baseTexture.source,e.x,e.y,e.width,e.height,
0,0,e.width,e.height)};
PIXI.CanvasTinter.tintWithPerPixel=function(a,b,c){var d=c.getContext("2d"),e=a.crop;c.width=e.width;c.height=e.height;d.globalCompositeOperation="copy";d.drawImage(a.baseTexture.source,e.x,e.y,e.width,e.height,0,0,e.width,e.height);c=PIXI.hex2rgb(b);a=c[0];b=c[1];c=c[2];for(var e=d.getImageData(0,0,e.width,e.height),f=e.data,g=0;g<f.length;g+=4)if(f[g+0]*=a,f[g+1]*=b,f[g+2]*=c,!PIXI.CanvasTinter.canHandleAlpha){var h=f[g+3];f[g+0]/=255/h;f[g+1]/=255/h;f[g+2]/=255/h}d.putImageData(e,0,0)};
PIXI.CanvasTinter.checkInverseAlpha=function(){var a=new PIXI.CanvasBuffer(2,1);a.context.fillStyle="rgba(10, 20, 30, 0.5)";a.context.fillRect(0,0,1,1);var b=a.context.getImageData(0,0,1,1);if(null===b)return!1;a.context.putImageData(b,1,0);a=a.context.getImageData(1,0,1,1);return a.data[0]===b.data[0]&&a.data[1]===b.data[1]&&a.data[2]===b.data[2]&&a.data[3]===b.data[3]};PIXI.CanvasTinter.canHandleAlpha=PIXI.CanvasTinter.checkInverseAlpha();PIXI.CanvasTinter.canUseMultiply=PIXI.canUseNewCanvasBlendModes();
PIXI.CanvasTinter.tintMethod=PIXI.CanvasTinter.canUseMultiply?PIXI.CanvasTinter.tintWithMultiply:PIXI.CanvasTinter.tintWithPerPixel;
PIXI.CanvasRenderer=function(a){this.game=a;PIXI.defaultRenderer||(PIXI.defaultRenderer=this);this.type=PIXI.CANVAS_RENDERER;this.resolution=a.resolution;this.clearBeforeRender=a.clearBeforeRender;this.transparent=a.transparent;this.autoResize=!1;this.width=a.width*this.resolution;this.height=a.height*this.resolution;this.view=a.canvas;this.context=this.view.getContext("2d",{alpha:this.transparent});this.refresh=!0;this.count=0;this.maskManager=new PIXI.CanvasMaskManager;this.renderSession={context:this.context,
maskManager:this.maskManager,scaleMode:null,smoothProperty:Phaser.Canvas.getSmoothingPrefix(this.context),roundPixels:!1};this.mapBlendModes();this.resize(this.width,this.height)};PIXI.CanvasRenderer.prototype.constructor=PIXI.CanvasRenderer;
PIXI.CanvasRenderer.prototype.render=function(a){this.context.setTransform(1,0,0,1,0,0);this.context.globalAlpha=1;this.renderSession.currentBlendMode=0;this.renderSession.shakeX=this.game.camera._shake.x;this.renderSession.shakeY=this.game.camera._shake.y;this.context.globalCompositeOperation="source-over";navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear());this.clearBeforeRender&&(this.transparent?this.context.clearRect(0,0,this.width,this.height):
a._bgColor&&(this.context.fillStyle=a._bgColor.rgba,this.context.fillRect(0,0,this.width,this.height)));this.renderDisplayObject(a)};PIXI.CanvasRenderer.prototype.destroy=function(a){void 0===a&&(a=!0);a&&this.view.parent&&this.view.parent.removeChild(this.view);this.renderSession=this.maskManager=this.context=this.view=null};
PIXI.CanvasRenderer.prototype.resize=function(a,b){this.width=a*this.resolution;this.height=b*this.resolution;this.view.width=this.width;this.view.height=this.height;this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px");this.renderSession.smoothProperty&&(this.context[this.renderSession.smoothProperty]=this.renderSession.scaleMode===PIXI.scaleModes.LINEAR)};
PIXI.CanvasRenderer.prototype.renderDisplayObject=function(a,b,c){this.renderSession.context=b||this.context;this.renderSession.resolution=this.resolution;a._renderCanvas(this.renderSession,c)};
PIXI.CanvasRenderer.prototype.mapBlendModes=function(){if(!PIXI.blendModesCanvas){var a=[],b=PIXI.blendModes,c=PIXI.canUseNewCanvasBlendModes();a[b.NORMAL]="source-over";a[b.ADD]="lighter";a[b.MULTIPLY]=c?"multiply":"source-over";a[b.SCREEN]=c?"screen":"source-over";a[b.OVERLAY]=c?"overlay":"source-over";a[b.DARKEN]=c?"darken":"source-over";a[b.LIGHTEN]=c?"lighten":"source-over";a[b.COLOR_DODGE]=c?"color-dodge":"source-over";a[b.COLOR_BURN]=c?"color-burn":"source-over";a[b.HARD_LIGHT]=c?"hard-light":
"source-over";a[b.SOFT_LIGHT]=c?"soft-light":"source-over";a[b.DIFFERENCE]=c?"difference":"source-over";a[b.EXCLUSION]=c?"exclusion":"source-over";a[b.HUE]=c?"hue":"source-over";a[b.SATURATION]=c?"saturation":"source-over";a[b.COLOR]=c?"color":"source-over";a[b.LUMINOSITY]=c?"luminosity":"source-over";PIXI.blendModesCanvas=a}};
PIXI.BaseTexture=function(a,b){this.resolution=1;this.height=this.width=100;this.scaleMode=b||PIXI.scaleModes.DEFAULT;this.hasLoaded=!1;this.source=a;this.premultipliedAlpha=!0;this._glTextures=[];this.mipmap=!1;this._dirty=[!0,!0,!0,!0];a&&((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height&&(this.hasLoaded=!0,this.width=this.source.naturalWidth||this.source.width,this.height=this.source.naturalHeight||this.source.height,this.dirty()),this._powerOf2=this.skipRender=
!1)};PIXI.BaseTexture.prototype.constructor=PIXI.BaseTexture;PIXI.BaseTexture.prototype.forceLoaded=function(a,b){this.hasLoaded=!0;this.width=a;this.height=b;this.dirty()};PIXI.BaseTexture.prototype.destroy=function(){this.source&&PIXI.CanvasPool.removeByCanvas(this.source);this.source=null;this.unloadFromGPU()};PIXI.BaseTexture.prototype.updateSourceImage=function(a){console.warn("PIXI.BaseTexture.updateSourceImage is deprecated. Use Phaser.Sprite.loadTexture instead.")};
PIXI.BaseTexture.prototype.dirty=function(){for(var a=0;a<this._glTextures.length;a++)this._dirty[a]=!0};PIXI.BaseTexture.prototype.unloadFromGPU=function(){this.dirty();for(var a=this._glTextures.length-1;0<=a;a--){var b=this._glTextures[a],c=PIXI.glContexts[a];c&&b&&c.deleteTexture(b)}this._glTextures.length=0;this.dirty()};PIXI.BaseTexture.fromCanvas=function(a,b){0===a.width&&(a.width=1);0===a.height&&(a.height=1);return new PIXI.BaseTexture(a,b)};PIXI.TextureSilentFail=!1;
PIXI.Texture=function(a,b,c,d){this.noFrame=!1;b||(this.noFrame=!0,b=new PIXI.Rectangle(0,0,1,1));a instanceof PIXI.Texture&&(a=a.baseTexture);this.baseTexture=a;this.frame=b;this.trim=d;this.requiresReTint=this.requiresUpdate=this.isTiling=this.valid=!1;this._uvs=null;this.height=this.width=0;this.crop=c||new PIXI.Rectangle(0,0,1,1);a.hasLoaded&&(this.noFrame&&(b=new PIXI.Rectangle(0,0,a.width,a.height)),this.setFrame(b))};PIXI.Texture.prototype.constructor=PIXI.Texture;
PIXI.Texture.prototype.onBaseTextureLoaded=function(){var a=this.baseTexture;this.noFrame&&(this.frame=new PIXI.Rectangle(0,0,a.width,a.height));this.setFrame(this.frame)};PIXI.Texture.prototype.destroy=function(a){a&&this.baseTexture.destroy();this.valid=!1};
PIXI.Texture.prototype.setFrame=function(a){this.noFrame=!1;this.frame=a;this.width=a.width;this.height=a.height;this.crop.x=a.x;this.crop.y=a.y;this.crop.width=a.width;this.crop.height=a.height;if(!this.trim&&(a.x+a.width>this.baseTexture.width||a.y+a.height>this.baseTexture.height)){if(!PIXI.TextureSilentFail)throw Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=!1}else this.valid=a&&a.width&&a.height&&this.baseTexture.source&&this.baseTexture.hasLoaded,
this.trim&&(this.width=this.trim.width,this.height=this.trim.height,this.frame.width=this.trim.width,this.frame.height=this.trim.height),this.valid&&this._updateUvs()};
PIXI.Texture.prototype._updateUvs=function(){this._uvs||(this._uvs=new PIXI.TextureUvs);var a=this.crop,b=this.baseTexture.width,c=this.baseTexture.height;this._uvs.x0=a.x/b;this._uvs.y0=a.y/c;this._uvs.x1=(a.x+a.width)/b;this._uvs.y1=a.y/c;this._uvs.x2=(a.x+a.width)/b;this._uvs.y2=(a.y+a.height)/c;this._uvs.x3=a.x/b;this._uvs.y3=(a.y+a.height)/c};PIXI.Texture.fromCanvas=function(a,b){var c=PIXI.BaseTexture.fromCanvas(a,b);return new PIXI.Texture(c)};
PIXI.TextureUvs=function(){this.y3=this.x3=this.y2=this.x2=this.y1=this.x1=this.y0=this.x0=0};
PIXI.RenderTexture=function(a,b,c,d,e){this.width=a||100;this.height=b||100;this.resolution=e||1;this.frame=new PIXI.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution);this.crop=new PIXI.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution);this.baseTexture=new PIXI.BaseTexture;this.baseTexture.width=this.width*this.resolution;this.baseTexture.height=this.height*this.resolution;this.baseTexture._glTextures=[];this.baseTexture.resolution=this.resolution;this.baseTexture.scaleMode=
d||PIXI.scaleModes.DEFAULT;this.baseTexture.hasLoaded=!0;PIXI.Texture.call(this,this.baseTexture,new PIXI.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution));this.renderer=c||PIXI.defaultRenderer;this.renderer.type===PIXI.WEBGL_RENDERER?(a=this.renderer.gl,this.baseTexture._dirty[a.id]=!1,this.textureBuffer=new PIXI.FilterTexture(a,this.width,this.height,this.baseTexture.scaleMode),this.baseTexture._glTextures[a.id]=this.textureBuffer.texture,this.render=this.renderWebGL,this.projection=
new PIXI.Point(.5*this.width,.5*-this.height)):(this.render=this.renderCanvas,this.textureBuffer=new PIXI.CanvasBuffer(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas);this.valid=!0;this.tempMatrix=new Phaser.Matrix;this._updateUvs()};PIXI.RenderTexture.prototype=Object.create(PIXI.Texture.prototype);PIXI.RenderTexture.prototype.constructor=PIXI.RenderTexture;
PIXI.RenderTexture.prototype.resize=function(a,b,c){if(a!==this.width||b!==this.height)this.valid=0<a&&0<b,this.width=a,this.height=b,this.frame.width=this.crop.width=a*this.resolution,this.frame.height=this.crop.height=b*this.resolution,c&&(this.baseTexture.width=this.width*this.resolution,this.baseTexture.height=this.height*this.resolution),this.renderer.type===PIXI.WEBGL_RENDERER&&(this.projection.x=this.width/2,this.projection.y=-this.height/2),this.valid&&this.textureBuffer.resize(this.width,
this.height)};PIXI.RenderTexture.prototype.clear=function(){this.valid&&(this.renderer.type===PIXI.WEBGL_RENDERER&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear())};
PIXI.RenderTexture.prototype.renderWebGL=function(a,b,c){if(this.valid&&0!==a.alpha){var d=a.worldTransform;d.identity();d.translate(0,2*this.projection.y);b&&d.append(b);d.scale(1,-1);for(d=0;d<a.children.length;d++)a.children[d].updateTransform();d=this.renderer.gl;d.viewport(0,0,this.width*this.resolution,this.height*this.resolution);d.bindFramebuffer(d.FRAMEBUFFER,this.textureBuffer.frameBuffer);c&&this.textureBuffer.clear();this.renderer.spriteBatch.dirty=!0;this.renderer.renderDisplayObject(a,
this.projection,this.textureBuffer.frameBuffer,b);this.renderer.spriteBatch.dirty=!0}};PIXI.RenderTexture.prototype.renderCanvas=function(a,b,c){if(this.valid&&0!==a.alpha){var d=a.worldTransform;d.identity();b&&d.append(b);for(d=0;d<a.children.length;d++)a.children[d].updateTransform();c&&this.textureBuffer.clear();c=this.renderer.resolution;this.renderer.resolution=this.resolution;this.renderer.renderDisplayObject(a,this.textureBuffer.context,b);this.renderer.resolution=c}};
PIXI.RenderTexture.prototype.getImage=function(){var a=new Image;a.src=this.getBase64();return a};PIXI.RenderTexture.prototype.getBase64=function(){return this.getCanvas().toDataURL()};
PIXI.RenderTexture.prototype.getCanvas=function(){if(this.renderer.type===PIXI.WEBGL_RENDERER){var a=this.renderer.gl,b=this.textureBuffer.width,c=this.textureBuffer.height,d=new Uint8Array(4*b*c);a.bindFramebuffer(a.FRAMEBUFFER,this.textureBuffer.frameBuffer);a.readPixels(0,0,b,c,a.RGBA,a.UNSIGNED_BYTE,d);a.bindFramebuffer(a.FRAMEBUFFER,null);a=new PIXI.CanvasBuffer(b,c);b=a.context.getImageData(0,0,b,c);b.data.set(d);a.context.putImageData(b,0,0);return a.canvas}return this.textureBuffer.canvas};
PIXI.AbstractFilter=function(a,b){this.passes=[this];this.shaders=[];this.dirty=!0;this.padding=0;this.uniforms=b||{};this.fragmentSrc=a||[]};PIXI.AbstractFilter.prototype.constructor=PIXI.AbstractFilter;PIXI.AbstractFilter.prototype.syncUniforms=function(){for(var a=0,b=this.shaders.length;a<b;a++)this.shaders[a].dirty=!0};
var Phaser=Phaser||{VERSION:"2.6.2",GAMES:[],AUTO:0,CANVAS:1,WEBGL:2,HEADLESS:3,NONE:0,LEFT:1,RIGHT:2,UP:3,DOWN:4,SPRITE:0,BUTTON:1,IMAGE:2,GRAPHICS:3,TEXT:4,TILESPRITE:5,BITMAPTEXT:6,GROUP:7,RENDERTEXTURE:8,TILEMAP:9,TILEMAPLAYER:10,EMITTER:11,POLYGON:12,BITMAPDATA:13,CANVAS_FILTER:14,WEBGL_FILTER:15,ELLIPSE:16,SPRITEBATCH:17,RETROFONT:18,POINTER:19,ROPE:20,CIRCLE:21,RECTANGLE:22,LINE:23,MATRIX:24,POINT:25,ROUNDEDRECTANGLE:26,CREATURE:27,VIDEO:28,PENDING_ATLAS:-1,HORIZONTAL:0,VERTICAL:1,LANDSCAPE:0,
PORTRAIT:1,ANGLE_UP:270,ANGLE_DOWN:90,ANGLE_LEFT:180,ANGLE_RIGHT:0,ANGLE_NORTH_EAST:315,ANGLE_NORTH_WEST:225,ANGLE_SOUTH_EAST:45,ANGLE_SOUTH_WEST:135,TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,LEFT_TOP:3,LEFT_CENTER:4,LEFT_BOTTOM:5,CENTER:6,RIGHT_TOP:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM_RIGHT:12,blendModes:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,
COLOR:15,LUMINOSITY:16},scaleModes:{DEFAULT:0,LINEAR:0,NEAREST:1},PIXI:PIXI||{}};Math.trunc||(Math.trunc=function(a){return 0>a?Math.ceil(a):Math.floor(a)});
Function.prototype.bind||(Function.prototype.bind=function(){var a=Array.prototype.slice;return function(b){function c(){var f=e.concat(a.call(arguments));d.apply(this instanceof c?this:b,f)}var d=this,e=a.call(arguments,1);if("function"!==typeof d)throw new TypeError;c.prototype=function g(a){a&&(g.prototype=a);if(!(this instanceof g))return new g}(d.prototype);return c}}());Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});
Array.prototype.forEach||(Array.prototype.forEach=function(a){if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!==typeof a)throw new TypeError;for(var d=2<=arguments.length?arguments[1]:void 0,e=0;e<c;e++)e in b&&a.call(d,b[e],e,b)});
if("function"!==typeof window.Uint32Array&&"object"!==typeof window.Uint32Array){var CheapArray=function(a){window[a]=function(a){if("number"===typeof a){Array.call(this,a);this.length=a;for(var c=0;c<this.length;c++)this[c]=0}else for(Array.call(this,a.length),this.length=a.length,c=0;c<this.length;c++)this[c]=a[c]};window[a].prototype=[];window[a].constructor=window[a]};CheapArray("Uint32Array");CheapArray("Int16Array")}
window.console||(window.console={},window.console.log=window.console.assert=function(){},window.console.warn=window.console.assert=function(){});
Phaser.Utils={reverseString:function(a){return a.split("").reverse().join("")},getProperty:function(a,b){for(var c=b.split("."),d=c.pop(),e=c.length,f=1,g=c[0];f<e&&(a=a[g]);)g=c[f],f++;return a?a[d]:null},setProperty:function(a,b,c){b=b.split(".");for(var d=b.pop(),e=b.length,f=1,g=b[0];f<e&&(a=a[g]);)g=b[f],f++;a&&(a[d]=c);return a},chanceRoll:function(a){void 0===a&&(a=50);return 0<a&&100*Math.random()<=a},randomChoice:function(a,b){return.5>Math.random()?a:b},parseDimension:function(a,b){var c=
0,c=0;"string"===typeof a?"%"===a.substr(-1)?(c=parseInt(a,10)/100,c=0===b?window.innerWidth*c:window.innerHeight*c):c=parseInt(a,10):c=a;return c},pad:function(a,b,c,d){void 0===b&&(b=0);void 0===c&&(c=" ");void 0===d&&(d=3);a=a.toString();var e=0;if(b+1>=a.length)switch(d){case 1:a=Array(b+1-a.length).join(c)+a;break;case 3:b=Math.ceil((e=b-a.length)/2);a=Array(e-b+1).join(c)+a+Array(b+1).join(c);break;default:a+=Array(b+1-a.length).join(c)}return a},isPlainObject:function(a){if("object"!==typeof a||
a.nodeType||a===a.window)return!1;try{if(a.constructor&&!{}.hasOwnProperty.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(b){return!1}return!0},extend:function(){var a,b,c,d,e,f=arguments[0]||{},g=1,h=arguments.length,k=!1;"boolean"===typeof f&&(k=f,f=arguments[1]||{},g=2);h===g&&(f=this,--g);for(;g<h;g++)if(null!=(a=arguments[g]))for(b in a)c=f[b],d=a[b],f!==d&&(k&&d&&(Phaser.Utils.isPlainObject(d)||(e=Array.isArray(d)))?(e?(e=!1,c=c&&Array.isArray(c)?c:[]):c=c&&Phaser.Utils.isPlainObject(c)?
c:{},f[b]=Phaser.Utils.extend(k,c,d)):void 0!==d&&(f[b]=d));return f},mixinPrototype:function(a,b,c){void 0===c&&(c=!1);for(var d=Object.keys(b),e=0;e<d.length;e++){var f=d[e],g=b[f];!c&&f in a||(!g||"function"!==typeof g.get&&"function"!==typeof g.set?a[f]=g:"function"===typeof g.clone?a[f]=g.clone():Object.defineProperty(a,f,g))}},mixin:function(a,b){if(!a||"object"!==typeof a)return b;for(var c in a){var d=a[c];if(!d.childNodes&&!d.cloneNode){var e=typeof a[c];b[c]=a[c]&&"object"===e?typeof b[c]===
e?Phaser.Utils.mixin(a[c],b[c]):Phaser.Utils.mixin(a[c],new d.constructor):a[c]}}return b}};Phaser.Circle=function(a,b,c){c=c||0;this.x=a||0;this.y=b||0;this._diameter=c;this._radius=0;0<c&&(this._radius=.5*c);this.type=Phaser.CIRCLE};
Phaser.Circle.prototype={circumference:function(){return 2*Math.PI*this._radius},random:function(a){void 0===a&&(a=new Phaser.Point);var b=2*Math.PI*Math.random(),c=Math.random()+Math.random(),c=1<c?2-c:c,d=c*Math.sin(b);a.x=this.x+c*Math.cos(b)*this.radius;a.y=this.y+d*this.radius;return a},getBounds:function(){return new Phaser.Rectangle(this.x-this.radius,this.y-this.radius,this.diameter,this.diameter)},setTo:function(a,b,c){this.x=a;this.y=b;this._diameter=c;this._radius=.5*c;return this},copyFrom:function(a){return this.setTo(a.x,
a.y,a.diameter)},copyTo:function(a){a.x=this.x;a.y=this.y;a.diameter=this._diameter;return a},distance:function(a,b){var c=Phaser.Math.distance(this.x,this.y,a.x,a.y);return b?Math.round(c):c},clone:function(a){void 0===a||null===a?a=new Phaser.Circle(this.x,this.y,this.diameter):a.setTo(this.x,this.y,this.diameter);return a},contains:function(a,b){return Phaser.Circle.contains(this,a,b)},circumferencePoint:function(a,b,c){return Phaser.Circle.circumferencePoint(this,a,b,c)},offset:function(a,b){this.x+=
a;this.y+=b;return this},offsetPoint:function(a){return this.offset(a.x,a.y)},toString:function(){return"[{Phaser.Circle (x="+this.x+" y="+this.y+" diameter="+this.diameter+" radius="+this.radius+")}]"}};Phaser.Circle.prototype.constructor=Phaser.Circle;Object.defineProperty(Phaser.Circle.prototype,"diameter",{get:function(){return this._diameter},set:function(a){0<a&&(this._diameter=a,this._radius=.5*a)}});
Object.defineProperty(Phaser.Circle.prototype,"radius",{get:function(){return this._radius},set:function(a){0<a&&(this._radius=a,this._diameter=2*a)}});Object.defineProperty(Phaser.Circle.prototype,"left",{get:function(){return this.x-this._radius},set:function(a){a>this.x?this._diameter=this._radius=0:this.radius=this.x-a}});Object.defineProperty(Phaser.Circle.prototype,"right",{get:function(){return this.x+this._radius},set:function(a){a<this.x?this._diameter=this._radius=0:this.radius=a-this.x}});
Object.defineProperty(Phaser.Circle.prototype,"top",{get:function(){return this.y-this._radius},set:function(a){a>this.y?this._diameter=this._radius=0:this.radius=this.y-a}});Object.defineProperty(Phaser.Circle.prototype,"bottom",{get:function(){return this.y+this._radius},set:function(a){a<this.y?this._diameter=this._radius=0:this.radius=a-this.y}});Object.defineProperty(Phaser.Circle.prototype,"area",{get:function(){return 0<this._radius?Math.PI*this._radius*this._radius:0}});
Object.defineProperty(Phaser.Circle.prototype,"empty",{get:function(){return 0===this._diameter},set:function(a){!0===a&&this.setTo(0,0,0)}});Phaser.Circle.contains=function(a,b,c){return 0<a.radius&&b>=a.left&&b<=a.right&&c>=a.top&&c<=a.bottom?(a.x-b)*(a.x-b)+(a.y-c)*(a.y-c)<=a.radius*a.radius:!1};Phaser.Circle.equals=function(a,b){return a.x===b.x&&a.y===b.y&&a.diameter===b.diameter};Phaser.Circle.intersects=function(a,b){return Phaser.Math.distance(a.x,a.y,b.x,b.y)<=a.radius+b.radius};
Phaser.Circle.circumferencePoint=function(a,b,c,d){void 0===c&&(c=!1);void 0===d&&(d=new Phaser.Point);!0===c&&(b=Phaser.Math.degToRad(b));d.x=a.x+a.radius*Math.cos(b);d.y=a.y+a.radius*Math.sin(b);return d};Phaser.Circle.intersectsRectangle=function(a,b){var c=Math.abs(a.x-b.x-b.halfWidth);if(c>b.halfWidth+a.radius)return!1;var d=Math.abs(a.y-b.y-b.halfHeight);if(d>b.halfHeight+a.radius)return!1;if(c<=b.halfWidth||d<=b.halfHeight)return!0;c-=b.halfWidth;d-=b.halfHeight;return c*c+d*d<=a.radius*a.radius};
PIXI.Circle=Phaser.Circle;Phaser.Ellipse=function(a,b,c,d){this.x=a||0;this.y=b||0;this.width=c||0;this.height=d||0;this.type=Phaser.ELLIPSE};
Phaser.Ellipse.prototype={setTo:function(a,b,c,d){this.x=a;this.y=b;this.width=c;this.height=d;return this},getBounds:function(){return new Phaser.Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)},copyFrom:function(a){return this.setTo(a.x,a.y,a.width,a.height)},copyTo:function(a){a.x=this.x;a.y=this.y;a.width=this.width;a.height=this.height;return a},clone:function(a){void 0===a||null===a?a=new Phaser.Ellipse(this.x,this.y,this.width,this.height):a.setTo(this.x,this.y,this.width,
this.height);return a},contains:function(a,b){return Phaser.Ellipse.contains(this,a,b)},random:function(a){void 0===a&&(a=new Phaser.Point);var b=Math.random()*Math.PI*2,c=Math.random();a.x=Math.sqrt(c)*Math.cos(b);a.y=Math.sqrt(c)*Math.sin(b);a.x=this.x+a.x*this.width/2;a.y=this.y+a.y*this.height/2;return a},toString:function(){return"[{Phaser.Ellipse (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")}]"}};Phaser.Ellipse.prototype.constructor=Phaser.Ellipse;
Object.defineProperty(Phaser.Ellipse.prototype,"left",{get:function(){return this.x},set:function(a){this.x=a}});Object.defineProperty(Phaser.Ellipse.prototype,"right",{get:function(){return this.x+this.width},set:function(a){this.width=a<this.x?0:a-this.x}});Object.defineProperty(Phaser.Ellipse.prototype,"top",{get:function(){return this.y},set:function(a){this.y=a}});
Object.defineProperty(Phaser.Ellipse.prototype,"bottom",{get:function(){return this.y+this.height},set:function(a){this.height=a<this.y?0:a-this.y}});Object.defineProperty(Phaser.Ellipse.prototype,"empty",{get:function(){return 0===this.width||0===this.height},set:function(a){!0===a&&this.setTo(0,0,0,0)}});Phaser.Ellipse.contains=function(a,b,c){if(0>=a.width||0>=a.height)return!1;b=(b-a.x)/a.width-.5;a=(c-a.y)/a.height-.5;return.25>b*b+a*a};PIXI.Ellipse=Phaser.Ellipse;
Phaser.Line=function(a,b,c,d){c=c||0;d=d||0;this.start=new Phaser.Point(a||0,b||0);this.end=new Phaser.Point(c,d);this.type=Phaser.LINE};
Phaser.Line.prototype={setTo:function(a,b,c,d){this.start.setTo(a,b);this.end.setTo(c,d);return this},fromSprite:function(a,b,c){void 0===c&&(c=!1);return c?this.setTo(a.center.x,a.center.y,b.center.x,b.center.y):this.setTo(a.x,a.y,b.x,b.y)},fromAngle:function(a,b,c,d){this.start.setTo(a,b);this.end.setTo(a+Math.cos(c)*d,b+Math.sin(c)*d);return this},rotate:function(a,b){var c=(this.start.x+this.end.x)/2,d=(this.start.y+this.end.y)/2;this.start.rotate(c,d,a,b);this.end.rotate(c,d,a,b);return this},
rotateAround:function(a,b,c,d){this.start.rotate(a,b,c,d);this.end.rotate(a,b,c,d);return this},intersects:function(a,b,c){return Phaser.Line.intersectsPoints(this.start,this.end,a.start,a.end,b,c)},reflect:function(a){return Phaser.Line.reflect(this,a)},midPoint:function(a){void 0===a&&(a=new Phaser.Point);a.x=(this.start.x+this.end.x)/2;a.y=(this.start.y+this.end.y)/2;return a},centerOn:function(a,b){var c=a-(this.start.x+this.end.x)/2,d=b-(this.start.y+this.end.y)/2;this.start.add(c,d);this.end.add(c,
d)},pointOnLine:function(a,b){return(a-this.start.x)*(this.end.y-this.start.y)===(this.end.x-this.start.x)*(b-this.start.y)},pointOnSegment:function(a,b){var c=Math.min(this.start.x,this.end.x),d=Math.max(this.start.x,this.end.x),e=Math.min(this.start.y,this.end.y),f=Math.max(this.start.y,this.end.y);return this.pointOnLine(a,b)&&a>=c&&a<=d&&b>=e&&b<=f},random:function(a){void 0===a&&(a=new Phaser.Point);var b=Math.random();a.x=this.start.x+b*(this.end.x-this.start.x);a.y=this.start.y+b*(this.end.y-
this.start.y);return a},coordinatesOnLine:function(a,b){void 0===a&&(a=1);void 0===b&&(b=[]);var c=Math.round(this.start.x),d=Math.round(this.start.y),e=Math.round(this.end.x),f=Math.round(this.end.y),g=Math.abs(e-c),h=Math.abs(f-d),k=c<e?1:-1,l=d<f?1:-1,m=g-h;b.push([c,d]);for(var n=1;c!==e||d!==f;){var p=m<<1;p>-h&&(m-=h,c+=k);p<g&&(m+=g,d+=l);0===n%a&&b.push([c,d]);n++}return b},clone:function(a){void 0===a||null===a?a=new Phaser.Line(this.start.x,this.start.y,this.end.x,this.end.y):a.setTo(this.start.x,
this.start.y,this.end.x,this.end.y);return a}};Object.defineProperty(Phaser.Line.prototype,"length",{get:function(){return Math.sqrt((this.end.x-this.start.x)*(this.end.x-this.start.x)+(this.end.y-this.start.y)*(this.end.y-this.start.y))}});Object.defineProperty(Phaser.Line.prototype,"angle",{get:function(){return Math.atan2(this.end.y-this.start.y,this.end.x-this.start.x)}});Object.defineProperty(Phaser.Line.prototype,"slope",{get:function(){return(this.end.y-this.start.y)/(this.end.x-this.start.x)}});
Object.defineProperty(Phaser.Line.prototype,"perpSlope",{get:function(){return-((this.end.x-this.start.x)/(this.end.y-this.start.y))}});Object.defineProperty(Phaser.Line.prototype,"x",{get:function(){return Math.min(this.start.x,this.end.x)}});Object.defineProperty(Phaser.Line.prototype,"y",{get:function(){return Math.min(this.start.y,this.end.y)}});Object.defineProperty(Phaser.Line.prototype,"left",{get:function(){return Math.min(this.start.x,this.end.x)}});
Object.defineProperty(Phaser.Line.prototype,"right",{get:function(){return Math.max(this.start.x,this.end.x)}});Object.defineProperty(Phaser.Line.prototype,"top",{get:function(){return Math.min(this.start.y,this.end.y)}});Object.defineProperty(Phaser.Line.prototype,"bottom",{get:function(){return Math.max(this.start.y,this.end.y)}});Object.defineProperty(Phaser.Line.prototype,"width",{get:function(){return Math.abs(this.start.x-this.end.x)}});
Object.defineProperty(Phaser.Line.prototype,"height",{get:function(){return Math.abs(this.start.y-this.end.y)}});Object.defineProperty(Phaser.Line.prototype,"normalX",{get:function(){return Math.cos(this.angle-1.5707963267948966)}});Object.defineProperty(Phaser.Line.prototype,"normalY",{get:function(){return Math.sin(this.angle-1.5707963267948966)}});Object.defineProperty(Phaser.Line.prototype,"normalAngle",{get:function(){return Phaser.Math.wrap(this.angle-1.5707963267948966,-Math.PI,Math.PI)}});
Phaser.Line.intersectsPoints=function(a,b,c,d,e,f){void 0===e&&(e=!0);void 0===f&&(f=new Phaser.Point);var g=b.y-a.y,h=d.y-c.y,k=a.x-b.x,l=c.x-d.x,m=b.x*a.y-a.x*b.y,n=d.x*c.y-c.x*d.y,p=g*l-h*k;if(0===p)return null;f.x=(k*n-l*m)/p;f.y=(h*m-g*n)/p;return!e||(e=(d.y-c.y)*(b.x-a.x)-(d.x-c.x)*(b.y-a.y),d=((d.x-c.x)*(a.y-c.y)-(d.y-c.y)*(a.x-c.x))/e,a=((b.x-a.x)*(a.y-c.y)-(b.y-a.y)*(a.x-c.x))/e,0<=d&&1>=d&&0<=a&&1>=a)?f:null};
Phaser.Line.intersects=function(a,b,c,d){return Phaser.Line.intersectsPoints(a.start,a.end,b.start,b.end,c,d)};
Phaser.Line.intersectsRectangle=function(a,b){if(!Phaser.Rectangle.intersects(a,b))return!1;var c=a.start.x,d=a.start.y,e=a.end.x,f=a.end.y,g=b.x,h=b.y,k=b.right,l=b.bottom,m=0;if(c>=g&&c<=k&&d>=h&&d<=l||e>=g&&e<=k&&f>=h&&f<=l)return!0;if(c<g&&e>=g){if(m=d+(f-d)*(g-c)/(e-c),m>h&&m<=l)return!0}else if(c>k&&e<=k&&(m=d+(f-d)*(k-c)/(e-c),m>=h&&m<=l))return!0;if(d<h&&f>=h){if(m=c+(e-c)*(h-d)/(f-d),m>=g&&m<=k)return!0}else if(d>l&&f<=l&&(m=c+(e-c)*(l-d)/(f-d),m>=g&&m<=k))return!0;return!1};
Phaser.Line.reflect=function(a,b){return 2*b.normalAngle-3.141592653589793-a.angle};Phaser.Matrix=function(a,b,c,d,e,f){if(void 0===a||null===a)a=1;if(void 0===b||null===b)b=0;if(void 0===c||null===c)c=0;if(void 0===d||null===d)d=1;if(void 0===e||null===e)e=0;if(void 0===f||null===f)f=0;this.a=a;this.b=b;this.c=c;this.d=d;this.tx=e;this.ty=f;this.type=Phaser.MATRIX};
Phaser.Matrix.prototype={fromArray:function(a){return this.setTo(a[0],a[1],a[3],a[4],a[2],a[5])},setTo:function(a,b,c,d,e,f){this.a=a;this.b=b;this.c=c;this.d=d;this.tx=e;this.ty=f;return this},clone:function(a){void 0===a||null===a?a=new Phaser.Matrix(this.a,this.b,this.c,this.d,this.tx,this.ty):(a.a=this.a,a.b=this.b,a.c=this.c,a.d=this.d,a.tx=this.tx,a.ty=this.ty);return a},copyTo:function(a){a.copyFrom(this);return a},copyFrom:function(a){this.a=a.a;this.b=a.b;this.c=a.c;this.d=a.d;this.tx=a.tx;
this.ty=a.ty;return this},toArray:function(a,b){void 0===b&&(b=new PIXI.Float32Array(9));a?(b[0]=this.a,b[1]=this.b,b[2]=0,b[3]=this.c,b[4]=this.d,b[5]=0,b[6]=this.tx,b[7]=this.ty):(b[0]=this.a,b[1]=this.c,b[2]=this.tx,b[3]=this.b,b[4]=this.d,b[5]=this.ty,b[6]=0,b[7]=0);b[8]=1;return b},apply:function(a,b){void 0===b&&(b=new Phaser.Point);b.x=this.a*a.x+this.c*a.y+this.tx;b.y=this.b*a.x+this.d*a.y+this.ty;return b},applyInverse:function(a,b){void 0===b&&(b=new Phaser.Point);var c=1/(this.a*this.d+
this.c*-this.b),d=a.x,e=a.y;b.x=this.d*c*d+-this.c*c*e+(this.ty*this.c-this.tx*this.d)*c;b.y=this.a*c*e+-this.b*c*d+(-this.ty*this.a+this.tx*this.b)*c;return b},translate:function(a,b){this.tx+=a;this.ty+=b;return this},scale:function(a,b){this.a*=a;this.d*=b;this.c*=a;this.b*=b;this.tx*=a;this.ty*=b;return this},rotate:function(a){var b=Math.cos(a);a=Math.sin(a);var c=this.a,d=this.c,e=this.tx;this.a=c*b-this.b*a;this.b=c*a+this.b*b;this.c=d*b-this.d*a;this.d=d*a+this.d*b;this.tx=e*b-this.ty*a;this.ty=
e*a+this.ty*b;return this},append:function(a){var b=this.a,c=this.b,d=this.c,e=this.d;this.a=a.a*b+a.b*d;this.b=a.a*c+a.b*e;this.c=a.c*b+a.d*d;this.d=a.c*c+a.d*e;this.tx=a.tx*b+a.ty*d+this.tx;this.ty=a.tx*c+a.ty*e+this.ty;return this},identity:function(){return this.setTo(1,0,0,1,0,0)}};Phaser.identityMatrix=new Phaser.Matrix;PIXI.Matrix=Phaser.Matrix;PIXI.identityMatrix=Phaser.identityMatrix;Phaser.Point=function(a,b){this.x=a||0;this.y=b||0;this.type=Phaser.POINT};
Phaser.Point.prototype={copyFrom:function(a){return this.setTo(a.x,a.y)},invert:function(){return this.setTo(this.y,this.x)},setTo:function(a,b){this.x=a||0;this.y=b||(0!==b?this.x:0);return this},set:function(a,b){this.x=a||0;this.y=b||(0!==b?this.x:0);return this},add:function(a,b){this.x+=a;this.y+=b;return this},subtract:function(a,b){this.x-=a;this.y-=b;return this},multiply:function(a,b){this.x*=a;this.y*=b;return this},divide:function(a,b){this.x/=a;this.y/=b;return this},clampX:function(a,
b){this.x=Phaser.Math.clamp(this.x,a,b);return this},clampY:function(a,b){this.y=Phaser.Math.clamp(this.y,a,b);return this},clamp:function(a,b){this.x=Phaser.Math.clamp(this.x,a,b);this.y=Phaser.Math.clamp(this.y,a,b);return this},clone:function(a){void 0===a||null===a?a=new Phaser.Point(this.x,this.y):a.setTo(this.x,this.y);return a},copyTo:function(a){a.x=this.x;a.y=this.y;return a},distance:function(a,b){return Phaser.Point.distance(this,a,b)},equals:function(a){return a.x===this.x&&a.y===this.y},
angle:function(a,b){void 0===b&&(b=!1);return b?Phaser.Math.radToDeg(Math.atan2(a.y-this.y,a.x-this.x)):Math.atan2(a.y-this.y,a.x-this.x)},rotate:function(a,b,c,d,e){return Phaser.Point.rotate(this,a,b,c,d,e)},getMagnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},getMagnitudeSq:function(){return this.x*this.x+this.y*this.y},setMagnitude:function(a){return this.normalize().multiply(a,a)},normalize:function(){if(!this.isZero()){var a=this.getMagnitude();this.x/=a;this.y/=a}return this},
isZero:function(){return 0===this.x&&0===this.y},dot:function(a){return this.x*a.x+this.y*a.y},cross:function(a){return this.x*a.y-this.y*a.x},perp:function(){return this.setTo(-this.y,this.x)},rperp:function(){return this.setTo(this.y,-this.x)},normalRightHand:function(){return this.setTo(-1*this.y,this.x)},floor:function(){return this.setTo(Math.floor(this.x),Math.floor(this.y))},ceil:function(){return this.setTo(Math.ceil(this.x),Math.ceil(this.y))},toString:function(){return"[{Point (x="+this.x+
" y="+this.y+")}]"}};Phaser.Point.prototype.constructor=Phaser.Point;Phaser.Point.add=function(a,b,c){void 0===c&&(c=new Phaser.Point);c.x=a.x+b.x;c.y=a.y+b.y;return c};Phaser.Point.subtract=function(a,b,c){void 0===c&&(c=new Phaser.Point);c.x=a.x-b.x;c.y=a.y-b.y;return c};Phaser.Point.multiply=function(a,b,c){void 0===c&&(c=new Phaser.Point);c.x=a.x*b.x;c.y=a.y*b.y;return c};Phaser.Point.divide=function(a,b,c){void 0===c&&(c=new Phaser.Point);c.x=a.x/b.x;c.y=a.y/b.y;return c};
Phaser.Point.equals=function(a,b){return a.x===b.x&&a.y===b.y};Phaser.Point.angle=function(a,b){return Math.atan2(a.y-b.y,a.x-b.x)};Phaser.Point.negative=function(a,b){void 0===b&&(b=new Phaser.Point);return b.setTo(-a.x,-a.y)};Phaser.Point.multiplyAdd=function(a,b,c,d){void 0===d&&(d=new Phaser.Point);return d.setTo(a.x+b.x*c,a.y+b.y*c)};Phaser.Point.interpolate=function(a,b,c,d){void 0===d&&(d=new Phaser.Point);return d.setTo(a.x+(b.x-a.x)*c,a.y+(b.y-a.y)*c)};
Phaser.Point.perp=function(a,b){void 0===b&&(b=new Phaser.Point);return b.setTo(-a.y,a.x)};Phaser.Point.rperp=function(a,b){void 0===b&&(b=new Phaser.Point);return b.setTo(a.y,-a.x)};Phaser.Point.distance=function(a,b,c){a=Phaser.Math.distance(a.x,a.y,b.x,b.y);return c?Math.round(a):a};Phaser.Point.project=function(a,b,c){void 0===c&&(c=new Phaser.Point);a=a.dot(b)/b.getMagnitudeSq();0!==a&&c.setTo(a*b.x,a*b.y);return c};
Phaser.Point.projectUnit=function(a,b,c){void 0===c&&(c=new Phaser.Point);a=a.dot(b);0!==a&&c.setTo(a*b.x,a*b.y);return c};Phaser.Point.normalRightHand=function(a,b){void 0===b&&(b=new Phaser.Point);return b.setTo(-1*a.y,a.x)};Phaser.Point.normalize=function(a,b){void 0===b&&(b=new Phaser.Point);var c=a.getMagnitude();0!==c&&b.setTo(a.x/c,a.y/c);return b};
Phaser.Point.rotate=function(a,b,c,d,e,f){e&&(d=Phaser.Math.degToRad(d));void 0===f?(a.subtract(b,c),f=Math.sin(d),d=Math.cos(d),e=f*a.x+d*a.y,a.x=d*a.x-f*a.y+b,a.y=e+c):(d+=Math.atan2(a.y-c,a.x-b),a.x=b+f*Math.cos(d),a.y=c+f*Math.sin(d));return a};
Phaser.Point.centroid=function(a,b){void 0===b&&(b=new Phaser.Point);if("[object Array]"!==Object.prototype.toString.call(a))throw Error("Phaser.Point. Parameter 'points' must be an array");var c=a.length;if(1>c)throw Error("Phaser.Point. Parameter 'points' array must not be empty");if(1===c)return b.copyFrom(a[0]),b;for(var d=0;d<c;d++)Phaser.Point.add(b,a[d],b);b.divide(c,c);return b};
Phaser.Point.parse=function(a,b,c){b=b||"x";c=c||"y";var d=new Phaser.Point;a[b]&&(d.x=parseInt(a[b],10));a[c]&&(d.y=parseInt(a[c],10));return d};PIXI.Point=Phaser.Point;Phaser.Polygon=function(){this.area=0;this._points=[];0<arguments.length&&this.setTo.apply(this,arguments);this.closed=!0;this.flattened=!1;this.type=Phaser.POLYGON};
Phaser.Polygon.prototype={toNumberArray:function(a){void 0===a&&(a=[]);for(var b=0;b<this._points.length;b++)"number"===typeof this._points[b]?(a.push(this._points[b]),a.push(this._points[b+1]),b++):(a.push(this._points[b].x),a.push(this._points[b].y));return a},flatten:function(){this._points=this.toNumberArray();this.flattened=!0;return this},clone:function(a){var b=this._points.slice();void 0===a||null===a?a=new Phaser.Polygon(b):a.setTo(b);return a},contains:function(a,b){var c=!1;if(this.flattened)for(var d=
-2,e=this._points.length-2;(d+=2)<this._points.length;e=d){var f=this._points[d],g=this._points[d+1],h=this._points[e],e=this._points[e+1];(g<=b&&b<e||e<=b&&b<g)&&a<(h-f)*(b-g)/(e-g)+f&&(c=!c)}else for(d=-1,e=this._points.length-1;++d<this._points.length;e=d)f=this._points[d].x,g=this._points[d].y,h=this._points[e].x,e=this._points[e].y,(g<=b&&b<e||e<=b&&b<g)&&a<(h-f)*(b-g)/(e-g)+f&&(c=!c);return c},setTo:function(a){this.area=0;this._points=[];if(0<arguments.length){Array.isArray(a)||(a=Array.prototype.slice.call(arguments));
for(var b=Number.MAX_VALUE,c=0,d=a.length;c<d;c++){if("number"===typeof a[c]){var e=new PIXI.Point(a[c],a[c+1]);c++}else e=Array.isArray(a[c])?new PIXI.Point(a[c][0],a[c][1]):new PIXI.Point(a[c].x,a[c].y);this._points.push(e);e.y<b&&(b=e.y)}this.calculateArea(b)}return this},calculateArea:function(a){for(var b,c,d,e=0,f=this._points.length;e<f;e++)b=this._points[e],c=e===f-1?this._points[0]:this._points[e+1],d=(b.y-a+(c.y-a))/2,b=b.x-c.x,this.area+=d*b;return this.area}};
Phaser.Polygon.prototype.constructor=Phaser.Polygon;Object.defineProperty(Phaser.Polygon.prototype,"points",{get:function(){return this._points},set:function(a){null!=a?this.setTo(a):this.setTo()}});PIXI.Polygon=Phaser.Polygon;Phaser.Rectangle=function(a,b,c,d){this.x=a||0;this.y=b||0;this.width=c||0;this.height=d||0;this.type=Phaser.RECTANGLE};
Phaser.Rectangle.prototype={offset:function(a,b){this.x+=a;this.y+=b;return this},offsetPoint:function(a){return this.offset(a.x,a.y)},setTo:function(a,b,c,d){this.x=a;this.y=b;this.width=c;this.height=d;return this},scale:function(a,b){void 0===b&&(b=a);this.width*=a;this.height*=b;return this},centerOn:function(a,b){this.centerX=a;this.centerY=b;return this},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y)},floorAll:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);
this.width=Math.floor(this.width);this.height=Math.floor(this.height)},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y)},ceilAll:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.width=Math.ceil(this.width);this.height=Math.ceil(this.height)},copyFrom:function(a){return this.setTo(a.x,a.y,a.width,a.height)},copyTo:function(a){a.x=this.x;a.y=this.y;a.width=this.width;a.height=this.height;return a},inflate:function(a,b){return Phaser.Rectangle.inflate(this,a,b)},size:function(a){return Phaser.Rectangle.size(this,
a)},resize:function(a,b){this.width=a;this.height=b;return this},clone:function(a){return Phaser.Rectangle.clone(this,a)},contains:function(a,b){return Phaser.Rectangle.contains(this,a,b)},containsRect:function(a){return Phaser.Rectangle.containsRect(a,this)},equals:function(a){return Phaser.Rectangle.equals(this,a)},intersection:function(a,b){return Phaser.Rectangle.intersection(this,a,b)},intersects:function(a){return Phaser.Rectangle.intersects(this,a)},intersectsRaw:function(a,b,c,d,e){return Phaser.Rectangle.intersectsRaw(this,
a,b,c,d,e)},union:function(a,b){return Phaser.Rectangle.union(this,a,b)},random:function(a){void 0===a&&(a=new Phaser.Point);a.x=this.randomX;a.y=this.randomY;return a},getPoint:function(a,b){void 0===b&&(b=new Phaser.Point);switch(a){default:case Phaser.TOP_LEFT:return b.set(this.x,this.y);case Phaser.TOP_CENTER:return b.set(this.centerX,this.y);case Phaser.TOP_RIGHT:return b.set(this.right,this.y);case Phaser.LEFT_CENTER:return b.set(this.x,this.centerY);case Phaser.CENTER:return b.set(this.centerX,
this.centerY);case Phaser.RIGHT_CENTER:return b.set(this.right,this.centerY);case Phaser.BOTTOM_LEFT:return b.set(this.x,this.bottom);case Phaser.BOTTOM_CENTER:return b.set(this.centerX,this.bottom);case Phaser.BOTTOM_RIGHT:return b.set(this.right,this.bottom)}},toString:function(){return"[{Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+" empty="+this.empty+")}]"}};
Object.defineProperty(Phaser.Rectangle.prototype,"halfWidth",{get:function(){return Math.round(this.width/2)}});Object.defineProperty(Phaser.Rectangle.prototype,"halfHeight",{get:function(){return Math.round(this.height/2)}});Object.defineProperty(Phaser.Rectangle.prototype,"bottom",{get:function(){return this.y+this.height},set:function(a){this.height=a<=this.y?0:a-this.y}});
Object.defineProperty(Phaser.Rectangle.prototype,"bottomLeft",{get:function(){return new Phaser.Point(this.x,this.bottom)},set:function(a){this.x=a.x;this.bottom=a.y}});Object.defineProperty(Phaser.Rectangle.prototype,"bottomRight",{get:function(){return new Phaser.Point(this.right,this.bottom)},set:function(a){this.right=a.x;this.bottom=a.y}});Object.defineProperty(Phaser.Rectangle.prototype,"left",{get:function(){return this.x},set:function(a){this.width=a>=this.right?0:this.right-a;this.x=a}});
Object.defineProperty(Phaser.Rectangle.prototype,"right",{get:function(){return this.x+this.width},set:function(a){this.width=a<=this.x?0:a-this.x}});Object.defineProperty(Phaser.Rectangle.prototype,"volume",{get:function(){return this.width*this.height}});Object.defineProperty(Phaser.Rectangle.prototype,"perimeter",{get:function(){return 2*this.width+2*this.height}});
Object.defineProperty(Phaser.Rectangle.prototype,"centerX",{get:function(){return this.x+this.halfWidth},set:function(a){this.x=a-this.halfWidth}});Object.defineProperty(Phaser.Rectangle.prototype,"centerY",{get:function(){return this.y+this.halfHeight},set:function(a){this.y=a-this.halfHeight}});Object.defineProperty(Phaser.Rectangle.prototype,"randomX",{get:function(){return this.x+Math.random()*this.width}});
Object.defineProperty(Phaser.Rectangle.prototype,"randomY",{get:function(){return this.y+Math.random()*this.height}});Object.defineProperty(Phaser.Rectangle.prototype,"top",{get:function(){return this.y},set:function(a){a>=this.bottom?(this.height=0,this.y=a):this.height=this.bottom-a}});Object.defineProperty(Phaser.Rectangle.prototype,"topLeft",{get:function(){return new Phaser.Point(this.x,this.y)},set:function(a){this.x=a.x;this.y=a.y}});
Object.defineProperty(Phaser.Rectangle.prototype,"topRight",{get:function(){return new Phaser.Point(this.x+this.width,this.y)},set:function(a){this.right=a.x;this.y=a.y}});Object.defineProperty(Phaser.Rectangle.prototype,"empty",{get:function(){return!this.width||!this.height},set:function(a){!0===a&&this.setTo(0,0,0,0)}});Phaser.Rectangle.prototype.constructor=Phaser.Rectangle;Phaser.Rectangle.inflate=function(a,b,c){a.x-=b;a.width+=2*b;a.y-=c;a.height+=2*c;return a};
Phaser.Rectangle.inflatePoint=function(a,b){return Phaser.Rectangle.inflate(a,b.x,b.y)};Phaser.Rectangle.size=function(a,b){void 0===b||null===b?b=new Phaser.Point(a.width,a.height):b.setTo(a.width,a.height);return b};Phaser.Rectangle.clone=function(a,b){void 0===b||null===b?b=new Phaser.Rectangle(a.x,a.y,a.width,a.height):b.setTo(a.x,a.y,a.width,a.height);return b};Phaser.Rectangle.contains=function(a,b,c){return 0>=a.width||0>=a.height?!1:b>=a.x&&b<a.right&&c>=a.y&&c<a.bottom};
Phaser.Rectangle.containsRaw=function(a,b,c,d,e,f){return e>=a&&e<a+c&&f>=b&&f<b+d};Phaser.Rectangle.containsPoint=function(a,b){return Phaser.Rectangle.contains(a,b.x,b.y)};Phaser.Rectangle.containsRect=function(a,b){return a.volume>b.volume?!1:a.x>=b.x&&a.y>=b.y&&a.right<b.right&&a.bottom<b.bottom};Phaser.Rectangle.equals=function(a,b){return a.x===b.x&&a.y===b.y&&a.width===b.width&&a.height===b.height};Phaser.Rectangle.sameDimensions=function(a,b){return a.width===b.width&&a.height===b.height};
Phaser.Rectangle.intersection=function(a,b,c){void 0===c&&(c=new Phaser.Rectangle);Phaser.Rectangle.intersects(a,b)&&(c.x=Math.max(a.x,b.x),c.y=Math.max(a.y,b.y),c.width=Math.min(a.right,b.right)-c.x,c.height=Math.min(a.bottom,b.bottom)-c.y);return c};Phaser.Rectangle.intersects=function(a,b){return 0>=a.width||0>=a.height||0>=b.width||0>=b.height?!1:!(a.right<b.x||a.bottom<b.y||a.x>b.right||a.y>b.bottom)};
Phaser.Rectangle.intersectsRaw=function(a,b,c,d,e,f){void 0===f&&(f=0);return!(b>a.right+f||c<a.left-f||d>a.bottom+f||e<a.top-f)};Phaser.Rectangle.union=function(a,b,c){void 0===c&&(c=new Phaser.Rectangle);return c.setTo(Math.min(a.x,b.x),Math.min(a.y,b.y),Math.max(a.right,b.right)-Math.min(a.left,b.left),Math.max(a.bottom,b.bottom)-Math.min(a.top,b.top))};
Phaser.Rectangle.aabb=function(a,b){void 0===b&&(b=new Phaser.Rectangle);var c=Number.NEGATIVE_INFINITY,d=Number.POSITIVE_INFINITY,e=Number.NEGATIVE_INFINITY,f=Number.POSITIVE_INFINITY;a.forEach(function(a){a.x>c&&(c=a.x);a.x<d&&(d=a.x);a.y>e&&(e=a.y);a.y<f&&(f=a.y)});b.setTo(d,f,c-d,e-f);return b};PIXI.Rectangle=Phaser.Rectangle;PIXI.EmptyRectangle=new Phaser.Rectangle(0,0,0,0);
Phaser.RoundedRectangle=function(a,b,c,d,e){void 0===a&&(a=0);void 0===b&&(b=0);void 0===c&&(c=0);void 0===d&&(d=0);void 0===e&&(e=20);this.x=a;this.y=b;this.width=c;this.height=d;this.radius=e||20;this.type=Phaser.ROUNDEDRECTANGLE};
Phaser.RoundedRectangle.prototype={clone:function(){return new Phaser.RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)},contains:function(a,b){if(0>=this.width||0>=this.height)return!1;var c=this.x;return a>=c&&a<=c+this.width&&(c=this.y,b>=c&&b<=c+this.height)?!0:!1}};Phaser.RoundedRectangle.prototype.constructor=Phaser.RoundedRectangle;PIXI.RoundedRectangle=Phaser.RoundedRectangle;
Phaser.Camera=function(a,b,c,d,e,f){this.game=a;this.world=a.world;this.id=0;this.view=new Phaser.Rectangle(c,d,e,f);this.bounds=new Phaser.Rectangle(c,d,e,f);this.deadzone=null;this.roundPx=this.visible=!0;this.atLimit={x:!1,y:!1};this.scale=this.displayObject=this.target=null;this.totalInView=0;this.lerp=new Phaser.Point(1,1);this.onShakeComplete=new Phaser.Signal;this.onFlashComplete=new Phaser.Signal;this.onFadeComplete=new Phaser.Signal;this.fx=null;this._targetPosition=new Phaser.Point;this._edge=
0;this._position=new Phaser.Point;this._shake={intensity:0,duration:0,horizontal:!1,vertical:!1,shakeBounds:!0,x:0,y:0};this._fxType=this._fxDuration=0};Phaser.Camera.FOLLOW_LOCKON=0;Phaser.Camera.FOLLOW_PLATFORMER=1;Phaser.Camera.FOLLOW_TOPDOWN=2;Phaser.Camera.FOLLOW_TOPDOWN_TIGHT=3;Phaser.Camera.SHAKE_BOTH=4;Phaser.Camera.SHAKE_HORIZONTAL=5;Phaser.Camera.SHAKE_VERTICAL=6;Phaser.Camera.ENABLE_FX=!0;
Phaser.Camera.prototype={boot:function(){this.displayObject=this.game.world;this.scale=this.game.world.scale;this.game.camera=this;Phaser.Graphics&&Phaser.Camera.ENABLE_FX&&(this.fx=new Phaser.Graphics(this.game),this.game.stage.addChild(this.fx))},preUpdate:function(){this.totalInView=0},follow:function(a,b,c,d){void 0===b&&(b=Phaser.Camera.FOLLOW_LOCKON);void 0===c&&(c=1);void 0===d&&(d=1);this.target=a;this.lerp.set(c,d);switch(b){case Phaser.Camera.FOLLOW_PLATFORMER:a=this.width/8;b=this.height/
3;this.deadzone=new Phaser.Rectangle((this.width-a)/2,(this.height-b)/2-.25*b,a,b);break;case Phaser.Camera.FOLLOW_TOPDOWN:a=Math.max(this.width,this.height)/4;this.deadzone=new Phaser.Rectangle((this.width-a)/2,(this.height-a)/2,a,a);break;case Phaser.Camera.FOLLOW_TOPDOWN_TIGHT:a=Math.max(this.width,this.height)/8;this.deadzone=new Phaser.Rectangle((this.width-a)/2,(this.height-a)/2,a,a);break;case Phaser.Camera.FOLLOW_LOCKON:this.deadzone=null;break;default:this.deadzone=null}},unfollow:function(){this.target=
null},focusOn:function(a){this.setPosition(Math.round(a.x-this.view.halfWidth),Math.round(a.y-this.view.halfHeight))},focusOnXY:function(a,b){this.setPosition(Math.round(a-this.view.halfWidth),Math.round(b-this.view.halfHeight))},shake:function(a,b,c,d,e){void 0===a&&(a=.05);void 0===b&&(b=500);void 0===c&&(c=!0);void 0===d&&(d=Phaser.Camera.SHAKE_BOTH);void 0===e&&(e=!0);if(!c&&0<this._shake.duration)return!1;this._shake.intensity=a;this._shake.duration=b;this._shake.shakeBounds=e;this._shake.x=
0;this._shake.y=0;this._shake.horizontal=d===Phaser.Camera.SHAKE_BOTH||d===Phaser.Camera.SHAKE_HORIZONTAL;this._shake.vertical=d===Phaser.Camera.SHAKE_BOTH||d===Phaser.Camera.SHAKE_VERTICAL;return!0},flash:function(a,b,c){void 0===a&&(a=16777215);void 0===b&&(b=500);void 0===c&&(c=!1);if(!this.fx||!c&&0<this._fxDuration)return!1;this.fx.clear();this.fx.beginFill(a);this.fx.drawRect(0,0,this.width,this.height);this.fx.endFill();this.fx.alpha=1;this._fxDuration=b;this._fxType=0;return!0},fade:function(a,
b,c){void 0===a&&(a=0);void 0===b&&(b=500);void 0===c&&(c=!1);if(!this.fx||!c&&0<this._fxDuration)return!1;this.fx.clear();this.fx.beginFill(a);this.fx.drawRect(0,0,this.width,this.height);this.fx.endFill();this.fx.alpha=0;this._fxDuration=b;this._fxType=1;return!0},update:function(){0<this._fxDuration&&this.updateFX();0<this._shake.duration&&this.updateShake();this.bounds&&this.checkBounds();this.roundPx&&(this.view.floor(),this._shake.x=Math.floor(this._shake.x),this._shake.y=Math.floor(this._shake.y));
this.displayObject.position.x=-this.view.x;this.displayObject.position.y=-this.view.y},updateFX:function(){0===this._fxType?(this.fx.alpha-=this.game.time.elapsedMS/this._fxDuration,0>=this.fx.alpha&&(this._fxDuration=0,this.fx.alpha=0,this.onFlashComplete.dispatch())):(this.fx.alpha+=this.game.time.elapsedMS/this._fxDuration,1<=this.fx.alpha&&(this._fxDuration=0,this.fx.alpha=1,this.onFadeComplete.dispatch()))},updateShake:function(){this._shake.duration-=this.game.time.elapsedMS;0>=this._shake.duration?
(this.onShakeComplete.dispatch(),this._shake.x=0,this._shake.y=0):(this._shake.horizontal&&(this._shake.x=this.game.rnd.frac()*this._shake.intensity*this.view.width*2-this._shake.intensity*this.view.width),this._shake.vertical&&(this._shake.y=this.game.rnd.frac()*this._shake.intensity*this.view.height*2-this._shake.intensity*this.view.height))},updateTarget:function(){this._targetPosition.x=this.view.x+this.target.worldPosition.x;this._targetPosition.y=this.view.y+this.target.worldPosition.y;this.deadzone?
(this._edge=this._targetPosition.x-this.view.x,this._edge<this.deadzone.left?this.view.x=this.game.math.linear(this.view.x,this._targetPosition.x-this.deadzone.left,this.lerp.x):this._edge>this.deadzone.right&&(this.view.x=this.game.math.linear(this.view.x,this._targetPosition.x-this.deadzone.right,this.lerp.x)),this._edge=this._targetPosition.y-this.view.y,this._edge<this.deadzone.top?this.view.y=this.game.math.linear(this.view.y,this._targetPosition.y-this.deadzone.top,this.lerp.y):this._edge>this.deadzone.bottom&&
(this.view.y=this.game.math.linear(this.view.y,this._targetPosition.y-this.deadzone.bottom,this.lerp.y))):(this.view.x=this.game.math.linear(this.view.x,this._targetPosition.x-this.view.halfWidth,this.lerp.x),this.view.y=this.game.math.linear(this.view.y,this._targetPosition.y-this.view.halfHeight,this.lerp.y));this.bounds&&this.checkBounds();this.roundPx&&this.view.floor();this.displayObject.position.x=-this.view.x;this.displayObject.position.y=-this.view.y},setBoundsToWorld:function(){this.bounds&&
this.bounds.copyFrom(this.game.world.bounds)},checkBounds:function(){this.atLimit.x=!1;this.atLimit.y=!1;var a=this.view.right+this._shake.x,b=this.view.y+this._shake.y,c=this.view.bottom+this._shake.y;this.view.x+this._shake.x<=this.bounds.x*this.scale.x&&(this.atLimit.x=!0,this.view.x=this.bounds.x*this.scale.x,this._shake.shakeBounds||(this._shake.x=0));a>=this.bounds.right*this.scale.x&&(this.atLimit.x=!0,this.view.x=this.bounds.right*this.scale.x-this.width,this._shake.shakeBounds||(this._shake.x=
0));b<=this.bounds.top*this.scale.y&&(this.atLimit.y=!0,this.view.y=this.bounds.top*this.scale.y,this._shake.shakeBounds||(this._shake.y=0));c>=this.bounds.bottom*this.scale.y&&(this.atLimit.y=!0,this.view.y=this.bounds.bottom*this.scale.y-this.height,this._shake.shakeBounds||(this._shake.y=0))},setPosition:function(a,b){this.view.x=a;this.view.y=b;this.bounds&&this.checkBounds()},setSize:function(a,b){this.view.width=a;this.view.height=b},reset:function(){this.target=null;this.view.x=0;this.view.y=
0;this._shake.duration=0;this.resetFX()},resetFX:function(){this.fx.clear();this._fxDuration=this.fx.alpha=0}};Phaser.Camera.prototype.constructor=Phaser.Camera;Object.defineProperty(Phaser.Camera.prototype,"x",{get:function(){return this.view.x},set:function(a){this.view.x=a;this.bounds&&this.checkBounds()}});Object.defineProperty(Phaser.Camera.prototype,"y",{get:function(){return this.view.y},set:function(a){this.view.y=a;this.bounds&&this.checkBounds()}});
Object.defineProperty(Phaser.Camera.prototype,"position",{get:function(){this._position.set(this.view.x,this.view.y);return this._position},set:function(a){"undefined"!==typeof a.x&&(this.view.x=a.x);"undefined"!==typeof a.y&&(this.view.y=a.y);this.bounds&&this.checkBounds()}});Object.defineProperty(Phaser.Camera.prototype,"width",{get:function(){return this.view.width},set:function(a){this.view.width=a}});
Object.defineProperty(Phaser.Camera.prototype,"height",{get:function(){return this.view.height},set:function(a){this.view.height=a}});Object.defineProperty(Phaser.Camera.prototype,"shakeIntensity",{get:function(){return this._shake.intensity},set:function(a){this._shake.intensity=a}});
Phaser.State=function(){this.game=null;this.key="";this.rnd=this.physics=this.particles=this.world=this.tweens=this.time=this.state=this.stage=this.scale=this.sound=this.math=this.load=this.input=this.cache=this.camera=this.make=this.add=null};
Phaser.State.prototype={init:function(){},preload:function(){},loadUpdate:function(){},loadRender:function(){},create:function(){},update:function(){},preRender:function(){},render:function(){},resize:function(){},paused:function(){},resumed:function(){},pauseUpdate:function(){},shutdown:function(){}};Phaser.State.prototype.constructor=Phaser.State;
Phaser.StateManager=function(a,b){this.game=a;this.states={};this._pendingState=null;"undefined"!==typeof b&&null!==b&&(this._pendingState=b);this._created=this._clearCache=this._clearWorld=!1;this._args=[];this.current="";this.onStateChange=new Phaser.Signal;this.onShutDownCallback=this.onPauseUpdateCallback=this.onResumedCallback=this.onPausedCallback=this.onLoadRenderCallback=this.onLoadUpdateCallback=this.onPreRenderCallback=this.onResizeCallback=this.onRenderCallback=this.onUpdateCallback=this.onCreateCallback=
this.onPreloadCallback=this.onInitCallback=null};
Phaser.StateManager.prototype={boot:function(){this.game.onPause.add(this.pause,this);this.game.onResume.add(this.resume,this);null!==this._pendingState&&"string"!==typeof this._pendingState&&this.add("default",this._pendingState,!0)},add:function(a,b,c){void 0===c&&(c=!1);var d;b instanceof Phaser.State?d=b:"object"===typeof b?(d=b,d.game=this.game):"function"===typeof b&&(d=new b(this.game));this.states[a]=d;c&&(this.game.isBooted?this.start(a):this._pendingState=a);return d},remove:function(a){this.current===
a&&(this.onPauseUpdateCallback=this.onResumedCallback=this.onPausedCallback=this.onResizeCallback=this.onRenderCallback=this.onPreRenderCallback=this.onUpdateCallback=this.onCreateCallback=this.onLoadUpdateCallback=this.onLoadRenderCallback=this.onPreloadCallback=this.onShutDownCallback=this.onInitCallback=this.callbackContext=null);delete this.states[a]},start:function(a,b,c){void 0===b&&(b=!0);void 0===c&&(c=!1);this.checkState(a)&&(this._pendingState=a,this._clearWorld=b,this._clearCache=c,3<arguments.length&&
(this._args=Array.prototype.splice.call(arguments,3)))},restart:function(a,b){void 0===a&&(a=!0);void 0===b&&(b=!1);this._pendingState=this.current;this._clearWorld=a;this._clearCache=b;2<arguments.length&&(this._args=Array.prototype.slice.call(arguments,2))},dummy:function(){},preUpdate:function(){if(this._pendingState&&this.game.isBooted){var a=this.current;this.clearCurrentState();this.setCurrentState(this._pendingState);this.onStateChange.dispatch(this.current,a);this.current===this._pendingState&&
(this._pendingState=null,this.onPreloadCallback?(this.game.load.reset(!0),this.onPreloadCallback.call(this.callbackContext,this.game),0===this.game.load.totalQueuedFiles()&&0===this.game.load.totalQueuedPacks()?this.loadComplete():this.game.load.start()):this.loadComplete())}},clearCurrentState:function(){this.current&&(this.onShutDownCallback&&this.onShutDownCallback.call(this.callbackContext,this.game),this.game.tweens.removeAll(),this.game.camera.reset(),this.game.input.reset(!0),this.game.physics.clear(),
this.game.time.removeAll(),this.game.scale.reset(this._clearWorld),this.game.debug&&this.game.debug.reset(),this._clearWorld&&(this.game.world.shutdown(),this._clearCache&&this.game.cache.destroy()))},checkState:function(a){if(this.states[a]){if(this.states[a].preload||this.states[a].create||this.states[a].update||this.states[a].render)return!0;console.warn("Invalid Phaser State object given. Must contain at least a one of the required functions: preload, create, update or render");return!1}console.warn("Phaser.StateManager - No state found with the key: "+
a);return!1},link:function(a){this.states[a].game=this.game;this.states[a].add=this.game.add;this.states[a].make=this.game.make;this.states[a].camera=this.game.camera;this.states[a].cache=this.game.cache;this.states[a].input=this.game.input;this.states[a].load=this.game.load;this.states[a].math=this.game.math;this.states[a].sound=this.game.sound;this.states[a].scale=this.game.scale;this.states[a].state=this;this.states[a].stage=this.game.stage;this.states[a].time=this.game.time;this.states[a].tweens=
this.game.tweens;this.states[a].world=this.game.world;this.states[a].particles=this.game.particles;this.states[a].rnd=this.game.rnd;this.states[a].physics=this.game.physics;this.states[a].key=a},unlink:function(a){this.states[a]&&(this.states[a].game=null,this.states[a].add=null,this.states[a].make=null,this.states[a].camera=null,this.states[a].cache=null,this.states[a].input=null,this.states[a].load=null,this.states[a].math=null,this.states[a].sound=null,this.states[a].scale=null,this.states[a].state=
null,this.states[a].stage=null,this.states[a].time=null,this.states[a].tweens=null,this.states[a].world=null,this.states[a].particles=null,this.states[a].rnd=null,this.states[a].physics=null)},setCurrentState:function(a){this.callbackContext=this.states[a];this.link(a);this.onInitCallback=this.states[a].init||this.dummy;this.onPreloadCallback=this.states[a].preload||null;this.onLoadRenderCallback=this.states[a].loadRender||null;this.onLoadUpdateCallback=this.states[a].loadUpdate||null;this.onCreateCallback=
this.states[a].create||null;this.onUpdateCallback=this.states[a].update||null;this.onPreRenderCallback=this.states[a].preRender||null;this.onRenderCallback=this.states[a].render||null;this.onResizeCallback=this.states[a].resize||null;this.onPausedCallback=this.states[a].paused||null;this.onResumedCallback=this.states[a].resumed||null;this.onPauseUpdateCallback=this.states[a].pauseUpdate||null;this.onShutDownCallback=this.states[a].shutdown||this.dummy;""!==this.current&&this.game.physics.reset();
this.current=a;this._created=!1;this.onInitCallback.apply(this.callbackContext,this._args);a===this._pendingState&&(this._args=[]);this.game._kickstart=!0},getCurrentState:function(){return this.states[this.current]},loadComplete:function(){!1===this._created&&this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game);!1===this._created&&this.onCreateCallback?(this._created=!0,this.onCreateCallback.call(this.callbackContext,this.game)):this._created=!0},pause:function(){this._created&&
this.onPausedCallback&&this.onPausedCallback.call(this.callbackContext,this.game)},resume:function(){this._created&&this.onResumedCallback&&this.onResumedCallback.call(this.callbackContext,this.game)},update:function(){this._created?this.onUpdateCallback&&this.onUpdateCallback.call(this.callbackContext,this.game):this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game)},pauseUpdate:function(){this._created?this.onPauseUpdateCallback&&this.onPauseUpdateCallback.call(this.callbackContext,
this.game):this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game)},preRender:function(a){this._created&&this.onPreRenderCallback&&this.onPreRenderCallback.call(this.callbackContext,this.game,a)},resize:function(a,b){this.onResizeCallback&&this.onResizeCallback.call(this.callbackContext,a,b)},render:function(){this._created?this.onRenderCallback&&(this.game.renderType===Phaser.CANVAS?(this.game.context.save(),this.game.context.setTransform(1,0,0,1,0,0),this.onRenderCallback.call(this.callbackContext,
this.game),this.game.context.restore()):this.onRenderCallback.call(this.callbackContext,this.game)):this.onLoadRenderCallback&&this.onLoadRenderCallback.call(this.callbackContext,this.game)},destroy:function(){this._clearCache=this._clearWorld=!0;this.clearCurrentState();this.game=this.onPauseUpdateCallback=this.onResumedCallback=this.onPausedCallback=this.onRenderCallback=this.onUpdateCallback=this.onCreateCallback=this.onLoadUpdateCallback=this.onLoadRenderCallback=this.onPreloadCallback=this.onShutDownCallback=
this.onInitCallback=this.callbackContext=null;this.states={};this._pendingState=null;this.current=""}};Phaser.StateManager.prototype.constructor=Phaser.StateManager;Object.defineProperty(Phaser.StateManager.prototype,"created",{get:function(){return this._created}});Phaser.Signal=function(){};
Phaser.Signal.prototype={_bindings:null,_prevParams:null,memorize:!1,_shouldPropagate:!0,active:!0,_boundDispatch:!1,validateListener:function(a,b){if("function"!==typeof a)throw Error("Phaser.Signal: listener is a required param of {fn}() and should be a Function.".replace("{fn}",b));},_registerListener:function(a,b,c,d,e){var f=this._indexOfListener(a,c);if(-1!==f){if(a=this._bindings[f],a.isOnce()!==b)throw Error("You cannot add"+(b?"":"Once")+"() then add"+(b?"Once":"")+"() the same listener without removing the relationship first.");
}else a=new Phaser.SignalBinding(this,a,b,c,d,e),this._addBinding(a);this.memorize&&this._prevParams&&a.execute(this._prevParams);return a},_addBinding:function(a){this._bindings||(this._bindings=[]);var b=this._bindings.length;do b--;while(this._bindings[b]&&a._priority<=this._bindings[b]._priority);this._bindings.splice(b+1,0,a)},_indexOfListener:function(a,b){if(!this._bindings)return-1;void 0===b&&(b=null);for(var c=this._bindings.length,d;c--;)if(d=this._bindings[c],d._listener===a&&d.context===
b)return c;return-1},has:function(a,b){return-1!==this._indexOfListener(a,b)},add:function(a,b,c){this.validateListener(a,"add");var d=[];if(3<arguments.length)for(var e=3;e<arguments.length;e++)d.push(arguments[e]);return this._registerListener(a,!1,b,c,d)},addOnce:function(a,b,c){this.validateListener(a,"addOnce");var d=[];if(3<arguments.length)for(var e=3;e<arguments.length;e++)d.push(arguments[e]);return this._registerListener(a,!0,b,c,d)},remove:function(a,b){this.validateListener(a,"remove");
var c=this._indexOfListener(a,b);-1!==c&&(this._bindings[c]._destroy(),this._bindings.splice(c,1));return a},removeAll:function(a){void 0===a&&(a=null);if(this._bindings){for(var b=this._bindings.length;b--;)a?this._bindings[b].context===a&&(this._bindings[b]._destroy(),this._bindings.splice(b,1)):this._bindings[b]._destroy();a||(this._bindings.length=0)}},getNumListeners:function(){return this._bindings?this._bindings.length:0},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active&&
this._bindings){var a=Array.prototype.slice.call(arguments),b=this._bindings.length,c;this.memorize&&(this._prevParams=a);if(b){c=this._bindings.slice();this._shouldPropagate=!0;do b--;while(c[b]&&this._shouldPropagate&&!1!==c[b].execute(a))}}},forget:function(){this._prevParams&&(this._prevParams=null)},dispose:function(){this.removeAll();this._bindings=null;this._prevParams&&(this._prevParams=null)},toString:function(){return"[Phaser.Signal active:"+this.active+" numListeners:"+this.getNumListeners()+
"]"}};Object.defineProperty(Phaser.Signal.prototype,"boundDispatch",{get:function(){var a=this;return this._boundDispatch||(this._boundDispatch=function(){return a.dispatch.apply(a,arguments)})}});Phaser.Signal.prototype.constructor=Phaser.Signal;Phaser.SignalBinding=function(a,b,c,d,e,f){this._listener=b;c&&(this._isOnce=!0);null!=d&&(this.context=d);this._signal=a;e&&(this._priority=e);f&&f.length&&(this._args=f)};
Phaser.SignalBinding.prototype={context:null,_isOnce:!1,_priority:0,_args:null,callCount:0,active:!0,params:null,execute:function(a){var b;this.active&&this._listener&&(a=this.params?this.params.concat(a):a,this._args&&(a=a.concat(this._args)),b=this._listener.apply(this.context,a),this.callCount++,this._isOnce&&this.detach());return b},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},
getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal;delete this._listener;delete this.context},toString:function(){return"[Phaser.SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}};Phaser.SignalBinding.prototype.constructor=Phaser.SignalBinding;
Phaser.Filter=function(a,b,c){this.game=a;this.type=Phaser.WEBGL_FILTER;this.passes=[this];this.shaders=[];this.dirty=!0;this.padding=0;this.prevPoint=new Phaser.Point;a=new Date;this.uniforms={resolution:{type:"2f",value:{x:256,y:256}},time:{type:"1f",value:0},mouse:{type:"2f",value:{x:0,y:0}},date:{type:"4fv",value:[a.getFullYear(),a.getMonth(),a.getDate(),3600*a.getHours()+60*a.getMinutes()+a.getSeconds()]},sampleRate:{type:"1f",value:44100},iChannel0:{type:"sampler2D",value:null,textureData:{repeat:!0}},
iChannel1:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel2:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel3:{type:"sampler2D",value:null,textureData:{repeat:!0}}};if(b)for(var d in b)this.uniforms[d]=b[d];this.fragmentSrc=c||""};
Phaser.Filter.prototype={init:function(){},setResolution:function(a,b){this.uniforms.resolution.value.x=a;this.uniforms.resolution.value.y=b},update:function(a){if("undefined"!==typeof a){var b=a.x/this.game.width;a=1-a.y/this.game.height;if(b!==this.prevPoint.x||a!==this.prevPoint.y)this.uniforms.mouse.value.x=b.toFixed(2),this.uniforms.mouse.value.y=a.toFixed(2),this.prevPoint.set(b,a)}this.uniforms.time.value=this.game.time.totalElapsedSeconds()},addToWorld:function(a,b,c,d,e,f){void 0===e&&(e=
0);void 0===f&&(f=0);void 0!==c&&null!==c?this.width=c:c=this.width;void 0!==d&&null!==d?this.height=d:d=this.height;a=this.game.add.image(a,b,"__default");a.width=c;a.height=d;a.anchor.set(e,f);a.filters=[this];return a},destroy:function(){this.game=null}};Phaser.Filter.prototype.constructor=Phaser.Filter;Object.defineProperty(Phaser.Filter.prototype,"width",{get:function(){return this.uniforms.resolution.value.x},set:function(a){this.uniforms.resolution.value.x=a}});
Object.defineProperty(Phaser.Filter.prototype,"height",{get:function(){return this.uniforms.resolution.value.y},set:function(a){this.uniforms.resolution.value.y=a}});Phaser.Plugin=function(a,b){void 0===b&&(b=null);this.game=a;this.parent=b;this.hasPostRender=this.hasRender=this.hasPostUpdate=this.hasUpdate=this.hasPreUpdate=this.visible=this.active=!1};
Phaser.Plugin.prototype={preUpdate:function(){},update:function(){},render:function(){},postRender:function(){},destroy:function(){this.parent=this.game=null;this.visible=this.active=!1}};Phaser.Plugin.prototype.constructor=Phaser.Plugin;Phaser.PluginManager=function(a){this.game=a;this.plugins=[];this._i=this._len=0};
Phaser.PluginManager.prototype={add:function(a){var b=Array.prototype.slice.call(arguments,1),c=!1;"function"===typeof a?a=new a(this.game,this):(a.game=this.game,a.parent=this);"function"===typeof a.preUpdate&&(c=a.hasPreUpdate=!0);"function"===typeof a.update&&(c=a.hasUpdate=!0);"function"===typeof a.postUpdate&&(c=a.hasPostUpdate=!0);"function"===typeof a.render&&(c=a.hasRender=!0);"function"===typeof a.postRender&&(c=a.hasPostRender=!0);if(c){if(a.hasPreUpdate||a.hasUpdate||a.hasPostUpdate)a.active=
!0;if(a.hasRender||a.hasPostRender)a.visible=!0;this._len=this.plugins.push(a);"function"===typeof a.init&&a.init.apply(a,b);return a}return null},remove:function(a,b){void 0===b&&(b=!0);for(this._i=this._len;this._i--;)if(this.plugins[this._i]===a){b&&a.destroy();this.plugins.splice(this._i,1);this._len--;break}},removeAll:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].destroy();this._len=this.plugins.length=0},preUpdate:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&
this.plugins[this._i].hasPreUpdate&&this.plugins[this._i].preUpdate()},update:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasUpdate&&this.plugins[this._i].update()},postUpdate:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasPostUpdate&&this.plugins[this._i].postUpdate()},render:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].visible&&this.plugins[this._i].hasRender&&this.plugins[this._i].render()},
postRender:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].visible&&this.plugins[this._i].hasPostRender&&this.plugins[this._i].postRender()},destroy:function(){this.removeAll();this.game=null}};Phaser.PluginManager.prototype.constructor=Phaser.PluginManager;
Phaser.Stage=function(a){this.game=a;PIXI.DisplayObjectContainer.call(this);this.name="_stage_root";this.disableVisibilityChange=!1;this.exists=!0;this.worldTransform=new PIXI.Matrix;this.stage=this;this.currentRenderOrderID=0;this._hiddenVar="hidden";this._onChange=null;this._bgColor={r:0,g:0,b:0,a:0,color:0,rgba:"#000000"};this.game.transparent||(this._bgColor.a=1);a.config&&this.parseConfig(a.config)};Phaser.Stage.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);
Phaser.Stage.prototype.constructor=Phaser.Stage;Phaser.Stage.prototype.parseConfig=function(a){a.disableVisibilityChange&&(this.disableVisibilityChange=a.disableVisibilityChange);a.backgroundColor&&this.setBackgroundColor(a.backgroundColor)};Phaser.Stage.prototype.boot=function(){Phaser.DOM.getOffset(this.game.canvas,this.offset);Phaser.Canvas.setUserSelect(this.game.canvas,"none");Phaser.Canvas.setTouchAction(this.game.canvas,"none");this.checkVisibility()};
Phaser.Stage.prototype.preUpdate=function(){for(var a=this.currentRenderOrderID=0;a<this.children.length;a++)this.children[a].preUpdate()};Phaser.Stage.prototype.update=function(){for(var a=this.children.length;a--;)this.children[a].update()};
Phaser.Stage.prototype.postUpdate=function(){this.game.camera.update();this.game.camera.target&&(this.game.camera.target.postUpdate(),this.updateTransform(),this.game.camera.updateTarget());for(var a=0;a<this.children.length;a++)this.children[a].postUpdate();this.updateTransform()};Phaser.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var a=0;a<this.children.length;a++)this.children[a].updateTransform()};
Phaser.Stage.prototype.checkVisibility=function(){this._hiddenVar=void 0!==document.hidden?"visibilitychange":void 0!==document.webkitHidden?"webkitvisibilitychange":void 0!==document.mozHidden?"mozvisibilitychange":void 0!==document.msHidden?"msvisibilitychange":null;var a=this;this._onChange=function(b){return a.visibilityChange(b)};this._hiddenVar&&document.addEventListener(this._hiddenVar,this._onChange,!1);window.onblur=this._onChange;window.onfocus=this._onChange;window.onpagehide=this._onChange;
window.onpageshow=this._onChange;this.game.device.cocoonJSApp&&(CocoonJS.App.onSuspended.addEventListener(function(){Phaser.Stage.prototype.visibilityChange.call(a,{type:"pause"})}),CocoonJS.App.onActivated.addEventListener(function(){Phaser.Stage.prototype.visibilityChange.call(a,{type:"resume"})}))};
Phaser.Stage.prototype.visibilityChange=function(a){"pagehide"===a.type||"blur"===a.type||"pageshow"===a.type||"focus"===a.type?"pagehide"===a.type||"blur"===a.type?this.game.focusLoss(a):"pageshow"!==a.type&&"focus"!==a.type||this.game.focusGain(a):this.disableVisibilityChange||(document.hidden||document.mozHidden||document.msHidden||document.webkitHidden||"pause"===a.type?this.game.gamePaused(a):this.game.gameResumed(a))};
Phaser.Stage.prototype.setBackgroundColor=function(a){this.game.transparent||(Phaser.Color.valueToColor(a,this._bgColor),Phaser.Color.updateColor(this._bgColor),this._bgColor.r/=255,this._bgColor.g/=255,this._bgColor.b/=255,this._bgColor.a=1)};Phaser.Stage.prototype.destroy=function(){this._hiddenVar&&document.removeEventListener(this._hiddenVar,this._onChange,!1);window.onpagehide=null;window.onpageshow=null;window.onblur=null;window.onfocus=null};
Object.defineProperty(Phaser.Stage.prototype,"backgroundColor",{get:function(){return this._bgColor.color},set:function(a){this.setBackgroundColor(a)}});Object.defineProperty(Phaser.Stage.prototype,"smoothed",{get:function(){return PIXI.scaleModes.DEFAULT===PIXI.scaleModes.LINEAR},set:function(a){PIXI.scaleModes.DEFAULT=a?PIXI.scaleModes.LINEAR:PIXI.scaleModes.NEAREST}});
Phaser.Group=function(a,b,c,d,e,f){void 0===d&&(d=!1);void 0===e&&(e=!1);void 0===f&&(f=Phaser.Physics.ARCADE);this.game=a;void 0===b&&(b=a.world);this.name=c||"group";this.z=0;PIXI.DisplayObjectContainer.call(this);d?(this.game.stage.addChild(this),this.z=this.game.stage.children.length):b&&(b.addChild(this),this.z=b.children.length);this.physicsType=this.type=Phaser.GROUP;this.exists=this.alive=!0;this.pendingDestroy=this.ignoreDestroy=!1;this.classType=Phaser.Sprite;this.cursor=null;this.inputEnableChildren=
!1;this.onChildInputDown=new Phaser.Signal;this.onChildInputUp=new Phaser.Signal;this.onChildInputOver=new Phaser.Signal;this.onChildInputOut=new Phaser.Signal;this.enableBody=e;this.enableBodyDebug=!1;this.physicsBodyType=f;this.physicsSortDirection=null;this.onDestroy=new Phaser.Signal;this.cursorIndex=0;this.fixedToCamera=!1;this.cameraOffset=new Phaser.Point;this.hash=[];this._sortProperty="z"};Phaser.Group.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);
Phaser.Group.prototype.constructor=Phaser.Group;Phaser.Group.RETURN_NONE=0;Phaser.Group.RETURN_TOTAL=1;Phaser.Group.RETURN_CHILD=2;Phaser.Group.RETURN_ALL=3;Phaser.Group.SORT_ASCENDING=-1;Phaser.Group.SORT_DESCENDING=1;
Phaser.Group.prototype.add=function(a,b,c){void 0===b&&(b=!1);if(a.parent===this)return a;a.body&&a.parent&&a.parent.hash&&a.parent.removeFromHash(a);void 0===c?(a.z=this.children.length,this.addChild(a)):(this.addChildAt(a,c),this.updateZ());this.enableBody&&a.hasOwnProperty("body")&&null===a.body?this.game.physics.enable(a,this.physicsBodyType):a.body&&this.addToHash(a);!this.inputEnableChildren||a.input&&!a.inputEnabled||(a.inputEnabled=!0);if(!b&&a.events)a.events.onAddedToGroup$dispatch(a,this);
null===this.cursor&&(this.cursor=a);return a};Phaser.Group.prototype.addAt=function(a,b,c){this.add(a,c,b)};Phaser.Group.prototype.addToHash=function(a){return a.parent===this&&-1===this.hash.indexOf(a)?(this.hash.push(a),!0):!1};Phaser.Group.prototype.removeFromHash=function(a){return a&&(a=this.hash.indexOf(a),-1!==a)?(this.hash.splice(a,1),!0):!1};
Phaser.Group.prototype.addMultiple=function(a,b){if(a instanceof Phaser.Group)a.moveAll(this,b);else if(Array.isArray(a))for(var c=0;c<a.length;c++)this.add(a[c],b);return a};Phaser.Group.prototype.getAt=function(a){return 0>a||a>=this.children.length?-1:this.getChildAt(a)};Phaser.Group.prototype.create=function(a,b,c,d,e,f){void 0===e&&(e=!0);a=new this.classType(this.game,a,b,c,d);a.exists=e;a.visible=e;a.alive=e;return this.add(a,!1,f)};
Phaser.Group.prototype.createMultiple=function(a,b,c,d){void 0===c&&(c=0);void 0===d&&(d=!1);Array.isArray(b)||(b=[b]);Array.isArray(c)||(c=[c]);var e=this,f=[];b.forEach(function(b){c.forEach(function(c){for(var k=0;k<a;k++)f.push(e.create(0,0,b,c,d))})});return f};Phaser.Group.prototype.updateZ=function(){for(var a=this.children.length;a--;)this.children[a].z=a};
Phaser.Group.prototype.align=function(a,b,c,d,e,f){void 0===e&&(e=Phaser.TOP_LEFT);void 0===f&&(f=0);if(0===this.children.length||f>this.children.length||-1===a&&-1===b)return!1;for(var g=new Phaser.Rectangle(0,0,c,d),h=a*c,k=b*d;f<this.children.length;f++){var l=this.children[f];if(l.alignIn)if(l.alignIn(g,e),-1===a)g.y+=d,g.y===k&&(g.x+=c,g.y=0);else if(-1===b)g.x+=c,g.x===h&&(g.x=0,g.y+=d);else if(g.x+=c,g.x===h&&(g.x=0,g.y+=d,g.y===k))break}return!0};
Phaser.Group.prototype.resetCursor=function(a){void 0===a&&(a=0);a>this.children.length-1&&(a=0);if(this.cursor)return this.cursorIndex=a,this.cursor=this.children[this.cursorIndex]};Phaser.Group.prototype.next=function(){if(this.cursor)return this.cursorIndex>=this.children.length-1?this.cursorIndex=0:this.cursorIndex++,this.cursor=this.children[this.cursorIndex]};
Phaser.Group.prototype.previous=function(){if(this.cursor)return 0===this.cursorIndex?this.cursorIndex=this.children.length-1:this.cursorIndex--,this.cursor=this.children[this.cursorIndex]};Phaser.Group.prototype.swap=function(a,b){this.swapChildren(a,b);this.updateZ()};Phaser.Group.prototype.bringToTop=function(a){a.parent===this&&this.getIndex(a)<this.children.length&&(this.remove(a,!1,!0),this.add(a,!0));return a};
Phaser.Group.prototype.sendToBack=function(a){a.parent===this&&0<this.getIndex(a)&&(this.remove(a,!1,!0),this.addAt(a,0,!0));return a};Phaser.Group.prototype.moveUp=function(a){if(a.parent===this&&this.getIndex(a)<this.children.length-1){var b=this.getIndex(a);(b=this.getAt(b+1))&&this.swap(a,b)}return a};Phaser.Group.prototype.moveDown=function(a){if(a.parent===this&&0<this.getIndex(a)){var b=this.getIndex(a);(b=this.getAt(b-1))&&this.swap(a,b)}return a};
Phaser.Group.prototype.xy=function(a,b,c){if(0>a||a>this.children.length)return-1;this.getChildAt(a).x=b;this.getChildAt(a).y=c};Phaser.Group.prototype.reverse=function(){this.children.reverse();this.updateZ()};Phaser.Group.prototype.getIndex=function(a){return this.children.indexOf(a)};Phaser.Group.prototype.getByName=function(a){for(var b=0;b<this.children.length;b++)if(this.children[b].name===a)return this.children[b];return null};
Phaser.Group.prototype.replace=function(a,b){var c=this.getIndex(a);if(-1!==c)return b.parent&&(b.parent instanceof Phaser.Group?b.parent.remove(b):b.parent.removeChild(b)),this.remove(a),this.addAt(b,c),a};Phaser.Group.prototype.hasProperty=function(a,b){var c=b.length;return 1===c&&b[0]in a||2===c&&b[0]in a&&b[1]in a[b[0]]||3===c&&b[0]in a&&b[1]in a[b[0]]&&b[2]in a[b[0]][b[1]]||4===c&&b[0]in a&&b[1]in a[b[0]]&&b[2]in a[b[0]][b[1]]&&b[3]in a[b[0]][b[1]][b[2]]?!0:!1};
Phaser.Group.prototype.setProperty=function(a,b,c,d,e){void 0===e&&(e=!1);d=d||0;if(!this.hasProperty(a,b)&&(!e||0<d))return!1;e=b.length;1===e?0===d?a[b[0]]=c:1===d?a[b[0]]+=c:2===d?a[b[0]]-=c:3===d?a[b[0]]*=c:4===d&&(a[b[0]]/=c):2===e?0===d?a[b[0]][b[1]]=c:1===d?a[b[0]][b[1]]+=c:2===d?a[b[0]][b[1]]-=c:3===d?a[b[0]][b[1]]*=c:4===d&&(a[b[0]][b[1]]/=c):3===e?0===d?a[b[0]][b[1]][b[2]]=c:1===d?a[b[0]][b[1]][b[2]]+=c:2===d?a[b[0]][b[1]][b[2]]-=c:3===d?a[b[0]][b[1]][b[2]]*=c:4===d&&(a[b[0]][b[1]][b[2]]/=
c):4===e&&(0===d?a[b[0]][b[1]][b[2]][b[3]]=c:1===d?a[b[0]][b[1]][b[2]][b[3]]+=c:2===d?a[b[0]][b[1]][b[2]][b[3]]-=c:3===d?a[b[0]][b[1]][b[2]][b[3]]*=c:4===d&&(a[b[0]][b[1]][b[2]][b[3]]/=c));return!0};Phaser.Group.prototype.checkProperty=function(a,b,c,d){void 0===d&&(d=!1);return!Phaser.Utils.getProperty(a,b)&&d||Phaser.Utils.getProperty(a,b)!==c?!1:!0};
Phaser.Group.prototype.set=function(a,b,c,d,e,f,g){void 0===g&&(g=!1);b=b.split(".");void 0===d&&(d=!1);void 0===e&&(e=!1);if((!1===d||d&&a.alive)&&(!1===e||e&&a.visible))return this.setProperty(a,b,c,f,g)};Phaser.Group.prototype.setAll=function(a,b,c,d,e,f){void 0===c&&(c=!1);void 0===d&&(d=!1);void 0===f&&(f=!1);a=a.split(".");e=e||0;for(var g=0;g<this.children.length;g++)(!c||c&&this.children[g].alive)&&(!d||d&&this.children[g].visible)&&this.setProperty(this.children[g],a,b,e,f)};
Phaser.Group.prototype.setAllChildren=function(a,b,c,d,e,f){void 0===c&&(c=!1);void 0===d&&(d=!1);void 0===f&&(f=!1);e=e||0;for(var g=0;g<this.children.length;g++)(!c||c&&this.children[g].alive)&&(!d||d&&this.children[g].visible)&&(this.children[g]instanceof Phaser.Group?this.children[g].setAllChildren(a,b,c,d,e,f):this.setProperty(this.children[g],a.split("."),b,e,f))};
Phaser.Group.prototype.checkAll=function(a,b,c,d,e){void 0===c&&(c=!1);void 0===d&&(d=!1);void 0===e&&(e=!1);for(var f=0;f<this.children.length;f++)if((!c||c&&this.children[f].alive)&&(!d||d&&this.children[f].visible)&&!this.checkProperty(this.children[f],a,b,e))return!1;return!0};Phaser.Group.prototype.addAll=function(a,b,c,d){this.setAll(a,b,c,d,1)};Phaser.Group.prototype.subAll=function(a,b,c,d){this.setAll(a,b,c,d,2)};Phaser.Group.prototype.multiplyAll=function(a,b,c,d){this.setAll(a,b,c,d,3)};
Phaser.Group.prototype.divideAll=function(a,b,c,d){this.setAll(a,b,c,d,4)};Phaser.Group.prototype.callAllExists=function(a,b){var c;if(2<arguments.length){c=[];for(var d=2;d<arguments.length;d++)c.push(arguments[d])}for(d=0;d<this.children.length;d++)this.children[d].exists===b&&this.children[d][a]&&this.children[d][a].apply(this.children[d],c)};
Phaser.Group.prototype.callbackFromArray=function(a,b,c){if(1===c){if(a[b[0]])return a[b[0]]}else if(2===c){if(a[b[0]][b[1]])return a[b[0]][b[1]]}else if(3===c){if(a[b[0]][b[1]][b[2]])return a[b[0]][b[1]][b[2]]}else if(4===c){if(a[b[0]][b[1]][b[2]][b[3]])return a[b[0]][b[1]][b[2]][b[3]]}else if(a[b])return a[b];return!1};
Phaser.Group.prototype.callAll=function(a,b){if(void 0!==a){a=a.split(".");var c=a.length;if(void 0===b||null===b||""===b)b=null;else if("string"===typeof b){b=b.split(".");var d=b.length}var e;if(2<arguments.length){e=[];for(var f=2;f<arguments.length;f++)e.push(arguments[f])}for(var g=null,h=null,f=0;f<this.children.length;f++)g=this.callbackFromArray(this.children[f],a,c),b&&g?(h=this.callbackFromArray(this.children[f],b,d),g&&g.apply(h,e)):g&&g.apply(this.children[f],e)}};
Phaser.Group.prototype.preUpdate=function(){if(this.pendingDestroy)return this.destroy(),!1;if(!this.exists||!this.parent.exists)return this.renderOrderID=-1,!1;for(var a=0;a<this.children.length;a++)this.children[a].preUpdate();return!0};Phaser.Group.prototype.update=function(){for(var a=this.children.length;a--;)this.children[a].update()};
Phaser.Group.prototype.postUpdate=function(){this.fixedToCamera&&(this.x=this.game.camera.view.x+this.cameraOffset.x,this.y=this.game.camera.view.y+this.cameraOffset.y);for(var a=0;a<this.children.length;a++)this.children[a].postUpdate()};Phaser.Group.prototype.filter=function(a,b){for(var c=-1,d=this.children.length,e=[];++c<d;){var f=this.children[c];(!b||b&&f.exists)&&a(f,c,this.children)&&e.push(f)}return new Phaser.ArraySet(e)};
Phaser.Group.prototype.forEach=function(a,b,c){void 0===c&&(c=!1);if(3>=arguments.length)for(var d=0;d<this.children.length;d++)(!c||c&&this.children[d].exists)&&a.call(b,this.children[d]);else{for(var e=[null],d=3;d<arguments.length;d++)e.push(arguments[d]);for(d=0;d<this.children.length;d++)if(!c||c&&this.children[d].exists)e[0]=this.children[d],a.apply(b,e)}};
Phaser.Group.prototype.forEachExists=function(a,b){var c;if(2<arguments.length){c=[null];for(var d=2;d<arguments.length;d++)c.push(arguments[d])}this.iterate("exists",!0,Phaser.Group.RETURN_TOTAL,a,b,c)};Phaser.Group.prototype.forEachAlive=function(a,b){var c;if(2<arguments.length){c=[null];for(var d=2;d<arguments.length;d++)c.push(arguments[d])}this.iterate("alive",!0,Phaser.Group.RETURN_TOTAL,a,b,c)};
Phaser.Group.prototype.forEachDead=function(a,b){var c;if(2<arguments.length){c=[null];for(var d=2;d<arguments.length;d++)c.push(arguments[d])}this.iterate("alive",!1,Phaser.Group.RETURN_TOTAL,a,b,c)};Phaser.Group.prototype.sort=function(a,b){2>this.children.length||(void 0===a&&(a="z"),void 0===b&&(b=Phaser.Group.SORT_ASCENDING),this._sortProperty=a,b===Phaser.Group.SORT_ASCENDING?this.children.sort(this.ascendingSortHandler.bind(this)):this.children.sort(this.descendingSortHandler.bind(this)),this.updateZ())};
Phaser.Group.prototype.customSort=function(a,b){2>this.children.length||(this.children.sort(a.bind(b)),this.updateZ())};Phaser.Group.prototype.ascendingSortHandler=function(a,b){return a[this._sortProperty]<b[this._sortProperty]?-1:a[this._sortProperty]>b[this._sortProperty]?1:a.z<b.z?-1:1};Phaser.Group.prototype.descendingSortHandler=function(a,b){return a[this._sortProperty]<b[this._sortProperty]?1:a[this._sortProperty]>b[this._sortProperty]?-1:0};
Phaser.Group.prototype.iterate=function(a,b,c,d,e,f){if(0===this.children.length){if(c===Phaser.Group.RETURN_TOTAL)return 0;if(c===Phaser.Group.RETURN_ALL)return[]}var g=0;if(c===Phaser.Group.RETURN_ALL)var h=[];for(var k=0;k<this.children.length;k++)if(this.children[k][a]===b){g++;d&&(f?(f[0]=this.children[k],d.apply(e,f)):d.call(e,this.children[k]));if(c===Phaser.Group.RETURN_CHILD)return this.children[k];c===Phaser.Group.RETURN_ALL&&h.push(this.children[k])}return c===Phaser.Group.RETURN_TOTAL?
g:c===Phaser.Group.RETURN_ALL?h:null};Phaser.Group.prototype.getFirstExists=function(a,b,c,d,e,f){void 0===b&&(b=!1);"boolean"!==typeof a&&(a=!0);a=this.iterate("exists",a,Phaser.Group.RETURN_CHILD);return null===a&&b?this.create(c,d,e,f):this.resetChild(a,c,d,e,f)};Phaser.Group.prototype.getFirstAlive=function(a,b,c,d,e){void 0===a&&(a=!1);var f=this.iterate("alive",!0,Phaser.Group.RETURN_CHILD);return null===f&&a?this.create(b,c,d,e):this.resetChild(f,b,c,d,e)};
Phaser.Group.prototype.getFirstDead=function(a,b,c,d,e){void 0===a&&(a=!1);var f=this.iterate("alive",!1,Phaser.Group.RETURN_CHILD);return null===f&&a?this.create(b,c,d,e):this.resetChild(f,b,c,d,e)};Phaser.Group.prototype.resetChild=function(a,b,c,d,e){if(null===a)return null;void 0===b&&(b=null);void 0===c&&(c=null);null!==b&&null!==c&&a.reset(b,c);void 0!==d&&a.loadTexture(d,e);return a};
Phaser.Group.prototype.getTop=function(){if(0<this.children.length)return this.children[this.children.length-1]};Phaser.Group.prototype.getBottom=function(){if(0<this.children.length)return this.children[0]};Phaser.Group.prototype.getClosestTo=function(a,b,c){for(var d=Number.MAX_VALUE,e=0,f=null,g=0;g<this.children.length;g++){var h=this.children[g];h.exists&&(e=Math.abs(Phaser.Point.distance(a,h)),e<d&&(!b||b.call(c,h,e))&&(d=e,f=h))}return f};
Phaser.Group.prototype.getFurthestFrom=function(a,b,c){for(var d=0,e=0,f=null,g=0;g<this.children.length;g++){var h=this.children[g];h.exists&&(e=Math.abs(Phaser.Point.distance(a,h)),e>d&&(!b||b.call(c,h,e))&&(d=e,f=h))}return f};Phaser.Group.prototype.countLiving=function(){return this.iterate("alive",!0,Phaser.Group.RETURN_TOTAL)};Phaser.Group.prototype.countDead=function(){return this.iterate("alive",!1,Phaser.Group.RETURN_TOTAL)};
Phaser.Group.prototype.getRandom=function(a,b){void 0===a&&(a=0);void 0===b&&(b=this.children.length);return 0===b?null:Phaser.ArrayUtils.getRandomItem(this.children,a,b)};Phaser.Group.prototype.getRandomExists=function(a,b){var c=this.getAll("exists",!0,a,b);return this.game.rnd.pick(c)};Phaser.Group.prototype.getAll=function(a,b,c,d){void 0===c&&(c=0);void 0===d&&(d=this.children.length);for(var e=[];c<d;c++){var f=this.children[c];a&&f[a]===b&&e.push(f)}return e};
Phaser.Group.prototype.remove=function(a,b,c){void 0===b&&(b=!1);void 0===c&&(c=!1);if(0===this.children.length||-1===this.children.indexOf(a))return!1;if(!c&&a.events&&!a.destroyPhase)a.events.onRemovedFromGroup$dispatch(a,this);c=this.removeChild(a);this.removeFromHash(a);this.updateZ();this.cursor===a&&this.next();b&&c&&c.destroy(!0);return!0};
Phaser.Group.prototype.moveAll=function(a,b){void 0===b&&(b=!1);if(0<this.children.length&&a instanceof Phaser.Group){do a.add(this.children[0],b);while(0<this.children.length);this.hash=[];this.cursor=null}return a};
Phaser.Group.prototype.removeAll=function(a,b,c){void 0===a&&(a=!1);void 0===b&&(b=!1);void 0===c&&(c=!1);if(0!==this.children.length){do{if(!b&&this.children[0].events)this.children[0].events.onRemovedFromGroup$dispatch(this.children[0],this);var d=this.removeChild(this.children[0]);this.removeFromHash(d);a&&d&&d.destroy(!0,c)}while(0<this.children.length);this.hash=[];this.cursor=null}};
Phaser.Group.prototype.removeBetween=function(a,b,c,d){void 0===b&&(b=this.children.length-1);void 0===c&&(c=!1);void 0===d&&(d=!1);if(0!==this.children.length){if(a>b||0>a||b>this.children.length)return!1;for(;b>=a;){if(!d&&this.children[b].events)this.children[b].events.onRemovedFromGroup$dispatch(this.children[b],this);var e=this.removeChild(this.children[b]);this.removeFromHash(e);c&&e&&e.destroy(!0);this.cursor===this.children[b]&&(this.cursor=null);b--}this.updateZ()}};
Phaser.Group.prototype.destroy=function(a,b){null===this.game||this.ignoreDestroy||(void 0===a&&(a=!0),void 0===b&&(b=!1),this.onDestroy.dispatch(this,a,b),this.removeAll(a),this.filters=this.cursor=null,this.pendingDestroy=!1,b||(this.parent&&this.parent.removeChild(this),this.game=null,this.exists=!1))};Object.defineProperty(Phaser.Group.prototype,"total",{get:function(){return this.iterate("exists",!0,Phaser.Group.RETURN_TOTAL)}});Object.defineProperty(Phaser.Group.prototype,"length",{get:function(){return this.children.length}});
Object.defineProperty(Phaser.Group.prototype,"angle",{get:function(){return Phaser.Math.radToDeg(this.rotation)},set:function(a){this.rotation=Phaser.Math.degToRad(a)}});Object.defineProperty(Phaser.Group.prototype,"centerX",{get:function(){return this.getBounds(this.parent).centerX},set:function(a){var b=this.getBounds(this.parent);this.x=a+(this.x-b.x)-b.halfWidth}});
Object.defineProperty(Phaser.Group.prototype,"centerY",{get:function(){return this.getBounds(this.parent).centerY},set:function(a){var b=this.getBounds(this.parent);this.y=a+(this.y-b.y)-b.halfHeight}});Object.defineProperty(Phaser.Group.prototype,"left",{get:function(){return this.getBounds(this.parent).left},set:function(a){var b=this.getBounds(this.parent);this.x=a+(this.x-b.x)}});
Object.defineProperty(Phaser.Group.prototype,"right",{get:function(){return this.getBounds(this.parent).right},set:function(a){var b=this.getBounds(this.parent);this.x=a+(this.x-b.x)-b.width}});Object.defineProperty(Phaser.Group.prototype,"top",{get:function(){return this.getBounds(this.parent).top},set:function(a){var b=this.getBounds(this.parent);this.y=a+(this.y-b.y)}});
Object.defineProperty(Phaser.Group.prototype,"bottom",{get:function(){return this.getBounds(this.parent).bottom},set:function(a){var b=this.getBounds(this.parent);this.y=a+(this.y-b.y)-b.height}});Phaser.World=function(a){Phaser.Group.call(this,a,null,"__world",!1);this.bounds=new Phaser.Rectangle(0,0,a.width,a.height);this.camera=null;this._definedSize=!1;this._width=a.width;this._height=a.height;this.game.state.onStateChange.add(this.stateChange,this)};Phaser.World.prototype=Object.create(Phaser.Group.prototype);
Phaser.World.prototype.constructor=Phaser.World;Phaser.World.prototype.boot=function(){this.camera=new Phaser.Camera(this.game,0,0,0,this.game.width,this.game.height);this.game.stage.addChild(this);this.camera.boot()};Phaser.World.prototype.stateChange=function(){this.y=this.x=0;this.camera.reset()};
Phaser.World.prototype.setBounds=function(a,b,c,d){this._definedSize=!0;this._width=c;this._height=d;this.bounds.setTo(a,b,c,d);this.x=a;this.y=b;this.camera.bounds&&this.camera.bounds.setTo(a,b,Math.max(c,this.game.width),Math.max(d,this.game.height));this.game.physics.setBoundsToWorld()};Phaser.World.prototype.resize=function(a,b){this._definedSize&&(a<this._width&&(a=this._width),b<this._height&&(b=this._height));this.bounds.width=a;this.bounds.height=b;this.game.camera.setBoundsToWorld();this.game.physics.setBoundsToWorld()};
Phaser.World.prototype.shutdown=function(){this.destroy(!0,!0)};
Phaser.World.prototype.wrap=function(a,b,c,d,e){void 0===b&&(b=0);void 0===c&&(c=!1);void 0===d&&(d=!0);void 0===e&&(e=!0);c?(a.getBounds(),d&&(a.x+a._currentBounds.width<this.bounds.x?a.x=this.bounds.right:a.x>this.bounds.right&&(a.x=this.bounds.left)),e&&(a.y+a._currentBounds.height<this.bounds.top?a.y=this.bounds.bottom:a.y>this.bounds.bottom&&(a.y=this.bounds.top))):(d&&a.x+b<this.bounds.x?a.x=this.bounds.right+b:d&&a.x-b>this.bounds.right&&(a.x=this.bounds.left-b),e&&a.y+b<this.bounds.top?a.y=
this.bounds.bottom+b:e&&a.y-b>this.bounds.bottom&&(a.y=this.bounds.top-b))};Object.defineProperty(Phaser.World.prototype,"width",{get:function(){return this.bounds.width},set:function(a){a<this.game.width&&(a=this.game.width);this._width=this.bounds.width=a;this._definedSize=!0}});Object.defineProperty(Phaser.World.prototype,"height",{get:function(){return this.bounds.height},set:function(a){a<this.game.height&&(a=this.game.height);this._height=this.bounds.height=a;this._definedSize=!0}});
Object.defineProperty(Phaser.World.prototype,"centerX",{get:function(){return this.bounds.halfWidth+this.bounds.x}});Object.defineProperty(Phaser.World.prototype,"centerY",{get:function(){return this.bounds.halfHeight+this.bounds.y}});Object.defineProperty(Phaser.World.prototype,"randomX",{get:function(){return 0>this.bounds.x?this.game.rnd.between(this.bounds.x,this.bounds.width-Math.abs(this.bounds.x)):this.game.rnd.between(this.bounds.x,this.bounds.width)}});
Object.defineProperty(Phaser.World.prototype,"randomY",{get:function(){return 0>this.bounds.y?this.game.rnd.between(this.bounds.y,this.bounds.height-Math.abs(this.bounds.y)):this.game.rnd.between(this.bounds.y,this.bounds.height)}});
Phaser.Game=function(a,b,c,d,e,f,g,h){this.id=Phaser.GAMES.push(this)-1;this.config=null;this.physicsConfig=h;this.parent="";this.width=800;this.height=600;this.resolution=1;this._width=800;this._height=600;this.transparent=!1;this.antialias=!0;this.preserveDrawingBuffer=!1;this.clearBeforeRender=!0;this.renderer=null;this.renderType=Phaser.AUTO;this.state=null;this.isRunning=this.isBooted=!1;this.rnd=this.plugins=this.physics=this.world=this.tweens=this.time=this.stage=this.sound=this.scale=this.net=
this.math=this.load=this.input=this.cache=this.make=this.add=this.raf=null;this.device=Phaser.Device;this.create=this.particles=this.debug=this.context=this.canvas=this.camera=null;this.pendingStep=this.stepping=this.lockRender=!1;this.stepCount=0;this.onFocus=this.onBlur=this.onResume=this.onPause=null;this._codePaused=this._paused=!1;this.currentUpdateID=0;this.updatesThisFrame=1;this._spiraling=this._lastCount=this._deltaTime=0;this._kickstart=!0;this.fpsProblemNotifier=new Phaser.Signal;this.forceSingleUpdate=
!0;this._nextFpsNotification=0;1===arguments.length&&"object"===typeof arguments[0]?this.parseConfig(arguments[0]):(this.config={enableDebug:!0},"undefined"!==typeof a&&(this._width=a),"undefined"!==typeof b&&(this._height=b),"undefined"!==typeof c&&(this.renderType=c),"undefined"!==typeof d&&(this.parent=d),"undefined"!==typeof f&&(this.transparent=f),"undefined"!==typeof g&&(this.antialias=g),this.rnd=new Phaser.RandomDataGenerator([(Date.now()*Math.random()).toString()]),this.state=new Phaser.StateManager(this,
e));this.device.whenReady(this.boot,this);return this};
Phaser.Game.prototype={parseConfig:function(a){this.config=a;void 0===a.enableDebug&&(this.config.enableDebug=!0);a.width&&(this._width=a.width);a.height&&(this._height=a.height);a.renderer&&(this.renderType=a.renderer);a.parent&&(this.parent=a.parent);void 0!==a.transparent&&(this.transparent=a.transparent);void 0!==a.antialias&&(this.antialias=a.antialias);a.resolution&&(this.resolution=a.resolution);void 0!==a.preserveDrawingBuffer&&(this.preserveDrawingBuffer=a.preserveDrawingBuffer);a.physicsConfig&&
(this.physicsConfig=a.physicsConfig);var b=[(Date.now()*Math.random()).toString()];a.seed&&(b=a.seed);this.rnd=new Phaser.RandomDataGenerator(b);b=null;a.state&&(b=a.state);this.state=new Phaser.StateManager(this,b)},boot:function(){this.isBooted||(this.onPause=new Phaser.Signal,this.onResume=new Phaser.Signal,this.onBlur=new Phaser.Signal,this.onFocus=new Phaser.Signal,this.isBooted=!0,PIXI.game=this,this.math=Phaser.Math,this.scale=new Phaser.ScaleManager(this,this._width,this._height),this.stage=
new Phaser.Stage(this),this.setUpRenderer(),this.world=new Phaser.World(this),this.add=new Phaser.GameObjectFactory(this),this.make=new Phaser.GameObjectCreator(this),this.cache=new Phaser.Cache(this),this.load=new Phaser.Loader(this),this.time=new Phaser.Time(this),this.tweens=new Phaser.TweenManager(this),this.input=new Phaser.Input(this),this.sound=new Phaser.SoundManager(this),this.physics=new Phaser.Physics(this,this.physicsConfig),this.particles=new Phaser.Particles(this),this.create=new Phaser.Create(this),
this.plugins=new Phaser.PluginManager(this),this.net=new Phaser.Net(this),this.time.boot(),this.stage.boot(),this.world.boot(),this.scale.boot(),this.input.boot(),this.sound.boot(),this.state.boot(),this.config.enableDebug?(this.debug=new Phaser.Utils.Debug(this),this.debug.boot()):this.debug={preUpdate:function(){},update:function(){},reset:function(){}},this.showDebugHeader(),this.isRunning=!0,this.raf=this.config&&this.config.forceSetTimeOut?new Phaser.RequestAnimationFrame(this,this.config.forceSetTimeOut):
new Phaser.RequestAnimationFrame(this,!1),this._kickstart=!0,window.focus&&(!window.PhaserGlobal||window.PhaserGlobal&&!window.PhaserGlobal.stopFocus)&&window.focus(),this.raf.start())},showDebugHeader:function(){if(!window.PhaserGlobal||!window.PhaserGlobal.hideBanner){var a=Phaser.VERSION,b="Canvas",c="HTML Audio",d=1;this.renderType===Phaser.WEBGL?(b="WebGL",d++):this.renderType===Phaser.HEADLESS&&(b="Headless");this.device.webAudio&&(c="WebAudio",d++);if(this.device.chrome){a=["%c %c %c Phaser v"+
a+" | Pixi.js | "+b+" | "+c+"  %c %c %c http://phaser.io %c\u2665%c\u2665%c\u2665","background: #fb8cb3","background: #d44a52","color: #ffffff; background: #871905;","background: #d44a52","background: #fb8cb3","background: #ffffff"];for(b=0;3>b;b++)b<d?a.push("color: #ff2424; background: #fff"):a.push("color: #959595; background: #fff");console.log.apply(console,a)}else window.console&&console.log("Phaser v"+a+" | Pixi.js "+PIXI.VERSION+" | "+b+" | "+c+" | http://phaser.io")}},setUpRenderer:function(){this.canvas=
this.config.canvas?this.config.canvas:Phaser.Canvas.create(this,this.width,this.height,this.config.canvasID,!0);this.config.canvasStyle?this.canvas.style=this.config.canvasStyle:this.canvas.style["-webkit-full-screen"]="width: 100%; height: 100%";if(this.renderType===Phaser.HEADLESS||this.renderType===Phaser.CANVAS||this.renderType===Phaser.AUTO&&!this.device.webGL)if(this.device.canvas)this.renderType=Phaser.CANVAS,this.renderer=new PIXI.CanvasRenderer(this),this.context=this.renderer.context;else throw Error("Phaser.Game - Cannot create Canvas or WebGL context, aborting.");
else this.renderType=Phaser.WEBGL,this.renderer=new PIXI.WebGLRenderer(this),this.context=null,this.canvas.addEventListener("webglcontextlost",this.contextLost.bind(this),!1),this.canvas.addEventListener("webglcontextrestored",this.contextRestored.bind(this),!1);this.device.cocoonJS&&(this.canvas.screencanvas=this.renderType===Phaser.CANVAS?!0:!1);this.renderType!==Phaser.HEADLESS&&(this.stage.smoothed=this.antialias,Phaser.Canvas.addToDOM(this.canvas,this.parent,!1),Phaser.Canvas.setTouchAction(this.canvas))},
contextLost:function(a){a.preventDefault();this.renderer.contextLost=!0},contextRestored:function(){this.renderer.initContext();this.cache.clearGLTextures();this.renderer.contextLost=!1},update:function(a){this.time.update(a);if(this._kickstart)this.updateLogic(this.time.desiredFpsMult),this.updateRender(this.time.slowMotion*this.time.desiredFps),this._kickstart=!1;else if(1<this._spiraling&&!this.forceSingleUpdate)this.time.time>this._nextFpsNotification&&(this._nextFpsNotification=this.time.time+
1E4,this.fpsProblemNotifier.dispatch()),this._spiraling=this._deltaTime=0,this.updateRender(this.time.slowMotion*this.time.desiredFps);else{a=1E3*this.time.slowMotion/this.time.desiredFps;this._deltaTime+=Math.max(Math.min(3*a,this.time.elapsed),0);var b=0;this.updatesThisFrame=Math.floor(this._deltaTime/a);this.forceSingleUpdate&&(this.updatesThisFrame=Math.min(1,this.updatesThisFrame));for(;this._deltaTime>=a&&(this._deltaTime-=a,this.currentUpdateID=b,this.updateLogic(this.time.desiredFpsMult),
b++,!this.forceSingleUpdate||1!==b);)this.time.refresh();b>this._lastCount?this._spiraling++:b<this._lastCount&&(this._spiraling=0);this._lastCount=b;this.updateRender(this._deltaTime/a)}},updateLogic:function(a){this._paused||this.pendingStep?(this.scale.pauseUpdate(),this.state.pauseUpdate(),this.debug.preUpdate()):(this.stepping&&(this.pendingStep=!0),this.scale.preUpdate(),this.debug.preUpdate(),this.camera.preUpdate(),this.physics.preUpdate(),this.state.preUpdate(a),this.plugins.preUpdate(a),
this.stage.preUpdate(),this.state.update(),this.stage.update(),this.tweens.update(),this.sound.update(),this.input.update(),this.physics.update(),this.particles.update(),this.plugins.update(),this.stage.postUpdate(),this.plugins.postUpdate());this.stage.updateTransform()},updateRender:function(a){this.lockRender||(this.state.preRender(a),this.renderType!==Phaser.HEADLESS&&(this.renderer.render(this.stage),this.plugins.render(a),this.state.render(a)),this.plugins.postRender(a))},enableStep:function(){this.stepping=
!0;this.pendingStep=!1;this.stepCount=0},disableStep:function(){this.pendingStep=this.stepping=!1},step:function(){this.pendingStep=!1;this.stepCount++},destroy:function(){this.raf.stop();this.state.destroy();this.sound.destroy();this.scale.destroy();this.stage.destroy();this.input.destroy();this.physics.destroy();this.plugins.destroy();this.world=this.time=this.load=this.cache=this.plugins=this.physics=this.input=this.stage=this.scale=this.sound=this.state=null;this.isBooted=!1;this.renderer.destroy(!1);
Phaser.Canvas.removeFromDOM(this.canvas);PIXI.defaultRenderer=null;Phaser.GAMES[this.id]=null},gamePaused:function(a){this._paused||(this._paused=!0,this.time.gamePaused(),this.sound.muteOnPause&&this.sound.setMute(),this.onPause.dispatch(a),this.device.cordova&&this.device.iOS&&(this.lockRender=!0))},gameResumed:function(a){this._paused&&!this._codePaused&&(this._paused=!1,this.time.gameResumed(),this.input.reset(),this.sound.muteOnPause&&this.sound.unsetMute(),this.onResume.dispatch(a),this.device.cordova&&
this.device.iOS&&(this.lockRender=!1))},focusLoss:function(a){this.onBlur.dispatch(a);this.stage.disableVisibilityChange||this.gamePaused(a)},focusGain:function(a){this.onFocus.dispatch(a);this.stage.disableVisibilityChange||this.gameResumed(a)}};Phaser.Game.prototype.constructor=Phaser.Game;
Object.defineProperty(Phaser.Game.prototype,"paused",{get:function(){return this._paused},set:function(a){!0===a?(!1===this._paused&&(this._paused=!0,this.sound.setMute(),this.time.gamePaused(),this.onPause.dispatch(this)),this._codePaused=!0):(this._paused&&(this._paused=!1,this.input.reset(),this.sound.unsetMute(),this.time.gameResumed(),this.onResume.dispatch(this)),this._codePaused=!1)}});
Phaser.Input=function(a){this.game=a;this.hitContext=this.hitCanvas=null;this.moveCallbacks=[];this.customCandidateHandlerContext=this.customCandidateHandler=null;this.pollRate=0;this.enabled=!0;this.multiInputOverride=Phaser.Input.MOUSE_TOUCH_COMBINE;this.scale=this.circle=this.speed=this.position=null;this.maxPointers=-1;this.tapRate=200;this.doubleTapRate=300;this.holdRate=2E3;this.justReleasedRate=this.justPressedRate=200;this.recordPointerHistory=!1;this.recordLimit=this.recordRate=100;this.pointer10=
this.pointer9=this.pointer8=this.pointer7=this.pointer6=this.pointer5=this.pointer4=this.pointer3=this.pointer2=this.pointer1=null;this.pointers=[];this.gamepad=this.mspointer=this.touch=this.keyboard=this.mouse=this.mousePointer=this.activePointer=null;this.resetLocked=!1;this.onHold=this.onTap=this.onUp=this.onDown=null;this.minPriorityID=0;this.interactiveItems=new Phaser.ArraySet;this._localPoint=new Phaser.Point;this._pollCounter=0;this._oldPosition=null;this._y=this._x=0};
Phaser.Input.MOUSE_OVERRIDES_TOUCH=0;Phaser.Input.TOUCH_OVERRIDES_MOUSE=1;Phaser.Input.MOUSE_TOUCH_COMBINE=2;Phaser.Input.MAX_POINTERS=10;
Phaser.Input.prototype={boot:function(){this.mousePointer=new Phaser.Pointer(this.game,0,Phaser.PointerMode.CURSOR);this.addPointer();this.addPointer();this.mouse=new Phaser.Mouse(this.game);this.touch=new Phaser.Touch(this.game);this.mspointer=new Phaser.MSPointer(this.game);Phaser.Keyboard&&(this.keyboard=new Phaser.Keyboard(this.game));Phaser.Gamepad&&(this.gamepad=new Phaser.Gamepad(this.game));this.onDown=new Phaser.Signal;this.onUp=new Phaser.Signal;this.onTap=new Phaser.Signal;this.onHold=
new Phaser.Signal;this.scale=new Phaser.Point(1,1);this.speed=new Phaser.Point;this.position=new Phaser.Point;this._oldPosition=new Phaser.Point;this.circle=new Phaser.Circle(0,0,44);this.activePointer=this.mousePointer;this.hitCanvas=PIXI.CanvasPool.create(this,1,1);this.hitContext=this.hitCanvas.getContext("2d");this.mouse.start();this.touch.start();this.game.device.mspointer&&this.mspointer.start();this.mousePointer.active=!0;this.keyboard&&this.keyboard.start();var a=this;this._onClickTrampoline=
function(b){a.onClickTrampoline(b)};this.game.canvas.addEventListener("click",this._onClickTrampoline,!1)},destroy:function(){this.mouse.stop();this.touch.stop();this.mspointer.stop();this.keyboard&&this.keyboard.stop();this.gamepad&&this.gamepad.stop();this.moveCallbacks=[];PIXI.CanvasPool.remove(this);this.game.canvas.removeEventListener("click",this._onClickTrampoline)},setInteractiveCandidateHandler:function(a,b){this.customCandidateHandler=a;this.customCandidateHandlerContext=b},addMoveCallback:function(a,
b){this.moveCallbacks.push({callback:a,context:b})},deleteMoveCallback:function(a,b){for(var c=this.moveCallbacks.length;c--;)if(this.moveCallbacks[c].callback===a&&this.moveCallbacks[c].context===b){this.moveCallbacks.splice(c,1);break}},addPointer:function(){if(this.pointers.length>=Phaser.Input.MAX_POINTERS)return console.warn("Phaser.Input.addPointer: Maximum limit of "+Phaser.Input.MAX_POINTERS+" pointers reached."),null;var a=this.pointers.length+1,b=new Phaser.Pointer(this.game,a,Phaser.PointerMode.TOUCH);
this.pointers.push(b);return this["pointer"+a]=b},update:function(){this.keyboard&&this.keyboard.update();if(0<this.pollRate&&this._pollCounter<this.pollRate)this._pollCounter++;else{this.speed.x=this.position.x-this._oldPosition.x;this.speed.y=this.position.y-this._oldPosition.y;this._oldPosition.copyFrom(this.position);this.mousePointer.update();this.gamepad&&this.gamepad.active&&this.gamepad.update();for(var a=0;a<this.pointers.length;a++)this.pointers[a].update();this._pollCounter=0}},reset:function(a){if(this.game.isBooted&&
!this.resetLocked){void 0===a&&(a=!1);this.mousePointer.reset();this.keyboard&&this.keyboard.reset(a);this.gamepad&&this.gamepad.reset();for(var b=0;b<this.pointers.length;b++)this.pointers[b].reset();"none"!==this.game.canvas.style.cursor&&(this.game.canvas.style.cursor="inherit");a&&(this.onDown.dispose(),this.onUp.dispose(),this.onTap.dispose(),this.onHold.dispose(),this.onDown=new Phaser.Signal,this.onUp=new Phaser.Signal,this.onTap=new Phaser.Signal,this.onHold=new Phaser.Signal,this.moveCallbacks=
[]);this._pollCounter=0}},resetSpeed:function(a,b){this._oldPosition.setTo(a,b);this.speed.setTo(0,0)},startPointer:function(a){if(0<=this.maxPointers&&this.countActivePointers(this.maxPointers)>=this.maxPointers)return null;if(!this.pointer1.active)return this.pointer1.start(a);if(!this.pointer2.active)return this.pointer2.start(a);for(var b=2;b<this.pointers.length;b++){var c=this.pointers[b];if(!c.active)return c.start(a)}return null},updatePointer:function(a){if(this.pointer1.active&&this.pointer1.identifier===
a.identifier)return this.pointer1.move(a);if(this.pointer2.active&&this.pointer2.identifier===a.identifier)return this.pointer2.move(a);for(var b=2;b<this.pointers.length;b++){var c=this.pointers[b];if(c.active&&c.identifier===a.identifier)return c.move(a)}return null},stopPointer:function(a){if(this.pointer1.active&&this.pointer1.identifier===a.identifier)return this.pointer1.stop(a);if(this.pointer2.active&&this.pointer2.identifier===a.identifier)return this.pointer2.stop(a);for(var b=2;b<this.pointers.length;b++){var c=
this.pointers[b];if(c.active&&c.identifier===a.identifier)return c.stop(a)}return null},countActivePointers:function(a){void 0===a&&(a=this.pointers.length);for(var b=a,c=0;c<this.pointers.length&&0<b;c++)this.pointers[c].active&&b--;return a-b},getPointer:function(a){void 0===a&&(a=!1);for(var b=0;b<this.pointers.length;b++){var c=this.pointers[b];if(c.active===a)return c}return null},getPointerFromIdentifier:function(a){for(var b=0;b<this.pointers.length;b++){var c=this.pointers[b];if(c.identifier===
a)return c}return null},getPointerFromId:function(a){for(var b=0;b<this.pointers.length;b++){var c=this.pointers[b];if(c.pointerId===a)return c}return null},getLocalPosition:function(a,b,c){void 0===c&&(c=new Phaser.Point);a=a.worldTransform;var d=1/(a.a*a.d+a.c*-a.b);return c.setTo(a.d*d*b.x+-a.c*d*b.y+(a.ty*a.c-a.tx*a.d)*d,a.a*d*b.y+-a.b*d*b.x+(-a.ty*a.a+a.tx*a.b)*d)},hitTest:function(a,b,c){if(!a.worldVisible)return!1;this.getLocalPosition(a,b,this._localPoint);c.copyFrom(this._localPoint);if(a.hitArea&&
a.hitArea.contains)return a.hitArea.contains(this._localPoint.x,this._localPoint.y);if(a instanceof Phaser.TileSprite){var d=a.width,e=a.height,f=-d*a.anchor.x;if(this._localPoint.x>=f&&this._localPoint.x<f+d&&(d=-e*a.anchor.y,this._localPoint.y>=d&&this._localPoint.y<d+e))return!0}else if(a instanceof PIXI.Sprite){if(d=a.texture.frame.width,e=a.texture.frame.height,f=-d*a.anchor.x,this._localPoint.x>=f&&this._localPoint.x<f+d&&(d=-e*a.anchor.y,this._localPoint.y>=d&&this._localPoint.y<d+e))return!0}else if(a instanceof
Phaser.Graphics)for(e=0;e<a.graphicsData.length;e++)if(d=a.graphicsData[e],d.fill&&d.shape&&d.shape.contains(this._localPoint.x,this._localPoint.y))return!0;for(e=0;e<a.children.length;e++)if(this.hitTest(a.children[e],b,c))return!0;return!1},onClickTrampoline:function(){this.activePointer.processClickTrampolines()}};Phaser.Input.prototype.constructor=Phaser.Input;Object.defineProperty(Phaser.Input.prototype,"x",{get:function(){return this._x},set:function(a){this._x=Math.floor(a)}});
Object.defineProperty(Phaser.Input.prototype,"y",{get:function(){return this._y},set:function(a){this._y=Math.floor(a)}});Object.defineProperty(Phaser.Input.prototype,"pollLocked",{get:function(){return 0<this.pollRate&&this._pollCounter<this.pollRate}});Object.defineProperty(Phaser.Input.prototype,"totalInactivePointers",{get:function(){return this.pointers.length-this.countActivePointers()}});Object.defineProperty(Phaser.Input.prototype,"totalActivePointers",{get:function(){return this.countActivePointers()}});
Object.defineProperty(Phaser.Input.prototype,"worldX",{get:function(){return this.game.camera.view.x+this.x}});Object.defineProperty(Phaser.Input.prototype,"worldY",{get:function(){return this.game.camera.view.y+this.y}});
Phaser.Mouse=function(a){this.game=a;this.input=a.input;this.callbackContext=this.game;this.mouseWheelCallback=this.mouseOverCallback=this.mouseOutCallback=this.mouseUpCallback=this.mouseDownCallback=null;this.capture=!1;this.button=-1;this.wheelDelta=0;this.enabled=!0;this.stopOnGameOut=this.locked=!1;this.pointerLock=new Phaser.Signal;this._wheelEvent=this._onMouseWheel=this._onMouseOver=this._onMouseOut=this._onMouseUp=this._onMouseMove=this._onMouseDown=this.event=null};
Phaser.Mouse.NO_BUTTON=-1;Phaser.Mouse.LEFT_BUTTON=0;Phaser.Mouse.MIDDLE_BUTTON=1;Phaser.Mouse.RIGHT_BUTTON=2;Phaser.Mouse.BACK_BUTTON=3;Phaser.Mouse.FORWARD_BUTTON=4;Phaser.Mouse.WHEEL_UP=1;Phaser.Mouse.WHEEL_DOWN=-1;
Phaser.Mouse.prototype={start:function(){if((!this.game.device.android||!1!==this.game.device.chrome)&&null===this._onMouseDown){var a=this;this._onMouseDown=function(b){return a.onMouseDown(b)};this._onMouseMove=function(b){return a.onMouseMove(b)};this._onMouseUp=function(b){return a.onMouseUp(b)};this._onMouseUpGlobal=function(b){return a.onMouseUpGlobal(b)};this._onMouseOutGlobal=function(b){return a.onMouseOutGlobal(b)};this._onMouseOut=function(b){return a.onMouseOut(b)};this._onMouseOver=function(b){return a.onMouseOver(b)};
this._onMouseWheel=function(b){return a.onMouseWheel(b)};var b=this.game.canvas;b.addEventListener("mousedown",this._onMouseDown,!0);b.addEventListener("mousemove",this._onMouseMove,!0);b.addEventListener("mouseup",this._onMouseUp,!0);this.game.device.cocoonJS||(window.addEventListener("mouseup",this._onMouseUpGlobal,!0),window.addEventListener("mouseout",this._onMouseOutGlobal,!0),b.addEventListener("mouseover",this._onMouseOver,!0),b.addEventListener("mouseout",this._onMouseOut,!0));var c=this.game.device.wheelEvent;
c&&(b.addEventListener(c,this._onMouseWheel,!0),"mousewheel"===c?this._wheelEvent=new WheelEventProxy(-.025,1):"DOMMouseScroll"===c&&(this._wheelEvent=new WheelEventProxy(1,1)))}},onMouseDown:function(a){this.event=a;this.capture&&a.preventDefault();this.mouseDownCallback&&this.mouseDownCallback.call(this.callbackContext,a);this.input.enabled&&this.enabled&&(a.identifier=0,this.input.mousePointer.start(a))},onMouseMove:function(a){this.event=a;this.capture&&a.preventDefault();this.mouseMoveCallback&&
this.mouseMoveCallback.call(this.callbackContext,a);this.input.enabled&&this.enabled&&(a.identifier=0,this.input.mousePointer.move(a))},onMouseUp:function(a){this.event=a;this.capture&&a.preventDefault();this.mouseUpCallback&&this.mouseUpCallback.call(this.callbackContext,a);this.input.enabled&&this.enabled&&(a.identifier=0,this.input.mousePointer.stop(a))},onMouseUpGlobal:function(a){this.input.mousePointer.withinGame||(this.mouseUpCallback&&this.mouseUpCallback.call(this.callbackContext,a),a.identifier=
0,this.input.mousePointer.stop(a))},onMouseOutGlobal:function(a){this.event=a;this.capture&&a.preventDefault();this.input.mousePointer.withinGame=!1;this.input.enabled&&this.enabled&&(this.input.mousePointer.stop(a),this.input.mousePointer.leftButton.stop(a),this.input.mousePointer.rightButton.stop(a))},onMouseOut:function(a){this.event=a;this.capture&&a.preventDefault();this.input.mousePointer.withinGame=!1;this.mouseOutCallback&&this.mouseOutCallback.call(this.callbackContext,a);this.input.enabled&&
this.enabled&&this.stopOnGameOut&&(a.identifier=0,this.input.mousePointer.stop(a))},onMouseOver:function(a){this.event=a;this.capture&&a.preventDefault();this.input.mousePointer.withinGame=!0;this.mouseOverCallback&&this.mouseOverCallback.call(this.callbackContext,a)},onMouseWheel:function(a){this._wheelEvent&&(a=this._wheelEvent.bindEvent(a));this.event=a;this.capture&&a.preventDefault();this.wheelDelta=Phaser.Math.clamp(-a.deltaY,-1,1);this.mouseWheelCallback&&this.mouseWheelCallback.call(this.callbackContext,
a)},requestPointerLock:function(){if(this.game.device.pointerLock){var a=this.game.canvas;a.requestPointerLock=a.requestPointerLock||a.mozRequestPointerLock||a.webkitRequestPointerLock;a.requestPointerLock();var b=this;this._pointerLockChange=function(a){return b.pointerLockChange(a)};document.addEventListener("pointerlockchange",this._pointerLockChange,!0);document.addEventListener("mozpointerlockchange",this._pointerLockChange,!0);document.addEventListener("webkitpointerlockchange",this._pointerLockChange,
!0)}},pointerLockChange:function(a){var b=this.game.canvas;document.pointerLockElement===b||document.mozPointerLockElement===b||document.webkitPointerLockElement===b?(this.locked=!0,this.pointerLock.dispatch(!0,a)):(this.locked=!1,this.pointerLock.dispatch(!1,a))},releasePointerLock:function(){document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock;document.exitPointerLock();document.removeEventListener("pointerlockchange",this._pointerLockChange,
!0);document.removeEventListener("mozpointerlockchange",this._pointerLockChange,!0);document.removeEventListener("webkitpointerlockchange",this._pointerLockChange,!0)},stop:function(){var a=this.game.canvas;a.removeEventListener("mousedown",this._onMouseDown,!0);a.removeEventListener("mousemove",this._onMouseMove,!0);a.removeEventListener("mouseup",this._onMouseUp,!0);a.removeEventListener("mouseover",this._onMouseOver,!0);a.removeEventListener("mouseout",this._onMouseOut,!0);var b=this.game.device.wheelEvent;
b&&a.removeEventListener(b,this._onMouseWheel,!0);window.removeEventListener("mouseup",this._onMouseUpGlobal,!0);window.removeEventListener("mouseout",this._onMouseOutGlobal,!0);document.removeEventListener("pointerlockchange",this._pointerLockChange,!0);document.removeEventListener("mozpointerlockchange",this._pointerLockChange,!0);document.removeEventListener("webkitpointerlockchange",this._pointerLockChange,!0)}};Phaser.Mouse.prototype.constructor=Phaser.Mouse;
function WheelEventProxy(a,b){this._scaleFactor=a;this._deltaMode=b;this.originalEvent=null}WheelEventProxy.prototype={};WheelEventProxy.prototype.constructor=WheelEventProxy;
WheelEventProxy.prototype.bindEvent=function(a){if(!WheelEventProxy._stubsGenerated&&a){var b=function(a){return function(){var b=this.originalEvent[a];return"function"!==typeof b?b:b.bind(this.originalEvent)}},c;for(c in a)c in WheelEventProxy.prototype||Object.defineProperty(WheelEventProxy.prototype,c,{get:b(c)});WheelEventProxy._stubsGenerated=!0}this.originalEvent=a;return this};
Object.defineProperties(WheelEventProxy.prototype,{type:{value:"wheel"},deltaMode:{get:function(){return this._deltaMode}},deltaY:{get:function(){return this._scaleFactor*(this.originalEvent.wheelDelta||this.originalEvent.detail)||0}},deltaX:{get:function(){return this._scaleFactor*this.originalEvent.wheelDeltaX||0}},deltaZ:{value:0}});
Phaser.MSPointer=function(a){this.game=a;this.input=a.input;this.callbackContext=this.game;this.pointerUpCallback=this.pointerMoveCallback=this.pointerDownCallback=null;this.capture=!0;this.button=-1;this.event=null;this.enabled=!0;this._onMSPointerOver=this._onMSPointerOut=this._onMSPointerUpGlobal=this._onMSPointerUp=this._onMSPointerMove=this._onMSPointerDown=null};
Phaser.MSPointer.prototype={start:function(){if(null===this._onMSPointerDown){var a=this;if(this.game.device.mspointer){this._onMSPointerDown=function(b){return a.onPointerDown(b)};this._onMSPointerMove=function(b){return a.onPointerMove(b)};this._onMSPointerUp=function(b){return a.onPointerUp(b)};this._onMSPointerUpGlobal=function(b){return a.onPointerUpGlobal(b)};this._onMSPointerOut=function(b){return a.onPointerOut(b)};this._onMSPointerOver=function(b){return a.onPointerOver(b)};var b=this.game.canvas;
b.addEventListener("MSPointerDown",this._onMSPointerDown,!1);b.addEventListener("MSPointerMove",this._onMSPointerMove,!1);b.addEventListener("MSPointerUp",this._onMSPointerUp,!1);b.addEventListener("pointerdown",this._onMSPointerDown,!1);b.addEventListener("pointermove",this._onMSPointerMove,!1);b.addEventListener("pointerup",this._onMSPointerUp,!1);b.style["-ms-content-zooming"]="none";b.style["-ms-touch-action"]="none";this.game.device.cocoonJS||(window.addEventListener("MSPointerUp",this._onMSPointerUpGlobal,
!0),b.addEventListener("MSPointerOver",this._onMSPointerOver,!0),b.addEventListener("MSPointerOut",this._onMSPointerOut,!0),window.addEventListener("pointerup",this._onMSPointerUpGlobal,!0),b.addEventListener("pointerover",this._onMSPointerOver,!0),b.addEventListener("pointerout",this._onMSPointerOut,!0))}}},onPointerDown:function(a){this.event=a;this.capture&&a.preventDefault();this.pointerDownCallback&&this.pointerDownCallback.call(this.callbackContext,a);this.input.enabled&&this.enabled&&(a.identifier=
a.pointerId,"mouse"===a.pointerType||4===a.pointerType?this.input.mousePointer.start(a):this.input.startPointer(a))},onPointerMove:function(a){this.event=a;this.capture&&a.preventDefault();this.pointerMoveCallback&&this.pointerMoveCallback.call(this.callbackContext,a);this.input.enabled&&this.enabled&&(a.identifier=a.pointerId,"mouse"===a.pointerType||4===a.pointerType?this.input.mousePointer.move(a):this.input.updatePointer(a))},onPointerUp:function(a){this.event=a;this.capture&&a.preventDefault();
this.pointerUpCallback&&this.pointerUpCallback.call(this.callbackContext,a);this.input.enabled&&this.enabled&&(a.identifier=a.pointerId,"mouse"===a.pointerType||4===a.pointerType?this.input.mousePointer.stop(a):this.input.stopPointer(a))},onPointerUpGlobal:function(a){if("mouse"!==a.pointerType&&4!==a.pointerType||this.input.mousePointer.withinGame){var b=this.input.getPointerFromIdentifier(a.identifier);if(b&&b.withinGame)this.onPointerUp(a)}else this.onPointerUp(a)},onPointerOut:function(a){this.event=
a;this.capture&&a.preventDefault();if("mouse"===a.pointerType||4===a.pointerType)this.input.mousePointer.withinGame=!1;else{var b=this.input.getPointerFromIdentifier(a.identifier);b&&(b.withinGame=!1)}this.input.mouse.mouseOutCallback&&this.input.mouse.mouseOutCallback.call(this.input.mouse.callbackContext,a);this.input.enabled&&this.enabled&&this.input.mouse.stopOnGameOut&&(a.identifier=0,b?b.stop(a):this.input.mousePointer.stop(a))},onPointerOver:function(a){this.event=a;this.capture&&a.preventDefault();
if("mouse"===a.pointerType||4===a.pointerType)this.input.mousePointer.withinGame=!0;else{var b=this.input.getPointerFromIdentifier(a.identifier);b&&(b.withinGame=!0)}this.input.mouse.mouseOverCallback&&this.input.mouse.mouseOverCallback.call(this.input.mouse.callbackContext,a)},stop:function(){var a=this.game.canvas;a.removeEventListener("MSPointerDown",this._onMSPointerDown,!1);a.removeEventListener("MSPointerMove",this._onMSPointerMove,!1);a.removeEventListener("MSPointerUp",this._onMSPointerUp,
!1);a.removeEventListener("pointerdown",this._onMSPointerDown,!1);a.removeEventListener("pointermove",this._onMSPointerMove,!1);a.removeEventListener("pointerup",this._onMSPointerUp,!1);window.removeEventListener("MSPointerUp",this._onMSPointerUpGlobal,!0);a.removeEventListener("MSPointerOver",this._onMSPointerOver,!0);a.removeEventListener("MSPointerOut",this._onMSPointerOut,!0);window.removeEventListener("pointerup",this._onMSPointerUpGlobal,!0);a.removeEventListener("pointerover",this._onMSPointerOver,
!0);a.removeEventListener("pointerout",this._onMSPointerOut,!0)}};Phaser.MSPointer.prototype.constructor=Phaser.MSPointer;Phaser.DeviceButton=function(a,b){this.parent=a;this.game=a.game;this.event=null;this.isDown=!1;this.isUp=!0;this.repeats=this.timeUp=this.timeDown=0;this.ctrlKey=this.shiftKey=this.altKey=!1;this.value=0;this.buttonCode=b;this.onDown=new Phaser.Signal;this.onUp=new Phaser.Signal;this.onFloat=new Phaser.Signal};
Phaser.DeviceButton.prototype={start:function(a,b){this.isDown||(this.isDown=!0,this.isUp=!1,this.timeDown=this.game.time.time,this.repeats=0,this.event=a,this.value=b,a&&(this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.ctrlKey=a.ctrlKey),this.onDown.dispatch(this,b))},stop:function(a,b){this.isUp||(this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.time,this.event=a,this.value=b,a&&(this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.ctrlKey=a.ctrlKey),this.onUp.dispatch(this,b))},padFloat:function(a){this.value=
a;this.onFloat.dispatch(this,a)},justPressed:function(a){return this.isDown&&this.timeDown+(a||250)>this.game.time.time},justReleased:function(a){return this.isUp&&this.timeUp+(a||250)>this.game.time.time},reset:function(){this.isDown=!1;this.isUp=!0;this.timeDown=this.game.time.time;this.repeats=0;this.ctrlKey=this.shiftKey=this.altKey=!1},destroy:function(){this.onDown.dispose();this.onUp.dispose();this.onFloat.dispose();this.game=this.parent=null}};Phaser.DeviceButton.prototype.constructor=Phaser.DeviceButton;
Object.defineProperty(Phaser.DeviceButton.prototype,"duration",{get:function(){return this.isUp?-1:this.game.time.time-this.timeDown}});
Phaser.Pointer=function(a,b,c){this.game=a;this.id=b;this.type=Phaser.POINTER;this.exists=!0;this.identifier=0;this.pointerId=null;this.pointerMode=c||Phaser.PointerMode.CURSOR|Phaser.PointerMode.CONTACT;this.button=this.target=null;this.leftButton=new Phaser.DeviceButton(this,Phaser.Pointer.LEFT_BUTTON);this.middleButton=new Phaser.DeviceButton(this,Phaser.Pointer.MIDDLE_BUTTON);this.rightButton=new Phaser.DeviceButton(this,Phaser.Pointer.RIGHT_BUTTON);this.backButton=new Phaser.DeviceButton(this,
Phaser.Pointer.BACK_BUTTON);this.forwardButton=new Phaser.DeviceButton(this,Phaser.Pointer.FORWARD_BUTTON);this.eraserButton=new Phaser.DeviceButton(this,Phaser.Pointer.ERASER_BUTTON);this._holdSent=!1;this._history=[];this._nextDrop=0;this.withinGame=this._stateReset=!1;this.screenY=this.screenX=this.pageY=this.pageX=this.clientY=this.clientX=-1;this.movementY=this.movementX=this.rawMovementY=this.rawMovementX=0;this.y=this.x=-1;this.isMouse=0===b;this.isDown=!1;this.isUp=!0;this.totalTouches=this.previousTapTime=
this.timeUp=this.timeDown=0;this.msSinceLastClick=Number.MAX_VALUE;this.targetObject=null;this.interactiveCandidates=[];this.dirty=this.active=!1;this.position=new Phaser.Point;this.positionDown=new Phaser.Point;this.positionUp=new Phaser.Point;this.circle=new Phaser.Circle(0,0,44);this._trampolineTargetObject=this._clickTrampolines=null};Phaser.Pointer.NO_BUTTON=0;Phaser.Pointer.LEFT_BUTTON=1;Phaser.Pointer.RIGHT_BUTTON=2;Phaser.Pointer.MIDDLE_BUTTON=4;Phaser.Pointer.BACK_BUTTON=8;
Phaser.Pointer.FORWARD_BUTTON=16;Phaser.Pointer.ERASER_BUTTON=32;
Phaser.Pointer.prototype={resetButtons:function(){this.isDown=!1;this.isUp=!0;this.isMouse&&(this.leftButton.reset(),this.middleButton.reset(),this.rightButton.reset(),this.backButton.reset(),this.forwardButton.reset(),this.eraserButton.reset())},processButtonsDown:function(a,b){Phaser.Pointer.LEFT_BUTTON&a&&this.leftButton.start(b);Phaser.Pointer.RIGHT_BUTTON&a&&this.rightButton.start(b);Phaser.Pointer.MIDDLE_BUTTON&a&&this.middleButton.start(b);Phaser.Pointer.BACK_BUTTON&a&&this.backButton.start(b);
Phaser.Pointer.FORWARD_BUTTON&a&&this.forwardButton.start(b);Phaser.Pointer.ERASER_BUTTON&a&&this.eraserButton.start(b)},processButtonsUp:function(a,b){a===Phaser.Mouse.LEFT_BUTTON&&this.leftButton.stop(b);a===Phaser.Mouse.RIGHT_BUTTON&&this.rightButton.stop(b);a===Phaser.Mouse.MIDDLE_BUTTON&&this.middleButton.stop(b);a===Phaser.Mouse.BACK_BUTTON&&this.backButton.stop(b);a===Phaser.Mouse.FORWARD_BUTTON&&this.forwardButton.stop(b);5===a&&this.eraserButton.stop(b)},updateButtons:function(a){this.button=
a.button;var b="down"===a.type.toLowerCase().substr(-4);void 0!==a.buttons?b?this.processButtonsDown(a.buttons,a):this.processButtonsUp(a.button,a):b?this.leftButton.start(a):(this.leftButton.stop(a),this.rightButton.stop(a));1===a.buttons&&a.ctrlKey&&this.leftButton.isDown&&(this.leftButton.stop(a),this.rightButton.start(a));this.isUp=!0;this.isDown=!1;if(this.leftButton.isDown||this.rightButton.isDown||this.middleButton.isDown||this.backButton.isDown||this.forwardButton.isDown||this.eraserButton.isDown)this.isUp=
!1,this.isDown=!0},start:function(a){var b=this.game.input;a.pointerId&&(this.pointerId=a.pointerId);this.identifier=a.identifier;this.target=a.target;this.isMouse?this.updateButtons(a):(this.isDown=!0,this.isUp=!1);this.withinGame=this.active=!0;this.dirty=!1;this._history=[];this._trampolineTargetObject=this._clickTrampolines=null;this.msSinceLastClick=this.game.time.time-this.timeDown;this.timeDown=this.game.time.time;this._holdSent=!1;this.move(a,!0);this.positionDown.setTo(this.x,this.y);if(b.multiInputOverride===
Phaser.Input.MOUSE_OVERRIDES_TOUCH||b.multiInputOverride===Phaser.Input.MOUSE_TOUCH_COMBINE||b.multiInputOverride===Phaser.Input.TOUCH_OVERRIDES_MOUSE&&0===b.totalActivePointers)b.x=this.x,b.y=this.y,b.position.setTo(this.x,this.y),b.onDown.dispatch(this,a),b.resetSpeed(this.x,this.y);this._stateReset=!1;this.totalTouches++;null!==this.targetObject&&this.targetObject._touchedHandler(this);return this},update:function(){var a=this.game.input;this.active&&(this.dirty&&(0<a.interactiveItems.total&&this.processInteractiveObjects(!1),
this.dirty=!1),!1===this._holdSent&&this.duration>=a.holdRate&&((a.multiInputOverride===Phaser.Input.MOUSE_OVERRIDES_TOUCH||a.multiInputOverride===Phaser.Input.MOUSE_TOUCH_COMBINE||a.multiInputOverride===Phaser.Input.TOUCH_OVERRIDES_MOUSE&&0===a.totalActivePointers)&&a.onHold.dispatch(this),this._holdSent=!0),a.recordPointerHistory&&this.game.time.time>=this._nextDrop&&(this._nextDrop=this.game.time.time+a.recordRate,this._history.push({x:this.position.x,y:this.position.y}),this._history.length>a.recordLimit&&
this._history.shift()))},move:function(a,b){var c=this.game.input;if(!c.pollLocked){void 0===b&&(b=!1);void 0!==a.button&&(this.button=a.button);b&&this.isMouse&&this.updateButtons(a);this.clientX=a.clientX;this.clientY=a.clientY;this.pageX=a.pageX;this.pageY=a.pageY;this.screenX=a.screenX;this.screenY=a.screenY;this.isMouse&&c.mouse.locked&&!b&&(this.rawMovementX=a.movementX||a.mozMovementX||a.webkitMovementX||0,this.rawMovementY=a.movementY||a.mozMovementY||a.webkitMovementY||0,this.movementX+=
this.rawMovementX,this.movementY+=this.rawMovementY);this.x=(this.pageX-this.game.scale.offset.x)*c.scale.x;this.y=(this.pageY-this.game.scale.offset.y)*c.scale.y;this.position.setTo(this.x,this.y);this.circle.x=this.x;this.circle.y=this.y;if(c.multiInputOverride===Phaser.Input.MOUSE_OVERRIDES_TOUCH||c.multiInputOverride===Phaser.Input.MOUSE_TOUCH_COMBINE||c.multiInputOverride===Phaser.Input.TOUCH_OVERRIDES_MOUSE&&0===c.totalActivePointers)c.activePointer=this,c.x=this.x,c.y=this.y,c.position.setTo(c.x,
c.y),c.circle.x=c.x,c.circle.y=c.y;this.withinGame=this.game.scale.bounds.contains(this.pageX,this.pageY);if(this.game.paused)return this;for(var d=c.moveCallbacks.length;d--;)c.moveCallbacks[d].callback.call(c.moveCallbacks[d].context,this,this.x,this.y,b);null!==this.targetObject&&!0===this.targetObject.isDragged?!1===this.targetObject.update(this)&&(this.targetObject=null):0<c.interactiveItems.total&&this.processInteractiveObjects(b);return this}},processInteractiveObjects:function(a){var b=0,
c=-1,d=null,e=this.game.input.interactiveItems.first;for(this.interactiveCandidates=[];e;)e.checked=!1,e.validForInput(c,b,!1)&&(e.checked=!0,a&&e.checkPointerDown(this,!0)||!a&&e.checkPointerOver(this,!0))&&(b=e.sprite.renderOrderID,c=e.priorityID,d=e,this.interactiveCandidates.push(e)),e=this.game.input.interactiveItems.next;for(e=this.game.input.interactiveItems.first;e;)!e.checked&&e.validForInput(c,b,!0)&&(a&&e.checkPointerDown(this,!1)||!a&&e.checkPointerOver(this,!1))&&(b=e.sprite.renderOrderID,
c=e.priorityID,d=e,this.interactiveCandidates.push(e)),e=this.game.input.interactiveItems.next;this.game.input.customCandidateHandler&&(d=this.game.input.customCandidateHandler.call(this.game.input.customCandidateHandlerContext,this,this.interactiveCandidates,d));this.swapTarget(d,!1);return null!==this.targetObject},swapTarget:function(a,b){void 0===b&&(b=!1);null===a?this.targetObject&&(this.targetObject._pointerOutHandler(this,b),this.targetObject=null):null===this.targetObject?(this.targetObject=
a,a._pointerOverHandler(this,b)):this.targetObject===a?!1===a.update(this)&&(this.targetObject=null):(this.targetObject._pointerOutHandler(this,b),this.targetObject=a,this.targetObject._pointerOverHandler(this,b))},leave:function(a){this.withinGame=!1;this.move(a,!1)},stop:function(a){var b=this.game.input;if(this._stateReset&&this.withinGame)a.preventDefault();else{this.timeUp=this.game.time.time;if(b.multiInputOverride===Phaser.Input.MOUSE_OVERRIDES_TOUCH||b.multiInputOverride===Phaser.Input.MOUSE_TOUCH_COMBINE||
b.multiInputOverride===Phaser.Input.TOUCH_OVERRIDES_MOUSE&&0===b.totalActivePointers)b.onUp.dispatch(this,a),0<=this.duration&&this.duration<=b.tapRate&&(this.timeUp-this.previousTapTime<b.doubleTapRate?b.onTap.dispatch(this,!0):b.onTap.dispatch(this,!1),this.previousTapTime=this.timeUp);this.isMouse?this.updateButtons(a):(this.isDown=!1,this.isUp=!0);0<this.id&&(this.active=!1);this.withinGame=this.game.scale.bounds.contains(a.pageX,a.pageY);this.identifier=this.pointerId=null;this.positionUp.setTo(this.x,
this.y);!1===this.isMouse&&b.currentPointers--;b.interactiveItems.callAll("_releasedHandler",this);this._clickTrampolines&&(this._trampolineTargetObject=this.targetObject);this.targetObject=null;return this}},justPressed:function(a){a=a||this.game.input.justPressedRate;return!0===this.isDown&&this.timeDown+a>this.game.time.time},justReleased:function(a){a=a||this.game.input.justReleasedRate;return this.isUp&&this.timeUp+a>this.game.time.time},addClickTrampoline:function(a,b,c,d){if(this.isDown){for(var e=
this._clickTrampolines=this._clickTrampolines||[],f=0;f<e.length;f++)if(e[f].name===a){e.splice(f,1);break}e.push({name:a,targetObject:this.targetObject,callback:b,callbackContext:c,callbackArgs:d})}},processClickTrampolines:function(){var a=this._clickTrampolines;if(a){for(var b=0;b<a.length;b++){var c=a[b];c.targetObject===this._trampolineTargetObject&&c.callback.apply(c.callbackContext,c.callbackArgs)}this._trampolineTargetObject=this._clickTrampolines=null}},reset:function(){!1===this.isMouse&&
(this.active=!1);this.identifier=this.pointerId=null;this.dirty=!1;this.totalTouches=0;this._holdSent=!1;this._history.length=0;this._stateReset=!0;this.resetButtons();this.targetObject&&this.targetObject._releasedHandler(this);this.targetObject=null},resetMovement:function(){this.movementY=this.movementX=0}};Phaser.Pointer.prototype.constructor=Phaser.Pointer;Object.defineProperty(Phaser.Pointer.prototype,"duration",{get:function(){return this.isUp?-1:this.game.time.time-this.timeDown}});
Object.defineProperty(Phaser.Pointer.prototype,"worldX",{get:function(){return this.game.world.camera.x+this.x}});Object.defineProperty(Phaser.Pointer.prototype,"worldY",{get:function(){return this.game.world.camera.y+this.y}});Phaser.PointerMode={CURSOR:1,CONTACT:2};
Phaser.Touch=function(a){this.game=a;this.enabled=!0;this.touchLockCallbacks=[];this.callbackContext=this.game;this.touchCancelCallback=this.touchLeaveCallback=this.touchEnterCallback=this.touchEndCallback=this.touchMoveCallback=this.touchStartCallback=null;this.preventDefault=!0;this._onTouchMove=this._onTouchCancel=this._onTouchLeave=this._onTouchEnter=this._onTouchEnd=this._onTouchMove=this._onTouchStart=this.event=null};
Phaser.Touch.prototype={start:function(){if(null===this._onTouchStart){var a=this;this.game.device.touch&&(this._onTouchStart=function(b){return a.onTouchStart(b)},this._onTouchMove=function(b){return a.onTouchMove(b)},this._onTouchEnd=function(b){return a.onTouchEnd(b)},this._onTouchEnter=function(b){return a.onTouchEnter(b)},this._onTouchLeave=function(b){return a.onTouchLeave(b)},this._onTouchCancel=function(b){return a.onTouchCancel(b)},this.game.canvas.addEventListener("touchstart",this._onTouchStart,
!1),this.game.canvas.addEventListener("touchmove",this._onTouchMove,!1),this.game.canvas.addEventListener("touchend",this._onTouchEnd,!1),this.game.canvas.addEventListener("touchcancel",this._onTouchCancel,!1),this.game.device.cocoonJS||(this.game.canvas.addEventListener("touchenter",this._onTouchEnter,!1),this.game.canvas.addEventListener("touchleave",this._onTouchLeave,!1)))}},consumeDocumentTouches:function(){this._documentTouchMove=function(a){a.preventDefault()};document.addEventListener("touchmove",
this._documentTouchMove,!1)},addTouchLockCallback:function(a,b,c){void 0===c&&(c=!1);this.touchLockCallbacks.push({callback:a,context:b,onEnd:c})},removeTouchLockCallback:function(a,b){for(var c=this.touchLockCallbacks.length;c--;)if(this.touchLockCallbacks[c].callback===a&&this.touchLockCallbacks[c].context===b)return this.touchLockCallbacks.splice(c,1),!0;return!1},onTouchStart:function(a){for(var b=this.touchLockCallbacks.length;b--;){var c=this.touchLockCallbacks[b];!c.onEnd&&c.callback.call(c.context,
this,a)&&this.touchLockCallbacks.splice(b,1)}this.event=a;if(this.game.input.enabled&&this.enabled)for(this.touchStartCallback&&this.touchStartCallback.call(this.callbackContext,a),this.preventDefault&&a.preventDefault(),b=0;b<a.changedTouches.length;b++)this.game.input.startPointer(a.changedTouches[b])},onTouchCancel:function(a){this.event=a;this.touchCancelCallback&&this.touchCancelCallback.call(this.callbackContext,a);if(this.game.input.enabled&&this.enabled){this.preventDefault&&a.preventDefault();
for(var b=0;b<a.changedTouches.length;b++)this.game.input.stopPointer(a.changedTouches[b])}},onTouchEnter:function(a){this.event=a;this.touchEnterCallback&&this.touchEnterCallback.call(this.callbackContext,a);this.game.input.enabled&&this.enabled&&this.preventDefault&&a.preventDefault()},onTouchLeave:function(a){this.event=a;this.touchLeaveCallback&&this.touchLeaveCallback.call(this.callbackContext,a);this.preventDefault&&a.preventDefault()},onTouchMove:function(a){this.event=a;this.touchMoveCallback&&
this.touchMoveCallback.call(this.callbackContext,a);this.preventDefault&&a.preventDefault();for(var b=0;b<a.changedTouches.length;b++)this.game.input.updatePointer(a.changedTouches[b])},onTouchEnd:function(a){for(var b=this.touchLockCallbacks.length;b--;){var c=this.touchLockCallbacks[b];c.onEnd&&c.callback.call(c.context,this,a)&&this.touchLockCallbacks.splice(b,1)}this.event=a;this.touchEndCallback&&this.touchEndCallback.call(this.callbackContext,a);this.preventDefault&&a.preventDefault();for(b=
0;b<a.changedTouches.length;b++)this.game.input.stopPointer(a.changedTouches[b])},stop:function(){this.game.device.touch&&(this.game.canvas.removeEventListener("touchstart",this._onTouchStart),this.game.canvas.removeEventListener("touchmove",this._onTouchMove),this.game.canvas.removeEventListener("touchend",this._onTouchEnd),this.game.canvas.removeEventListener("touchenter",this._onTouchEnter),this.game.canvas.removeEventListener("touchleave",this._onTouchLeave),this.game.canvas.removeEventListener("touchcancel",
this._onTouchCancel))}};Phaser.Touch.prototype.constructor=Phaser.Touch;
Phaser.InputHandler=function(a){this.sprite=a;this.game=a.game;this.checked=this.enabled=!1;this.priorityID=0;this.isDragged=this._setHandCursor=this.useHandCursor=!1;this.allowVerticalDrag=this.allowHorizontalDrag=!0;this.bringToTop=!1;this.snapOffset=null;this.snapOnRelease=this.snapOnDrag=!1;this.snapOffsetY=this.snapOffsetX=this.snapY=this.snapX=0;this.pixelPerfectClick=this.pixelPerfectOver=!1;this.pixelPerfectAlpha=255;this.draggable=!1;this.boundsSprite=this.boundsRect=null;this.scaleLayer=
!1;this.dragOffset=new Phaser.Point;this.dragStopBlocksInputUp=this.dragFromCenter=!1;this.dragStartPoint=new Phaser.Point;this.dragTimeThreshold=this.dragDistanceThreshold=0;this.downPoint=new Phaser.Point;this.snapPoint=new Phaser.Point;this._dragPoint=new Phaser.Point;this._wasEnabled=this._dragDistancePass=this._dragTimePass=this._pendingDrag=this._dragPhase=!1;this._tempPoint=new Phaser.Point;this._pointerData=[];this._pointerData.push({id:0,x:0,y:0,camX:0,camY:0,isDown:!1,isUp:!1,isOver:!1,
isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1})};
Phaser.InputHandler.prototype={start:function(a,b){a=a||0;void 0===b&&(b=!1);if(!1===this.enabled){this.game.input.interactiveItems.add(this);this.useHandCursor=b;this.priorityID=a;for(var c=0;10>c;c++)this._pointerData[c]={id:c,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1};this.snapOffset=new Phaser.Point;this._wasEnabled=this.enabled=!0}this.sprite.events.onAddedToGroup.add(this.addedToGroup,this);this.sprite.events.onRemovedFromGroup.add(this.removedFromGroup,
this);return this.sprite},addedToGroup:function(){this._dragPhase||this._wasEnabled&&!this.enabled&&this.start()},removedFromGroup:function(){this._dragPhase||(this.enabled?(this._wasEnabled=!0,this.stop()):this._wasEnabled=!1)},reset:function(){this.enabled=!1;for(var a=0;10>a;a++)this._pointerData[a]={id:a,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1}},stop:function(){!1!==this.enabled&&(this.enabled=!1,this.game.input.interactiveItems.remove(this))},
destroy:function(){this.sprite&&(this._setHandCursor&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1),this.enabled=!1,this.game.input.interactiveItems.remove(this),this._pointerData.length=0,this.sprite=this.boundsSprite=this.boundsRect=null)},validForInput:function(a,b,c){void 0===c&&(c=!0);return!this.enabled||0===this.sprite.scale.x||0===this.sprite.scale.y||this.priorityID<this.game.input.minPriorityID||this.sprite.parent&&this.sprite.parent.ignoreChildInput||!c&&(this.pixelPerfectClick||
this.pixelPerfectOver)?!1:this.priorityID>a||this.priorityID===a&&this.sprite.renderOrderID>b?!0:!1},isPixelPerfect:function(){return this.pixelPerfectClick||this.pixelPerfectOver},pointerX:function(a){return this._pointerData[a||0].x},pointerY:function(a){return this._pointerData[a||0].y},pointerDown:function(a){return this._pointerData[a||0].isDown},pointerUp:function(a){return this._pointerData[a||0].isUp},pointerTimeDown:function(a){return this._pointerData[a||0].timeDown},pointerTimeUp:function(a){return this._pointerData[a||
0].timeUp},pointerOver:function(a){if(!this.enabled)return!1;if(void 0===a){for(a=0;10>a;a++)if(this._pointerData[a].isOver)return!0;return!1}return this._pointerData[a].isOver},pointerOut:function(a){if(!this.enabled)return!1;if(void 0===a)for(a=0;10>a;a++){if(this._pointerData[a].isOut)return!0}else return this._pointerData[a].isOut},pointerTimeOver:function(a){return this._pointerData[a||0].timeOver},pointerTimeOut:function(a){return this._pointerData[a||0].timeOut},pointerDragged:function(a){return this._pointerData[a||
0].isDragged},checkPointerDown:function(a,b){return a.isDown&&this.enabled&&this.sprite&&this.sprite.parent&&this.sprite.visible&&this.sprite.parent.visible&&0!==this.sprite.worldScale.x&&0!==this.sprite.worldScale.y?this.game.input.hitTest(this.sprite,a,this._tempPoint)?(void 0===b&&(b=!1),!b&&this.pixelPerfectClick?this.checkPixel(this._tempPoint.x,this._tempPoint.y):!0):!1:!1},checkPointerOver:function(a,b){return this.enabled&&this.sprite&&this.sprite.parent&&this.sprite.visible&&this.sprite.parent.visible&&
0!==this.sprite.worldScale.x&&0!==this.sprite.worldScale.y?this.game.input.hitTest(this.sprite,a,this._tempPoint)?(void 0===b&&(b=!1),!b&&this.pixelPerfectOver?this.checkPixel(this._tempPoint.x,this._tempPoint.y):!0):!1:!1},checkPixel:function(a,b,c){if(this.sprite.texture.baseTexture.source){null===a&&null===b&&(this.game.input.getLocalPosition(this.sprite,c,this._tempPoint),a=this._tempPoint.x,b=this._tempPoint.y);0!==this.sprite.anchor.x&&(a-=-this.sprite.texture.frame.width*this.sprite.anchor.x);
0!==this.sprite.anchor.y&&(b-=-this.sprite.texture.frame.height*this.sprite.anchor.y);a+=this.sprite.texture.frame.x;b+=this.sprite.texture.frame.y;if(this.sprite.texture.trim&&(a-=this.sprite.texture.trim.x,b-=this.sprite.texture.trim.y,a<this.sprite.texture.crop.x||a>this.sprite.texture.crop.right||b<this.sprite.texture.crop.y||b>this.sprite.texture.crop.bottom))return this._dx=a,this._dy=b,!1;this._dx=a;this._dy=b;this.game.input.hitContext.clearRect(0,0,1,1);this.game.input.hitContext.drawImage(this.sprite.texture.baseTexture.source,
a,b,1,1,0,0,1,1);if(this.game.input.hitContext.getImageData(0,0,1,1).data[3]>=this.pixelPerfectAlpha)return!0}return!1},update:function(a){if(null!==this.sprite&&void 0!==this.sprite.parent){if(!this.enabled||!this.sprite.visible||!this.sprite.parent.visible)return this._pointerOutHandler(a),!1;if(this._pendingDrag)return this._dragDistancePass||(this._dragDistancePass=Phaser.Math.distance(a.x,a.y,this.downPoint.x,this.downPoint.y)>=this.dragDistanceThreshold),this._dragDistancePass&&this._dragTimePass&&
this.startDrag(a),!0;if(this.draggable&&this._draggedPointerID===a.id)return this.updateDrag(a,!1);if(this._pointerData[a.id].isOver){if(this.checkPointerOver(a))return this._pointerData[a.id].x=a.x-this.sprite.x,this._pointerData[a.id].y=a.y-this.sprite.y,!0;this._pointerOutHandler(a);return!1}}},_pointerOverHandler:function(a,b){if(null!==this.sprite){var c=this._pointerData[a.id];if(!1===c.isOver||a.dirty){var d=!1===c.isOver;c.isOver=!0;c.isOut=!1;c.timeOver=this.game.time.time;c.x=a.x-this.sprite.x;
c.y=a.y-this.sprite.y;this.useHandCursor&&!1===c.isDragged&&(this.game.canvas.style.cursor="pointer",this._setHandCursor=!0);if(!b&&d&&this.sprite&&this.sprite.events)this.sprite.events.onInputOver$dispatch(this.sprite,a);this.sprite.parent&&this.sprite.parent.type===Phaser.GROUP&&this.sprite.parent.onChildInputOver.dispatch(this.sprite,a)}}},_pointerOutHandler:function(a,b){if(null!==this.sprite){var c=this._pointerData[a.id];c.isOver=!1;c.isOut=!0;c.timeOut=this.game.time.time;this.useHandCursor&&
!1===c.isDragged&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1);!b&&this.sprite&&this.sprite.events&&(this.sprite.events.onInputOut$dispatch(this.sprite,a),this.sprite&&this.sprite.parent&&this.sprite.parent.type===Phaser.GROUP&&this.sprite.parent.onChildInputOut.dispatch(this.sprite,a))}},_touchedHandler:function(a){if(null!==this.sprite){var b=this._pointerData[a.id];if(!b.isDown&&b.isOver&&(!this.pixelPerfectClick||this.checkPixel(null,null,a))){b.isDown=!0;b.isUp=!1;b.timeDown=
this.game.time.time;this.downPoint.set(a.x,a.y);a.dirty=!0;if(this.sprite&&this.sprite.events&&(this.sprite.events.onInputDown$dispatch(this.sprite,a),this.sprite&&this.sprite.parent&&this.sprite.parent.type===Phaser.GROUP&&this.sprite.parent.onChildInputDown.dispatch(this.sprite,a),null===this.sprite))return;this.draggable&&!1===this.isDragged&&(0===this.dragTimeThreshold&&0===this.dragDistanceThreshold?this.startDrag(a):(this._pendingDrag=!0,this._dragDistancePass=0===this.dragDistanceThreshold,
0<this.dragTimeThreshold?(this._dragTimePass=!1,this.game.time.events.add(this.dragTimeThreshold,this.dragTimeElapsed,this,a)):this._dragTimePass=!0));this.bringToTop&&this.sprite.bringToTop()}}},dragTimeElapsed:function(a){this._dragTimePass=!0;this._pendingDrag&&this.sprite&&this._dragDistancePass&&this.startDrag(a)},_releasedHandler:function(a){if(null!==this.sprite){var b=this._pointerData[a.id];if(b.isDown&&a.isUp){b.isDown=!1;b.isUp=!0;b.timeUp=this.game.time.time;b.downDuration=b.timeUp-b.timeDown;
var c=this.checkPointerOver(a);if(this.sprite&&this.sprite.events){if(!this.dragStopBlocksInputUp||this.dragStopBlocksInputUp&&(!this.draggable||!this.isDragged||this._draggedPointerID!==a.id))this.sprite.events.onInputUp$dispatch(this.sprite,a,c);this.sprite&&this.sprite.parent&&this.sprite.parent.type===Phaser.GROUP&&this.sprite.parent.onChildInputUp.dispatch(this.sprite,a,c);c&&(c=this.checkPointerOver(a))}b.isOver=c;!c&&this.useHandCursor&&(this.game.canvas.style.cursor="default",this._setHandCursor=
!1);a.dirty=!0;this._pendingDrag=!1;this.draggable&&this.isDragged&&this._draggedPointerID===a.id&&this.stopDrag(a)}}},updateDrag:function(a,b){void 0===b&&(b=!1);if(a.isUp)return this.stopDrag(a),!1;var c=this.globalToLocalX(a.x)+this._dragPoint.x+this.dragOffset.x,d=this.globalToLocalY(a.y)+this._dragPoint.y+this.dragOffset.y;if(this.sprite.fixedToCamera)this.allowHorizontalDrag&&(this.sprite.cameraOffset.x=c),this.allowVerticalDrag&&(this.sprite.cameraOffset.y=d),this.boundsRect&&this.checkBoundsRect(),
this.boundsSprite&&this.checkBoundsSprite(),this.snapOnDrag&&(this.sprite.cameraOffset.x=Math.round((this.sprite.cameraOffset.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.cameraOffset.y=Math.round((this.sprite.cameraOffset.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY,this.snapPoint.set(this.sprite.cameraOffset.x,this.sprite.cameraOffset.y));else{var e=this.game.camera.x-this._pointerData[a.id].camX,f=this.game.camera.y-
this._pointerData[a.id].camY;this.allowHorizontalDrag&&(this.sprite.x=c+e);this.allowVerticalDrag&&(this.sprite.y=d+f);this.boundsRect&&this.checkBoundsRect();this.boundsSprite&&this.checkBoundsSprite();this.snapOnDrag&&(this.sprite.x=Math.round((this.sprite.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.y=Math.round((this.sprite.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY,this.snapPoint.set(this.sprite.x,this.sprite.y))}this.sprite.events.onDragUpdate.dispatch(this.sprite,
a,c,d,this.snapPoint,b);return!0},justOver:function(a,b){a=a||0;b=b||500;return this._pointerData[a].isOver&&this.overDuration(a)<b},justOut:function(a,b){a=a||0;return this._pointerData[a].isOut&&this.game.time.time-this._pointerData[a].timeOut<(b||500)},justPressed:function(a,b){a=a||0;b=b||500;return this._pointerData[a].isDown&&this.downDuration(a)<b},justReleased:function(a,b){a=a||0;return this._pointerData[a].isUp&&this.game.time.time-this._pointerData[a].timeUp<(b||500)},overDuration:function(a){a=
a||0;return this._pointerData[a].isOver?this.game.time.time-this._pointerData[a].timeOver:-1},downDuration:function(a){a=a||0;return this._pointerData[a].isDown?this.game.time.time-this._pointerData[a].timeDown:-1},enableDrag:function(a,b,c,d,e,f){void 0===a&&(a=!1);void 0===b&&(b=!1);void 0===c&&(c=!1);void 0===d&&(d=255);void 0===e&&(e=null);void 0===f&&(f=null);this._dragPoint=new Phaser.Point;this.draggable=!0;this.bringToTop=b;this.dragOffset=new Phaser.Point;this.dragFromCenter=a;this.pixelPerfectClick=
c;this.pixelPerfectAlpha=d;e&&(this.boundsRect=e);f&&(this.boundsSprite=f)},disableDrag:function(){if(this._pointerData)for(var a=0;10>a;a++)this._pointerData[a].isDragged=!1;this.isDragged=this.draggable=!1;this._draggedPointerID=-1;this._pendingDrag=!1},startDrag:function(a){var b=this.sprite.x,c=this.sprite.y;this.isDragged=!0;this._draggedPointerID=a.id;this._pointerData[a.id].camX=this.game.camera.x;this._pointerData[a.id].camY=this.game.camera.y;this._pointerData[a.id].isDragged=!0;if(this.sprite.fixedToCamera){if(this.dragFromCenter){var d=
this.sprite.getBounds();this.sprite.cameraOffset.x=this.globalToLocalX(a.x)+(this.sprite.cameraOffset.x-d.centerX);this.sprite.cameraOffset.y=this.globalToLocalY(a.y)+(this.sprite.cameraOffset.y-d.centerY)}this._dragPoint.setTo(this.sprite.cameraOffset.x-a.x,this.sprite.cameraOffset.y-a.y)}else this.dragFromCenter&&(d=this.sprite.getBounds(),this.sprite.x=this.globalToLocalX(a.x)+(this.sprite.x-d.centerX),this.sprite.y=this.globalToLocalY(a.y)+(this.sprite.y-d.centerY)),this._dragPoint.setTo(this.sprite.x-
this.globalToLocalX(a.x),this.sprite.y-this.globalToLocalY(a.y));this.updateDrag(a,!0);this.bringToTop&&(this._dragPhase=!0,this.sprite.bringToTop());this.dragStartPoint.set(b,c);this.sprite.events.onDragStart$dispatch(this.sprite,a,b,c);this._pendingDrag=!1},globalToLocalX:function(a){this.scaleLayer&&(a-=this.game.scale.grid.boundsFluid.x,a*=this.game.scale.grid.scaleFluidInversed.x);return a},globalToLocalY:function(a){this.scaleLayer&&(a-=this.game.scale.grid.boundsFluid.y,a*=this.game.scale.grid.scaleFluidInversed.y);
return a},stopDrag:function(a){this.isDragged=!1;this._draggedPointerID=-1;this._pendingDrag=this._dragPhase=this._pointerData[a.id].isDragged=!1;this.snapOnRelease&&(this.sprite.fixedToCamera?(this.sprite.cameraOffset.x=Math.round((this.sprite.cameraOffset.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.cameraOffset.y=Math.round((this.sprite.cameraOffset.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY):(this.sprite.x=
Math.round((this.sprite.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.y=Math.round((this.sprite.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY));this.sprite.events.onDragStop$dispatch(this.sprite,a);!1===this.checkPointerOver(a)&&this._pointerOutHandler(a)},setDragLock:function(a,b){void 0===a&&(a=!0);void 0===b&&(b=!0);this.allowHorizontalDrag=a;this.allowVerticalDrag=b},enableSnap:function(a,b,c,d,e,f){void 0===c&&
(c=!0);void 0===d&&(d=!1);void 0===e&&(e=0);void 0===f&&(f=0);this.snapX=a;this.snapY=b;this.snapOffsetX=e;this.snapOffsetY=f;this.snapOnDrag=c;this.snapOnRelease=d},disableSnap:function(){this.snapOnRelease=this.snapOnDrag=!1},checkBoundsRect:function(){this.sprite.fixedToCamera?(this.sprite.cameraOffset.x<this.boundsRect.left?this.sprite.cameraOffset.x=this.boundsRect.left:this.sprite.cameraOffset.x+this.sprite.width>this.boundsRect.right&&(this.sprite.cameraOffset.x=this.boundsRect.right-this.sprite.width),
this.sprite.cameraOffset.y<this.boundsRect.top?this.sprite.cameraOffset.y=this.boundsRect.top:this.sprite.cameraOffset.y+this.sprite.height>this.boundsRect.bottom&&(this.sprite.cameraOffset.y=this.boundsRect.bottom-this.sprite.height)):(this.sprite.left<this.boundsRect.left?this.sprite.x=this.boundsRect.x+this.sprite.offsetX:this.sprite.right>this.boundsRect.right&&(this.sprite.x=this.boundsRect.right-(this.sprite.width-this.sprite.offsetX)),this.sprite.top<this.boundsRect.top?this.sprite.y=this.boundsRect.top+
this.sprite.offsetY:this.sprite.bottom>this.boundsRect.bottom&&(this.sprite.y=this.boundsRect.bottom-(this.sprite.height-this.sprite.offsetY)))},checkBoundsSprite:function(){this.sprite.fixedToCamera&&this.boundsSprite.fixedToCamera?(this.sprite.cameraOffset.x<this.boundsSprite.cameraOffset.x?this.sprite.cameraOffset.x=this.boundsSprite.cameraOffset.x:this.sprite.cameraOffset.x+this.sprite.width>this.boundsSprite.cameraOffset.x+this.boundsSprite.width&&(this.sprite.cameraOffset.x=this.boundsSprite.cameraOffset.x+
this.boundsSprite.width-this.sprite.width),this.sprite.cameraOffset.y<this.boundsSprite.cameraOffset.y?this.sprite.cameraOffset.y=this.boundsSprite.cameraOffset.y:this.sprite.cameraOffset.y+this.sprite.height>this.boundsSprite.cameraOffset.y+this.boundsSprite.height&&(this.sprite.cameraOffset.y=this.boundsSprite.cameraOffset.y+this.boundsSprite.height-this.sprite.height)):(this.sprite.left<this.boundsSprite.left?this.sprite.x=this.boundsSprite.left+this.sprite.offsetX:this.sprite.right>this.boundsSprite.right&&
(this.sprite.x=this.boundsSprite.right-(this.sprite.width-this.sprite.offsetX)),this.sprite.top<this.boundsSprite.top?this.sprite.y=this.boundsSprite.top+this.sprite.offsetY:this.sprite.bottom>this.boundsSprite.bottom&&(this.sprite.y=this.boundsSprite.bottom-(this.sprite.height-this.sprite.offsetY)))}};Phaser.InputHandler.prototype.constructor=Phaser.InputHandler;
Phaser.Key=function(a,b){this.game=a;this._enabled=!0;this.event=null;this.isDown=!1;this.isUp=!0;this.shiftKey=this.ctrlKey=this.altKey=!1;this.duration=this.timeDown=0;this.timeUp=-2500;this.repeats=0;this.keyCode=b;this.onDown=new Phaser.Signal;this.onHoldContext=this.onHoldCallback=null;this.onUp=new Phaser.Signal;this._justUp=this._justDown=!1};
Phaser.Key.prototype={update:function(){this._enabled&&this.isDown&&(this.duration=this.game.time.time-this.timeDown,this.repeats++,this.onHoldCallback&&this.onHoldCallback.call(this.onHoldContext,this))},processKeyDown:function(a){this._enabled&&(this.event=a,this.isDown||(this.altKey=a.altKey,this.ctrlKey=a.ctrlKey,this.shiftKey=a.shiftKey,this.isDown=!0,this.isUp=!1,this.timeDown=this.game.time.time,this.repeats=this.duration=0,this._justDown=!0,this.onDown.dispatch(this)))},processKeyUp:function(a){this._enabled&&
(this.event=a,this.isUp||(this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.time,this.duration=this.game.time.time-this.timeDown,this._justUp=!0,this.onUp.dispatch(this)))},reset:function(a){void 0===a&&(a=!0);this.isDown=!1;this.isUp=!0;this.timeUp=this.game.time.time;this.duration=0;this._enabled=!0;this._justUp=this._justDown=!1;a&&(this.onDown.removeAll(),this.onUp.removeAll(),this.onHoldContext=this.onHoldCallback=null)},downDuration:function(a){void 0===a&&(a=50);return this.isDown&&this.duration<
a},upDuration:function(a){void 0===a&&(a=50);return!this.isDown&&this.game.time.time-this.timeUp<a}};Object.defineProperty(Phaser.Key.prototype,"justDown",{get:function(){var a=this._justDown;this._justDown=!1;return a}});Object.defineProperty(Phaser.Key.prototype,"justUp",{get:function(){var a=this._justUp;this._justUp=!1;return a}});
Object.defineProperty(Phaser.Key.prototype,"enabled",{get:function(){return this._enabled},set:function(a){a=!!a;a!==this._enabled&&(a||this.reset(!1),this._enabled=a)}});Phaser.Key.prototype.constructor=Phaser.Key;Phaser.Keyboard=function(a){this.game=a;this.enabled=!0;this.pressEvent=this.event=null;this.callbackContext=this;this.onUpCallback=this.onPressCallback=this.onDownCallback=null;this._keys=[];this._capture=[];this._onKeyUp=this._onKeyPress=this._onKeyDown=null;this._k=this._i=0};
Phaser.Keyboard.prototype={addCallbacks:function(a,b,c,d){this.callbackContext=a;void 0!==b&&null!==b&&(this.onDownCallback=b);void 0!==c&&null!==c&&(this.onUpCallback=c);void 0!==d&&null!==d&&(this.onPressCallback=d)},addKey:function(a){this._keys[a]||(this._keys[a]=new Phaser.Key(this.game,a),this.addKeyCapture(a));return this._keys[a]},addKeys:function(a){var b={},c;for(c in a)b[c]=this.addKey(a[c]);return b},removeKey:function(a){this._keys[a]&&(this._keys[a]=null,this.removeKeyCapture(a))},createCursorKeys:function(){return this.addKeys({up:Phaser.KeyCode.UP,
down:Phaser.KeyCode.DOWN,left:Phaser.KeyCode.LEFT,right:Phaser.KeyCode.RIGHT})},start:function(){if(!this.game.device.cocoonJS&&null===this._onKeyDown){var a=this;this._onKeyDown=function(b){return a.processKeyDown(b)};this._onKeyUp=function(b){return a.processKeyUp(b)};this._onKeyPress=function(b){return a.processKeyPress(b)};window.addEventListener("keydown",this._onKeyDown,!1);window.addEventListener("keyup",this._onKeyUp,!1);window.addEventListener("keypress",this._onKeyPress,!1)}},stop:function(){window.removeEventListener("keydown",
this._onKeyDown);window.removeEventListener("keyup",this._onKeyUp);window.removeEventListener("keypress",this._onKeyPress);this._onKeyPress=this._onKeyUp=this._onKeyDown=null},destroy:function(){this.stop();this.clearCaptures();this._i=this._keys.length=0},addKeyCapture:function(a){if("object"===typeof a)for(var b in a)this._capture[a[b]]=!0;else this._capture[a]=!0},removeKeyCapture:function(a){delete this._capture[a]},clearCaptures:function(){this._capture={}},update:function(){for(this._i=this._keys.length;this._i--;)this._keys[this._i]&&
this._keys[this._i].update()},processKeyDown:function(a){this.event=a;if(this.game.input.enabled&&this.enabled){var b=a.keyCode;this._capture[b]&&a.preventDefault();this._keys[b]||(this._keys[b]=new Phaser.Key(this.game,b));this._keys[b].processKeyDown(a);this._k=b;this.onDownCallback&&this.onDownCallback.call(this.callbackContext,a)}},processKeyPress:function(a){this.pressEvent=a;this.game.input.enabled&&this.enabled&&this.onPressCallback&&this.onPressCallback.call(this.callbackContext,String.fromCharCode(a.charCode),
a)},processKeyUp:function(a){this.event=a;if(this.game.input.enabled&&this.enabled){var b=a.keyCode;this._capture[b]&&a.preventDefault();this._keys[b]||(this._keys[b]=new Phaser.Key(this.game,b));this._keys[b].processKeyUp(a);this.onUpCallback&&this.onUpCallback.call(this.callbackContext,a)}},reset:function(a){void 0===a&&(a=!0);this.event=null;for(var b=this._keys.length;b--;)this._keys[b]&&this._keys[b].reset(a)},downDuration:function(a,b){return this._keys[a]?this._keys[a].downDuration(b):null},
upDuration:function(a,b){return this._keys[a]?this._keys[a].upDuration(b):null},isDown:function(a){return this._keys[a]?this._keys[a].isDown:null}};Object.defineProperty(Phaser.Keyboard.prototype,"lastChar",{get:function(){return 32===this.event.charCode?"":String.fromCharCode(this.pressEvent.charCode)}});Object.defineProperty(Phaser.Keyboard.prototype,"lastKey",{get:function(){return this._keys[this._k]}});Phaser.Keyboard.prototype.constructor=Phaser.Keyboard;
Phaser.KeyCode={A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_ADD:107,NUMPAD_ENTER:108,NUMPAD_SUBTRACT:109,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,
F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,COLON:186,EQUALS:187,COMMA:188,UNDERSCORE:189,PERIOD:190,QUESTION_MARK:191,TILDE:192,OPEN_BRACKET:219,BACKWARD_SLASH:220,CLOSED_BRACKET:221,QUOTES:222,BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,CAPS_LOCK:20,ESC:27,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS:43,MINUS:44,INSERT:45,DELETE:46,HELP:47,NUM_LOCK:144};
for(var key in Phaser.KeyCode)Phaser.KeyCode.hasOwnProperty(key)&&!key.match(/[a-z]/)&&(Phaser.Keyboard[key]=Phaser.KeyCode[key]);Phaser.Component=function(){};Phaser.Component.Angle=function(){};Phaser.Component.Angle.prototype={angle:{get:function(){return Phaser.Math.wrapAngle(Phaser.Math.radToDeg(this.rotation))},set:function(a){this.rotation=Phaser.Math.degToRad(Phaser.Math.wrapAngle(a))}}};Phaser.Component.Animation=function(){};
Phaser.Component.Animation.prototype={play:function(a,b,c,d){if(this.animations)return this.animations.play(a,b,c,d)}};Phaser.Component.AutoCull=function(){};Phaser.Component.AutoCull.prototype={autoCull:!1,inCamera:{get:function(){this.autoCull||this.checkWorldBounds||(this._bounds.copyFrom(this.getBounds()),this._bounds.x+=this.game.camera.view.x,this._bounds.y+=this.game.camera.view.y);return this.game.world.camera.view.intersects(this._bounds)}}};Phaser.Component.Bounds=function(){};
Phaser.Component.Bounds.prototype={offsetX:{get:function(){return this.anchor.x*this.width}},offsetY:{get:function(){return this.anchor.y*this.height}},centerX:{get:function(){return this.x-this.offsetX+.5*this.width},set:function(a){this.x=a+this.offsetX-.5*this.width}},centerY:{get:function(){return this.y-this.offsetY+.5*this.height},set:function(a){this.y=a+this.offsetY-.5*this.height}},left:{get:function(){return this.x-this.offsetX},set:function(a){this.x=a+this.offsetX}},right:{get:function(){return this.x+
this.width-this.offsetX},set:function(a){this.x=a-this.width+this.offsetX}},top:{get:function(){return this.y-this.offsetY},set:function(a){this.y=a+this.offsetY}},bottom:{get:function(){return this.y+this.height-this.offsetY},set:function(a){this.y=a-this.height+this.offsetY}},alignIn:function(a,b,c,d){void 0===c&&(c=0);void 0===d&&(d=0);switch(b){default:case Phaser.TOP_LEFT:this.left=a.left-c;this.top=a.top-d;break;case Phaser.TOP_CENTER:this.centerX=a.centerX+c;this.top=a.top-d;break;case Phaser.TOP_RIGHT:this.right=
a.right+c;this.top=a.top-d;break;case Phaser.LEFT_CENTER:this.left=a.left-c;this.centerY=a.centerY+d;break;case Phaser.CENTER:this.centerX=a.centerX+c;this.centerY=a.centerY+d;break;case Phaser.RIGHT_CENTER:this.right=a.right+c;this.centerY=a.centerY+d;break;case Phaser.BOTTOM_LEFT:this.left=a.left-c;this.bottom=a.bottom+d;break;case Phaser.BOTTOM_CENTER:this.centerX=a.centerX+c;this.bottom=a.bottom+d;break;case Phaser.BOTTOM_RIGHT:this.right=a.right+c,this.bottom=a.bottom+d}return this},alignTo:function(a,
b,c,d){void 0===c&&(c=0);void 0===d&&(d=0);switch(b){default:case Phaser.TOP_LEFT:this.left=a.left-c;this.bottom=a.top-d;break;case Phaser.TOP_CENTER:this.centerX=a.centerX+c;this.bottom=a.top-d;break;case Phaser.TOP_RIGHT:this.right=a.right+c;this.bottom=a.top-d;break;case Phaser.LEFT_TOP:this.right=a.left-c;this.top=a.top-d;break;case Phaser.LEFT_CENTER:this.right=a.left-c;this.centerY=a.centerY+d;break;case Phaser.LEFT_BOTTOM:this.right=a.left-c;this.bottom=a.bottom+d;break;case Phaser.RIGHT_TOP:this.left=
a.right+c;this.top=a.top-d;break;case Phaser.RIGHT_CENTER:this.left=a.right+c;this.centerY=a.centerY+d;break;case Phaser.RIGHT_BOTTOM:this.left=a.right+c;this.bottom=a.bottom+d;break;case Phaser.BOTTOM_LEFT:this.left=a.left-c;this.top=a.bottom+d;break;case Phaser.BOTTOM_CENTER:this.centerX=a.centerX+c;this.top=a.bottom+d;break;case Phaser.BOTTOM_RIGHT:this.right=a.right+c,this.top=a.bottom+d}return this}};Phaser.Group.prototype.alignIn=Phaser.Component.Bounds.prototype.alignIn;
Phaser.Group.prototype.alignTo=Phaser.Component.Bounds.prototype.alignTo;Phaser.Component.BringToTop=function(){};Phaser.Component.BringToTop.prototype.bringToTop=function(){this.parent&&this.parent.bringToTop(this);return this};Phaser.Component.BringToTop.prototype.sendToBack=function(){this.parent&&this.parent.sendToBack(this);return this};Phaser.Component.BringToTop.prototype.moveUp=function(){this.parent&&this.parent.moveUp(this);return this};
Phaser.Component.BringToTop.prototype.moveDown=function(){this.parent&&this.parent.moveDown(this);return this};Phaser.Component.Core=function(){};Phaser.Component.Core.install=function(a){Phaser.Utils.mixinPrototype(this,Phaser.Component.Core.prototype);this.components={};for(var b=0;b<a.length;b++){var c=a[b],d=!1;"Destroy"===c&&(d=!0);Phaser.Utils.mixinPrototype(this,Phaser.Component[c].prototype,d);this.components[c]=!0}};
Phaser.Component.Core.init=function(a,b,c,d,e){this.game=a;this.key=d;this.data={};this.position.set(b,c);this.world=new Phaser.Point(b,c);this.previousPosition=new Phaser.Point(b,c);this.events=new Phaser.Events(this);this._bounds=new Phaser.Rectangle;this.components.PhysicsBody&&(this.body=this.body);this.components.Animation&&(this.animations=new Phaser.AnimationManager(this));this.components.LoadTexture&&null!==d&&this.loadTexture(d,e);this.components.FixedToCamera&&(this.cameraOffset=new Phaser.Point(b,
c))};
Phaser.Component.Core.preUpdate=function(){if(this.pendingDestroy)this.destroy();else{this.previousPosition.set(this.world.x,this.world.y);this.previousRotation=this.rotation;if(!this.exists||!this.parent.exists)return this.renderOrderID=-1,!1;this.world.setTo(this.game.camera.x+this.worldTransform.tx,this.game.camera.y+this.worldTransform.ty);this.visible&&(this.renderOrderID=this.game.stage.currentRenderOrderID++);this.animations&&this.animations.update();this.body&&this.body.preUpdate();for(var a=0;a<
this.children.length;a++)this.children[a].preUpdate();return!0}};
Phaser.Component.Core.prototype={game:null,name:"",data:{},components:{},z:0,events:void 0,animations:void 0,key:"",world:null,debug:!1,previousPosition:null,previousRotation:0,renderOrderID:0,fresh:!0,pendingDestroy:!1,_bounds:null,_exists:!0,exists:{get:function(){return this._exists},set:function(a){a?(this._exists=!0,this.body&&this.body.type===Phaser.Physics.P2JS&&this.body.addToWorld(),this.visible=!0):(this._exists=!1,this.body&&this.body.type===Phaser.Physics.P2JS&&this.body.removeFromWorld(),
this.visible=!1)}},update:function(){},postUpdate:function(){this.customRender&&this.key.render();this.components.PhysicsBody&&Phaser.Component.PhysicsBody.postUpdate.call(this);this.components.FixedToCamera&&Phaser.Component.FixedToCamera.postUpdate.call(this);for(var a=0;a<this.children.length;a++)this.children[a].postUpdate()}};Phaser.Component.Crop=function(){};
Phaser.Component.Crop.prototype={cropRect:null,_crop:null,crop:function(a,b){void 0===b&&(b=!1);a?(b&&null!==this.cropRect?this.cropRect.setTo(a.x,a.y,a.width,a.height):this.cropRect=b&&null===this.cropRect?new Phaser.Rectangle(a.x,a.y,a.width,a.height):a,this.updateCrop()):(this.cropRect=this._crop=null,this.resetFrame())},updateCrop:function(){if(this.cropRect){var a=this.texture.crop.x,b=this.texture.crop.y,c=this.texture.crop.width,d=this.texture.crop.height;this._crop=Phaser.Rectangle.clone(this.cropRect,
this._crop);this._crop.x+=this._frame.x;this._crop.y+=this._frame.y;var e=Math.max(this._frame.x,this._crop.x),f=Math.max(this._frame.y,this._crop.y),g=Math.min(this._frame.right,this._crop.right)-e,h=Math.min(this._frame.bottom,this._crop.bottom)-f;this.texture.crop.x=e;this.texture.crop.y=f;this.texture.crop.width=g;this.texture.crop.height=h;this.texture.frame.width=Math.min(g,this.cropRect.width);this.texture.frame.height=Math.min(h,this.cropRect.height);this.texture.width=this.texture.frame.width;
this.texture.height=this.texture.frame.height;this.texture._updateUvs();16777215===this.tint||a===e&&b===f&&c===g&&d===h||(this.texture.requiresReTint=!0)}}};Phaser.Component.Delta=function(){};Phaser.Component.Delta.prototype={deltaX:{get:function(){return this.world.x-this.previousPosition.x}},deltaY:{get:function(){return this.world.y-this.previousPosition.y}},deltaZ:{get:function(){return this.rotation-this.previousRotation}}};Phaser.Component.Destroy=function(){};
Phaser.Component.Destroy.prototype={destroyPhase:!1,destroy:function(a,b){if(null!==this.game&&!this.destroyPhase){void 0===a&&(a=!0);void 0===b&&(b=!1);this.destroyPhase=!0;if(this.events)this.events.onDestroy$dispatch(this);this.parent&&(this.parent instanceof Phaser.Group?this.parent.remove(this):this.parent.removeChild(this));this.input&&this.input.destroy();this.animations&&this.animations.destroy();this.body&&this.body.destroy();this.events&&this.events.destroy();this.game.tweens.removeFrom(this);
var c=this.children.length;if(a)for(;c--;)this.children[c].destroy(a);else for(;c--;)this.removeChild(this.children[c]);this._crop&&(this.cropRect=this._crop=null);this._frame&&(this._frame=null);Phaser.Video&&this.key instanceof Phaser.Video&&this.key.onChangeSource.remove(this.resizeFrame,this);Phaser.BitmapText&&this._glyphs&&(this._glyphs=[]);this.visible=this.exists=this.alive=!1;this.game=this.mask=this.filters=null;this.data={};this.renderable=!1;this.transformCallback&&(this.transformCallbackContext=
this.transformCallback=null);this._mask=this._currentBounds=this._bounds=this.filterArea=this.worldTransform=this.stage=this.parent=this.hitArea=null;this._destroyCachedSprite();b&&this.texture.destroy(!0);this.pendingDestroy=this.destroyPhase=!1}}};Phaser.Events=function(a){this.parent=a};
Phaser.Events.prototype={destroy:function(){this._parent=null;this._onDestroy&&this._onDestroy.dispose();this._onAddedToGroup&&this._onAddedToGroup.dispose();this._onRemovedFromGroup&&this._onRemovedFromGroup.dispose();this._onRemovedFromWorld&&this._onRemovedFromWorld.dispose();this._onKilled&&this._onKilled.dispose();this._onRevived&&this._onRevived.dispose();this._onEnterBounds&&this._onEnterBounds.dispose();this._onOutOfBounds&&this._onOutOfBounds.dispose();this._onInputOver&&this._onInputOver.dispose();
this._onInputOut&&this._onInputOut.dispose();this._onInputDown&&this._onInputDown.dispose();this._onInputUp&&this._onInputUp.dispose();this._onDragStart&&this._onDragStart.dispose();this._onDragUpdate&&this._onDragUpdate.dispose();this._onDragStop&&this._onDragStop.dispose();this._onAnimationStart&&this._onAnimationStart.dispose();this._onAnimationComplete&&this._onAnimationComplete.dispose();this._onAnimationLoop&&this._onAnimationLoop.dispose()},onAddedToGroup:null,onRemovedFromGroup:null,onRemovedFromWorld:null,
onDestroy:null,onKilled:null,onRevived:null,onOutOfBounds:null,onEnterBounds:null,onInputOver:null,onInputOut:null,onInputDown:null,onInputUp:null,onDragStart:null,onDragUpdate:null,onDragStop:null,onAnimationStart:null,onAnimationComplete:null,onAnimationLoop:null};Phaser.Events.prototype.constructor=Phaser.Events;
for(var prop in Phaser.Events.prototype)Phaser.Events.prototype.hasOwnProperty(prop)&&0===prop.indexOf("on")&&null===Phaser.Events.prototype[prop]&&function(a,b){Object.defineProperty(Phaser.Events.prototype,a,{get:function(){return this[b]||(this[b]=new Phaser.Signal)}});Phaser.Events.prototype[a+"$dispatch"]=function(){return this[b]?this[b].dispatch.apply(this[b],arguments):null}}(prop,"_"+prop);Phaser.Component.FixedToCamera=function(){};
Phaser.Component.FixedToCamera.postUpdate=function(){this.fixedToCamera&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y)};Phaser.Component.FixedToCamera.prototype={_fixedToCamera:!1,fixedToCamera:{get:function(){return this._fixedToCamera},set:function(a){a?(this._fixedToCamera=!0,this.cameraOffset.set(this.x,this.y)):this._fixedToCamera=!1}},cameraOffset:new Phaser.Point};
Phaser.Component.Health=function(){};Phaser.Component.Health.prototype={health:1,maxHealth:100,damage:function(a){this.alive&&(this.health-=a,0>=this.health&&this.kill());return this},setHealth:function(a){this.health=a;this.health>this.maxHealth&&(this.health=this.maxHealth);return this},heal:function(a){this.alive&&(this.health+=a,this.health>this.maxHealth&&(this.health=this.maxHealth));return this}};Phaser.Component.InCamera=function(){};Phaser.Component.InCamera.prototype={inCamera:{get:function(){return this.game.world.camera.view.intersects(this._bounds)}}};
Phaser.Component.InputEnabled=function(){};Phaser.Component.InputEnabled.prototype={input:null,inputEnabled:{get:function(){return this.input&&this.input.enabled},set:function(a){a?null===this.input?(this.input=new Phaser.InputHandler(this),this.input.start()):this.input&&!this.input.enabled&&this.input.start():this.input&&this.input.enabled&&this.input.stop()}}};Phaser.Component.InWorld=function(){};
Phaser.Component.InWorld.preUpdate=function(){if(this.autoCull||this.checkWorldBounds){this._bounds.copyFrom(this.getBounds());this._bounds.x+=this.game.camera.view.x;this._bounds.y+=this.game.camera.view.y;if(this.autoCull)if(this.game.world.camera.view.intersects(this._bounds))this.renderable=!0,this.game.world.camera.totalInView++;else if(this.renderable=!1,this.outOfCameraBoundsKill)return this.kill(),!1;if(this.checkWorldBounds)if(this._outOfBoundsFired&&this.game.world.bounds.intersects(this._bounds))this._outOfBoundsFired=
!1,this.events.onEnterBounds$dispatch(this);else if(!this._outOfBoundsFired&&!this.game.world.bounds.intersects(this._bounds)&&(this._outOfBoundsFired=!0,this.events.onOutOfBounds$dispatch(this),this.outOfBoundsKill))return this.kill(),!1}return!0};Phaser.Component.InWorld.prototype={checkWorldBounds:!1,outOfBoundsKill:!1,outOfCameraBoundsKill:!1,_outOfBoundsFired:!1,inWorld:{get:function(){return this.game.world.bounds.intersects(this.getBounds())}}};Phaser.Component.LifeSpan=function(){};
Phaser.Component.LifeSpan.preUpdate=function(){return 0<this.lifespan&&(this.lifespan-=this.game.time.physicsElapsedMS,0>=this.lifespan)?(this.kill(),!1):!0};
Phaser.Component.LifeSpan.prototype={alive:!0,lifespan:0,revive:function(a){void 0===a&&(a=100);this.visible=this.exists=this.alive=!0;"function"===typeof this.setHealth&&this.setHealth(a);if(this.events)this.events.onRevived$dispatch(this);return this},kill:function(){this.visible=this.exists=this.alive=!1;if(this.events)this.events.onKilled$dispatch(this);return this}};Phaser.Component.LoadTexture=function(){};
Phaser.Component.LoadTexture.prototype={customRender:!1,_frame:null,loadTexture:function(a,b,c){a===Phaser.PENDING_ATLAS?(a=b,b=0):b=b||0;(c||void 0===c)&&this.animations&&this.animations.stop();this.key=a;this.customRender=!1;var d=this.game.cache,e=!0;c=!this.texture.baseTexture.scaleMode;Phaser.RenderTexture&&a instanceof Phaser.RenderTexture?(this.key=a.key,this.setTexture(a)):Phaser.BitmapData&&a instanceof Phaser.BitmapData?(this.customRender=!0,this.setTexture(a.texture),e=d.hasFrameData(a.key,
Phaser.Cache.BITMAPDATA)?!this.animations.loadFrameData(d.getFrameData(a.key,Phaser.Cache.BITMAPDATA),b):!this.animations.loadFrameData(a.frameData,0)):Phaser.Video&&a instanceof Phaser.Video?(this.customRender=!0,b=a.texture.valid,this.setTexture(a.texture),this.setFrame(a.texture.frame.clone()),a.onChangeSource.add(this.resizeFrame,this),this.texture.valid=b):Phaser.Tilemap&&a instanceof Phaser.TilemapLayer?this.setTexture(PIXI.Texture.fromCanvas(a.canvas)):a instanceof PIXI.Texture?this.setTexture(a):
(e=d.getImage(a,!0),this.key=e.key,this.setTexture(new PIXI.Texture(e.base)),this.texture.baseTexture.skipRender="__default"===a?!0:!1,e=!this.animations.loadFrameData(e.frameData,b));e&&(this._frame=Phaser.Rectangle.clone(this.texture.frame));c||(this.texture.baseTexture.scaleMode=1)},setFrame:function(a){this._frame=a;this.texture.frame.x=a.x;this.texture.frame.y=a.y;this.texture.frame.width=a.width;this.texture.frame.height=a.height;this.texture.crop.x=a.x;this.texture.crop.y=a.y;this.texture.crop.width=
a.width;this.texture.crop.height=a.height;a.trimmed?(this.texture.trim?(this.texture.trim.x=a.spriteSourceSizeX,this.texture.trim.y=a.spriteSourceSizeY,this.texture.trim.width=a.sourceSizeW,this.texture.trim.height=a.sourceSizeH):this.texture.trim={x:a.spriteSourceSizeX,y:a.spriteSourceSizeY,width:a.sourceSizeW,height:a.sourceSizeH},this.texture.width=a.sourceSizeW,this.texture.height=a.sourceSizeH,this.texture.frame.width=a.sourceSizeW,this.texture.frame.height=a.sourceSizeH):!a.trimmed&&this.texture.trim&&
(this.texture.trim=null);this.cropRect&&this.updateCrop();this.texture.requiresReTint=!0;this.texture._updateUvs();this.tilingTexture&&(this.refreshTexture=!0)},resizeFrame:function(a,b,c){this.texture.frame.resize(b,c);this.texture.setFrame(this.texture.frame)},resetFrame:function(){this._frame&&this.setFrame(this._frame)},frame:{get:function(){return this.animations.frame},set:function(a){this.animations.frame=a}},frameName:{get:function(){return this.animations.frameName},set:function(a){this.animations.frameName=
a}}};Phaser.Component.Overlap=function(){};Phaser.Component.Overlap.prototype={overlap:function(a){return Phaser.Rectangle.intersects(this.getBounds(),a.getBounds())}};Phaser.Component.PhysicsBody=function(){};
Phaser.Component.PhysicsBody.preUpdate=function(){if(this.fresh&&this.exists)return this.world.setTo(this.parent.position.x+this.position.x,this.parent.position.y+this.position.y),this.worldTransform.tx=this.world.x,this.worldTransform.ty=this.world.y,this.previousPosition.set(this.world.x,this.world.y),this.previousRotation=this.rotation,this.body&&this.body.preUpdate(),this.fresh=!1;this.previousPosition.set(this.world.x,this.world.y);this.previousRotation=this.rotation;return this._exists&&this.parent.exists?
!0:(this.renderOrderID=-1,!1)};Phaser.Component.PhysicsBody.postUpdate=function(){this.exists&&this.body&&this.body.postUpdate()};Phaser.Component.PhysicsBody.prototype={body:null,x:{get:function(){return this.position.x},set:function(a){this.position.x=a;this.body&&!this.body.dirty&&(this.body._reset=!0)}},y:{get:function(){return this.position.y},set:function(a){this.position.y=a;this.body&&!this.body.dirty&&(this.body._reset=!0)}}};Phaser.Component.Reset=function(){};
Phaser.Component.Reset.prototype.reset=function(a,b,c){void 0===c&&(c=1);this.world.set(a,b);this.position.set(a,b);this.renderable=this.visible=this.exists=this.fresh=!0;this.components.InWorld&&(this._outOfBoundsFired=!1);this.components.LifeSpan&&(this.alive=!0,this.health=c);this.components.PhysicsBody&&this.body&&this.body.reset(a,b,!1,!1);return this};Phaser.Component.ScaleMinMax=function(){};
Phaser.Component.ScaleMinMax.prototype={transformCallback:null,transformCallbackContext:this,scaleMin:null,scaleMax:null,checkTransform:function(a){this.scaleMin&&(a.a<this.scaleMin.x&&(a.a=this.scaleMin.x),a.d<this.scaleMin.y&&(a.d=this.scaleMin.y));this.scaleMax&&(a.a>this.scaleMax.x&&(a.a=this.scaleMax.x),a.d>this.scaleMax.y&&(a.d=this.scaleMax.y))},setScaleMinMax:function(a,b,c,d){void 0===b?b=c=d=a:void 0===c&&(c=d=b,b=a);null===a?this.scaleMin=null:this.scaleMin?this.scaleMin.set(a,b):this.scaleMin=
new Phaser.Point(a,b);null===c?this.scaleMax=null:this.scaleMax?this.scaleMax.set(c,d):this.scaleMax=new Phaser.Point(c,d);null===this.scaleMin?this.transformCallback=null:(this.transformCallback=this.checkTransform,this.transformCallbackContext=this)}};Phaser.Component.Smoothed=function(){};
Phaser.Component.Smoothed.prototype={smoothed:{get:function(){return!this.texture.baseTexture.scaleMode},set:function(a){a?this.texture&&(this.texture.baseTexture.scaleMode=0):this.texture&&(this.texture.baseTexture.scaleMode=1)}}};Phaser.GameObjectFactory=function(a){this.game=a;this.world=this.game.world};
Phaser.GameObjectFactory.prototype={existing:function(a){return this.world.add(a)},weapon:function(a,b,c,d){var e=this.game.plugins.add(Phaser.Weapon);e.createBullets(a,b,c,d);return e},image:function(a,b,c,d,e){void 0===e&&(e=this.world);return e.add(new Phaser.Image(this.game,a,b,c,d))},sprite:function(a,b,c,d,e){void 0===e&&(e=this.world);return e.create(a,b,c,d)},creature:function(a,b,c,d,e){void 0===e&&(e=this.world);a=new Phaser.Creature(this.game,a,b,c,d);e.add(a);return a},tween:function(a){return this.game.tweens.create(a)},
group:function(a,b,c,d,e){return new Phaser.Group(this.game,a,b,c,d,e)},physicsGroup:function(a,b,c,d){return new Phaser.Group(this.game,b,c,d,!0,a)},spriteBatch:function(a,b,c){void 0===a&&(a=null);void 0===b&&(b="group");void 0===c&&(c=!1);return new Phaser.SpriteBatch(this.game,a,b,c)},audio:function(a,b,c,d){return this.game.sound.add(a,b,c,d)},sound:function(a,b,c,d){return this.game.sound.add(a,b,c,d)},audioSprite:function(a){return this.game.sound.addSprite(a)},tileSprite:function(a,b,c,d,
e,f,g){void 0===g&&(g=this.world);return g.add(new Phaser.TileSprite(this.game,a,b,c,d,e,f))},rope:function(a,b,c,d,e,f){void 0===f&&(f=this.world);return f.add(new Phaser.Rope(this.game,a,b,c,d,e))},text:function(a,b,c,d,e){void 0===e&&(e=this.world);return e.add(new Phaser.Text(this.game,a,b,c,d))},button:function(a,b,c,d,e,f,g,h,k,l){void 0===l&&(l=this.world);return l.add(new Phaser.Button(this.game,a,b,c,d,e,f,g,h,k))},graphics:function(a,b,c){void 0===c&&(c=this.world);return c.add(new Phaser.Graphics(this.game,
a,b))},emitter:function(a,b,c){return this.game.particles.add(new Phaser.Particles.Arcade.Emitter(this.game,a,b,c))},retroFont:function(a,b,c,d,e,f,g,h,k){return new Phaser.RetroFont(this.game,a,b,c,d,e,f,g,h,k)},bitmapText:function(a,b,c,d,e,f){void 0===f&&(f=this.world);return f.add(new Phaser.BitmapText(this.game,a,b,c,d,e))},tilemap:function(a,b,c,d,e){return new Phaser.Tilemap(this.game,a,b,c,d,e)},renderTexture:function(a,b,c,d){if(void 0===c||""===c)c=this.game.rnd.uuid();void 0===d&&(d=!1);
a=new Phaser.RenderTexture(this.game,a,b,c);d&&this.game.cache.addRenderTexture(c,a);return a},video:function(a,b){return new Phaser.Video(this.game,a,b)},bitmapData:function(a,b,c,d){void 0===d&&(d=!1);if(void 0===c||""===c)c=this.game.rnd.uuid();a=new Phaser.BitmapData(this.game,c,a,b);d&&this.game.cache.addBitmapData(c,a);return a},filter:function(a){var b=Array.prototype.slice.call(arguments,1);a=new Phaser.Filter[a](this.game);a.init.apply(a,b);return a},plugin:function(a){return this.game.plugins.add(a)}};
Phaser.GameObjectFactory.prototype.constructor=Phaser.GameObjectFactory;Phaser.GameObjectCreator=function(a){this.game=a;this.world=this.game.world};
Phaser.GameObjectCreator.prototype={image:function(a,b,c,d){return new Phaser.Image(this.game,a,b,c,d)},sprite:function(a,b,c,d){return new Phaser.Sprite(this.game,a,b,c,d)},tween:function(a){return new Phaser.Tween(a,this.game,this.game.tweens)},group:function(a,b,c,d,e){return new Phaser.Group(this.game,a,b,c,d,e)},spriteBatch:function(a,b,c){void 0===b&&(b="group");void 0===c&&(c=!1);return new Phaser.SpriteBatch(this.game,a,b,c)},audio:function(a,b,c,d){return this.game.sound.add(a,b,c,d)},audioSprite:function(a){return this.game.sound.addSprite(a)},
sound:function(a,b,c,d){return this.game.sound.add(a,b,c,d)},tileSprite:function(a,b,c,d,e,f){return new Phaser.TileSprite(this.game,a,b,c,d,e,f)},rope:function(a,b,c,d,e){return new Phaser.Rope(this.game,a,b,c,d,e)},text:function(a,b,c,d){return new Phaser.Text(this.game,a,b,c,d)},button:function(a,b,c,d,e,f,g,h,k){return new Phaser.Button(this.game,a,b,c,d,e,f,g,h,k)},graphics:function(a,b){return new Phaser.Graphics(this.game,a,b)},emitter:function(a,b,c){return new Phaser.Particles.Arcade.Emitter(this.game,
a,b,c)},retroFont:function(a,b,c,d,e,f,g,h,k){return new Phaser.RetroFont(this.game,a,b,c,d,e,f,g,h,k)},bitmapText:function(a,b,c,d,e,f){return new Phaser.BitmapText(this.game,a,b,c,d,e,f)},tilemap:function(a,b,c,d,e){return new Phaser.Tilemap(this.game,a,b,c,d,e)},renderTexture:function(a,b,c,d){if(void 0===c||""===c)c=this.game.rnd.uuid();void 0===d&&(d=!1);a=new Phaser.RenderTexture(this.game,a,b,c);d&&this.game.cache.addRenderTexture(c,a);return a},bitmapData:function(a,b,c,d){void 0===d&&(d=
!1);if(void 0===c||""===c)c=this.game.rnd.uuid();a=new Phaser.BitmapData(this.game,c,a,b);d&&this.game.cache.addBitmapData(c,a);return a},filter:function(a){var b=Array.prototype.slice.call(arguments,1);a=new Phaser.Filter[a](this.game);a.init.apply(a,b);return a}};Phaser.GameObjectCreator.prototype.constructor=Phaser.GameObjectCreator;
Phaser.Sprite=function(a,b,c,d,e){b=b||0;c=c||0;d=d||null;e=e||null;this.physicsType=this.type=Phaser.SPRITE;PIXI.Sprite.call(this,Phaser.Cache.DEFAULT);Phaser.Component.Core.init.call(this,a,b,c,d,e)};Phaser.Sprite.prototype=Object.create(PIXI.Sprite.prototype);Phaser.Sprite.prototype.constructor=Phaser.Sprite;Phaser.Component.Core.install.call(Phaser.Sprite.prototype,"Angle Animation AutoCull Bounds BringToTop Crop Delta Destroy FixedToCamera Health InCamera InputEnabled InWorld LifeSpan LoadTexture Overlap PhysicsBody Reset ScaleMinMax Smoothed".split(" "));
Phaser.Sprite.prototype.preUpdatePhysics=Phaser.Component.PhysicsBody.preUpdate;Phaser.Sprite.prototype.preUpdateLifeSpan=Phaser.Component.LifeSpan.preUpdate;Phaser.Sprite.prototype.preUpdateInWorld=Phaser.Component.InWorld.preUpdate;Phaser.Sprite.prototype.preUpdateCore=Phaser.Component.Core.preUpdate;Phaser.Sprite.prototype.preUpdate=function(){return this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1};
Phaser.Image=function(a,b,c,d,e){b=b||0;c=c||0;d=d||null;e=e||null;this.type=Phaser.IMAGE;PIXI.Sprite.call(this,Phaser.Cache.DEFAULT);Phaser.Component.Core.init.call(this,a,b,c,d,e)};Phaser.Image.prototype=Object.create(PIXI.Sprite.prototype);Phaser.Image.prototype.constructor=Phaser.Image;Phaser.Component.Core.install.call(Phaser.Image.prototype,"Angle Animation AutoCull Bounds BringToTop Crop Destroy FixedToCamera InputEnabled LifeSpan LoadTexture Overlap Reset ScaleMinMax Smoothed".split(" "));
Phaser.Image.prototype.preUpdateInWorld=Phaser.Component.InWorld.preUpdate;Phaser.Image.prototype.preUpdateCore=Phaser.Component.Core.preUpdate;Phaser.Image.prototype.preUpdate=function(){return this.preUpdateInWorld()?this.preUpdateCore():!1};
Phaser.Button=function(a,b,c,d,e,f,g,h,k,l){e=e||null;f=f||this;Phaser.Image.call(this,a,b||0,c||0,d||null,h);this.type=Phaser.BUTTON;this.physicsType=Phaser.SPRITE;this.onUpSound=this.onDownSound=this.onOutSound=this.onOverSound=this._onUpFrame=this._onDownFrame=this._onOutFrame=this._onOverFrame=null;this.onUpSoundMarker=this.onDownSoundMarker=this.onOutSoundMarker=this.onOverSoundMarker="";this.onInputOver=new Phaser.Signal;this.onInputOut=new Phaser.Signal;this.onInputDown=new Phaser.Signal;this.onInputUp=
new Phaser.Signal;this.onOverMouseOnly=!0;this.justReleasedPreventsOver=Phaser.PointerMode.TOUCH;this.forceOut=this.freezeFrames=!1;this.inputState="Up";this.inputEnabled=!0;this.input.start(0,!0);this.input.useHandCursor=!0;this.setFrames(g,h,k,l);null!==e&&this.onInputUp.add(e,f);this.events.onInputOver.add(this.onInputOverHandler,this);this.events.onInputOut.add(this.onInputOutHandler,this);this.events.onInputDown.add(this.onInputDownHandler,this);this.events.onInputUp.add(this.onInputUpHandler,
this);this.events.onRemovedFromWorld.add(this.removedFromWorld,this)};Phaser.Button.prototype=Object.create(Phaser.Image.prototype);Phaser.Button.prototype.constructor=Phaser.Button;var STATE_OVER="Over",STATE_OUT="Out",STATE_DOWN="Down",STATE_UP="Up";Phaser.Button.prototype.clearFrames=function(){this.setFrames(null,null,null,null)};Phaser.Button.prototype.removedFromWorld=function(){this.inputEnabled=!1};
Phaser.Button.prototype.setStateFrame=function(a,b,c){var d="_on"+a+"Frame";null!==b?(this[d]=b,c&&this.changeStateFrame(a)):this[d]=null};Phaser.Button.prototype.changeStateFrame=function(a){if(this.freezeFrames)return!1;var b=this["_on"+a+"Frame"];return"string"===typeof b?(this.inputState=a,this.frameName=b,!0):"number"===typeof b?(this.inputState=a,this.frame=b,!0):!1};
Phaser.Button.prototype.setFrames=function(a,b,c,d){this.setStateFrame(STATE_OVER,a,this.input.pointerOver());this.setStateFrame(STATE_OUT,b,!this.input.pointerOver());this.setStateFrame(STATE_DOWN,c,this.input.pointerDown());this.setStateFrame(STATE_UP,d,this.input.pointerUp())};
Phaser.Button.prototype.setStateSound=function(a,b,c){var d="on"+a+"Sound";a="on"+a+"SoundMarker";b instanceof Phaser.Sound||b instanceof Phaser.AudioSprite?(this[d]=b,this[a]="string"===typeof c?c:""):(this[d]=null,this[a]="")};Phaser.Button.prototype.playStateSound=function(a){var b=this["on"+a+"Sound"];return b?(b.play(this["on"+a+"SoundMarker"]),!0):!1};
Phaser.Button.prototype.setSounds=function(a,b,c,d,e,f,g,h){this.setStateSound(STATE_OVER,a,b);this.setStateSound(STATE_OUT,e,f);this.setStateSound(STATE_DOWN,c,d);this.setStateSound(STATE_UP,g,h)};Phaser.Button.prototype.setOverSound=function(a,b){this.setStateSound(STATE_OVER,a,b)};Phaser.Button.prototype.setOutSound=function(a,b){this.setStateSound(STATE_OUT,a,b)};Phaser.Button.prototype.setDownSound=function(a,b){this.setStateSound(STATE_DOWN,a,b)};
Phaser.Button.prototype.setUpSound=function(a,b){this.setStateSound(STATE_UP,a,b)};Phaser.Button.prototype.onInputOverHandler=function(a,b){if(!b.justReleased()||(this.justReleasedPreventsOver&b.pointerMode)!==b.pointerMode)if(this.changeStateFrame(STATE_OVER),!this.onOverMouseOnly||b.isMouse)this.playStateSound(STATE_OVER),this.onInputOver&&this.onInputOver.dispatch(this,b)};
Phaser.Button.prototype.onInputOutHandler=function(a,b){this.changeStateFrame(STATE_OUT);this.playStateSound(STATE_OUT);this.onInputOut&&this.onInputOut.dispatch(this,b)};Phaser.Button.prototype.onInputDownHandler=function(a,b){this.changeStateFrame(STATE_DOWN);this.playStateSound(STATE_DOWN);this.onInputDown&&this.onInputDown.dispatch(this,b)};
Phaser.Button.prototype.onInputUpHandler=function(a,b,c){this.playStateSound(STATE_UP);this.onInputUp&&this.onInputUp.dispatch(this,b,c);this.freezeFrames||(!0===this.forceOut||(this.forceOut&b.pointerMode)===b.pointerMode?this.changeStateFrame(STATE_OUT):this.changeStateFrame(STATE_UP)||(c?this.changeStateFrame(STATE_OVER):this.changeStateFrame(STATE_OUT)))};
Phaser.SpriteBatch=function(a,b,c,d){if(void 0===b||null===b)b=a.world;PIXI.SpriteBatch.call(this);Phaser.Group.call(this,a,b,c,d);this.type=Phaser.SPRITEBATCH};Phaser.SpriteBatch.prototype=Phaser.Utils.extend(!0,Phaser.SpriteBatch.prototype,PIXI.SpriteBatch.prototype,Phaser.Group.prototype);Phaser.SpriteBatch.prototype.constructor=Phaser.SpriteBatch;
Phaser.BitmapData=function(a,b,c,d,e){if(void 0===c||0===c)c=256;if(void 0===d||0===d)d=256;void 0===e&&(e=!1);this.game=a;this.key=b;this.width=c;this.height=d;this.canvas=Phaser.Canvas.create(this,c,d,null,e);this.ctx=this.context=this.canvas.getContext("2d",{alpha:!0});this.smoothProperty=a.renderType===Phaser.CANVAS?a.renderer.renderSession.smoothProperty:Phaser.Canvas.getSmoothingPrefix(this.context);this.imageData=this.context.getImageData(0,0,c,d);this.data=null;this.imageData&&(this.data=
this.imageData.data);this.pixels=null;this.data&&(this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data);this.baseTexture=new PIXI.BaseTexture(this.canvas);this.texture=new PIXI.Texture(this.baseTexture);this.frameData=new Phaser.FrameData;this.textureFrame=this.frameData.addFrame(new Phaser.Frame(0,
0,0,c,d,"bitmapData"));this.texture.frame=this.textureFrame;this.type=Phaser.BITMAPDATA;this.dirty=this.disableTextureUpload=!1;this.cls=this.clear;this._image=null;this._pos=new Phaser.Point;this._size=new Phaser.Point;this._scale=new Phaser.Point;this._rotate=0;this._alpha={prev:1,current:1};this._anchor=new Phaser.Point;this._tempB=this._tempG=this._tempR=0;this._circle=new Phaser.Circle;this._swapCanvas=void 0};
Phaser.BitmapData.prototype={move:function(a,b,c){0!==a&&this.moveH(a,c);0!==b&&this.moveV(b,c);return this},moveH:function(a,b){void 0===b&&(b=!0);void 0===this._swapCanvas&&(this._swapCanvas=PIXI.CanvasPool.create(this,this.width,this.height));var c=this._swapCanvas.getContext("2d"),d=this.height,e=this.canvas;c.clearRect(0,0,this.width,this.height);if(0>a){a=Math.abs(a);var f=this.width-a;b&&c.drawImage(e,0,0,a,d,f,0,a,d);c.drawImage(e,a,0,f,d,0,0,f,d)}else f=this.width-a,b&&c.drawImage(e,f,0,
a,d,0,0,a,d),c.drawImage(e,0,0,f,d,a,0,f,d);this.clear();return this.copy(this._swapCanvas)},moveV:function(a,b){void 0===b&&(b=!0);void 0===this._swapCanvas&&(this._swapCanvas=PIXI.CanvasPool.create(this,this.width,this.height));var c=this._swapCanvas.getContext("2d"),d=this.width,e=this.canvas;c.clearRect(0,0,this.width,this.height);if(0>a){a=Math.abs(a);var f=this.height-a;b&&c.drawImage(e,0,0,d,a,0,f,d,a);c.drawImage(e,0,a,d,f,0,0,d,f)}else f=this.height-a,b&&c.drawImage(e,0,f,d,a,0,0,d,a),c.drawImage(e,
0,0,d,f,0,a,d,f);this.clear();return this.copy(this._swapCanvas)},add:function(a){if(Array.isArray(a))for(var b=0;b<a.length;b++)a[b].loadTexture&&a[b].loadTexture(this);else a.loadTexture(this);return this},load:function(a){"string"===typeof a&&(a=this.game.cache.getImage(a));if(a)return this.resize(a.width,a.height),this.cls(),this.draw(a),this.update(),this},clear:function(a,b,c,d){void 0===a&&(a=0);void 0===b&&(b=0);void 0===c&&(c=this.width);void 0===d&&(d=this.height);this.context.clearRect(a,
b,c,d);this.dirty=!0;return this},fill:function(a,b,c,d){void 0===d&&(d=1);this.context.fillStyle="rgba("+a+","+b+","+c+","+d+")";this.context.fillRect(0,0,this.width,this.height);this.dirty=!0;return this},generateTexture:function(a){var b=new Image;b.src=this.canvas.toDataURL("image/png");a=this.game.cache.addImage(a,"",b);return new PIXI.Texture(a.base)},resize:function(a,b){if(a!==this.width||b!==this.height)this.width=a,this.height=b,this.canvas.width=a,this.canvas.height=b,void 0!==this._swapCanvas&&
(this._swapCanvas.width=a,this._swapCanvas.height=b),this.baseTexture.width=a,this.baseTexture.height=b,this.textureFrame.width=a,this.textureFrame.height=b,this.texture.width=a,this.texture.height=b,this.texture.crop.width=a,this.texture.crop.height=b,this.update(),this.dirty=!0;return this},update:function(a,b,c,d){void 0===a&&(a=0);void 0===b&&(b=0);void 0===c&&(c=Math.max(1,this.width));void 0===d&&(d=Math.max(1,this.height));this.imageData=this.context.getImageData(a,b,c,d);this.data=this.imageData.data;
this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data;return this},processPixelRGB:function(a,b,c,d,e,f){void 0===c&&(c=0);void 0===d&&(d=0);void 0===e&&(e=this.width);void 0===f&&(f=this.height);e=c+e;f=d+f;for(var g=Phaser.Color.createColor(),h={r:0,g:0,b:0,a:0},k=!1;d<f;d++)for(var l=c;l<e;l++)Phaser.Color.unpackPixel(this.getPixel32(l,
d),g),h=a.call(b,g,l,d),!1!==h&&null!==h&&void 0!==h&&(this.setPixel32(l,d,h.r,h.g,h.b,h.a,!1),k=!0);k&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0);return this},processPixel:function(a,b,c,d,e,f){void 0===c&&(c=0);void 0===d&&(d=0);void 0===e&&(e=this.width);void 0===f&&(f=this.height);e=c+e;f=d+f;for(var g=0,h=0,k=!1;d<f;d++)for(var l=c;l<e;l++)g=this.getPixel32(l,d),h=a.call(b,g,l,d),h!==g&&(this.pixels[d*this.width+l]=h,k=!0);k&&(this.context.putImageData(this.imageData,0,0),
this.dirty=!0);return this},replaceRGB:function(a,b,c,d,e,f,g,h,k){var l=0,m=0,n=this.width,p=this.height;a=Phaser.Color.packPixel(a,b,c,d);void 0!==k&&k instanceof Phaser.Rectangle&&(l=k.x,m=k.y,n=k.width,p=k.height);for(k=0;k<p;k++)for(b=0;b<n;b++)this.getPixel32(l+b,m+k)===a&&this.setPixel32(l+b,m+k,e,f,g,h,!1);this.context.putImageData(this.imageData,0,0);this.dirty=!0;return this},setHSL:function(a,b,c,d){var e=a||0===a,f=b||0===b,g=c||0===c;if(e||f||g){void 0===d&&(d=new Phaser.Rectangle(0,
0,this.width,this.height));for(var h=Phaser.Color.createColor(),k=d.y;k<d.bottom;k++)for(var l=d.x;l<d.right;l++)Phaser.Color.unpackPixel(this.getPixel32(l,k),h,!0),e&&(h.h=a),f&&(h.s=b),g&&(h.l=c),Phaser.Color.HSLtoRGB(h.h,h.s,h.l,h),this.setPixel32(l,k,h.r,h.g,h.b,h.a,!1);this.context.putImageData(this.imageData,0,0);this.dirty=!0;return this}},shiftHSL:function(a,b,c,d){if(void 0===a||null===a)a=!1;if(void 0===b||null===b)b=!1;if(void 0===c||null===c)c=!1;if(a||b||c){void 0===d&&(d=new Phaser.Rectangle(0,
0,this.width,this.height));for(var e=Phaser.Color.createColor(),f=d.y;f<d.bottom;f++)for(var g=d.x;g<d.right;g++)Phaser.Color.unpackPixel(this.getPixel32(g,f),e,!0),a&&(e.h=this.game.math.wrap(e.h+a,0,1)),b&&(e.s=this.game.math.clamp(e.s+b,0,1)),c&&(e.l=this.game.math.clamp(e.l+c,0,1)),Phaser.Color.HSLtoRGB(e.h,e.s,e.l,e),this.setPixel32(g,f,e.r,e.g,e.b,e.a,!1);this.context.putImageData(this.imageData,0,0);this.dirty=!0;return this}},setPixel32:function(a,b,c,d,e,f,g){void 0===g&&(g=!0);0<=a&&a<=
this.width&&0<=b&&b<=this.height&&(this.pixels[b*this.width+a]=Phaser.Device.LITTLE_ENDIAN?f<<24|e<<16|d<<8|c:c<<24|d<<16|e<<8|f,g&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0));return this},setPixel:function(a,b,c,d,e,f){return this.setPixel32(a,b,c,d,e,255,f)},getPixel:function(a,b,c){c||(c=Phaser.Color.createColor());a=~~(a+b*this.width);a*=4;c.r=this.data[a];c.g=this.data[++a];c.b=this.data[++a];c.a=this.data[++a];return c},getPixel32:function(a,b){if(0<=a&&a<=this.width&&0<=
b&&b<=this.height)return this.pixels[b*this.width+a]},getPixelRGB:function(a,b,c,d,e){return Phaser.Color.unpackPixel(this.getPixel32(a,b),c,d,e)},getPixels:function(a){return this.context.getImageData(a.x,a.y,a.width,a.height)},getFirstPixel:function(a){void 0===a&&(a=0);var b=Phaser.Color.createColor(),c=0,d=0,e=1,f=!1;1===a?(e=-1,d=this.height):3===a&&(e=-1,c=this.width);do if(Phaser.Color.unpackPixel(this.getPixel32(c,d),b),0===a||1===a){if(c++,c===this.width&&(c=0,d+=e,d>=this.height||0>=d))f=
!0}else if(2===a||3===a)if(d++,d===this.height&&(d=0,c+=e,c>=this.width||0>=c))f=!0;while(0===b.a&&!f);b.x=c;b.y=d;return b},getBounds:function(a){void 0===a&&(a=new Phaser.Rectangle);a.x=this.getFirstPixel(2).x;if(a.x===this.width)return a.setTo(0,0,0,0);a.y=this.getFirstPixel(0).y;a.width=this.getFirstPixel(3).x-a.x+1;a.height=this.getFirstPixel(1).y-a.y+1;return a},addToWorld:function(a,b,c,d,e,f){e=e||1;f=f||1;a=this.game.add.image(a,b,this);a.anchor.set(c,d);a.scale.set(e,f);return a},copy:function(a,
b,c,d,e,f,g,h,k,l,m,n,p,q,t,r,F){if(void 0===a||null===a)a=this;if(a instanceof Phaser.RenderTexture||a instanceof PIXI.RenderTexture)a=a.getCanvas();this._image=a;if(a instanceof Phaser.Sprite||a instanceof Phaser.Image||a instanceof Phaser.Text||a instanceof PIXI.Sprite){this._pos.set(a.texture.crop.x,a.texture.crop.y);this._size.set(a.texture.crop.width,a.texture.crop.height);this._scale.set(a.scale.x,a.scale.y);this._anchor.set(a.anchor.x,a.anchor.y);this._rotate=a.rotation;this._alpha.current=
a.alpha;this._image=a.texture instanceof Phaser.RenderTexture||a.texture instanceof PIXI.RenderTexture?a.texture.getCanvas():a.texture.baseTexture.source;if(void 0===f||null===f)f=a.x;if(void 0===g||null===g)g=a.y;a.texture.trim&&(f+=a.texture.trim.x-a.anchor.x*a.texture.trim.width,g+=a.texture.trim.y-a.anchor.y*a.texture.trim.height);16777215!==a.tint&&(a.cachedTint!==a.tint&&(a.cachedTint=a.tint,a.tintedTexture=PIXI.CanvasTinter.getTintedTexture(a,a.tint)),this._image=a.tintedTexture,this._pos.set(0))}else{this._pos.set(0);
this._scale.set(1);this._anchor.set(0);this._rotate=0;this._alpha.current=1;if(a instanceof Phaser.BitmapData)this._image=a.canvas;else if("string"===typeof a){a=this.game.cache.getImage(a);if(null===a)return;this._image=a}this._size.set(this._image.width,this._image.height)}if(void 0===b||null===b)b=0;if(void 0===c||null===c)c=0;d&&(this._size.x=d);e&&(this._size.y=e);if(void 0===f||null===f)f=b;if(void 0===g||null===g)g=c;if(void 0===h||null===h)h=this._size.x;if(void 0===k||null===k)k=this._size.y;
"number"===typeof l&&(this._rotate=l);"number"===typeof m&&(this._anchor.x=m);"number"===typeof n&&(this._anchor.y=n);"number"===typeof p&&(this._scale.x=p);"number"===typeof q&&(this._scale.y=q);"number"===typeof t&&(this._alpha.current=t);void 0===r&&(r=null);void 0===F&&(F=!1);if(!(0>=this._alpha.current||0===this._scale.x||0===this._scale.y||0===this._size.x||0===this._size.y))return a=this.context,this._alpha.prev=a.globalAlpha,a.save(),a.globalAlpha=this._alpha.current,r&&(this.op=r),F&&(f|=
0,g|=0),a.translate(f,g),a.scale(this._scale.x,this._scale.y),a.rotate(this._rotate),a.drawImage(this._image,this._pos.x+b,this._pos.y+c,this._size.x,this._size.y,-h*this._anchor.x,-k*this._anchor.y,h,k),a.restore(),a.globalAlpha=this._alpha.prev,this.dirty=!0,this},copyTransform:function(a,b,c){void 0===b&&(b=null);void 0===c&&(c=!1);if(!a.hasOwnProperty("worldTransform")||!a.worldVisible||0===a.worldAlpha)return this;var d=a.worldTransform;this._pos.set(a.texture.crop.x,a.texture.crop.y);this._size.set(a.texture.crop.width,
a.texture.crop.height);if(0===d.a||0===d.d||0===this._size.x||0===this._size.y)return this;this._image=a.texture instanceof Phaser.RenderTexture||a.texture instanceof PIXI.RenderTexture?a.texture.getCanvas():a.texture.baseTexture.source;var e=d.tx,f=d.ty;a.texture.trim&&(e+=a.texture.trim.x-a.anchor.x*a.texture.trim.width,f+=a.texture.trim.y-a.anchor.y*a.texture.trim.height);16777215!==a.tint&&(a.cachedTint!==a.tint&&(a.cachedTint=a.tint,a.tintedTexture=PIXI.CanvasTinter.getTintedTexture(a,a.tint)),
this._image=a.tintedTexture,this._pos.set(0));c&&(e|=0,f|=0);c=this.context;this._alpha.prev=c.globalAlpha;c.save();c.globalAlpha=this._alpha.current;b&&(this.op=b);c[this.smoothProperty]=a.texture.baseTexture.scaleMode===PIXI.scaleModes.LINEAR;c.setTransform(d.a,d.b,d.c,d.d,e,f);c.drawImage(this._image,this._pos.x,this._pos.y,this._size.x,this._size.y,-this._size.x*a.anchor.x,-this._size.y*a.anchor.y,this._size.x,this._size.y);c.restore();c.globalAlpha=this._alpha.prev;this.dirty=!0;return this},
copyRect:function(a,b,c,d,e,f,g){return this.copy(a,b.x,b.y,b.width,b.height,c,d,b.width,b.height,0,0,0,1,1,e,f,g)},draw:function(a,b,c,d,e,f,g){return this.copy(a,null,null,null,null,b,c,d,e,null,null,null,null,null,null,f,g)},drawGroup:function(a,b,c){0<a.total&&a.forEachExists(this.drawGroupProxy,this,b,c);return this},drawGroupProxy:function(a,b,c){a.hasOwnProperty("texture")&&this.copyTransform(a,b,c);if(a.type===Phaser.GROUP&&a.exists)this.drawGroup(a,b,c);else if(a.hasOwnProperty("children")&&
0<a.children.length)for(var d=0;d<a.children.length;d++)a.children[d].exists&&this.copyTransform(a.children[d],b,c)},drawFull:function(a,b,c){if(!1===a.worldVisible||0===a.worldAlpha||a.hasOwnProperty("exists")&&!1===a.exists)return this;if(a.type!==Phaser.GROUP&&a.type!==Phaser.EMITTER&&a.type!==Phaser.BITMAPTEXT)if(a.type===Phaser.GRAPHICS){var d=a.getBounds();this.ctx.save();this.ctx.translate(d.x,d.y);PIXI.CanvasGraphics.renderGraphics(a,this.ctx);this.ctx.restore()}else this.copy(a,null,null,
null,null,a.worldPosition.x,a.worldPosition.y,null,null,a.worldRotation,null,null,a.worldScale.x,a.worldScale.y,a.worldAlpha,b,c);if(a.children)for(d=0;d<a.children.length;d++)this.drawFull(a.children[d],b,c);return this},shadow:function(a,b,c,d){var e=this.context;void 0===a||null===a?e.shadowColor="rgba(0,0,0,0)":(e.shadowColor=a,e.shadowBlur=b||5,e.shadowOffsetX=c||10,e.shadowOffsetY=d||10);return this},alphaMask:function(a,b,c,d){void 0===d||null===d?this.draw(b).blendSourceAtop():this.draw(b,
d.x,d.y,d.width,d.height).blendSourceAtop();void 0===c||null===c?this.draw(a).blendReset():this.draw(a,c.x,c.y,c.width,c.height).blendReset();return this},extract:function(a,b,c,d,e,f,g,h,k){void 0===e&&(e=255);void 0===f&&(f=!1);void 0===g&&(g=b);void 0===h&&(h=c);void 0===k&&(k=d);f&&a.resize(this.width,this.height);this.processPixelRGB(function(f,m,n){f.r===b&&f.g===c&&f.b===d&&a.setPixel32(m,n,g,h,k,e,!1);return!1},this);a.context.putImageData(a.imageData,0,0);a.dirty=!0;return a},rect:function(a,
b,c,d,e){"undefined"!==typeof e&&(this.context.fillStyle=e);this.context.fillRect(a,b,c,d);return this},text:function(a,b,c,d,e,f){void 0===b&&(b=0);void 0===c&&(c=0);void 0===d&&(d="14px Courier");void 0===e&&(e="rgb(255,255,255)");void 0===f&&(f=!0);var g=this.context,h=g.font;g.font=d;f&&(g.fillStyle="rgb(0,0,0)",g.fillText(a,b+1,c+1));g.fillStyle=e;g.fillText(a,b,c);g.font=h;return this},circle:function(a,b,c,d){var e=this.context;void 0!==d&&(e.fillStyle=d);e.beginPath();e.arc(a,b,c,0,2*Math.PI,
!1);e.closePath();e.fill();return this},line:function(a,b,c,d,e,f){void 0===e&&(e="#fff");void 0===f&&(f=1);var g=this.context;g.beginPath();g.moveTo(a,b);g.lineTo(c,d);g.lineWidth=f;g.strokeStyle=e;g.stroke();g.closePath();return this},textureLine:function(a,b,c){void 0===c&&(c="repeat-x");if("string"===typeof b&&(b=this.game.cache.getImage(b),!b))return;var d=a.length;"no-repeat"===c&&d>b.width&&(d=b.width);var e=this.context;e.fillStyle=e.createPattern(b,c);this._circle=new Phaser.Circle(a.start.x,
a.start.y,b.height);this._circle.circumferencePoint(a.angle-1.5707963267948966,!1,this._pos);e.save();e.translate(this._pos.x,this._pos.y);e.rotate(a.angle);e.fillRect(0,0,d,b.height);e.restore();this.dirty=!0;return this},render:function(){!this.disableTextureUpload&&this.dirty&&(this.baseTexture.dirty(),this.dirty=!1);return this},destroy:function(){this.frameData.destroy();this.texture.destroy(!0);PIXI.CanvasPool.remove(this)},blendReset:function(){this.op="source-over";return this},blendSourceOver:function(){this.op=
"source-over";return this},blendSourceIn:function(){this.op="source-in";return this},blendSourceOut:function(){this.op="source-out";return this},blendSourceAtop:function(){this.op="source-atop";return this},blendDestinationOver:function(){this.op="destination-over";return this},blendDestinationIn:function(){this.op="destination-in";return this},blendDestinationOut:function(){this.op="destination-out";return this},blendDestinationAtop:function(){this.op="destination-atop";return this},blendXor:function(){this.op=
"xor";return this},blendAdd:function(){this.op="lighter";return this},blendMultiply:function(){this.op="multiply";return this},blendScreen:function(){this.op="screen";return this},blendOverlay:function(){this.op="overlay";return this},blendDarken:function(){this.op="darken";return this},blendLighten:function(){this.op="lighten";return this},blendColorDodge:function(){this.op="color-dodge";return this},blendColorBurn:function(){this.op="color-burn";return this},blendHardLight:function(){this.op="hard-light";
return this},blendSoftLight:function(){this.op="soft-light";return this},blendDifference:function(){this.op="difference";return this},blendExclusion:function(){this.op="exclusion";return this},blendHue:function(){this.op="hue";return this},blendSaturation:function(){this.op="saturation";return this},blendColor:function(){this.op="color";return this},blendLuminosity:function(){this.op="luminosity";return this}};
Object.defineProperty(Phaser.BitmapData.prototype,"smoothed",{get:function(){Phaser.Canvas.getSmoothingEnabled(this.context)},set:function(a){Phaser.Canvas.setSmoothingEnabled(this.context,a)}});Object.defineProperty(Phaser.BitmapData.prototype,"op",{get:function(){return this.context.globalCompositeOperation},set:function(a){this.context.globalCompositeOperation=a}});
Phaser.BitmapData.getTransform=function(a,b,c,d,e,f){"number"!==typeof a&&(a=0);"number"!==typeof b&&(b=0);"number"!==typeof c&&(c=1);"number"!==typeof d&&(d=1);"number"!==typeof e&&(e=0);"number"!==typeof f&&(f=0);return{sx:c,sy:d,scaleX:c,scaleY:d,skewX:e,skewY:f,translateX:a,translateY:b,tx:a,ty:b}};Phaser.BitmapData.prototype.constructor=Phaser.BitmapData;
PIXI.Graphics=function(){PIXI.DisplayObjectContainer.call(this);this.renderable=!0;this.fillAlpha=1;this.lineColor=this.lineWidth=0;this.graphicsData=[];this.tint=16777215;this.blendMode=PIXI.blendModes.NORMAL;this.currentPath=null;this._webGL=[];this.isMask=!1;this.boundsPadding=0;this._localBounds=new PIXI.Rectangle(0,0,1,1);this.dirty=!0;this.cachedSpriteDirty=this.webGLDirty=this._boundsDirty=!1};PIXI.Graphics.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);
PIXI.Graphics.prototype.constructor=PIXI.Graphics;PIXI.Graphics.prototype.lineStyle=function(a,b,c){this.lineWidth=a||0;this.lineColor=b||0;this.lineAlpha=void 0===c?1:c;this.currentPath&&(this.currentPath.shape.points.length?this.drawShape(new PIXI.Polygon(this.currentPath.shape.points.slice(-2))):(this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha));return this};
PIXI.Graphics.prototype.moveTo=function(a,b){this.drawShape(new PIXI.Polygon([a,b]));return this};PIXI.Graphics.prototype.lineTo=function(a,b){this.currentPath||this.moveTo(0,0);this.currentPath.shape.points.push(a,b);this._boundsDirty=this.dirty=!0;return this};
PIXI.Graphics.prototype.quadraticCurveTo=function(a,b,c,d){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var e,f,g=this.currentPath.shape.points;0===g.length&&this.moveTo(0,0);for(var h=g[g.length-2],k=g[g.length-1],l=0,m=1;20>=m;++m)l=m/20,e=h+(a-h)*l,f=k+(b-k)*l,g.push(e+(a+(c-a)*l-e)*l,f+(b+(d-b)*l-f)*l);this._boundsDirty=this.dirty=!0;return this};
PIXI.Graphics.prototype.bezierCurveTo=function(a,b,c,d,e,f){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var g,h,k,l,m,n=this.currentPath.shape.points,p=n[n.length-2],q=n[n.length-1],t=0,r=1;20>=r;++r)t=r/20,g=1-t,h=g*g,k=h*g,l=t*t,m=l*t,n.push(k*p+3*h*t*a+3*g*l*c+m*e,k*q+3*h*t*b+3*g*l*d+m*f);this._boundsDirty=this.dirty=!0;return this};
PIXI.Graphics.prototype.arcTo=function(a,b,c,d,e){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(a,b):this.moveTo(a,b);var f=this.currentPath.shape.points,g=f[f.length-1]-b,h=f[f.length-2]-a;d-=b;c-=a;var k=Math.abs(g*c-h*d);if(1E-8>k||0===e)f[f.length-2]===a&&f[f.length-1]===b||f.push(a,b);else{var l=g*g+h*h,m=d*d+c*c,n=g*d+h*c,f=e*Math.sqrt(l)/k,k=e*Math.sqrt(m)/k,l=f*n/l,m=k*n/m,n=f*c+k*h,p=f*d+k*g;this.arc(n+a,p+b,e,Math.atan2(g*(k+l)-p,h*(k+l)-n),
Math.atan2(d*(f+m)-p,c*(f+m)-n),h*d>c*g)}this._boundsDirty=this.dirty=!0;return this};
PIXI.Graphics.prototype.arc=function(a,b,c,d,e,f,g){if(d===e)return this;void 0===f&&(f=!1);void 0===g&&(g=40);!f&&e<=d?e+=2*Math.PI:f&&d<=e&&(d+=2*Math.PI);e=f?-1*(d-e):e-d;var h=Math.ceil(Math.abs(e)/(2*Math.PI))*g;if(0===e)return this;g=a+Math.cos(d)*c;var k=b+Math.sin(d)*c;f&&this.filling?this.moveTo(a,b):this.moveTo(g,k);f=this.currentPath.shape.points;e/=2*h;g=2*e;for(var k=Math.cos(e),l=Math.sin(e),h=h-1,m=h%1/h,n=0;n<=h;n++){var p=e+d+g*(n+m*n),q=Math.cos(p),p=-Math.sin(p);f.push((k*q+l*p)*
c+a,(k*-p+l*q)*c+b)}this._boundsDirty=this.dirty=!0;return this};PIXI.Graphics.prototype.beginFill=function(a,b){this.filling=!0;this.fillColor=a||0;this.fillAlpha=void 0===b?1:b;this.currentPath&&2>=this.currentPath.shape.points.length&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha);return this};PIXI.Graphics.prototype.endFill=function(){this.filling=!1;this.fillColor=null;this.fillAlpha=1;return this};
PIXI.Graphics.prototype.drawRect=function(a,b,c,d){this.drawShape(new PIXI.Rectangle(a,b,c,d));return this};PIXI.Graphics.prototype.drawRoundedRect=function(a,b,c,d,e){this.drawShape(new PIXI.RoundedRectangle(a,b,c,d,e));return this};PIXI.Graphics.prototype.drawCircle=function(a,b,c){this.drawShape(new PIXI.Circle(a,b,c));return this};PIXI.Graphics.prototype.drawEllipse=function(a,b,c,d){this.drawShape(new PIXI.Ellipse(a,b,c,d));return this};
PIXI.Graphics.prototype.drawPolygon=function(a){if(a instanceof Phaser.Polygon||a instanceof PIXI.Polygon)a=a.points;var b=a;if(!Array.isArray(b))for(var b=Array(arguments.length),c=0;c<b.length;++c)b[c]=arguments[c];this.drawShape(new Phaser.Polygon(b));return this};PIXI.Graphics.prototype.clear=function(){this.lineWidth=0;this.filling=!1;this.clearDirty=this._boundsDirty=this.dirty=!0;this.graphicsData=[];this.updateLocalBounds();return this};
PIXI.Graphics.prototype.generateTexture=function(a,b,c){void 0===a&&(a=1);void 0===b&&(b=PIXI.scaleModes.DEFAULT);void 0===c&&(c=0);var d=this.getBounds();d.width+=c;d.height+=c;c=new PIXI.CanvasBuffer(d.width*a,d.height*a);b=PIXI.Texture.fromCanvas(c.canvas,b);b.baseTexture.resolution=a;c.context.scale(a,a);c.context.translate(-d.x,-d.y);PIXI.CanvasGraphics.renderGraphics(this,c.context);return b};
PIXI.Graphics.prototype._renderWebGL=function(a){if(!1!==this.visible&&0!==this.alpha&&!0!==this.isMask)if(this._cacheAsBitmap){if(this.dirty||this.cachedSpriteDirty)this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.dirty=this.cachedSpriteDirty=!1;this._cachedSprite.worldAlpha=this.worldAlpha;PIXI.Sprite.prototype._renderWebGL.call(this._cachedSprite,a)}else{a.spriteBatch.stop();a.blendModeManager.setBlendMode(this.blendMode);this._mask&&a.maskManager.pushMask(this._mask,a);this._filters&&
a.filterManager.pushFilter(this._filterBlock);if(this.blendMode!==a.spriteBatch.currentBlendMode){a.spriteBatch.currentBlendMode=this.blendMode;var b=PIXI.blendModesWebGL[a.spriteBatch.currentBlendMode];a.spriteBatch.gl.blendFunc(b[0],b[1])}this.webGLDirty&&(this.dirty=!0,this.webGLDirty=!1);PIXI.WebGLGraphics.renderGraphics(this,a);if(this.children.length){a.spriteBatch.start();for(b=0;b<this.children.length;b++)this.children[b]._renderWebGL(a);a.spriteBatch.stop()}this._filters&&a.filterManager.popFilter();
this._mask&&a.maskManager.popMask(this.mask,a);a.drawCount++;a.spriteBatch.start()}};
PIXI.Graphics.prototype._renderCanvas=function(a){if(!1!==this.visible&&0!==this.alpha&&!0!==this.isMask)if(this._prevTint!==this.tint&&(this.dirty=!0,this._prevTint=this.tint),this._cacheAsBitmap){if(this.dirty||this.cachedSpriteDirty)this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.dirty=this.cachedSpriteDirty=!1;this._cachedSprite.alpha=this.alpha;PIXI.Sprite.prototype._renderCanvas.call(this._cachedSprite,a)}else{var b=a.context,c=this.worldTransform;this.blendMode!==a.currentBlendMode&&
(a.currentBlendMode=this.blendMode,b.globalCompositeOperation=PIXI.blendModesCanvas[a.currentBlendMode]);this._mask&&a.maskManager.pushMask(this._mask,a);var d=a.resolution;b.setTransform(c.a*d,c.b*d,c.c*d,c.d*d,c.tx*a.resolution+a.shakeX,c.ty*a.resolution+a.shakeY);PIXI.CanvasGraphics.renderGraphics(this,b);for(b=0;b<this.children.length;b++)this.children[b]._renderCanvas(a);this._mask&&a.maskManager.popMask(a)}};
PIXI.Graphics.prototype.getBounds=function(a){if(!this._currentBounds){if(!this.renderable)return PIXI.EmptyRectangle;this.dirty&&(this.updateLocalBounds(),this.cachedSpriteDirty=this.webGLDirty=!0,this.dirty=!1);var b=this._localBounds,c=b.x,d=b.width+b.x,e=b.y,f=b.height+b.y;a=a||this.worldTransform;var g=a.a,h=a.b,k=a.c,l=a.d,m=a.tx,n=a.ty,p=g*d+k*f+m,b=l*f+h*d+n;a=g*c+k*f+m;var f=l*f+h*c+n,q=g*c+k*e+m,c=l*e+h*c+n,g=g*d+k*e+m,d=l*e+h*d+n,e=p,h=b,p=a<p?a:p,p=q<p?q:p,p=g<p?g:p,b=f<b?f:b,b=c<b?c:
b,b=d<b?d:b,e=a>e?a:e,e=q>e?q:e,h=f>h?f:h,h=c>h?c:h;this._bounds.x=p;this._bounds.width=(g>e?g:e)-p;this._bounds.y=b;this._bounds.height=(d>h?d:h)-b;this._currentBounds=this._bounds}return this._currentBounds};
PIXI.Graphics.prototype.getLocalBounds=function(){var a=this.worldTransform;this.worldTransform=PIXI.identityMatrix;for(var b=0;b<this.children.length;b++)this.children[b].updateTransform();var c=this.getBounds();this.worldTransform=a;for(b=0;b<this.children.length;b++)this.children[b].updateTransform();return c};
PIXI.Graphics.prototype.containsPoint=function(a){this.worldTransform.applyInverse(a,tempPoint);a=this.graphicsData;for(var b=0;b<a.length;b++){var c=a[b];if(c.fill&&c.shape&&c.shape.contains(tempPoint.x,tempPoint.y))return!0}return!1};
PIXI.Graphics.prototype.updateLocalBounds=function(){var a=Infinity,b=-Infinity,c=Infinity,d=-Infinity;if(this.graphicsData.length)for(var e,f,g,h,k,l=0;l<this.graphicsData.length;l++)if(g=this.graphicsData[l],f=g.type,k=g.lineWidth,e=g.shape,f===PIXI.Graphics.RECT||f===PIXI.Graphics.RREC)f=e.x-k/2,g=e.y-k/2,h=e.width+k,k=e.height+k,a=f<a?f:a,b=f+h>b?f+h:b,c=g<c?g:c,d=g+k>d?g+k:d;else if(f===PIXI.Graphics.CIRC)f=e.x,g=e.y,h=e.radius+k/2,k=e.radius+k/2,a=f-h<a?f-h:a,b=f+h>b?f+h:b,c=g-k<c?g-k:c,d=g+
k>d?g+k:d;else if(f===PIXI.Graphics.ELIP)f=e.x,g=e.y,h=e.width+k/2,k=e.height+k/2,a=f-h<a?f-h:a,b=f+h>b?f+h:b,c=g-k<c?g-k:c,d=g+k>d?g+k:d;else for(e=e.points,h=0;h<e.length;h++)e[h]instanceof Phaser.Point?(f=e[h].x,g=e[h].y):(f=e[h],g=e[h+1],h<e.length-1&&h++),a=f-k<a?f-k:a,b=f+k>b?f+k:b,c=g-k<c?g-k:c,d=g+k>d?g+k:d;else d=c=b=a=0;l=this.boundsPadding;this._localBounds.x=a-l;this._localBounds.width=b-a+2*l;this._localBounds.y=c-l;this._localBounds.height=d-c+2*l};
PIXI.Graphics.prototype._generateCachedSprite=function(){var a=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.buffer.resize(a.width,a.height);else{var b=new PIXI.CanvasBuffer(a.width,a.height),c=PIXI.Texture.fromCanvas(b.canvas);this._cachedSprite=new PIXI.Sprite(c);this._cachedSprite.buffer=b;this._cachedSprite.worldTransform=this.worldTransform}this._cachedSprite.anchor.x=-(a.x/a.width);this._cachedSprite.anchor.y=-(a.y/a.height);this._cachedSprite.buffer.context.translate(-a.x,
-a.y);this.worldAlpha=1;PIXI.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context);this._cachedSprite.alpha=this.alpha};PIXI.Graphics.prototype.updateCachedSpriteTexture=function(){var a=this._cachedSprite,b=a.texture,c=a.buffer.canvas;b.baseTexture.width=c.width;b.baseTexture.height=c.height;b.crop.width=b.frame.width=c.width;b.crop.height=b.frame.height=c.height;a._width=c.width;a._height=c.height;b.baseTexture.dirty()};
PIXI.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(!0);this._cachedSprite=null};
PIXI.Graphics.prototype.drawShape=function(a){this.currentPath&&2>=this.currentPath.shape.points.length&&this.graphicsData.pop();this.currentPath=null;a instanceof Phaser.Polygon&&(a=a.clone(),a.flatten());a=new PIXI.GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,a);this.graphicsData.push(a);a.type===PIXI.Graphics.POLY&&(a.shape.closed=this.filling,this.currentPath=a);this._boundsDirty=this.dirty=!0;return a};
Object.defineProperty(PIXI.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(a){(this._cacheAsBitmap=a)?this._generateCachedSprite():this.destroyCachedSprite();this.webGLDirty=this.dirty=!0}});PIXI.GraphicsData=function(a,b,c,d,e,f,g){this.lineWidth=a;this.lineColor=b;this.lineAlpha=c;this._lineTint=b;this.fillColor=d;this.fillAlpha=e;this._fillTint=d;this.fill=f;this.shape=g;this.type=g.type};PIXI.GraphicsData.prototype.constructor=PIXI.GraphicsData;
PIXI.GraphicsData.prototype.clone=function(){return new GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)};PIXI.EarCut={};
PIXI.EarCut.Triangulate=function(a,b,c){c=c||2;var d=b&&b.length,e=d?b[0]*c:a.length,f=PIXI.EarCut.linkedList(a,0,e,c,!0),g=[];if(!f)return g;var h,k,l,m;d&&(f=PIXI.EarCut.eliminateHoles(a,b,f,c));if(a.length>80*c){h=b=a[0];k=d=a[1];for(var n=c;n<e;n+=c)l=a[n],m=a[n+1],l<h&&(h=l),m<k&&(k=m),l>b&&(b=l),m>d&&(d=m);l=Math.max(b-h,d-k)}PIXI.EarCut.earcutLinked(f,g,c,h,k,l);return g};
PIXI.EarCut.linkedList=function(a,b,c,d,e){var f=0,g,h,k;g=b;for(h=c-d;g<c;g+=d)f+=(a[h]-a[g])*(a[g+1]+a[h+1]),h=g;if(e===0<f)for(g=b;g<c;g+=d)k=PIXI.EarCut.insertNode(g,a[g],a[g+1],k);else for(g=c-d;g>=b;g-=d)k=PIXI.EarCut.insertNode(g,a[g],a[g+1],k);return k};
PIXI.EarCut.filterPoints=function(a,b){if(!a)return a;b||(b=a);var c=a,d;do if(d=!1,c.steiner||!PIXI.EarCut.equals(c,c.next)&&0!==PIXI.EarCut.area(c.prev,c,c.next))c=c.next;else{PIXI.EarCut.removeNode(c);c=b=c.prev;if(c===c.next)return null;d=!0}while(d||c!==b);return b};
PIXI.EarCut.earcutLinked=function(a,b,c,d,e,f,g){if(a){!g&&f&&PIXI.EarCut.indexCurve(a,d,e,f);for(var h=a,k,l;a.prev!==a.next;)if(k=a.prev,l=a.next,f?PIXI.EarCut.isEarHashed(a,d,e,f):PIXI.EarCut.isEar(a))b.push(k.i/c),b.push(a.i/c),b.push(l.i/c),PIXI.EarCut.removeNode(a),h=a=l.next;else if(a=l,a===h){g?1===g?(a=PIXI.EarCut.cureLocalIntersections(a,b,c),PIXI.EarCut.earcutLinked(a,b,c,d,e,f,2)):2===g&&PIXI.EarCut.splitEarcut(a,b,c,d,e,f):PIXI.EarCut.earcutLinked(PIXI.EarCut.filterPoints(a),b,c,d,e,
f,1);break}}};PIXI.EarCut.isEar=function(a){var b=a.prev,c=a.next;if(0<=PIXI.EarCut.area(b,a,c))return!1;for(var d=a.next.next;d!==a.prev;){if(PIXI.EarCut.pointInTriangle(b.x,b.y,a.x,a.y,c.x,c.y,d.x,d.y)&&0<=PIXI.EarCut.area(d.prev,d,d.next))return!1;d=d.next}return!0};
PIXI.EarCut.isEarHashed=function(a,b,c,d){var e=a.prev,f=a.next;if(0<=PIXI.EarCut.area(e,a,f))return!1;var g=e.x>a.x?e.x>f.x?e.x:f.x:a.x>f.x?a.x:f.x,h=e.y>a.y?e.y>f.y?e.y:f.y:a.y>f.y?a.y:f.y,k=PIXI.EarCut.zOrder(e.x<a.x?e.x<f.x?e.x:f.x:a.x<f.x?a.x:f.x,e.y<a.y?e.y<f.y?e.y:f.y:a.y<f.y?a.y:f.y,b,c,d);b=PIXI.EarCut.zOrder(g,h,b,c,d);for(c=a.nextZ;c&&c.z<=b;){if(c!==a.prev&&c!==a.next&&PIXI.EarCut.pointInTriangle(e.x,e.y,a.x,a.y,f.x,f.y,c.x,c.y)&&0<=PIXI.EarCut.area(c.prev,c,c.next))return!1;c=c.nextZ}for(c=
a.prevZ;c&&c.z>=k;){if(c!==a.prev&&c!==a.next&&PIXI.EarCut.pointInTriangle(e.x,e.y,a.x,a.y,f.x,f.y,c.x,c.y)&&0<=PIXI.EarCut.area(c.prev,c,c.next))return!1;c=c.prevZ}return!0};PIXI.EarCut.cureLocalIntersections=function(a,b,c){var d=a;do{var e=d.prev,f=d.next.next;PIXI.EarCut.intersects(e,d,d.next,f)&&PIXI.EarCut.locallyInside(e,f)&&PIXI.EarCut.locallyInside(f,e)&&(b.push(e.i/c),b.push(d.i/c),b.push(f.i/c),PIXI.EarCut.removeNode(d),PIXI.EarCut.removeNode(d.next),d=a=f);d=d.next}while(d!==a);return d};
PIXI.EarCut.splitEarcut=function(a,b,c,d,e,f){var g=a;do{for(var h=g.next.next;h!==g.prev;){if(g.i!==h.i&&PIXI.EarCut.isValidDiagonal(g,h)){a=PIXI.EarCut.splitPolygon(g,h);g=PIXI.EarCut.filterPoints(g,g.next);a=PIXI.EarCut.filterPoints(a,a.next);PIXI.EarCut.earcutLinked(g,b,c,d,e,f);PIXI.EarCut.earcutLinked(a,b,c,d,e,f);return}h=h.next}g=g.next}while(g!==a)};
PIXI.EarCut.eliminateHoles=function(a,b,c,d){var e=[],f,g,h,k;f=0;for(g=b.length;f<g;f++)h=b[f]*d,k=f<g-1?b[f+1]*d:a.length,h=PIXI.EarCut.linkedList(a,h,k,d,!1),h===h.next&&(h.steiner=!0),e.push(PIXI.EarCut.getLeftmost(h));e.sort(compareX);for(f=0;f<e.length;f++)PIXI.EarCut.eliminateHole(e[f],c),c=PIXI.EarCut.filterPoints(c,c.next);return c};PIXI.EarCut.compareX=function(a,b){return a.x-b.x};
PIXI.EarCut.eliminateHole=function(a,b){if(b=PIXI.EarCut.findHoleBridge(a,b)){var c=PIXI.EarCut.splitPolygon(b,a);PIXI.EarCut.filterPoints(c,c.next)}};
PIXI.EarCut.findHoleBridge=function(a,b){var c=b,d=a.x,e=a.y,f=-Infinity,g;do{if(e<=c.y&&e>=c.next.y){var h=c.x+(e-c.y)*(c.next.x-c.x)/(c.next.y-c.y);h<=d&&h>f&&(f=h,g=c.x<c.next.x?c:c.next)}c=c.next}while(c!==b);if(!g)return null;if(a.x===g.x)return g.prev;for(var h=g,k=Infinity,l,c=g.next;c!==h;)d>=c.x&&c.x>=g.x&&PIXI.EarCut.pointInTriangle(e<g.y?d:f,e,g.x,g.y,e<g.y?f:d,e,c.x,c.y)&&(l=Math.abs(e-c.y)/(d-c.x),(l<k||l===k&&c.x>g.x)&&PIXI.EarCut.locallyInside(c,a)&&(g=c,k=l)),c=c.next;return g};
PIXI.EarCut.indexCurve=function(a,b,c,d){var e=a;do null===e.z&&(e.z=PIXI.EarCut.zOrder(e.x,e.y,b,c,d)),e.prevZ=e.prev,e=e.nextZ=e.next;while(e!==a);e.prevZ.nextZ=null;e.prevZ=null;PIXI.EarCut.sortLinked(e)};
PIXI.EarCut.sortLinked=function(a){var b,c,d,e,f,g,h,k=1;do{c=a;e=a=null;for(f=0;c;){f++;d=c;for(b=g=0;b<k&&(g++,d=d.nextZ,d);b++);for(h=k;0<g||0<h&&d;)0===g?(b=d,d=d.nextZ,h--):0!==h&&d?c.z<=d.z?(b=c,c=c.nextZ,g--):(b=d,d=d.nextZ,h--):(b=c,c=c.nextZ,g--),e?e.nextZ=b:a=b,b.prevZ=e,e=b;c=d}e.nextZ=null;k*=2}while(1<f);return a};
PIXI.EarCut.zOrder=function(a,b,c,d,e){a=32767*(a-c)/e;b=32767*(b-d)/e;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;return(a|a<<1)&1431655765|((b|b<<1)&1431655765)<<1};PIXI.EarCut.getLeftmost=function(a){var b=a,c=a;do b.x<c.x&&(c=b),b=b.next;while(b!==a);return c};PIXI.EarCut.pointInTriangle=function(a,b,c,d,e,f,g,h){return 0<=(e-g)*(b-h)-(a-g)*(f-h)&&0<=(a-g)*(d-h)-(c-g)*(b-h)&&0<=(c-g)*(f-h)-(e-g)*(d-h)};
PIXI.EarCut.isValidDiagonal=function(a,b){return PIXI.EarCut.equals(a,b)||a.next.i!==b.i&&a.prev.i!==b.i&&!PIXI.EarCut.intersectsPolygon(a,b)&&PIXI.EarCut.locallyInside(a,b)&&PIXI.EarCut.locallyInside(b,a)&&PIXI.EarCut.middleInside(a,b)};PIXI.EarCut.area=function(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)};PIXI.EarCut.equals=function(a,b){return a.x===b.x&&a.y===b.y};
PIXI.EarCut.intersects=function(a,b,c,d){return 0<PIXI.EarCut.area(a,b,c)!==0<PIXI.EarCut.area(a,b,d)&&0<PIXI.EarCut.area(c,d,a)!==0<PIXI.EarCut.area(c,d,b)};PIXI.EarCut.intersectsPolygon=function(a,b){var c=a;do{if(c.i!==a.i&&c.next.i!==a.i&&c.i!==b.i&&c.next.i!==b.i&&PIXI.EarCut.intersects(c,c.next,a,b))return!0;c=c.next}while(c!==a);return!1};
PIXI.EarCut.locallyInside=function(a,b){return 0>PIXI.EarCut.area(a.prev,a,a.next)?0<=PIXI.EarCut.area(a,b,a.next)&&0<=PIXI.EarCut.area(a,a.prev,b):0>PIXI.EarCut.area(a,b,a.prev)||0>PIXI.EarCut.area(a,a.next,b)};PIXI.EarCut.middleInside=function(a,b){var c=a,d=!1,e=(a.x+b.x)/2,f=(a.y+b.y)/2;do c.y>f!==c.next.y>f&&e<(c.next.x-c.x)*(f-c.y)/(c.next.y-c.y)+c.x&&(d=!d),c=c.next;while(c!==a);return d};
PIXI.EarCut.splitPolygon=function(a,b){var c=new PIXI.EarCut.Node(a.i,a.x,a.y),d=new PIXI.EarCut.Node(b.i,b.x,b.y),e=a.next,f=b.prev;a.next=b;b.prev=a;c.next=e;e.prev=c;d.next=c;c.prev=d;f.next=d;d.prev=f;return d};PIXI.EarCut.insertNode=function(a,b,c,d){a=new PIXI.EarCut.Node(a,b,c);d?(a.next=d.next,a.prev=d,d.next.prev=a,d.next=a):(a.prev=a,a.next=a);return a};PIXI.EarCut.removeNode=function(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)};
PIXI.EarCut.Node=function(a,b,c){this.i=a;this.x=b;this.y=c;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1};PIXI.WebGLGraphics=function(){};PIXI.WebGLGraphics.stencilBufferLimit=6;
PIXI.WebGLGraphics.renderGraphics=function(a,b){var c=b.gl,d=b.projection,e=b.offset,f=b.shaderManager.primitiveShader,g;a.dirty&&PIXI.WebGLGraphics.updateGraphics(a,c);for(var h=a._webGL[c.id],k=0;k<h.data.length;k++)1===h.data[k].mode?(g=h.data[k],b.stencilManager.pushStencil(a,g,b),c.drawElements(c.TRIANGLE_FAN,4,c.UNSIGNED_SHORT,2*(g.indices.length-4)),b.stencilManager.popStencil(a,g,b)):(g=h.data[k],b.shaderManager.setShader(f),f=b.shaderManager.primitiveShader,c.uniformMatrix3fv(f.translationMatrix,
!1,a.worldTransform.toArray(!0)),c.uniform1f(f.flipY,1),c.uniform2f(f.projectionVector,d.x,-d.y),c.uniform2f(f.offsetVector,-e.x,-e.y),c.uniform3fv(f.tintColor,PIXI.hex2rgb(a.tint)),c.uniform1f(f.alpha,a.worldAlpha),c.bindBuffer(c.ARRAY_BUFFER,g.buffer),c.vertexAttribPointer(f.aVertexPosition,2,c.FLOAT,!1,24,0),c.vertexAttribPointer(f.colorAttribute,4,c.FLOAT,!1,24,8),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,g.indexBuffer),c.drawElements(c.TRIANGLE_STRIP,g.indices.length,c.UNSIGNED_SHORT,0))};
PIXI.WebGLGraphics.updateGraphics=function(a,b){var c=a._webGL[b.id];c||(c=a._webGL[b.id]={lastIndex:0,data:[],gl:b});a.dirty=!1;var d;if(a.clearDirty){a.clearDirty=!1;for(d=0;d<c.data.length;d++){var e=c.data[d];e.reset();PIXI.WebGLGraphics.graphicsDataPool.push(e)}c.data=[];c.lastIndex=0}for(d=c.lastIndex;d<a.graphicsData.length;d++){var f=a.graphicsData[d];f.type===PIXI.Graphics.POLY?(f.points=f.shape.points.slice(),f.shape.closed&&(f.points[0]===f.points[f.points.length-2]&&f.points[1]===f.points[f.points.length-
1]||f.points.push(f.points[0],f.points[1])),f.fill&&f.points.length>=PIXI.WebGLGraphics.stencilBufferLimit&&(f.points.length<2*PIXI.WebGLGraphics.stencilBufferLimit?(e=PIXI.WebGLGraphics.switchMode(c,0),PIXI.WebGLGraphics.buildPoly(f,e)||(e=PIXI.WebGLGraphics.switchMode(c,1),PIXI.WebGLGraphics.buildComplexPoly(f,e))):(e=PIXI.WebGLGraphics.switchMode(c,1),PIXI.WebGLGraphics.buildComplexPoly(f,e))),0<f.lineWidth&&(e=PIXI.WebGLGraphics.switchMode(c,0),PIXI.WebGLGraphics.buildLine(f,e))):(e=PIXI.WebGLGraphics.switchMode(c,
0),f.type===PIXI.Graphics.RECT?PIXI.WebGLGraphics.buildRectangle(f,e):f.type===PIXI.Graphics.CIRC||f.type===PIXI.Graphics.ELIP?PIXI.WebGLGraphics.buildCircle(f,e):f.type===PIXI.Graphics.RREC&&PIXI.WebGLGraphics.buildRoundedRectangle(f,e));c.lastIndex++}for(d=0;d<c.data.length;d++)e=c.data[d],e.dirty&&e.upload()};
PIXI.WebGLGraphics.switchMode=function(a,b){var c;if(a.data.length){if(c=a.data[a.data.length-1],c.mode!==b||1===b)c=PIXI.WebGLGraphics.graphicsDataPool.pop()||new PIXI.WebGLGraphicsData(a.gl),c.mode=b,a.data.push(c)}else c=PIXI.WebGLGraphics.graphicsDataPool.pop()||new PIXI.WebGLGraphicsData(a.gl),c.mode=b,a.data.push(c);c.dirty=!0;return c};
PIXI.WebGLGraphics.buildRectangle=function(a,b){var c=a.shape,d=c.x,e=c.y,f=c.width,c=c.height;if(a.fill){var g=PIXI.hex2rgb(a.fillColor),h=a.fillAlpha,k=g[0]*h,l=g[1]*h,g=g[2]*h,m=b.points,n=b.indices,p=m.length/6;m.push(d,e);m.push(k,l,g,h);m.push(d+f,e);m.push(k,l,g,h);m.push(d,e+c);m.push(k,l,g,h);m.push(d+f,e+c);m.push(k,l,g,h);n.push(p,p,p+1,p+2,p+3,p+3)}a.lineWidth&&(h=a.points,a.points=[d,e,d+f,e,d+f,e+c,d,e+c,d,e],PIXI.WebGLGraphics.buildLine(a,b),a.points=h)};
PIXI.WebGLGraphics.buildRoundedRectangle=function(a,b){var c=a.shape,d=c.x,e=c.y,f=c.width,g=c.height,h=c.radius,c=[];c.push(d,e+h);c=c.concat(PIXI.WebGLGraphics.quadraticBezierCurve(d,e+g-h,d,e+g,d+h,e+g));c=c.concat(PIXI.WebGLGraphics.quadraticBezierCurve(d+f-h,e+g,d+f,e+g,d+f,e+g-h));c=c.concat(PIXI.WebGLGraphics.quadraticBezierCurve(d+f,e+h,d+f,e,d+f-h,e));c=c.concat(PIXI.WebGLGraphics.quadraticBezierCurve(d+h,e,d,e,d,e+h));if(a.fill){for(var g=PIXI.hex2rgb(a.fillColor),d=a.fillAlpha,e=g[0]*d,
f=g[1]*d,g=g[2]*d,h=b.points,k=b.indices,l=h.length/6,m=PIXI.EarCut.Triangulate(c,null,2),n=0,n=0;n<m.length;n+=3)k.push(m[n]+l),k.push(m[n]+l),k.push(m[n+1]+l),k.push(m[n+2]+l),k.push(m[n+2]+l);for(n=0;n<c.length;n++)h.push(c[n],c[++n],e,f,g,d)}a.lineWidth&&(d=a.points,a.points=c,PIXI.WebGLGraphics.buildLine(a,b),a.points=d)};
PIXI.WebGLGraphics.quadraticBezierCurve=function(a,b,c,d,e,f){for(var g,h,k,l,m=[],n=0,p=0;20>=p;p++)n=p/20,g=a+(c-a)*n,h=b+(d-b)*n,k=c+(e-c)*n,l=d+(f-d)*n,g+=(k-g)*n,h+=(l-h)*n,m.push(g,h);return m};
PIXI.WebGLGraphics.buildCircle=function(a,b){var c=a.shape,d=c.x,e=c.y,f;a.type===PIXI.Graphics.CIRC?c=f=c.radius:(f=c.width,c=c.height);var g=2*Math.PI/40,h=0;if(a.fill){var h=PIXI.hex2rgb(a.fillColor),k=a.fillAlpha,l=h[0]*k,m=h[1]*k,n=h[2]*k,p=b.points,q=b.indices,t=p.length/6;q.push(t);for(h=0;41>h;h++)p.push(d,e,l,m,n,k),p.push(d+Math.sin(g*h)*f,e+Math.cos(g*h)*c,l,m,n,k),q.push(t++,t++);q.push(t-1)}if(a.lineWidth){k=a.points;a.points=[];for(h=0;41>h;h++)a.points.push(d+Math.sin(g*h)*f,e+Math.cos(g*
h)*c);PIXI.WebGLGraphics.buildLine(a,b);a.points=k}};
PIXI.WebGLGraphics.buildLine=function(a,b){var c=0,d=a.points;if(0!==d.length){if(a.lineWidth%2)for(c=0;c<d.length;c++)d[c]+=.5;var e=new PIXI.Point(d[0],d[1]),f=new PIXI.Point(d[d.length-2],d[d.length-1]);if(e.x===f.x&&e.y===f.y){d=d.slice();d.pop();d.pop();var f=new PIXI.Point(d[d.length-2],d[d.length-1]),g=f.x+.5*(e.x-f.x),e=f.y+.5*(e.y-f.y);d.unshift(g,e);d.push(g,e)}var g=b.points,e=b.indices,f=d.length/2,h=d.length,k=g.length/6,l=a.lineWidth/2,c=PIXI.hex2rgb(a.lineColor),m=a.lineAlpha,n=c[0]*
m,p=c[1]*m,q=c[2]*m,t,r,F,H,G,I,S,T,y,z,Q,E,P;F=d[0];H=d[1];G=d[2];I=d[3];y=-(H-I);z=F-G;r=Math.sqrt(y*y+z*z);y=y/r*l;z=z/r*l;g.push(F-y,H-z,n,p,q,m);g.push(F+y,H+z,n,p,q,m);for(c=1;c<f-1;c++)F=d[2*(c-1)],H=d[2*(c-1)+1],G=d[2*c],I=d[2*c+1],S=d[2*(c+1)],T=d[2*(c+1)+1],y=-(H-I),z=F-G,r=Math.sqrt(y*y+z*z),y/=r,z/=r,y*=l,z*=l,Q=-(I-T),E=G-S,r=Math.sqrt(Q*Q+E*E),Q/=r,E/=r,Q*=l,E*=l,r=-z+H-(-z+I),t=-y+G-(-y+F),F=(-y+F)*(-z+I)-(-y+G)*(-z+H),H=-E+T-(-E+I),P=-Q+G-(-Q+S),S=(-Q+S)*(-E+I)-(-Q+G)*(-E+T),T=r*P-
H*t,.1>Math.abs(T)?(g.push(G-y,I-z,n,p,q,m),g.push(G+y,I+z,n,p,q,m)):(t=(t*S-P*F)/T,r=(H*F-r*S)/T,S=(t-G)*(t-G)+(r-I)+(r-I),19600<S?(y-=Q,z-=E,r=Math.sqrt(y*y+z*z),y/=r,z/=r,y*=l,z*=l,g.push(G-y,I-z),g.push(n,p,q,m),g.push(G+y,I+z),g.push(n,p,q,m),g.push(G-y,I-z),g.push(n,p,q,m),h++):(g.push(t,r),g.push(n,p,q,m),g.push(G-(t-G),I-(r-I)),g.push(n,p,q,m)));F=d[2*(f-2)];H=d[2*(f-2)+1];G=d[2*(f-1)];I=d[2*(f-1)+1];y=-(H-I);z=F-G;r=Math.sqrt(y*y+z*z);y/=r;z/=r;y*=l;z*=l;g.push(G-y,I-z);g.push(n,p,q,m);g.push(G+
y,I+z);g.push(n,p,q,m);e.push(k);for(c=0;c<h;c++)e.push(k++);e.push(k-1)}};PIXI.WebGLGraphics.buildComplexPoly=function(a,b){var c=a.points.slice();if(!(6>c.length)){var d=b.indices;b.points=c;b.alpha=a.fillAlpha;b.color=PIXI.hex2rgb(a.fillColor);for(var e=Infinity,f=-Infinity,g=Infinity,h=-Infinity,k,l,m=0;m<c.length;m+=2)k=c[m],l=c[m+1],e=k<e?k:e,f=k>f?k:f,g=l<g?l:g,h=l>h?l:h;c.push(e,g,f,g,f,h,e,h);c=c.length/2;for(m=0;m<c;m++)d.push(m)}};
PIXI.WebGLGraphics.buildPoly=function(a,b){var c=a.points;if(!(6>c.length)){var d=b.points,e=b.indices,f=c.length/2,g=PIXI.hex2rgb(a.fillColor),h=a.fillAlpha,k=g[0]*h,l=g[1]*h,g=g[2]*h,m=PIXI.EarCut.Triangulate(c,null,2);if(!m)return!1;for(var n=d.length/6,p=0,p=0;p<m.length;p+=3)e.push(m[p]+n),e.push(m[p]+n),e.push(m[p+1]+n),e.push(m[p+2]+n),e.push(m[p+2]+n);for(p=0;p<f;p++)d.push(c[2*p],c[2*p+1],k,l,g,h);return!0}};PIXI.WebGLGraphics.graphicsDataPool=[];
PIXI.WebGLGraphicsData=function(a){this.gl=a;this.color=[0,0,0];this.points=[];this.indices=[];this.buffer=a.createBuffer();this.indexBuffer=a.createBuffer();this.alpha=this.mode=1;this.dirty=!0};PIXI.WebGLGraphicsData.prototype.reset=function(){this.points=[];this.indices=[]};
PIXI.WebGLGraphicsData.prototype.upload=function(){var a=this.gl;this.glPoints=new PIXI.Float32Array(this.points);a.bindBuffer(a.ARRAY_BUFFER,this.buffer);a.bufferData(a.ARRAY_BUFFER,this.glPoints,a.STATIC_DRAW);this.glIndicies=new PIXI.Uint16Array(this.indices);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.glIndicies,a.STATIC_DRAW);this.dirty=!1};PIXI.CanvasGraphics=function(){};
PIXI.CanvasGraphics.renderGraphics=function(a,b){var c=a.worldAlpha;a.dirty&&(this.updateGraphicsTint(a),a.dirty=!1);for(var d=0;d<a.graphicsData.length;d++){var e=a.graphicsData[d],f=e.shape,g=e._fillTint,h=e._lineTint;b.lineWidth=e.lineWidth;if(e.type===PIXI.Graphics.POLY){b.beginPath();var k=f.points;b.moveTo(k[0],k[1]);for(var l=1;l<k.length/2;l++)b.lineTo(k[2*l],k[2*l+1]);f.closed&&b.lineTo(k[0],k[1]);k[0]===k[k.length-2]&&k[1]===k[k.length-1]&&b.closePath();e.fill&&(b.globalAlpha=e.fillAlpha*
c,b.fillStyle="#"+("00000"+(g|0).toString(16)).substr(-6),b.fill());e.lineWidth&&(b.globalAlpha=e.lineAlpha*c,b.strokeStyle="#"+("00000"+(h|0).toString(16)).substr(-6),b.stroke())}else if(e.type===PIXI.Graphics.RECT){if(e.fillColor||0===e.fillColor)b.globalAlpha=e.fillAlpha*c,b.fillStyle="#"+("00000"+(g|0).toString(16)).substr(-6),b.fillRect(f.x,f.y,f.width,f.height);e.lineWidth&&(b.globalAlpha=e.lineAlpha*c,b.strokeStyle="#"+("00000"+(h|0).toString(16)).substr(-6),b.strokeRect(f.x,f.y,f.width,f.height))}else if(e.type===
PIXI.Graphics.CIRC)b.beginPath(),b.arc(f.x,f.y,f.radius,0,2*Math.PI),b.closePath(),e.fill&&(b.globalAlpha=e.fillAlpha*c,b.fillStyle="#"+("00000"+(g|0).toString(16)).substr(-6),b.fill()),e.lineWidth&&(b.globalAlpha=e.lineAlpha*c,b.strokeStyle="#"+("00000"+(h|0).toString(16)).substr(-6),b.stroke());else if(e.type===PIXI.Graphics.ELIP){var m=2*f.width,l=2*f.height,k=f.x-m/2,f=f.y-l/2;b.beginPath();var n=m/2*.5522848,p=l/2*.5522848,q=k+m,t=f+l,m=k+m/2,l=f+l/2;b.moveTo(k,l);b.bezierCurveTo(k,l-p,m-n,f,
m,f);b.bezierCurveTo(m+n,f,q,l-p,q,l);b.bezierCurveTo(q,l+p,m+n,t,m,t);b.bezierCurveTo(m-n,t,k,l+p,k,l);b.closePath();e.fill&&(b.globalAlpha=e.fillAlpha*c,b.fillStyle="#"+("00000"+(g|0).toString(16)).substr(-6),b.fill());e.lineWidth&&(b.globalAlpha=e.lineAlpha*c,b.strokeStyle="#"+("00000"+(h|0).toString(16)).substr(-6),b.stroke())}else if(e.type===PIXI.Graphics.RREC){k=f.x;l=f.y;n=f.width;p=f.height;f=f.radius;q=Math.min(n,p)/2|0;f=f>q?q:f;b.beginPath();b.moveTo(k,l+f);b.lineTo(k,l+p-f);b.quadraticCurveTo(k,
l+p,k+f,l+p);b.lineTo(k+n-f,l+p);b.quadraticCurveTo(k+n,l+p,k+n,l+p-f);b.lineTo(k+n,l+f);b.quadraticCurveTo(k+n,l,k+n-f,l);b.lineTo(k+f,l);b.quadraticCurveTo(k,l,k,l+f);b.closePath();if(e.fillColor||0===e.fillColor)b.globalAlpha=e.fillAlpha*c,b.fillStyle="#"+("00000"+(g|0).toString(16)).substr(-6),b.fill();e.lineWidth&&(b.globalAlpha=e.lineAlpha*c,b.strokeStyle="#"+("00000"+(h|0).toString(16)).substr(-6),b.stroke())}}};
PIXI.CanvasGraphics.renderGraphicsMask=function(a,b){var c=a.graphicsData.length;if(0!==c){b.beginPath();for(var d=0;d<c;d++){var e=a.graphicsData[d],f=e.shape;if(e.type===PIXI.Graphics.POLY){e=f.points;b.moveTo(e[0],e[1]);for(var g=1;g<e.length/2;g++)b.lineTo(e[2*g],e[2*g+1]);e[0]===e[e.length-2]&&e[1]===e[e.length-1]&&b.closePath()}else if(e.type===PIXI.Graphics.RECT)b.rect(f.x,f.y,f.width,f.height),b.closePath();else if(e.type===PIXI.Graphics.CIRC)b.arc(f.x,f.y,f.radius,0,2*Math.PI),b.closePath();
else if(e.type===PIXI.Graphics.ELIP){var h=2*f.width,g=2*f.height,e=f.x-h/2,f=f.y-g/2,k=h/2*.5522848,l=g/2*.5522848,m=e+h,n=f+g,h=e+h/2,g=f+g/2;b.moveTo(e,g);b.bezierCurveTo(e,g-l,h-k,f,h,f);b.bezierCurveTo(h+k,f,m,g-l,m,g);b.bezierCurveTo(m,g+l,h+k,n,h,n);b.bezierCurveTo(h-k,n,e,g+l,e,g);b.closePath()}else e.type===PIXI.Graphics.RREC&&(e=f.x,g=f.y,k=f.width,l=f.height,f=f.radius,m=Math.min(k,l)/2|0,f=f>m?m:f,b.moveTo(e,g+f),b.lineTo(e,g+l-f),b.quadraticCurveTo(e,g+l,e+f,g+l),b.lineTo(e+k-f,g+l),
b.quadraticCurveTo(e+k,g+l,e+k,g+l-f),b.lineTo(e+k,g+f),b.quadraticCurveTo(e+k,g,e+k-f,g),b.lineTo(e+f,g),b.quadraticCurveTo(e,g,e,g+f),b.closePath())}}};
PIXI.CanvasGraphics.updateGraphicsTint=function(a){if(16777215!==a.tint)for(var b=(a.tint>>16&255)/255,c=(a.tint>>8&255)/255,d=(a.tint&255)/255,e=0;e<a.graphicsData.length;e++){var f=a.graphicsData[e],g=f.fillColor|0,h=f.lineColor|0;f._fillTint=((g>>16&255)/255*b*255<<16)+((g>>8&255)/255*c*255<<8)+(g&255)/255*d*255;f._lineTint=((h>>16&255)/255*b*255<<16)+((h>>8&255)/255*c*255<<8)+(h&255)/255*d*255}};
Phaser.Graphics=function(a,b,c){void 0===b&&(b=0);void 0===c&&(c=0);this.type=Phaser.GRAPHICS;this.physicsType=Phaser.SPRITE;this.anchor=new Phaser.Point;PIXI.Graphics.call(this);Phaser.Component.Core.init.call(this,a,b,c,"",null)};Phaser.Graphics.prototype=Object.create(PIXI.Graphics.prototype);Phaser.Graphics.prototype.constructor=Phaser.Graphics;Phaser.Component.Core.install.call(Phaser.Graphics.prototype,"Angle AutoCull Bounds Destroy FixedToCamera InputEnabled InWorld LifeSpan PhysicsBody Reset".split(" "));
Phaser.Graphics.prototype.preUpdatePhysics=Phaser.Component.PhysicsBody.preUpdate;Phaser.Graphics.prototype.preUpdateLifeSpan=Phaser.Component.LifeSpan.preUpdate;Phaser.Graphics.prototype.preUpdateInWorld=Phaser.Component.InWorld.preUpdate;Phaser.Graphics.prototype.preUpdateCore=Phaser.Component.Core.preUpdate;Phaser.Graphics.prototype.preUpdate=function(){return this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1};
Phaser.Graphics.prototype.postUpdate=function(){Phaser.Component.PhysicsBody.postUpdate.call(this);Phaser.Component.FixedToCamera.postUpdate.call(this);this._boundsDirty&&(this.updateLocalBounds(),this._boundsDirty=!1);for(var a=0;a<this.children.length;a++)this.children[a].postUpdate()};Phaser.Graphics.prototype.destroy=function(a){this.clear();Phaser.Component.Destroy.prototype.destroy.call(this,a)};
Phaser.Graphics.prototype.drawTriangle=function(a,b){void 0===b&&(b=!1);var c=new Phaser.Polygon(a);if(b){var d=new Phaser.Point(this.game.camera.x-a[0].x,this.game.camera.y-a[0].y),e=new Phaser.Point(a[1].x-a[0].x,a[1].y-a[0].y),e=(new Phaser.Point(a[1].x-a[2].x,a[1].y-a[2].y)).cross(e);0<d.dot(e)&&this.drawPolygon(c)}else this.drawPolygon(c)};
Phaser.Graphics.prototype.drawTriangles=function(a,b,c){void 0===c&&(c=!1);var d=new Phaser.Point,e=new Phaser.Point,f=new Phaser.Point,g=[],h;if(b)if(a[0]instanceof Phaser.Point)for(h=0;h<b.length/3;h++)g.push(a[b[3*h]]),g.push(a[b[3*h+1]]),g.push(a[b[3*h+2]]),3===g.length&&(this.drawTriangle(g,c),g=[]);else for(h=0;h<b.length;h++)d.x=a[2*b[h]],d.y=a[2*b[h]+1],g.push(d.copyTo({})),3===g.length&&(this.drawTriangle(g,c),g=[]);else if(a[0]instanceof Phaser.Point)for(h=0;h<a.length/3;h++)this.drawTriangle([a[3*
h],a[3*h+1],a[3*h+2]],c);else for(h=0;h<a.length/6;h++)d.x=a[6*h+0],d.y=a[6*h+1],e.x=a[6*h+2],e.y=a[6*h+3],f.x=a[6*h+4],f.y=a[6*h+5],this.drawTriangle([d,e,f],c)};Phaser.RenderTexture=function(a,b,c,d,e,f){void 0===d&&(d="");void 0===e&&(e=Phaser.scaleModes.DEFAULT);void 0===f&&(f=1);this.game=a;this.key=d;this.type=Phaser.RENDERTEXTURE;this._tempMatrix=new PIXI.Matrix;PIXI.RenderTexture.call(this,b,c,this.game.renderer,e,f);this.render=Phaser.RenderTexture.prototype.render};
Phaser.RenderTexture.prototype=Object.create(PIXI.RenderTexture.prototype);Phaser.RenderTexture.prototype.constructor=Phaser.RenderTexture;Phaser.RenderTexture.prototype.renderXY=function(a,b,c,d){a.updateTransform();this._tempMatrix.copyFrom(a.worldTransform);this._tempMatrix.tx=b;this._tempMatrix.ty=c;this.renderer.type===PIXI.WEBGL_RENDERER?this.renderWebGL(a,this._tempMatrix,d):this.renderCanvas(a,this._tempMatrix,d)};
Phaser.RenderTexture.prototype.renderRawXY=function(a,b,c,d){this._tempMatrix.identity().translate(b,c);this.renderer.type===PIXI.WEBGL_RENDERER?this.renderWebGL(a,this._tempMatrix,d):this.renderCanvas(a,this._tempMatrix,d)};Phaser.RenderTexture.prototype.render=function(a,b,c){void 0===b||null===b?this._tempMatrix.copyFrom(a.worldTransform):this._tempMatrix.copyFrom(b);this.renderer.type===PIXI.WEBGL_RENDERER?this.renderWebGL(a,this._tempMatrix,c):this.renderCanvas(a,this._tempMatrix,c)};
Phaser.Text=function(a,b,c,d,e){b=b||0;c=c||0;d=void 0===d||null===d?"":d.toString();e=Phaser.Utils.extend({},e);this.type=Phaser.TEXT;this.physicsType=Phaser.SPRITE;this.padding=new Phaser.Point;this.textBounds=null;this.canvas=PIXI.CanvasPool.create(this);this.context=this.canvas.getContext("2d");this.colors=[];this.strokeColors=[];this.fontStyles=[];this.fontWeights=[];this.useAdvancedWrap=this.autoRound=!1;this._res=a.renderer.resolution;this._text=d;this._fontComponents=null;this._height=this._width=
this._charCount=this._lineSpacing=0;Phaser.Sprite.call(this,a,b,c,PIXI.Texture.fromCanvas(this.canvas));this.setStyle(e);""!==d&&this.updateText()};Phaser.Text.prototype=Object.create(Phaser.Sprite.prototype);Phaser.Text.prototype.constructor=Phaser.Text;Phaser.Text.prototype.preUpdate=function(){return this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1};Phaser.Text.prototype.update=function(){};
Phaser.Text.prototype.destroy=function(a){this.texture.destroy(!0);Phaser.Component.Destroy.prototype.destroy.call(this,a)};Phaser.Text.prototype.setShadow=function(a,b,c,d,e,f){void 0===a&&(a=0);void 0===b&&(b=0);void 0===c&&(c="rgba(0, 0, 0, 1)");void 0===d&&(d=0);void 0===e&&(e=!0);void 0===f&&(f=!0);this.style.shadowOffsetX=a;this.style.shadowOffsetY=b;this.style.shadowColor=c;this.style.shadowBlur=d;this.style.shadowStroke=e;this.style.shadowFill=f;this.dirty=!0;return this};
Phaser.Text.prototype.setStyle=function(a,b){void 0===b&&(b=!1);a=a||{};a.font=a.font||"bold 20pt Arial";a.backgroundColor=a.backgroundColor||null;a.fill=a.fill||"black";a.align=a.align||"left";a.boundsAlignH=a.boundsAlignH||"left";a.boundsAlignV=a.boundsAlignV||"top";a.stroke=a.stroke||"black";a.strokeThickness=a.strokeThickness||0;a.wordWrap=a.wordWrap||!1;a.wordWrapWidth=a.wordWrapWidth||100;a.maxLines=a.maxLines||0;a.shadowOffsetX=a.shadowOffsetX||0;a.shadowOffsetY=a.shadowOffsetY||0;a.shadowColor=
a.shadowColor||"rgba(0,0,0,0)";a.shadowBlur=a.shadowBlur||0;a.tabs=a.tabs||0;var c=this.fontToComponents(a.font);a.fontStyle&&(c.fontStyle=a.fontStyle);a.fontVariant&&(c.fontVariant=a.fontVariant);a.fontWeight&&(c.fontWeight=a.fontWeight);a.fontSize&&("number"===typeof a.fontSize&&(a.fontSize+="px"),c.fontSize=a.fontSize);this._fontComponents=c;a.font=this.componentsToFont(this._fontComponents);this.style=a;this.dirty=!0;b&&this.updateText();return this};
Phaser.Text.prototype.updateText=function(){this.texture.baseTexture.resolution=this._res;this.context.font=this.style.font;var a=this.text;this.style.wordWrap&&(a=this.runWordWrap(this.text));var a=a.split(/(?:\r\n|\r|\n)/),b=this.style.tabs,c=[],d=0,e=this.determineFontProperties(this.style.font),f=a.length;0<this.style.maxLines&&this.style.maxLines<a.length&&(f=this.style.maxLines);for(var g=this._charCount=0;g<f;g++){if(0===b){var h=this.style.strokeThickness+this.padding.x,h=0<this.colors.length||
0<this.strokeColors.length||0<this.fontWeights.length||0<this.fontStyles.length?h+this.measureLine(a[g]):h+this.context.measureText(a[g]).width;this.style.wordWrap&&(h-=this.context.measureText(" ").width)}else{var k=a[g].split(/(?:\t)/),h=this.padding.x+this.style.strokeThickness;if(Array.isArray(b))for(var l=0,m=0;m<k.length;m++)h=0,h=0<this.colors.length||0<this.strokeColors.length||0<this.fontWeights.length||0<this.fontStyles.length?this.measureLine(k[m]):Math.ceil(this.context.measureText(k[m]).width),
0<m&&(l+=b[m-1]),h=l+h;else for(m=0;m<k.length;m++)h=0<this.colors.length||0<this.strokeColors.length||0<this.fontWeights.length||0<this.fontStyles.length?h+this.measureLine(k[m]):h+Math.ceil(this.context.measureText(k[m]).width),l=this.game.math.snapToCeil(h,b)-h,h+=l}c[g]=Math.ceil(h);d=Math.max(d,c[g])}this.canvas.width=d*this._res;k=e.fontSize+this.style.strokeThickness+this.padding.y;g=k*f;m=this._lineSpacing;0>m&&Math.abs(m)>k&&(m=-k);0!==m&&(g+=0<m?m*a.length:m*(a.length-1));this.canvas.height=
g*this._res;this.context.scale(this._res,this._res);navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height);this.style.backgroundColor&&(this.context.fillStyle=this.style.backgroundColor,this.context.fillRect(0,0,this.canvas.width,this.canvas.height));this.context.fillStyle=this.style.fill;this.context.font=this.style.font;this.context.strokeStyle=this.style.stroke;this.context.textBaseline="alphabetic";this.context.lineWidth=this.style.strokeThickness;this.context.lineCap=
"round";this.context.lineJoin="round";for(g=this._charCount=0;g<f;g++)h=this.style.strokeThickness/2,l=this.style.strokeThickness/2+g*k+e.ascent,0<g&&(l+=m*g),"right"===this.style.align?h+=d-c[g]:"center"===this.style.align&&(h+=(d-c[g])/2),this.autoRound&&(h=Math.round(h),l=Math.round(l)),0<this.colors.length||0<this.strokeColors.length||0<this.fontWeights.length||0<this.fontStyles.length?this.updateLine(a[g],h,l):(this.style.stroke&&this.style.strokeThickness&&(this.updateShadow(this.style.shadowStroke),
0===b?this.context.strokeText(a[g],h,l):this.renderTabLine(a[g],h,l,!1)),this.style.fill&&(this.updateShadow(this.style.shadowFill),0===b?this.context.fillText(a[g],h,l):this.renderTabLine(a[g],h,l,!0)));this.updateTexture();this.dirty=!1};
Phaser.Text.prototype.renderTabLine=function(a,b,c,d){a=a.split(/(?:\t)/);var e=this.style.tabs,f=0;if(Array.isArray(e))for(var g=0,h=0;h<a.length;h++)0<h&&(g+=e[h-1]),f=b+g,d?this.context.fillText(a[h],f,c):this.context.strokeText(a[h],f,c);else for(h=0;h<a.length;h++)g=Math.ceil(this.context.measureText(a[h]).width),f=this.game.math.snapToCeil(b,e),d?this.context.fillText(a[h],f,c):this.context.strokeText(a[h],f,c),b=f+g};
Phaser.Text.prototype.updateShadow=function(a){a?(this.context.shadowOffsetX=this.style.shadowOffsetX,this.context.shadowOffsetY=this.style.shadowOffsetY,this.context.shadowColor=this.style.shadowColor,this.context.shadowBlur=this.style.shadowBlur):(this.context.shadowOffsetX=0,this.context.shadowOffsetY=0,this.context.shadowColor=0,this.context.shadowBlur=0)};
Phaser.Text.prototype.measureLine=function(a){for(var b=0,c=0;c<a.length;c++){var d=a[c];if(0<this.fontWeights.length||0<this.fontStyles.length){var e=this.fontToComponents(this.context.font);this.fontStyles[this._charCount]&&(e.fontStyle=this.fontStyles[this._charCount]);this.fontWeights[this._charCount]&&(e.fontWeight=this.fontWeights[this._charCount]);this.context.font=this.componentsToFont(e)}this.style.stroke&&this.style.strokeThickness&&(this.strokeColors[this._charCount]&&(this.context.strokeStyle=
this.strokeColors[this._charCount]),this.updateShadow(this.style.shadowStroke));this.style.fill&&(this.colors[this._charCount]&&(this.context.fillStyle=this.colors[this._charCount]),this.updateShadow(this.style.shadowFill));b+=this.context.measureText(d).width;this._charCount++}return Math.ceil(b)};
Phaser.Text.prototype.updateLine=function(a,b,c){for(var d=0;d<a.length;d++){var e=a[d];if(0<this.fontWeights.length||0<this.fontStyles.length){var f=this.fontToComponents(this.context.font);this.fontStyles[this._charCount]&&(f.fontStyle=this.fontStyles[this._charCount]);this.fontWeights[this._charCount]&&(f.fontWeight=this.fontWeights[this._charCount]);this.context.font=this.componentsToFont(f)}this.style.stroke&&this.style.strokeThickness&&(this.strokeColors[this._charCount]&&(this.context.strokeStyle=
this.strokeColors[this._charCount]),this.updateShadow(this.style.shadowStroke),this.context.strokeText(e,b,c));this.style.fill&&(this.colors[this._charCount]&&(this.context.fillStyle=this.colors[this._charCount]),this.updateShadow(this.style.shadowFill),this.context.fillText(e,b,c));b+=this.context.measureText(e).width;this._charCount++}};Phaser.Text.prototype.clearColors=function(){this.colors=[];this.strokeColors=[];this.dirty=!0;return this};
Phaser.Text.prototype.clearFontValues=function(){this.fontStyles=[];this.fontWeights=[];this.dirty=!0;return this};Phaser.Text.prototype.addColor=function(a,b){this.colors[b]=a;this.dirty=!0;return this};Phaser.Text.prototype.addStrokeColor=function(a,b){this.strokeColors[b]=a;this.dirty=!0;return this};Phaser.Text.prototype.addFontStyle=function(a,b){this.fontStyles[b]=a;this.dirty=!0;return this};Phaser.Text.prototype.addFontWeight=function(a,b){this.fontWeights[b]=a;this.dirty=!0;return this};
Phaser.Text.prototype.precalculateWordWrap=function(a){this.texture.baseTexture.resolution=this._res;this.context.font=this.style.font;return this.runWordWrap(a).split(/(?:\r\n|\r|\n)/)};Phaser.Text.prototype.runWordWrap=function(a){return this.useAdvancedWrap?this.advancedWordWrap(a):this.basicWordWrap(a)};
Phaser.Text.prototype.advancedWordWrap=function(a){var b=this.context,c=this.style.wordWrapWidth,d="";a=a.replace(/ +/gi," ").split(/\r?\n/gi);for(var e=a.length,f=0;f<e;f++){var g=a[f],h="",g=g.replace(/^ *|\s*$/gi,"");if(b.measureText(g).width<c)d+=g+"\n";else{for(var k=c,g=g.split(" "),l=0;l<g.length;l++){var m=g[l],n=m+" ",p=b.measureText(n).width;if(p>k){if(0===l){for(e=n;e.length&&!(e=e.slice(0,-1),p=b.measureText(e).width,p<=k););if(!e.length)throw Error("This text's wordWrapWidth setting is less than a single character!");
k=m.substr(e.length);g[l]=k;h+=e}k=g.slice(g[l].length?l:l+1).join(" ").replace(/[ \n]*$/gi,"");a[f+1]=k+" "+(a[f+1]||"");e=a.length;break}else h+=n,k-=p}d+=h.replace(/[ \n]*$/gi,"")+"\n"}}return d=d.replace(/[\s|\n]*$/gi,"")};
Phaser.Text.prototype.basicWordWrap=function(a){var b="";a=a.split("\n");for(var c=0;c<a.length;c++){for(var d=this.style.wordWrapWidth,e=a[c].split(" "),f=0;f<e.length;f++){var g=this.context.measureText(e[f]).width,h=g+this.context.measureText(" ").width;h>d?(0<f&&(b+="\n"),b+=e[f]+" ",d=this.style.wordWrapWidth-g):(d-=h,b+=e[f]+" ")}c<a.length-1&&(b+="\n")}return b};
Phaser.Text.prototype.updateFont=function(a){a=this.componentsToFont(a);this.style.font!==a&&(this.style.font=a,this.dirty=!0,this.parent&&this.updateTransform())};
Phaser.Text.prototype.fontToComponents=function(a){var b=a.match(/^\s*(?:\b(normal|italic|oblique|inherit)?\b)\s*(?:\b(normal|small-caps|inherit)?\b)\s*(?:\b(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit)?\b)\s*(?:\b(xx-small|x-small|small|medium|large|x-large|xx-large|larger|smaller|0|\d*(?:[.]\d*)?(?:%|[a-z]{2,5}))?\b)\s*(.*)\s*$/);if(b){var c=b[5].trim();/^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(c)||/['",]/.exec(c)||(c="'"+c+"'");return{font:a,fontStyle:b[1]||
"normal",fontVariant:b[2]||"normal",fontWeight:b[3]||"normal",fontSize:b[4]||"medium",fontFamily:c}}console.warn("Phaser.Text - unparsable CSS font: "+a);return{font:a}};Phaser.Text.prototype.componentsToFont=function(a){var b=[],c;(c=a.fontStyle)&&"normal"!==c&&b.push(c);(c=a.fontVariant)&&"normal"!==c&&b.push(c);(c=a.fontWeight)&&"normal"!==c&&b.push(c);(c=a.fontSize)&&"medium"!==c&&b.push(c);(c=a.fontFamily)&&b.push(c);b.length||b.push(a.font);return b.join(" ")};
Phaser.Text.prototype.setText=function(a,b){void 0===b&&(b=!1);this.text=a.toString()||"";b?this.updateText():this.dirty=!0;return this};Phaser.Text.prototype.parseList=function(a){if(Array.isArray(a))for(var b="",c=0;c<a.length;c++)Array.isArray(a[c])?(b+=a[c].join("\t"),c<a.length-1&&(b+="\n")):(b+=a[c],c<a.length-1&&(b+="\t"));else return this;this.text=b;this.dirty=!0;return this};
Phaser.Text.prototype.setTextBounds=function(a,b,c,d){void 0===a?this.textBounds=null:(this.textBounds?this.textBounds.setTo(a,b,c,d):this.textBounds=new Phaser.Rectangle(a,b,c,d),this.style.wordWrapWidth>c&&(this.style.wordWrapWidth=c));this.updateTexture();return this};
Phaser.Text.prototype.updateTexture=function(){var a=this.texture.baseTexture,b=this.texture.crop,c=this.texture.frame,d=this.canvas.width,e=this.canvas.height;a.width=d;a.height=e;b.width=d;b.height=e;c.width=d;c.height=e;this.texture.width=d;this.texture.height=e;this._width=d;this._height=e;this.textBounds&&(a=this.textBounds.x,b=this.textBounds.y,"right"===this.style.boundsAlignH?a+=this.textBounds.width-this.canvas.width/this.resolution:"center"===this.style.boundsAlignH&&(a+=this.textBounds.halfWidth-
this.canvas.width/this.resolution/2),"bottom"===this.style.boundsAlignV?b+=this.textBounds.height-this.canvas.height/this.resolution:"middle"===this.style.boundsAlignV&&(b+=this.textBounds.halfHeight-this.canvas.height/this.resolution/2),this.pivot.x=-a,this.pivot.y=-b);this.renderable=0!==d&&0!==e;this.texture.requiresReTint=!0;this.texture.baseTexture.dirty()};
Phaser.Text.prototype._renderWebGL=function(a){this.dirty&&(this.updateText(),this.dirty=!1);PIXI.Sprite.prototype._renderWebGL.call(this,a)};Phaser.Text.prototype._renderCanvas=function(a){this.dirty&&(this.updateText(),this.dirty=!1);PIXI.Sprite.prototype._renderCanvas.call(this,a)};
Phaser.Text.prototype.determineFontProperties=function(a){var b=Phaser.Text.fontPropertiesCache[a];if(!b){var b={},c=Phaser.Text.fontPropertiesCanvas,d=Phaser.Text.fontPropertiesContext;d.font=a;var e=Math.ceil(d.measureText("|M\u00c9q").width),f=Math.ceil(d.measureText("|M\u00c9q").width),g=2*f,f=1.4*f|0;c.width=e;c.height=g;d.fillStyle="#f00";d.fillRect(0,0,e,g);d.font=a;d.textBaseline="alphabetic";d.fillStyle="#000";d.fillText("|M\u00c9q",0,f);if(!d.getImageData(0,0,e,g))return b.ascent=f,b.descent=
f+6,b.fontSize=b.ascent+b.descent,Phaser.Text.fontPropertiesCache[a]=b;var c=d.getImageData(0,0,e,g).data,d=c.length,e=4*e,h,k,l=0,m=!1;for(h=0;h<f;h++){for(k=0;k<e;k+=4)if(255!==c[l+k]){m=!0;break}if(m)break;else l+=e}b.ascent=f-h;l=d-e;m=!1;for(h=g;h>f;h--){for(k=0;k<e;k+=4)if(255!==c[l+k]){m=!0;break}if(m)break;else l-=e}b.descent=h-f;b.descent+=6;b.fontSize=b.ascent+b.descent;Phaser.Text.fontPropertiesCache[a]=b}return b};
Phaser.Text.prototype.getBounds=function(a){this.dirty&&(this.updateText(),this.dirty=!1);return PIXI.Sprite.prototype.getBounds.call(this,a)};Object.defineProperty(Phaser.Text.prototype,"text",{get:function(){return this._text},set:function(a){a!==this._text&&(this._text=a.toString()||"",this.dirty=!0,this.parent&&this.updateTransform())}});
Object.defineProperty(Phaser.Text.prototype,"cssFont",{get:function(){return this.componentsToFont(this._fontComponents)},set:function(a){this._fontComponents=this.fontToComponents(a||"bold 20pt Arial");this.updateFont(this._fontComponents)}});
Object.defineProperty(Phaser.Text.prototype,"font",{get:function(){return this._fontComponents.fontFamily},set:function(a){a=(a||"Arial").trim();/^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(a)||/['",]/.exec(a)||(a="'"+a+"'");this._fontComponents.fontFamily=a;this.updateFont(this._fontComponents)}});
Object.defineProperty(Phaser.Text.prototype,"fontSize",{get:function(){var a=this._fontComponents.fontSize;return a&&/(?:^0$|px$)/.exec(a)?parseInt(a,10):a},set:function(a){a=a||"0";"number"===typeof a&&(a+="px");this._fontComponents.fontSize=a;this.updateFont(this._fontComponents)}});Object.defineProperty(Phaser.Text.prototype,"fontWeight",{get:function(){return this._fontComponents.fontWeight||"normal"},set:function(a){this._fontComponents.fontWeight=a||"normal";this.updateFont(this._fontComponents)}});
Object.defineProperty(Phaser.Text.prototype,"fontStyle",{get:function(){return this._fontComponents.fontStyle||"normal"},set:function(a){this._fontComponents.fontStyle=a||"normal";this.updateFont(this._fontComponents)}});Object.defineProperty(Phaser.Text.prototype,"fontVariant",{get:function(){return this._fontComponents.fontVariant||"normal"},set:function(a){this._fontComponents.fontVariant=a||"normal";this.updateFont(this._fontComponents)}});
Object.defineProperty(Phaser.Text.prototype,"fill",{get:function(){return this.style.fill},set:function(a){a!==this.style.fill&&(this.style.fill=a,this.dirty=!0)}});Object.defineProperty(Phaser.Text.prototype,"align",{get:function(){return this.style.align},set:function(a){a!==this.style.align&&(this.style.align=a,this.dirty=!0)}});Object.defineProperty(Phaser.Text.prototype,"resolution",{get:function(){return this._res},set:function(a){a!==this._res&&(this._res=a,this.dirty=!0)}});
Object.defineProperty(Phaser.Text.prototype,"tabs",{get:function(){return this.style.tabs},set:function(a){a!==this.style.tabs&&(this.style.tabs=a,this.dirty=!0)}});Object.defineProperty(Phaser.Text.prototype,"boundsAlignH",{get:function(){return this.style.boundsAlignH},set:function(a){a!==this.style.boundsAlignH&&(this.style.boundsAlignH=a,this.dirty=!0)}});
Object.defineProperty(Phaser.Text.prototype,"boundsAlignV",{get:function(){return this.style.boundsAlignV},set:function(a){a!==this.style.boundsAlignV&&(this.style.boundsAlignV=a,this.dirty=!0)}});Object.defineProperty(Phaser.Text.prototype,"stroke",{get:function(){return this.style.stroke},set:function(a){a!==this.style.stroke&&(this.style.stroke=a,this.dirty=!0)}});
Object.defineProperty(Phaser.Text.prototype,"strokeThickness",{get:function(){return this.style.strokeThickness},set:function(a){a!==this.style.strokeThickness&&(this.style.strokeThickness=a,this.dirty=!0)}});Object.defineProperty(Phaser.Text.prototype,"wordWrap",{get:function(){return this.style.wordWrap},set:function(a){a!==this.style.wordWrap&&(this.style.wordWrap=a,this.dirty=!0)}});
Object.defineProperty(Phaser.Text.prototype,"wordWrapWidth",{get:function(){return this.style.wordWrapWidth},set:function(a){a!==this.style.wordWrapWidth&&(this.style.wordWrapWidth=a,this.dirty=!0)}});Object.defineProperty(Phaser.Text.prototype,"lineSpacing",{get:function(){return this._lineSpacing},set:function(a){a!==this._lineSpacing&&(this._lineSpacing=parseFloat(a),this.dirty=!0,this.parent&&this.updateTransform())}});
Object.defineProperty(Phaser.Text.prototype,"shadowOffsetX",{get:function(){return this.style.shadowOffsetX},set:function(a){a!==this.style.shadowOffsetX&&(this.style.shadowOffsetX=a,this.dirty=!0)}});Object.defineProperty(Phaser.Text.prototype,"shadowOffsetY",{get:function(){return this.style.shadowOffsetY},set:function(a){a!==this.style.shadowOffsetY&&(this.style.shadowOffsetY=a,this.dirty=!0)}});
Object.defineProperty(Phaser.Text.prototype,"shadowColor",{get:function(){return this.style.shadowColor},set:function(a){a!==this.style.shadowColor&&(this.style.shadowColor=a,this.dirty=!0)}});Object.defineProperty(Phaser.Text.prototype,"shadowBlur",{get:function(){return this.style.shadowBlur},set:function(a){a!==this.style.shadowBlur&&(this.style.shadowBlur=a,this.dirty=!0)}});
Object.defineProperty(Phaser.Text.prototype,"shadowStroke",{get:function(){return this.style.shadowStroke},set:function(a){a!==this.style.shadowStroke&&(this.style.shadowStroke=a,this.dirty=!0)}});Object.defineProperty(Phaser.Text.prototype,"shadowFill",{get:function(){return this.style.shadowFill},set:function(a){a!==this.style.shadowFill&&(this.style.shadowFill=a,this.dirty=!0)}});
Object.defineProperty(Phaser.Text.prototype,"width",{get:function(){this.dirty&&(this.updateText(),this.dirty=!1);return this.scale.x*this.texture.frame.width},set:function(a){this.scale.x=a/this.texture.frame.width;this._width=a}});Object.defineProperty(Phaser.Text.prototype,"height",{get:function(){this.dirty&&(this.updateText(),this.dirty=!1);return this.scale.y*this.texture.frame.height},set:function(a){this.scale.y=a/this.texture.frame.height;this._height=a}});
Phaser.Text.fontPropertiesCache={};Phaser.Text.fontPropertiesCanvas=document.createElement("canvas");Phaser.Text.fontPropertiesContext=Phaser.Text.fontPropertiesCanvas.getContext("2d");
Phaser.BitmapText=function(a,b,c,d,e,f,g){b=b||0;c=c||0;d=d||"";e=e||"";f=f||32;g=g||"left";PIXI.DisplayObjectContainer.call(this);this.type=Phaser.BITMAPTEXT;this.physicsType=Phaser.SPRITE;this.textHeight=this.textWidth=0;this.anchor=new Phaser.Point;this._prevAnchor=new Phaser.Point;this._glyphs=[];this._maxWidth=0;this._text=e.toString()||"";this._data=a.cache.getBitmapFont(d);this._font=d;this._fontSize=f;this._align=g;this._tint=16777215;this.updateText();this.dirty=!1;Phaser.Component.Core.init.call(this,
a,b,c,"",null)};Phaser.BitmapText.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);Phaser.BitmapText.prototype.constructor=Phaser.BitmapText;Phaser.Component.Core.install.call(Phaser.BitmapText.prototype,"Angle AutoCull Bounds Destroy FixedToCamera InputEnabled InWorld LifeSpan PhysicsBody Reset".split(" "));Phaser.BitmapText.prototype.preUpdatePhysics=Phaser.Component.PhysicsBody.preUpdate;Phaser.BitmapText.prototype.preUpdateLifeSpan=Phaser.Component.LifeSpan.preUpdate;
Phaser.BitmapText.prototype.preUpdateInWorld=Phaser.Component.InWorld.preUpdate;Phaser.BitmapText.prototype.preUpdateCore=Phaser.Component.Core.preUpdate;Phaser.BitmapText.prototype.preUpdate=function(){return this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1};
Phaser.BitmapText.prototype.postUpdate=function(){Phaser.Component.PhysicsBody.postUpdate.call(this);Phaser.Component.FixedToCamera.postUpdate.call(this);this.body&&this.body.type===Phaser.Physics.ARCADE&&(this.textWidth===this.body.sourceWidth&&this.textHeight===this.body.sourceHeight||this.body.setSize(this.textWidth,this.textHeight))};Phaser.BitmapText.prototype.setText=function(a){this.text=a};
Phaser.BitmapText.prototype.scanLine=function(a,b,c){for(var d=0,e=0,f=-1,g=0,h=null,k=0<this._maxWidth?this._maxWidth:null,l=[],m=0;m<c.length;m++){var n=m===c.length-1?!0:!1;if(/(?:\r\n|\r|\n)/.test(c.charAt(m)))return{width:e,text:c.substr(0,m),end:n,chars:l};var p=c.charCodeAt(m),q=a.chars[p],t=0;void 0===q&&(p=32,q=a.chars[p]);h=h&&q.kerning[h]?q.kerning[h]:0;/(\s)/.test(c.charAt(m))&&(f=m,g=e);t=(h+q.texture.width+q.xOffset)*b;if(k&&e+t>=k&&-1<f)return{width:g||e,text:c.substr(0,m-(m-f)),end:n,
chars:l};e+=(q.xAdvance+h)*b;l.push(d+(q.xOffset+h)*b);d+=(q.xAdvance+h)*b;h=p}return{width:e,text:c,end:n,chars:l}};Phaser.BitmapText.prototype.cleanText=function(a,b){void 0===b&&(b="");var c=this._data.font;if(!c)return"";for(var d=a.replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),e=0;e<d.length;e++){for(var f="",g=d[e],h=0;h<g.length;h++)f=c.chars[g.charCodeAt(h)]?f.concat(g[h]):f.concat(b);d[e]=f}return d.join("\n")};
Phaser.BitmapText.prototype.updateText=function(){var a=this._data.font;if(a){var b=this.text,c=this._fontSize/a.size,d=[],e=0;this.textWidth=0;do{var f=this.scanLine(a,c,b);f.y=e;d.push(f);f.width>this.textWidth&&(this.textWidth=f.width);e+=a.lineHeight*c;b=b.substr(f.text.length+1)}while(!1===f.end);this.textHeight=e;for(var e=b=0,g=this.textWidth*this.anchor.x,h=this.textHeight*this.anchor.y,k=0;k<d.length;k++){f=d[k];"right"===this._align?e=this.textWidth-f.width:"center"===this._align&&(e=(this.textWidth-
f.width)/2);for(var l=0;l<f.text.length;l++){var m=f.text.charCodeAt(l),m=a.chars[m];void 0===m&&(m=32,m=a.chars[m]);var n=this._glyphs[b];n?n.texture=m.texture:(n=new PIXI.Sprite(m.texture),n.name=f.text[l],this._glyphs.push(n));n.position.x=f.chars[l]+e-g;n.position.y=f.y+m.yOffset*c-h;n.scale.set(c);n.tint=this.tint;n.texture.requiresReTint=!0;n.parent||this.addChild(n);b++}}for(k=b;k<this._glyphs.length;k++)this.removeChild(this._glyphs[k])}};
Phaser.BitmapText.prototype.purgeGlyphs=function(){for(var a=this._glyphs.length,b=[],c=0;c<this._glyphs.length;c++)this._glyphs[c].parent!==this?this._glyphs[c].destroy():b.push(this._glyphs[c]);this._glyphs=[];this._glyphs=b;this.updateText();return a-b.length};Phaser.BitmapText.prototype.updateTransform=function(){if(this.dirty||!this.anchor.equals(this._prevAnchor))this.updateText(),this.dirty=!1,this._prevAnchor.copyFrom(this.anchor);PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)};
Object.defineProperty(Phaser.BitmapText.prototype,"align",{get:function(){return this._align},set:function(a){a===this._align||"left"!==a&&"center"!==a&&"right"!==a||(this._align=a,this.updateText())}});Object.defineProperty(Phaser.BitmapText.prototype,"tint",{get:function(){return this._tint},set:function(a){a!==this._tint&&(this._tint=a,this.updateText())}});
Object.defineProperty(Phaser.BitmapText.prototype,"font",{get:function(){return this._font},set:function(a){a!==this._font&&(this._font=a.trim(),this._data=this.game.cache.getBitmapFont(this._font),this.updateText())}});Object.defineProperty(Phaser.BitmapText.prototype,"fontSize",{get:function(){return this._fontSize},set:function(a){a=parseInt(a,10);a!==this._fontSize&&0<a&&(this._fontSize=a,this.updateText())}});
Object.defineProperty(Phaser.BitmapText.prototype,"text",{get:function(){return this._text},set:function(a){a!==this._text&&(this._text=a.toString()||"",this.updateText())}});Object.defineProperty(Phaser.BitmapText.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(a){a!==this._maxWidth&&(this._maxWidth=a,this.updateText())}});
Object.defineProperty(Phaser.BitmapText.prototype,"smoothed",{get:function(){return!this._data.base.scaleMode},set:function(a){this._data.base.scaleMode=a?0:1}});
Phaser.RetroFont=function(a,b,c,d,e,f,g,h,k,l){if(!a.cache.checkImageKey(b))return!1;if(void 0===f||null===f)f=a.cache.getImage(b).width/c;this.characterWidth=c;this.characterHeight=d;this.characterSpacingX=g||0;this.characterSpacingY=h||0;this.characterPerRow=f;this.offsetX=k||0;this.offsetY=l||0;this.align="left";this.multiLine=!1;this.autoUpperCase=!0;this.fixedWidth=this.customSpacingY=this.customSpacingX=0;this.fontSet=a.cache.getImage(b);this._text="";this.grabData=[];this.frameData=new Phaser.FrameData;
c=this.offsetX;d=this.offsetY;for(g=f=0;g<e.length;g++)h=this.frameData.addFrame(new Phaser.Frame(g,c,d,this.characterWidth,this.characterHeight)),this.grabData[e.charCodeAt(g)]=h.index,f++,f===this.characterPerRow?(f=0,c=this.offsetX,d+=this.characterHeight+this.characterSpacingY):c+=this.characterWidth+this.characterSpacingX;a.cache.updateFrameData(b,this.frameData);this.stamp=new Phaser.Image(a,0,0,b,0);Phaser.RenderTexture.call(this,a,100,100,"",Phaser.scaleModes.NEAREST);this.type=Phaser.RETROFONT};
Phaser.RetroFont.prototype=Object.create(Phaser.RenderTexture.prototype);Phaser.RetroFont.prototype.constructor=Phaser.RetroFont;Phaser.RetroFont.ALIGN_LEFT="left";Phaser.RetroFont.ALIGN_RIGHT="right";Phaser.RetroFont.ALIGN_CENTER="center";Phaser.RetroFont.TEXT_SET1=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~";Phaser.RetroFont.TEXT_SET2=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ";Phaser.RetroFont.TEXT_SET3="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ";
Phaser.RetroFont.TEXT_SET4="ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789";Phaser.RetroFont.TEXT_SET5="ABCDEFGHIJKLMNOPQRSTUVWXYZ.,/() '!?-*:0123456789";Phaser.RetroFont.TEXT_SET6="ABCDEFGHIJKLMNOPQRSTUVWXYZ!?:;0123456789\"(),-.' ";Phaser.RetroFont.TEXT_SET7="AGMSY+:4BHNTZ!;5CIOU.?06DJPV,(17EKQW\")28FLRX-'39";Phaser.RetroFont.TEXT_SET8="0123456789 .ABCDEFGHIJKLMNOPQRSTUVWXYZ";Phaser.RetroFont.TEXT_SET9="ABCDEFGHIJKLMNOPQRSTUVWXYZ()-0123456789.:,'\"?!";Phaser.RetroFont.TEXT_SET10="ABCDEFGHIJKLMNOPQRSTUVWXYZ";
Phaser.RetroFont.TEXT_SET11="ABCDEFGHIJKLMNOPQRSTUVWXYZ.,\"-+!?()':;0123456789";Phaser.RetroFont.prototype.setFixedWidth=function(a,b){void 0===b&&(b="left");this.fixedWidth=a;this.align=b};Phaser.RetroFont.prototype.setText=function(a,b,c,d,e,f){this.multiLine=b||!1;this.customSpacingX=c||0;this.customSpacingY=d||0;this.align=e||"left";this.autoUpperCase=f?!1:!0;0<a.length&&(this.text=a)};
Phaser.RetroFont.prototype.buildRetroFontText=function(){var a=0,b=0;this.clear();if(this.multiLine){var c=this._text.split("\n");0<this.fixedWidth?this.resize(this.fixedWidth,c.length*(this.characterHeight+this.customSpacingY)-this.customSpacingY,!0):this.resize(this.getLongestLine()*(this.characterWidth+this.customSpacingX),c.length*(this.characterHeight+this.customSpacingY)-this.customSpacingY,!0);for(var d=0;d<c.length;d++)a=0,this.align===Phaser.RetroFont.ALIGN_RIGHT?a=this.width-c[d].length*
(this.characterWidth+this.customSpacingX):this.align===Phaser.RetroFont.ALIGN_CENTER&&(a=this.width/2-c[d].length*(this.characterWidth+this.customSpacingX)/2,a+=this.customSpacingX/2),0>a&&(a=0),this.pasteLine(c[d],a,b,this.customSpacingX),b+=this.characterHeight+this.customSpacingY}else 0<this.fixedWidth?this.resize(this.fixedWidth,this.characterHeight,!0):this.resize(this._text.length*(this.characterWidth+this.customSpacingX),this.characterHeight,!0),a=0,this.align===Phaser.RetroFont.ALIGN_RIGHT?
a=this.width-this._text.length*(this.characterWidth+this.customSpacingX):this.align===Phaser.RetroFont.ALIGN_CENTER&&(a=this.width/2-this._text.length*(this.characterWidth+this.customSpacingX)/2,a+=this.customSpacingX/2),0>a&&(a=0),this.pasteLine(this._text,a,0,this.customSpacingX);this.requiresReTint=!0};
Phaser.RetroFont.prototype.pasteLine=function(a,b,c,d){for(var e=0;e<a.length;e++)if(" "===a.charAt(e))b+=this.characterWidth+d;else if(0<=this.grabData[a.charCodeAt(e)]&&(this.stamp.frame=this.grabData[a.charCodeAt(e)],this.renderXY(this.stamp,b,c,!1),b+=this.characterWidth+d,b>this.width))break};Phaser.RetroFont.prototype.getLongestLine=function(){var a=0;if(0<this._text.length)for(var b=this._text.split("\n"),c=0;c<b.length;c++)b[c].length>a&&(a=b[c].length);return a};
Phaser.RetroFont.prototype.removeUnsupportedCharacters=function(a){for(var b="",c=0;c<this._text.length;c++){var d=this._text[c],e=d.charCodeAt(0);if(0<=this.grabData[e]||!a&&"\n"===d)b=b.concat(d)}return b};Phaser.RetroFont.prototype.updateOffset=function(a,b){if(this.offsetX!==a||this.offsetY!==b){for(var c=a-this.offsetX,d=b-this.offsetY,e=this.game.cache.getFrameData(this.stamp.key).getFrames(),f=e.length;f--;)e[f].x+=c,e[f].y+=d;this.buildRetroFontText()}};
Object.defineProperty(Phaser.RetroFont.prototype,"text",{get:function(){return this._text},set:function(a){a=this.autoUpperCase?a.toUpperCase():a;a!==this._text&&(this._text=a,this.removeUnsupportedCharacters(this.multiLine),this.buildRetroFontText())}});Object.defineProperty(Phaser.RetroFont.prototype,"smoothed",{get:function(){return this.stamp.smoothed},set:function(a){this.stamp.smoothed=a;this.buildRetroFontText()}});Phaser.TileSprite=function(){};
Phaser.Device=function(){this.deviceReadyAt=0;this.iOS=this.desktop=this.initialized=!1;this.iOSVersion=0;this.canvas=this.windowsPhone=this.windows=this.macOS=this.linux=this.chromeOS=this.android=this.crosswalk=this.ejecta=this.electron=this.nodeWebkit=this.node=this.cordova=this.cocoonJSApp=this.cocoonJS=!1;this.canvasBitBltShift=null;this.vibration=this.typedArray=this.pointerLock=this.css3D=this.worker=this.localStorage=this.fileSystem=this.file=this.webGL=!1;this.getUserMedia=!0;this.mspointer=
this.touch=this.quirksMode=!1;this.wheelEvent=null;this.chrome=this.arora=!1;this.chromeVersion=0;this.firefox=this.epiphany=!1;this.firefoxVersion=0;this.ie=!1;this.ieVersion=0;this.trident=!1;this.tridentVersion=0;this.safari=this.opera=this.midori=this.mobileSafari=this.edge=!1;this.safariVersion=0;this.iPad=this.iPhone4=this.iPhone=this.hlsVideo=this.vp9Video=this.webmVideo=this.mp4Video=this.h264Video=this.oggVideo=this.dolby=this.webm=this.m4a=this.wav=this.mp3=this.opus=this.ogg=this.webAudio=
this.audioData=this.silk=this.webApp=!1;this.pixelRatio=0;this.fullscreen=this.support32bit=this.LITTLE_ENDIAN=this.littleEndian=!1;this.cancelFullscreen=this.requestFullscreen="";this.fullscreenKeyboard=!1};Phaser.Device=new Phaser.Device;Phaser.Device.onInitialized=new Phaser.Signal;
Phaser.Device.whenReady=function(a,b,c){var d=this._readyCheck;this.deviceReadyAt||!d?a.call(b,this):d._monitor||c?(d._queue=d._queue||[],d._queue.push([a,b])):(d._monitor=d.bind(this),d._queue=d._queue||[],d._queue.push([a,b]),a="undefined"!==typeof window.cordova,b=navigator.isCocoonJS,"complete"===document.readyState||"interactive"===document.readyState?window.setTimeout(d._monitor,0):a&&!b?document.addEventListener("deviceready",d._monitor,!1):(document.addEventListener("DOMContentLoaded",d._monitor,
!1),window.addEventListener("load",d._monitor,!1)))};
Phaser.Device._readyCheck=function(){var a=this._readyCheck;if(!document.body)window.setTimeout(a._monitor,20);else if(!this.deviceReadyAt){this.deviceReadyAt=Date.now();document.removeEventListener("deviceready",a._monitor);document.removeEventListener("DOMContentLoaded",a._monitor);window.removeEventListener("load",a._monitor);this._initialize();this.initialized=!0;this.onInitialized.dispatch(this);for(var b;b=a._queue.shift();)b[0].call(b[1],this);this.onInitialized=this._initialize=this._readyCheck=
null}};
Phaser.Device._initialize=function(){function a(){var a=new ArrayBuffer(4),b=new Uint8Array(a),a=new Uint32Array(a);b[0]=161;b[1]=178;b[2]=195;b[3]=212;return 3569595041===a[0]?!0:2712847316===a[0]?!1:null}function b(){if(void 0===Uint8ClampedArray)return!1;var a=PIXI.CanvasPool.create(this,1,1).getContext("2d");if(!a)return!1;a=a.createImageData(1,1);PIXI.CanvasPool.remove(this);return a.data instanceof Uint8ClampedArray}var c=this;(function(){var a=navigator.userAgent;/Playstation Vita/.test(a)?c.vita=
!0:/Kindle/.test(a)||/\bKF[A-Z][A-Z]+/.test(a)||/Silk.*Mobile Safari/.test(a)?c.kindle=!0:/Android/.test(a)?c.android=!0:/CrOS/.test(a)?c.chromeOS=!0:/iP[ao]d|iPhone/i.test(a)?(c.iOS=!0,navigator.appVersion.match(/OS (\d+)/),c.iOSVersion=parseInt(RegExp.$1,10)):/Linux/.test(a)?c.linux=!0:/Mac OS/.test(a)?c.macOS=!0:/Windows/.test(a)&&(c.windows=!0);if(/Windows Phone/i.test(a)||/IEMobile/i.test(a))c.android=!1,c.iOS=!1,c.macOS=!1,c.windows=!0,c.windowsPhone=!0;var b=/Silk/.test(a);if(c.windows||c.macOS||
c.linux&&!b||c.chromeOS)c.desktop=!0;if(c.windowsPhone||/Windows NT/i.test(a)&&/Touch/i.test(a))c.desktop=!1})();(function(){var a=navigator.userAgent;/Arora/.test(a)?c.arora=!0:/Edge\/\d+/.test(a)?c.edge=!0:/Chrome\/(\d+)/.test(a)&&!c.windowsPhone?(c.chrome=!0,c.chromeVersion=parseInt(RegExp.$1,10)):/Epiphany/.test(a)?c.epiphany=!0:/Firefox\D+(\d+)/.test(a)?(c.firefox=!0,c.firefoxVersion=parseInt(RegExp.$1,10)):/AppleWebKit/.test(a)&&c.iOS?c.mobileSafari=!0:/MSIE (\d+\.\d+);/.test(a)?(c.ie=!0,c.ieVersion=
parseInt(RegExp.$1,10)):/Midori/.test(a)?c.midori=!0:/Opera/.test(a)?c.opera=!0:/Safari\/(\d+)/.test(a)&&!c.windowsPhone?(c.safari=!0,/Version\/(\d+)\./.test(a)&&(c.safariVersion=parseInt(RegExp.$1,10))):/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(a)&&(c.ie=!0,c.trident=!0,c.tridentVersion=parseInt(RegExp.$1,10),c.ieVersion=parseInt(RegExp.$3,10));/Silk/.test(a)&&(c.silk=!0);navigator.standalone&&(c.webApp=!0);"undefined"!==typeof window.cordova&&(c.cordova=!0);"undefined"!==typeof process&&"undefined"!==
typeof require&&(c.node=!0);c.node&&"object"===typeof process.versions&&(c.nodeWebkit=!!process.versions["node-webkit"],c.electron=!!process.versions.electron);navigator.isCocoonJS&&(c.cocoonJS=!0);if(c.cocoonJS)try{c.cocoonJSApp="undefined"!==typeof CocoonJS}catch(b){c.cocoonJSApp=!1}"undefined"!==typeof window.ejecta&&(c.ejecta=!0);/Crosswalk/.test(a)&&(c.crosswalk=!0)})();(function(){c.audioData=!!window.Audio;c.webAudio=!(!window.AudioContext&&!window.webkitAudioContext);var a=document.createElement("audio");
try{if(a.canPlayType){a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(c.ogg=!0);if(a.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")||a.canPlayType("audio/opus;").replace(/^no$/,""))c.opus=!0;a.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(c.mp3=!0);a.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")&&(c.wav=!0);if(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/aac;").replace(/^no$/,""))c.m4a=!0;a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")&&
(c.webm=!0);if(""!==a.canPlayType('audio/mp4;codecs="ec-3"'))if(c.edge)c.dolby=!0;else if(c.safari&&9<=c.safariVersion&&/Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)){var b=parseInt(RegExp.$1,10),f=parseInt(RegExp.$2,10);if(10===b&&11<=f||10<b)c.dolby=!0}}}catch(g){}})();(function(){var a=document.createElement("video");try{a.canPlayType&&(a.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,"")&&(c.oggVideo=!0),a.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,"")&&(c.h264Video=
!0,c.mp4Video=!0),a.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")&&(c.webmVideo=!0),a.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,"")&&(c.vp9Video=!0),a.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,"")&&(c.hlsVideo=!0))}catch(b){}})();(function(){var a=document.createElement("p"),b,f={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(a,
null);for(var g in f)void 0!==a.style[g]&&(a.style[g]="translate3d(1px,1px,1px)",b=window.getComputedStyle(a).getPropertyValue(f[g]));document.body.removeChild(a);c.css3D=void 0!==b&&0<b.length&&"none"!==b})();c.pixelRatio=window.devicePixelRatio||1;c.iPhone=-1!==navigator.userAgent.toLowerCase().indexOf("iphone");c.iPhone4=2===c.pixelRatio&&c.iPhone;c.iPad=-1!==navigator.userAgent.toLowerCase().indexOf("ipad");c.typedArray="undefined"!==typeof Int8Array?!0:!1;"undefined"!==typeof ArrayBuffer&&"undefined"!==
typeof Uint8Array&&"undefined"!==typeof Uint32Array&&(c.littleEndian=a(),c.LITTLE_ENDIAN=c.littleEndian);c.support32bit="undefined"!==typeof ArrayBuffer&&"undefined"!==typeof Uint8ClampedArray&&"undefined"!==typeof Int32Array&&null!==c.littleEndian&&b();navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate;navigator.vibrate&&(c.vibration=!0);(function(){c.canvas=!!window.CanvasRenderingContext2D||c.cocoonJS;try{c.localStorage=!!localStorage.getItem}catch(a){c.localStorage=
!1}c.file=!!window.File&&!!window.FileReader&&!!window.FileList&&!!window.Blob;c.fileSystem=!!window.requestFileSystem;var b;try{var e=document.createElement("canvas");e.screencanvas=!1;b=!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(a){b=!1}c.webGL=b;c.webGL=!!c.webGL;c.worker=!!window.Worker;c.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document;c.quirksMode="CSS1Compat"===document.compatMode?
!1:!0;navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia;window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL;c.getUserMedia=c.getUserMedia&&!!navigator.getUserMedia&&!!window.URL;c.firefox&&21>c.firefoxVersion&&(c.getUserMedia=!1);!c.iOS&&(c.ie||c.firefox||c.chrome)&&(c.canvasBitBltShift=!0);if(c.safari||c.mobileSafari)c.canvasBitBltShift=!1})();(function(){for(var a="requestFullscreen requestFullScreen webkitRequestFullscreen webkitRequestFullScreen msRequestFullscreen msRequestFullScreen mozRequestFullScreen mozRequestFullscreen".split(" "),
b=document.createElement("div"),f=0;f<a.length;f++)if(b[a[f]]){c.fullscreen=!0;c.requestFullscreen=a[f];break}a="cancelFullScreen exitFullscreen webkitCancelFullScreen webkitExitFullscreen msCancelFullScreen msExitFullscreen mozCancelFullScreen mozExitFullscreen".split(" ");if(c.fullscreen)for(f=0;f<a.length;f++)if(document[a[f]]){c.cancelFullscreen=a[f];break}window.Element&&Element.ALLOW_KEYBOARD_INPUT&&(c.fullscreenKeyboard=!0)})();if("ontouchstart"in document.documentElement||window.navigator.maxTouchPoints&&
1<=window.navigator.maxTouchPoints)c.touch=!0;if(window.navigator.msPointerEnabled||window.navigator.pointerEnabled)c.mspointer=!0;c.cocoonJS||("onwheel"in window||c.ie&&"WheelEvent"in window?c.wheelEvent="wheel":"onmousewheel"in window?c.wheelEvent="mousewheel":c.firefox&&"MouseScrollEvent"in window&&(c.wheelEvent="DOMMouseScroll"))};
Phaser.Device.canPlayAudio=function(a){return"mp3"===a&&this.mp3||"ogg"===a&&(this.ogg||this.opus)||"m4a"===a&&this.m4a||"opus"===a&&this.opus||"wav"===a&&this.wav||"webm"===a&&this.webm||"mp4"===a&&this.dolby?!0:!1};Phaser.Device.canPlayVideo=function(a){return"webm"===a&&(this.webmVideo||this.vp9Video)||"mp4"===a&&(this.mp4Video||this.h264Video)||("ogg"===a||"ogv"===a)&&this.oggVideo||"mpeg"===a&&this.hlsVideo?!0:!1};
Phaser.Device.isConsoleOpen=function(){return window.console&&window.console.firebug?!0:window.console&&(console.profile(),console.profileEnd(),console.clear&&console.clear(),console.profiles)?0<console.profiles.length:!1};Phaser.Device.isAndroidStockBrowser=function(){var a=window.navigator.userAgent.match(/Android.*AppleWebKit\/([\d.]+)/);return a&&537>a[1]};
Phaser.Canvas={create:function(a,b,c,d,e){b=b||256;c=c||256;a=e?document.createElement("canvas"):PIXI.CanvasPool.create(a,b,c);"string"===typeof d&&""!==d&&(a.id=d);a.width=b;a.height=c;a.style.display="block";return a},setBackgroundColor:function(a,b){a.style.backgroundColor=b||"rgb(0,0,0)";return a},setTouchAction:function(a,b){b=b||"none";a.style.msTouchAction=b;a.style["ms-touch-action"]=b;a.style["touch-action"]=b;return a},setUserSelect:function(a,b){b=b||"none";a.style["-webkit-touch-callout"]=
b;a.style["-webkit-user-select"]=b;a.style["-khtml-user-select"]=b;a.style["-moz-user-select"]=b;a.style["-ms-user-select"]=b;a.style["user-select"]=b;a.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)";return a},addToDOM:function(a,b,c){var d;void 0===c&&(c=!0);b&&("string"===typeof b?d=document.getElementById(b):"object"===typeof b&&1===b.nodeType&&(d=b));d||(d=document.body);c&&d.style&&(d.style.overflow="hidden");d.appendChild(a);return a},removeFromDOM:function(a){a.parentNode&&a.parentNode.removeChild(a)},
setTransform:function(a,b,c,d,e,f,g){a.setTransform(d,f,g,e,b,c);return a},setSmoothingEnabled:function(a,b){var c=Phaser.Canvas.getSmoothingPrefix(a);c&&(a[c]=b);return a},getSmoothingPrefix:function(a){var b=["i","webkitI","msI","mozI","oI"],c;for(c in b){var d=b[c]+"mageSmoothingEnabled";if(d in a)return d}return null},getSmoothingEnabled:function(a){var b=Phaser.Canvas.getSmoothingPrefix(a);if(b)return a[b]},setImageRenderingCrisp:function(a){for(var b="optimizeSpeed crisp-edges -moz-crisp-edges -webkit-optimize-contrast optimize-contrast pixelated".split(" "),
c=0;c<b.length;c++)a.style["image-rendering"]=b[c];a.style.msInterpolationMode="nearest-neighbor";return a},setImageRenderingBicubic:function(a){a.style["image-rendering"]="auto";a.style.msInterpolationMode="bicubic";return a}};
Phaser.RequestAnimationFrame=function(a,b){void 0===b&&(b=!1);this.game=a;this.isRunning=!1;this.forceSetTimeOut=b;for(var c=["ms","moz","webkit","o"],d=0;d<c.length&&!window.requestAnimationFrame;d++)window.requestAnimationFrame=window[c[d]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[d]+"CancelAnimationFrame"];this._isSetTimeOut=!1;this._timeOutID=this._onLoop=null};
Phaser.RequestAnimationFrame.prototype={start:function(){this.isRunning=!0;var a=this;!window.requestAnimationFrame||this.forceSetTimeOut?(this._isSetTimeOut=!0,this._onLoop=function(){return a.updateSetTimeout()},this._timeOutID=window.setTimeout(this._onLoop,0)):(this._isSetTimeOut=!1,this._onLoop=function(b){return a.updateRAF(b)},this._timeOutID=window.requestAnimationFrame(this._onLoop))},updateRAF:function(a){this.isRunning&&(this.game.update(Math.floor(a)),this._timeOutID=window.requestAnimationFrame(this._onLoop))},
updateSetTimeout:function(){this.isRunning&&(this.game.update(Date.now()),this._timeOutID=window.setTimeout(this._onLoop,this.game.time.timeToCall))},stop:function(){this._isSetTimeOut?clearTimeout(this._timeOutID):window.cancelAnimationFrame(this._timeOutID);this.isRunning=!1},isSetTimeOut:function(){return this._isSetTimeOut},isRAF:function(){return!1===this._isSetTimeOut}};Phaser.RequestAnimationFrame.prototype.constructor=Phaser.RequestAnimationFrame;
Phaser.Math={PI2:2*Math.PI,between:function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},fuzzyEqual:function(a,b,c){void 0===c&&(c=1E-4);return Math.abs(a-b)<c},fuzzyLessThan:function(a,b,c){void 0===c&&(c=1E-4);return a<b+c},fuzzyGreaterThan:function(a,b,c){void 0===c&&(c=1E-4);return a>b-c},fuzzyCeil:function(a,b){void 0===b&&(b=1E-4);return Math.ceil(a-b)},fuzzyFloor:function(a,b){void 0===b&&(b=1E-4);return Math.floor(a+b)},average:function(){for(var a=0,b=arguments.length,c=0;c<b;c++)a+=
+arguments[c];return a/b},shear:function(a){return a%1},snapTo:function(a,b,c){void 0===c&&(c=0);if(0===b)return a;a=b*Math.round((a-c)/b);return c+a},snapToFloor:function(a,b,c){void 0===c&&(c=0);if(0===b)return a;a=b*Math.floor((a-c)/b);return c+a},snapToCeil:function(a,b,c){void 0===c&&(c=0);if(0===b)return a;a=b*Math.ceil((a-c)/b);return c+a},roundTo:function(a,b,c){void 0===b&&(b=0);void 0===c&&(c=10);b=Math.pow(c,-b);return Math.round(a*b)/b},floorTo:function(a,b,c){void 0===b&&(b=0);void 0===
c&&(c=10);b=Math.pow(c,-b);return Math.floor(a*b)/b},ceilTo:function(a,b,c){void 0===b&&(b=0);void 0===c&&(c=10);b=Math.pow(c,-b);return Math.ceil(a*b)/b},rotateToAngle:function(a,b,c){void 0===c&&(c=.05);if(a===b)return a;Math.abs(b-a)<=c||Math.abs(b-a)>=Phaser.Math.PI2-c?a=b:(Math.abs(b-a)>Math.PI&&(b=b<a?b+Phaser.Math.PI2:b-Phaser.Math.PI2),b>a?a+=c:b<a&&(a-=c));return a},getShortestAngle:function(a,b){var c=b-a;return 0===c?0:c-360*Math.floor((c- -180)/360)},angleBetween:function(a,b,c,d){return Math.atan2(d-
b,c-a)},angleBetweenY:function(a,b,c,d){return Math.atan2(c-a,d-b)},angleBetweenPoints:function(a,b){return Math.atan2(b.y-a.y,b.x-a.x)},angleBetweenPointsY:function(a,b){return Math.atan2(b.x-a.x,b.y-a.y)},reverseAngle:function(a){return this.normalizeAngle(a+Math.PI,!0)},normalizeAngle:function(a){a%=2*Math.PI;return 0<=a?a:a+2*Math.PI},maxAdd:function(a,b,c){return Math.min(a+b,c)},minSub:function(a,b,c){return Math.max(a-b,c)},wrap:function(a,b,c){c-=b;if(0>=c)return 0;a=(a-b)%c;0>a&&(a+=c);return a+
b},wrapValue:function(a,b,c){a=Math.abs(a);b=Math.abs(b);c=Math.abs(c);return(a+b)%c},isOdd:function(a){return!!(a&1)},isEven:function(a){return!(a&1)},min:function(){for(var a=1===arguments.length&&"object"===typeof arguments[0]?arguments[0]:arguments,b=1,c=0,d=a.length;b<d;b++)a[b]<a[c]&&(c=b);return a[c]},max:function(){for(var a=1===arguments.length&&"object"===typeof arguments[0]?arguments[0]:arguments,b=1,c=0,d=a.length;b<d;b++)a[b]>a[c]&&(c=b);return a[c]},minProperty:function(a){for(var b=
2===arguments.length&&"object"===typeof arguments[1]?arguments[1]:arguments.slice(1),c=1,d=0,e=b.length;c<e;c++)b[c][a]<b[d][a]&&(d=c);return b[d][a]},maxProperty:function(a){for(var b=2===arguments.length&&"object"===typeof arguments[1]?arguments[1]:arguments.slice(1),c=1,d=0,e=b.length;c<e;c++)b[c][a]>b[d][a]&&(d=c);return b[d][a]},wrapAngle:function(a,b){return b?this.wrap(a,-Math.PI,Math.PI):this.wrap(a,-180,180)},linearInterpolation:function(a,b){var c=a.length-1,d=c*b,e=Math.floor(d);return 0>
b?this.linear(a[0],a[1],d):1<b?this.linear(a[c],a[c-1],c-d):this.linear(a[e],a[e+1>c?c:e+1],d-e)},bezierInterpolation:function(a,b){for(var c=0,d=a.length-1,e=0;e<=d;e++)c+=Math.pow(1-b,d-e)*Math.pow(b,e)*a[e]*this.bernstein(d,e);return c},catmullRomInterpolation:function(a,b){var c=a.length-1,d=c*b,e=Math.floor(d);return a[0]===a[c]?(0>b&&(e=Math.floor(d=c*(1+b))),this.catmullRom(a[(e-1+c)%c],a[e],a[(e+1)%c],a[(e+2)%c],d-e)):0>b?a[0]-(this.catmullRom(a[0],a[0],a[1],a[1],-d)-a[0]):1<b?a[c]-(this.catmullRom(a[c],
a[c],a[c-1],a[c-1],d-c)-a[c]):this.catmullRom(a[e?e-1:0],a[e],a[c<e+1?c:e+1],a[c<e+2?c:e+2],d-e)},linear:function(a,b,c){return(b-a)*c+a},bernstein:function(a,b){return this.factorial(a)/this.factorial(b)/this.factorial(a-b)},factorial:function(a){if(0===a)return 1;for(var b=a;--a;)b*=a;return b},catmullRom:function(a,b,c,d,e){a=.5*(c-a);d=.5*(d-b);var f=e*e;return(2*b-2*c+a+d)*e*f+(-3*b+3*c-2*a-d)*f+a*e+b},difference:function(a,b){return Math.abs(a-b)},roundAwayFromZero:function(a){return 0<a?Math.ceil(a):
Math.floor(a)},sinCosGenerator:function(a,b,c,d){void 0===b&&(b=1);void 0===c&&(c=1);void 0===d&&(d=1);d=d*Math.PI/a;for(var e=[],f=[],g=0;g<a;g++)c-=b*d,b+=c*d,e[g]=c,f[g]=b;return{sin:f,cos:e,length:a}},distance:function(a,b,c,d){a-=c;b-=d;return Math.sqrt(a*a+b*b)},distanceSq:function(a,b,c,d){a-=c;b-=d;return a*a+b*b},distancePow:function(a,b,c,d,e){void 0===e&&(e=2);return Math.sqrt(Math.pow(c-a,e)+Math.pow(d-b,e))},clamp:function(a,b,c){return a<b?b:c<a?c:a},clampBottom:function(a,b){return a<
b?b:a},within:function(a,b,c){return Math.abs(a-b)<=c},mapLinear:function(a,b,c,d,e){return d+(a-b)*(e-d)/(c-b)},smoothstep:function(a,b,c){a=Math.max(0,Math.min(1,(a-b)/(c-b)));return a*a*(3-2*a)},smootherstep:function(a,b,c){a=Math.max(0,Math.min(1,(a-b)/(c-b)));return a*a*a*(a*(6*a-15)+10)},sign:function(a){return 0>a?-1:0<a?1:0},percent:function(a,b,c){void 0===c&&(c=0);return a>b||c>b?1:a<c||c>a?0:(a-c)/b}};var degreeToRadiansFactor=Math.PI/180,radianToDegreesFactor=180/Math.PI;
Phaser.Math.degToRad=function(a){return a*degreeToRadiansFactor};Phaser.Math.radToDeg=function(a){return a*radianToDegreesFactor};Phaser.RandomDataGenerator=function(a){void 0===a&&(a=[]);this.c=1;this.s2=this.s1=this.s0=0;"string"===typeof a?this.state(a):this.sow(a)};
Phaser.RandomDataGenerator.prototype={rnd:function(){var a=2091639*this.s0+2.3283064365386963E-10*this.c;this.c=a|0;this.s0=this.s1;this.s1=this.s2;return this.s2=a-this.c},sow:function(a){this.s0=this.hash(" ");this.s1=this.hash(this.s0);this.s2=this.hash(this.s1);this.c=1;if(a)for(var b=0;b<a.length&&null!=a[b];b++){var c=a[b];this.s0-=this.hash(c);this.s0+=~~(0>this.s0);this.s1-=this.hash(c);this.s1+=~~(0>this.s1);this.s2-=this.hash(c);this.s2+=~~(0>this.s2)}},hash:function(a){var b,c,d;d=4022871197;
a=a.toString();for(c=0;c<a.length;c++)d+=a.charCodeAt(c),b=.02519603282416938*d,d=b>>>0,b-=d,b*=d,d=b>>>0,b-=d,d+=4294967296*b;return 2.3283064365386963E-10*(d>>>0)},integer:function(){return 4294967296*this.rnd.apply(this)},frac:function(){return this.rnd.apply(this)+1.1102230246251565E-16*(2097152*this.rnd.apply(this)|0)},real:function(){return this.integer()+this.frac()},integerInRange:function(a,b){return Math.floor(this.realInRange(0,b-a+1)+a)},between:function(a,b){return this.integerInRange(a,
b)},realInRange:function(a,b){return this.frac()*(b-a)+a},normal:function(){return 1-2*this.frac()},uuid:function(){for(var a="",b="",b=a="";36>a++;b+=~a%5|3*a&4?(a^15?8^this.frac()*(a^20?16:4):4).toString(16):"-");return b},pick:function(a){return a[this.integerInRange(0,a.length-1)]},sign:function(){return this.pick([-1,1])},weightedPick:function(a){return a[~~(Math.pow(this.frac(),2)*(a.length-1)+.5)]},timestamp:function(a,b){return this.realInRange(a||9466848E5,b||1577862E6)},angle:function(){return this.integerInRange(-180,
180)},state:function(a){"string"===typeof a&&a.match(/^!rnd/)&&(a=a.split(","),this.c=parseFloat(a[1]),this.s0=parseFloat(a[2]),this.s1=parseFloat(a[3]),this.s2=parseFloat(a[4]));return["!rnd",this.c,this.s0,this.s1,this.s2].join()}};Phaser.RandomDataGenerator.prototype.constructor=Phaser.RandomDataGenerator;Phaser.QuadTree=function(a,b,c,d,e,f,g){this.maxObjects=10;this.maxLevels=4;this.level=0;this.bounds={};this.objects=[];this.nodes=[];this._empty=[];this.reset(a,b,c,d,e,f,g)};
Phaser.QuadTree.prototype={reset:function(a,b,c,d,e,f,g){this.maxObjects=e||10;this.maxLevels=f||4;this.level=g||0;this.bounds={x:Math.round(a),y:Math.round(b),width:c,height:d,subWidth:Math.floor(c/2),subHeight:Math.floor(d/2),right:Math.round(a)+Math.floor(c/2),bottom:Math.round(b)+Math.floor(d/2)};this.objects.length=0;this.nodes.length=0},populate:function(a){a.forEach(this.populateHandler,this,!0)},populateHandler:function(a){a.body&&a.exists&&this.insert(a.body)},split:function(){this.nodes[0]=
new Phaser.QuadTree(this.bounds.right,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1);this.nodes[1]=new Phaser.QuadTree(this.bounds.x,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1);this.nodes[2]=new Phaser.QuadTree(this.bounds.x,this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1);this.nodes[3]=new Phaser.QuadTree(this.bounds.right,this.bounds.bottom,
this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1)},insert:function(a){var b=0,c;if(null!=this.nodes[0]&&(c=this.getIndex(a),-1!==c)){this.nodes[c].insert(a);return}this.objects.push(a);if(this.objects.length>this.maxObjects&&this.level<this.maxLevels)for(null==this.nodes[0]&&this.split();b<this.objects.length;)c=this.getIndex(this.objects[b]),-1!==c?this.nodes[c].insert(this.objects.splice(b,1)[0]):b++},getIndex:function(a){var b=-1;a.x<this.bounds.right&&a.right<
this.bounds.right?a.y<this.bounds.bottom&&a.bottom<this.bounds.bottom?b=1:a.y>this.bounds.bottom&&(b=2):a.x>this.bounds.right&&(a.y<this.bounds.bottom&&a.bottom<this.bounds.bottom?b=0:a.y>this.bounds.bottom&&(b=3));return b},retrieve:function(a){if(a instanceof Phaser.Rectangle)var b=this.objects,c=this.getIndex(a);else{if(!a.body)return this._empty;b=this.objects;c=this.getIndex(a.body)}this.nodes[0]&&(-1!==c?b=b.concat(this.nodes[c].retrieve(a)):(b=b.concat(this.nodes[0].retrieve(a)),b=b.concat(this.nodes[1].retrieve(a)),
b=b.concat(this.nodes[2].retrieve(a)),b=b.concat(this.nodes[3].retrieve(a))));return b},clear:function(){this.objects.length=0;for(var a=this.nodes.length;a--;)this.nodes[a].clear(),this.nodes.splice(a,1);this.nodes.length=0}};Phaser.QuadTree.prototype.constructor=Phaser.QuadTree;var netNoop=function(){};Phaser.Net=netNoop;Phaser.Net.prototype={isDisabled:!0,getHostName:netNoop,checkDomainName:netNoop,updateQueryString:netNoop,getQueryString:netNoop,decodeURI:netNoop};
Phaser.Net.prototype.constructor=Phaser.Net;Phaser.TweenManager=function(){};Phaser.TweenManager.prototype.update=function(){};Phaser.TweenManager.prototype.removeAll=function(){};Phaser.TweenManager.prototype.removeFrom=function(){};Phaser.TweenManager.prototype.constructor=Phaser.TweenManager;
Phaser.Time=function(a){this.game=a;this.elapsedMS=this.elapsed=this.now=this.prevTime=this.time=0;this.physicsElapsed=1/60;this.physicsElapsedMS=1/60*1E3;this.desiredFpsMult=1/60;this._desiredFps=60;this.suggestedFps=this.desiredFps;this.slowMotion=1;this.advancedTiming=!1;this.fps=this.frames=0;this.fpsMin=1E3;this.fpsMax=0;this.msMin=1E3;this.timeExpected=this.timeToCall=this.pauseDuration=this.msMax=0;this.events=new Phaser.Timer(this.game,!1);this._pauseStarted=this._timeLastSecond=this._started=
this._elapsedAccumulator=this._frameCount=0;this._justResumed=!1;this._timers=[]};
Phaser.Time.prototype={boot:function(){this._started=Date.now();this.time=Date.now();this.events.start();this.timeExpected=this.time},add:function(a){this._timers.push(a);return a},create:function(a){void 0===a&&(a=!0);a=new Phaser.Timer(this.game,a);this._timers.push(a);return a},removeAll:function(){for(var a=0;a<this._timers.length;a++)this._timers[a].destroy();this._timers=[];this.events.removeAll()},refresh:function(){var a=this.time;this.time=Date.now();this.elapsedMS=this.time-a},update:function(a){var b=
this.time;this.time=Date.now();this.elapsedMS=this.time-b;this.prevTime=this.now;this.now=a;this.elapsed=this.now-this.prevTime;this.game.raf._isSetTimeOut&&(this.timeToCall=Math.floor(Math.max(0,1E3/this._desiredFps-(this.timeExpected-a))),this.timeExpected=a+this.timeToCall);this.advancedTiming&&this.updateAdvancedTiming();this.game.paused||(this.events.update(this.time),this._timers.length&&this.updateTimers())},updateTimers:function(){for(var a=0,b=this._timers.length;a<b;)this._timers[a].update(this.time)?
a++:(this._timers.splice(a,1),b--)},updateAdvancedTiming:function(){this._frameCount++;this._elapsedAccumulator+=this.elapsed;this._frameCount>=2*this._desiredFps&&(this.suggestedFps=5*Math.floor(200/(this._elapsedAccumulator/this._frameCount)),this._elapsedAccumulator=this._frameCount=0);this.msMin=Math.min(this.msMin,this.elapsed);this.msMax=Math.max(this.msMax,this.elapsed);this.frames++;this.now>this._timeLastSecond+1E3&&(this.fps=Math.round(1E3*this.frames/(this.now-this._timeLastSecond)),this.fpsMin=
Math.min(this.fpsMin,this.fps),this.fpsMax=Math.max(this.fpsMax,this.fps),this._timeLastSecond=this.now,this.frames=0)},gamePaused:function(){this._pauseStarted=Date.now();this.events.pause();for(var a=this._timers.length;a--;)this._timers[a]._pause()},gameResumed:function(){this.time=Date.now();this.pauseDuration=this.time-this._pauseStarted;this.events.resume();for(var a=this._timers.length;a--;)this._timers[a]._resume()},totalElapsedSeconds:function(){return.001*(this.time-this._started)},elapsedSince:function(a){return this.time-
a},elapsedSecondsSince:function(a){return.001*(this.time-a)},reset:function(){this._started=this.time;this.removeAll()}};Object.defineProperty(Phaser.Time.prototype,"desiredFps",{get:function(){return this._desiredFps},set:function(a){this._desiredFps=a;this.physicsElapsed=1/a;this.physicsElapsedMS=1E3*this.physicsElapsed;this.desiredFpsMult=1/a}});Phaser.Time.prototype.constructor=Phaser.Time;
Phaser.Timer=function(a,b){void 0===b&&(b=!0);this.game=a;this.running=!1;this.autoDestroy=b;this.expired=!1;this.elapsed=0;this.events=[];this.onComplete=new Phaser.Signal;this.nextTick=0;this.timeCap=1E3;this._codePaused=this.paused=!1;this._pauseTotal=this._pauseStarted=this._started=0;this._now=Date.now();this._newTick=this._diff=this._i=this._marked=this._len=0};Phaser.Timer.MINUTE=6E4;Phaser.Timer.SECOND=1E3;Phaser.Timer.HALF=500;Phaser.Timer.QUARTER=250;
Phaser.Timer.prototype={create:function(a,b,c,d,e,f){var g=a=Math.round(a),g=0===this._now?g+this.game.time.time:g+this._now;a=new Phaser.TimerEvent(this,a,g,c,b,d,e,f);this.events.push(a);this.order();this.expired=!1;return a},add:function(a,b,c){return this.create(a,!1,0,b,c,Array.prototype.slice.call(arguments,3))},repeat:function(a,b,c,d){return this.create(a,!1,b,c,d,Array.prototype.slice.call(arguments,4))},loop:function(a,b,c){return this.create(a,!0,0,b,c,Array.prototype.slice.call(arguments,
3))},start:function(a){if(!this.running)for(this._started=this.game.time.time+(a||0),this.running=!0,a=0;a<this.events.length;a++)this.events[a].tick=this.events[a].delay+this._started},stop:function(a){this.running=!1;void 0===a&&(a=!0);a&&(this.events.length=0)},remove:function(a){for(var b=0;b<this.events.length;b++)if(this.events[b]===a)return this.events[b].pendingDelete=!0;return!1},order:function(){0<this.events.length&&(this.events.sort(this.sortHandler),this.nextTick=this.events[0].tick)},
sortHandler:function(a,b){return a.tick<b.tick?-1:a.tick>b.tick?1:0},clearPendingEvents:function(){for(this._i=this.events.length;this._i--;)this.events[this._i].pendingDelete&&this.events.splice(this._i,1);this._len=this.events.length;this._i=0},update:function(a){if(this.paused)return!0;this.elapsed=a-this._now;this._now=a;this.elapsed>this.timeCap&&this.adjustEvents(a-this.elapsed);this._marked=0;this.clearPendingEvents();if(this.running&&this._now>=this.nextTick&&0<this._len){for(;this._i<this._len&&
this.running;)if(this._now>=this.events[this._i].tick&&!this.events[this._i].pendingDelete)this._newTick=this._now+this.events[this._i].delay-(this._now-this.events[this._i].tick),0>this._newTick&&(this._newTick=this._now+this.events[this._i].delay),!0===this.events[this._i].loop?this.events[this._i].tick=this._newTick:0<this.events[this._i].repeatCount?(this.events[this._i].repeatCount--,this.events[this._i].tick=this._newTick):(this._marked++,this.events[this._i].pendingDelete=!0),this.events[this._i].callback.apply(this.events[this._i].callbackContext,
this.events[this._i].args),this._i++;else break;this.events.length>this._marked?this.order():(this.expired=!0,this.onComplete.dispatch(this))}return this.expired&&this.autoDestroy?!1:!0},pause:function(){this.running&&(this._codePaused=!0,this.paused||(this._pauseStarted=this.game.time.time,this.paused=!0))},_pause:function(){!this.paused&&this.running&&(this._pauseStarted=this.game.time.time,this.paused=!0)},adjustEvents:function(a){for(var b=0;b<this.events.length;b++)if(!this.events[b].pendingDelete){var c=
this.events[b].tick-a;0>c&&(c=0);this.events[b].tick=this._now+c}a=this.nextTick-a;this.nextTick=0>a?this._now:this._now+a},resume:function(){if(this.paused){var a=this.game.time.time;this._pauseTotal+=a-this._now;this._now=a;this.adjustEvents(this._pauseStarted);this._codePaused=this.paused=!1}},_resume:function(){this._codePaused||this.resume()},removeAll:function(){this.onComplete.removeAll();this._i=this._len=this.events.length=0},destroy:function(){this.onComplete.removeAll();this.running=!1;
this.events=[];this._i=this._len=0}};Object.defineProperty(Phaser.Timer.prototype,"next",{get:function(){return this.nextTick}});Object.defineProperty(Phaser.Timer.prototype,"duration",{get:function(){return this.running&&this.nextTick>this._now?this.nextTick-this._now:0}});Object.defineProperty(Phaser.Timer.prototype,"length",{get:function(){return this.events.length}});
Object.defineProperty(Phaser.Timer.prototype,"ms",{get:function(){return this.running?this._now-this._started-this._pauseTotal:0}});Object.defineProperty(Phaser.Timer.prototype,"seconds",{get:function(){return this.running?.001*this.ms:0}});Phaser.Timer.prototype.constructor=Phaser.Timer;Phaser.TimerEvent=function(a,b,c,d,e,f,g,h){this.timer=a;this.delay=b;this.tick=c;this.repeatCount=d-1;this.loop=e;this.callback=f;this.callbackContext=g;this.args=h;this.pendingDelete=!1};
Phaser.TimerEvent.prototype.constructor=Phaser.TimerEvent;Phaser.AnimationManager=function(a){this.sprite=a;this.game=a.game;this.currentAnim=this.currentFrame=null;this.updateIfVisible=!0;this.isLoaded=!1;this._frameData=null;this._anims={};this._outputFrames=[]};
Phaser.AnimationManager.prototype={loadFrameData:function(a,b){if(void 0===a)return!1;if(this.isLoaded)for(var c in this._anims)this._anims[c].updateFrameData(a);this._frameData=a;void 0===b||null===b?this.frame=0:"string"===typeof b?this.frameName=b:this.frame=b;return this.isLoaded=!0},copyFrameData:function(a,b){this._frameData=a.clone();if(this.isLoaded)for(var c in this._anims)this._anims[c].updateFrameData(this._frameData);void 0===b||null===b?this.frame=0:"string"===typeof b?this.frameName=
b:this.frame=b;return this.isLoaded=!0},add:function(a,b,c,d,e){b=b||[];c=c||60;void 0===d&&(d=!1);void 0===e&&(e=b&&"number"===typeof b[0]?!0:!1);this._outputFrames=[];this._frameData.getFrameIndexes(b,e,this._outputFrames);this._anims[a]=new Phaser.Animation(this.game,this.sprite,a,this._frameData,this._outputFrames,c,d);this.currentAnim=this._anims[a];this.sprite.tilingTexture&&(this.sprite.refreshTexture=!0);return this._anims[a]},validateFrames:function(a,b){void 0===b&&(b=!0);for(var c=0;c<
a.length;c++)if(!0===b){if(a[c]>this._frameData.total)return!1}else if(!1===this._frameData.checkFrameName(a[c]))return!1;return!0},play:function(a,b,c,d){if(this._anims[a]){if(this.currentAnim===this._anims[a])return!1===this.currentAnim.isPlaying?(this.currentAnim.paused=!1,this.currentAnim.play(b,c,d)):this.currentAnim;this.currentAnim&&this.currentAnim.isPlaying&&this.currentAnim.stop();this.currentAnim=this._anims[a];this.currentAnim.paused=!1;this.currentFrame=this.currentAnim.currentFrame;
return this.currentAnim.play(b,c,d)}},stop:function(a,b){void 0===b&&(b=!1);!this.currentAnim||"string"===typeof a&&a!==this.currentAnim.name||this.currentAnim.stop(b)},update:function(){return this.updateIfVisible&&!this.sprite.visible?!1:this.currentAnim&&this.currentAnim.update()?(this.currentFrame=this.currentAnim.currentFrame,!0):!1},next:function(a){this.currentAnim&&(this.currentAnim.next(a),this.currentFrame=this.currentAnim.currentFrame)},previous:function(a){this.currentAnim&&(this.currentAnim.previous(a),
this.currentFrame=this.currentAnim.currentFrame)},getAnimation:function(a){return"string"===typeof a&&this._anims[a]?this._anims[a]:null},refreshFrame:function(){},destroy:function(){var a=null;for(a in this._anims)this._anims.hasOwnProperty(a)&&this._anims[a].destroy();this._anims={};this._outputFrames=[];this.game=this.sprite=this.currentFrame=this.currentAnim=this._frameData=null}};Phaser.AnimationManager.prototype.constructor=Phaser.AnimationManager;
Object.defineProperty(Phaser.AnimationManager.prototype,"frameData",{get:function(){return this._frameData}});Object.defineProperty(Phaser.AnimationManager.prototype,"frameTotal",{get:function(){return this._frameData.total}});Object.defineProperty(Phaser.AnimationManager.prototype,"paused",{get:function(){return this.currentAnim.isPaused},set:function(a){this.currentAnim.paused=a}});Object.defineProperty(Phaser.AnimationManager.prototype,"name",{get:function(){if(this.currentAnim)return this.currentAnim.name}});
Object.defineProperty(Phaser.AnimationManager.prototype,"frame",{get:function(){if(this.currentFrame)return this.currentFrame.index},set:function(a){"number"===typeof a&&this._frameData&&null!==this._frameData.getFrame(a)&&(this.currentFrame=this._frameData.getFrame(a))&&this.sprite.setFrame(this.currentFrame)}});
Object.defineProperty(Phaser.AnimationManager.prototype,"frameName",{get:function(){if(this.currentFrame)return this.currentFrame.name},set:function(a){if("string"===typeof a&&this._frameData&&null!==this._frameData.getFrameByName(a)){if(this.currentFrame=this._frameData.getFrameByName(a))this._frameIndex=this.currentFrame.index,this.sprite.setFrame(this.currentFrame)}else console.warn("Cannot set frameName: "+a)}});
Phaser.Animation=function(a,b,c,d,e,f,g){void 0===g&&(g=!1);this.game=a;this._parent=b;this._frameData=d;this.name=c;this._frames=[];this._frames=this._frames.concat(e);this.delay=1E3/f;this.loop=g;this.loopCount=0;this.isPaused=this.isPlaying=this.isFinished=this.killOnComplete=!1;this._frameDiff=this._frameIndex=this._pauseStartTime=0;this._frameSkip=1;this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]);this.onStart=new Phaser.Signal;this.onUpdate=null;this.onComplete=new Phaser.Signal;
this.onLoop=new Phaser.Signal;this.isReversed=!1;this.game.onPause.add(this.onPause,this);this.game.onResume.add(this.onResume,this)};
Phaser.Animation.prototype={play:function(a,b,c){"number"===typeof a&&(this.delay=1E3/a);"boolean"===typeof b&&(this.loop=b);"undefined"!==typeof c&&(this.killOnComplete=c);this.isPlaying=!0;this.paused=this.isFinished=!1;this.loopCount=0;this._timeLastFrame=this.game.time.time;this._timeNextFrame=this.game.time.time+this.delay;this._frameIndex=this.isReversed?this._frames.length-1:0;this.updateCurrentFrame(!1,!0);this._parent.events.onAnimationStart$dispatch(this._parent,this);this.onStart.dispatch(this._parent,
this);this._parent.animations.currentAnim=this;this._parent.animations.currentFrame=this.currentFrame;return this},restart:function(){this.isPlaying=!0;this.paused=this.isFinished=!1;this.loopCount=0;this._timeLastFrame=this.game.time.time;this._timeNextFrame=this.game.time.time+this.delay;this._frameIndex=0;this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]);this._parent.setFrame(this.currentFrame);this._parent.animations.currentAnim=this;this._parent.animations.currentFrame=
this.currentFrame;this.onStart.dispatch(this._parent,this)},reverse:function(){this.reversed=!this.reversed;return this},reverseOnce:function(){this.onComplete.addOnce(this.reverse,this);return this.reverse()},setFrame:function(a,b){var c;void 0===b&&(b=!1);if("string"===typeof a)for(var d=0;d<this._frames.length;d++)this._frameData.getFrame(this._frames[d]).name===a&&(c=d);else if("number"===typeof a)if(b)c=a;else for(d=0;d<this._frames.length;d++)this._frames[d]===a&&(c=d);c&&(this._frameIndex=
c-1,this._timeNextFrame=this.game.time.time,this.update())},stop:function(a,b){void 0===a&&(a=!1);void 0===b&&(b=!1);this.isPlaying=!1;this.isFinished=!0;this.paused=!1;a&&(this.currentFrame=this._frameData.getFrame(this._frames[0]),this._parent.setFrame(this.currentFrame));b&&(this._parent.events.onAnimationComplete$dispatch(this._parent,this),this.onComplete.dispatch(this._parent,this))},onPause:function(){this.isPlaying&&(this._frameDiff=this._timeNextFrame-this.game.time.time)},onResume:function(){this.isPlaying&&
(this._timeNextFrame=this.game.time.time+this._frameDiff)},update:function(){if(this.isPaused)return!1;if(this.isPlaying&&this.game.time.time>=this._timeNextFrame)if(this._frameSkip=1,this._frameDiff=this.game.time.time-this._timeNextFrame,this._timeLastFrame=this.game.time.time,this._frameDiff>this.delay&&(this._frameSkip=Math.floor(this._frameDiff/this.delay),this._frameDiff-=this._frameSkip*this.delay),this._timeNextFrame=this.game.time.time+(this.delay-this._frameDiff),this._frameIndex=this.isReversed?
this._frameIndex-this._frameSkip:this._frameIndex+this._frameSkip,!this.isReversed&&this._frameIndex>=this._frames.length||this.isReversed&&-1>=this._frameIndex){if(this.loop)return this._frameIndex=Math.abs(this._frameIndex)%this._frames.length,this.isReversed&&(this._frameIndex=this._frames.length-1-this._frameIndex),(this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]))&&this._parent.setFrame(this.currentFrame),this.loopCount++,this._parent.events.onAnimationLoop$dispatch(this._parent,
this),this.onLoop.dispatch(this._parent,this),this.onUpdate?(this.onUpdate.dispatch(this,this.currentFrame),!!this._frameData):!0;this.complete()}else return this.updateCurrentFrame(!0);return!1},updateCurrentFrame:function(a,b){void 0===b&&(b=!1);if(!this._frameData)return!1;var c=this.currentFrame.index;(this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]))&&(b||!b&&c!==this.currentFrame.index)&&this._parent.setFrame(this.currentFrame);return this.onUpdate&&a?(this.onUpdate.dispatch(this,
this.currentFrame),!!this._frameData):!0},next:function(a){void 0===a&&(a=1);a=this._frameIndex+a;a>=this._frames.length&&(a=this.loop?a%this._frames.length:this._frames.length-1);a!==this._frameIndex&&(this._frameIndex=a,this.updateCurrentFrame(!0))},previous:function(a){void 0===a&&(a=1);a=this._frameIndex-a;0>a&&(this.loop?a=this._frames.length+a:a++);a!==this._frameIndex&&(this._frameIndex=a,this.updateCurrentFrame(!0))},updateFrameData:function(a){this.currentFrame=(this._frameData=a)?this._frameData.getFrame(this._frames[this._frameIndex%
this._frames.length]):null},destroy:function(){this._frameData&&(this.game.onPause.remove(this.onPause,this),this.game.onResume.remove(this.onResume,this),this.currentFrame=this._frameData=this._frames=this._parent=this.game=null,this.isPlaying=!1,this.onStart.dispose(),this.onLoop.dispose(),this.onComplete.dispose(),this.onUpdate&&this.onUpdate.dispose())},complete:function(){this._frameIndex=this._frames.length-1;this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]);this.isPlaying=
!1;this.isFinished=!0;this.paused=!1;this._parent.events.onAnimationComplete$dispatch(this._parent,this);this.onComplete.dispatch(this._parent,this);this.killOnComplete&&this._parent.kill()}};Phaser.Animation.prototype.constructor=Phaser.Animation;Object.defineProperty(Phaser.Animation.prototype,"paused",{get:function(){return this.isPaused},set:function(a){(this.isPaused=a)?this._pauseStartTime=this.game.time.time:this.isPlaying&&(this._timeNextFrame=this.game.time.time+this.delay)}});
Object.defineProperty(Phaser.Animation.prototype,"reversed",{get:function(){return this.isReversed},set:function(a){this.isReversed=a}});Object.defineProperty(Phaser.Animation.prototype,"frameTotal",{get:function(){return this._frames.length}});
Object.defineProperty(Phaser.Animation.prototype,"frame",{get:function(){return null!==this.currentFrame?this.currentFrame.index:this._frameIndex},set:function(a){this.currentFrame=this._frameData.getFrame(this._frames[a]);null!==this.currentFrame&&(this._frameIndex=a,this._parent.setFrame(this.currentFrame),this.onUpdate&&this.onUpdate.dispatch(this,this.currentFrame))}});
Object.defineProperty(Phaser.Animation.prototype,"speed",{get:function(){return 1E3/this.delay},set:function(a){0<a&&(this.delay=1E3/a)}});Object.defineProperty(Phaser.Animation.prototype,"enableUpdate",{get:function(){return null!==this.onUpdate},set:function(a){a&&null===this.onUpdate?this.onUpdate=new Phaser.Signal:a||null===this.onUpdate||(this.onUpdate.dispose(),this.onUpdate=null)}});
Phaser.Animation.generateFrameNames=function(a,b,c,d,e){void 0===d&&(d="");var f=[],g="";if(b<c)for(;b<=c;b++)g="number"===typeof e?Phaser.Utils.pad(b.toString(),e,"0",1):b.toString(),g=a+g+d,f.push(g);else for(;b>=c;b--)g="number"===typeof e?Phaser.Utils.pad(b.toString(),e,"0",1):b.toString(),g=a+g+d,f.push(g);return f};
Phaser.Frame=function(a,b,c,d,e,f){this.index=a;this.x=b;this.y=c;this.width=d;this.height=e;this.name=f;this.centerX=Math.floor(d/2);this.centerY=Math.floor(e/2);this.distance=Phaser.Math.distance(0,0,d,e);this.rotated=!1;this.rotationDirection="cw";this.trimmed=!1;this.sourceSizeW=d;this.sourceSizeH=e;this.spriteSourceSizeH=this.spriteSourceSizeW=this.spriteSourceSizeY=this.spriteSourceSizeX=0;this.right=this.x+this.width;this.bottom=this.y+this.height};
Phaser.Frame.prototype={resize:function(a,b){this.width=a;this.height=b;this.centerX=Math.floor(a/2);this.centerY=Math.floor(b/2);this.distance=Phaser.Math.distance(0,0,a,b);this.sourceSizeW=a;this.sourceSizeH=b;this.right=this.x+a;this.bottom=this.y+b},setTrim:function(a,b,c,d,e,f,g){if(this.trimmed=a)this.sourceSizeW=b,this.sourceSizeH=c,this.centerX=Math.floor(b/2),this.centerY=Math.floor(c/2),this.spriteSourceSizeX=d,this.spriteSourceSizeY=e,this.spriteSourceSizeW=f,this.spriteSourceSizeH=g},
clone:function(){var a=new Phaser.Frame(this.index,this.x,this.y,this.width,this.height,this.name),b;for(b in this)this.hasOwnProperty(b)&&(a[b]=this[b]);return a},getRect:function(a){void 0===a?a=new Phaser.Rectangle(this.x,this.y,this.width,this.height):a.setTo(this.x,this.y,this.width,this.height);return a}};Phaser.Frame.prototype.constructor=Phaser.Frame;Phaser.FrameData=function(){this._frames=[];this._frameNames=[]};
Phaser.FrameData.prototype={addFrame:function(a){a.index=this._frames.length;this._frames.push(a);""!==a.name&&(this._frameNames[a.name]=a.index);return a},getFrame:function(a){a>=this._frames.length&&(a=0);return this._frames[a]},getFrameByName:function(a){return"number"===typeof this._frameNames[a]?this._frames[this._frameNames[a]]:null},checkFrameName:function(a){return null==this._frameNames[a]?!1:!0},clone:function(){for(var a=new Phaser.FrameData,b=0;b<this._frames.length;b++)a._frames.push(this._frames[b].clone());
for(var c in this._frameNames)this._frameNames.hasOwnProperty(c)&&a._frameNames.push(this._frameNames[c]);return a},getFrameRange:function(a,b,c){for(void 0===c&&(c=[]);a<=b;a++)c.push(this._frames[a]);return c},getFrames:function(a,b,c){void 0===b&&(b=!0);void 0===c&&(c=[]);if(void 0===a||0===a.length)for(var d=0;d<this._frames.length;d++)c.push(this._frames[d]);else for(d=0;d<a.length;d++)b?c.push(this.getFrame(a[d])):c.push(this.getFrameByName(a[d]));return c},getFrameIndexes:function(a,b,c){void 0===
b&&(b=!0);void 0===c&&(c=[]);if(void 0===a||0===a.length)for(var d=0;d<this._frames.length;d++)c.push(this._frames[d].index);else for(d=0;d<a.length;d++)b&&this._frames[a[d]]?c.push(this._frames[a[d]].index):this.getFrameByName(a[d])&&c.push(this.getFrameByName(a[d]).index);return c},destroy:function(){this._frameNames=this._frames=null}};Phaser.FrameData.prototype.constructor=Phaser.FrameData;Object.defineProperty(Phaser.FrameData.prototype,"total",{get:function(){return this._frames.length}});
Phaser.AnimationParser={spriteSheet:function(a,b,c,d,e,f,g){var h=b;"string"===typeof b&&(h=a.cache.getImage(b));if(null===h)return null;a=h.width;var k=h.height;0>=c&&(c=Math.floor(-a/Math.min(-1,c)));0>=d&&(d=Math.floor(-k/Math.min(-1,d)));h=Math.floor((a-f)/(c+g))*Math.floor((k-f)/(d+g));-1!==e&&(h=e);if(0===a||0===k||a<c||k<d||0===h)return console.warn("Phaser.AnimationParser.spriteSheet: '"+b+"'s width/height zero or width/height < given frameWidth/frameHeight"),null;b=new Phaser.FrameData;for(var k=
e=f,l=0;l<h;l++)b.addFrame(new Phaser.Frame(l,e,k,c,d,"")),e+=c+g,e+c>a&&(e=f,k+=d+g);return b},JSONData:function(a,b){if(b.frames){for(var c=new Phaser.FrameData,d=b.frames,e,f=0;f<d.length;f++)e=c.addFrame(new Phaser.Frame(f,d[f].frame.x,d[f].frame.y,d[f].frame.w,d[f].frame.h,d[f].filename)),d[f].trimmed&&e.setTrim(d[f].trimmed,d[f].sourceSize.w,d[f].sourceSize.h,d[f].spriteSourceSize.x,d[f].spriteSourceSize.y,d[f].spriteSourceSize.w,d[f].spriteSourceSize.h);return c}console.warn("Phaser.AnimationParser.JSONData: Invalid Texture Atlas JSON given, missing 'frames' array");
console.log(b)},JSONDataPyxel:function(a,b){["layers","tilewidth","tileheight","tileswide","tileshigh"].forEach(function(a){b[a]||(console.warn('Phaser.AnimationParser.JSONDataPyxel: Invalid Pyxel Tilemap JSON given, missing "'+a+'" key.'),console.log(b))});if(1!==b.layers.length)console.warn("Phaser.AnimationParser.JSONDataPyxel: Too many layers, this parser only supports flat Tilemaps."),console.log(b);else{for(var c=new Phaser.FrameData,d=b.tileheight,e=b.tilewidth,f=b.layers[0].tiles,g,h=0;h<
f.length;h++)g=c.addFrame(new Phaser.Frame(h,f[h].x,f[h].y,e,d,"frame_"+h)),g.setTrim(!1);return c}},JSONDataHash:function(a,b){if(b.frames){var c=new Phaser.FrameData,d=b.frames,e,f=0,g;for(g in d)e=c.addFrame(new Phaser.Frame(f,d[g].frame.x,d[g].frame.y,d[g].frame.w,d[g].frame.h,g)),d[g].trimmed&&e.setTrim(d[g].trimmed,d[g].sourceSize.w,d[g].sourceSize.h,d[g].spriteSourceSize.x,d[g].spriteSourceSize.y,d[g].spriteSourceSize.w,d[g].spriteSourceSize.h),f++;return c}console.warn("Phaser.AnimationParser.JSONDataHash: Invalid Texture Atlas JSON given, missing 'frames' object");
console.log(b)},XMLData:function(a,b){if(b.getElementsByTagName("TextureAtlas")){for(var c=new Phaser.FrameData,d=b.getElementsByTagName("SubTexture"),e,f,g,h,k,l,m,n,p,q,t=0;t<d.length;t++)f=d[t].attributes,e=f.name.value,g=parseInt(f.x.value,10),h=parseInt(f.y.value,10),k=parseInt(f.width.value,10),l=parseInt(f.height.value,10),n=m=null,f.frameX&&(m=Math.abs(parseInt(f.frameX.value,10)),n=Math.abs(parseInt(f.frameY.value,10)),p=parseInt(f.frameWidth.value,10),q=parseInt(f.frameHeight.value,10)),
e=c.addFrame(new Phaser.Frame(t,g,h,k,l,e)),null===m&&null===n||e.setTrim(!0,k,l,m,n,p,q);return c}console.warn("Phaser.AnimationParser.XMLData: Invalid Texture Atlas XML given, missing <TextureAtlas> tag")}};
Phaser.Cache=function(a){this.game=a;this.autoResolveURL=!1;this._cache={canvas:{},image:{},texture:{},sound:{},video:{},text:{},json:{},xml:{},physics:{},tilemap:{},binary:{},bitmapData:{},bitmapFont:{},shader:{},renderTexture:{}};this._urlMap={};this._urlResolver=new Image;this._urlTemp=null;this.onSoundUnlock=new Phaser.Signal;this._cacheMap=[];this._cacheMap[Phaser.Cache.CANVAS]=this._cache.canvas;this._cacheMap[Phaser.Cache.IMAGE]=this._cache.image;this._cacheMap[Phaser.Cache.TEXTURE]=this._cache.texture;
this._cacheMap[Phaser.Cache.SOUND]=this._cache.sound;this._cacheMap[Phaser.Cache.TEXT]=this._cache.text;this._cacheMap[Phaser.Cache.PHYSICS]=this._cache.physics;this._cacheMap[Phaser.Cache.TILEMAP]=this._cache.tilemap;this._cacheMap[Phaser.Cache.BINARY]=this._cache.binary;this._cacheMap[Phaser.Cache.BITMAPDATA]=this._cache.bitmapData;this._cacheMap[Phaser.Cache.BITMAPFONT]=this._cache.bitmapFont;this._cacheMap[Phaser.Cache.JSON]=this._cache.json;this._cacheMap[Phaser.Cache.XML]=this._cache.xml;this._cacheMap[Phaser.Cache.VIDEO]=
this._cache.video;this._cacheMap[Phaser.Cache.SHADER]=this._cache.shader;this._cacheMap[Phaser.Cache.RENDER_TEXTURE]=this._cache.renderTexture;this.addDefaultImage();this.addMissingImage()};Phaser.Cache.CANVAS=1;Phaser.Cache.IMAGE=2;Phaser.Cache.TEXTURE=3;Phaser.Cache.SOUND=4;Phaser.Cache.TEXT=5;Phaser.Cache.PHYSICS=6;Phaser.Cache.TILEMAP=7;Phaser.Cache.BINARY=8;Phaser.Cache.BITMAPDATA=9;Phaser.Cache.BITMAPFONT=10;Phaser.Cache.JSON=11;Phaser.Cache.XML=12;Phaser.Cache.VIDEO=13;
Phaser.Cache.SHADER=14;Phaser.Cache.RENDER_TEXTURE=15;Phaser.Cache.DEFAULT=null;Phaser.Cache.MISSING=null;
Phaser.Cache.prototype={addCanvas:function(a,b,c){void 0===c&&(c=b.getContext("2d"));this._cache.canvas[a]={canvas:b,context:c}},addImage:function(a,b,c){this.checkImageKey(a)&&this.removeImage(a);var d={key:a,url:b,data:c,base:new PIXI.BaseTexture(c),frame:new Phaser.Frame(0,0,0,c.width,c.height,a),frameData:new Phaser.FrameData};d.frameData.addFrame(new Phaser.Frame(0,0,0,c.width,c.height,b));this._cache.image[a]=d;this._resolveURL(b,d);"__default"===a?Phaser.Cache.DEFAULT=new PIXI.Texture(d.base):
"__missing"===a&&(Phaser.Cache.MISSING=new PIXI.Texture(d.base));return d},addDefaultImage:function(){var a=new Image;a.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg==";a=this.addImage("__default",null,a);a.base.skipRender=!0;Phaser.Cache.DEFAULT=new PIXI.Texture(a.base)},addMissingImage:function(){var a=new Image;a.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg==";
a=this.addImage("__missing",null,a);Phaser.Cache.MISSING=new PIXI.Texture(a.base)},addSound:function(a,b,c,d,e){void 0===d&&(d=!0,e=!1);void 0===e&&(d=!1,e=!0);var f=!1;e&&(f=!0);this._cache.sound[a]={url:b,data:c,isDecoding:!1,decoded:f,webAudio:d,audioTag:e,locked:this.game.sound.touchLocked};this._resolveURL(b,this._cache.sound[a])},addText:function(a,b,c){this._cache.text[a]={url:b,data:c};this._resolveURL(b,this._cache.text[a])},addPhysicsData:function(a,b,c,d){this._cache.physics[a]={url:b,
data:c,format:d};this._resolveURL(b,this._cache.physics[a])},addTilemap:function(a,b,c,d){this._cache.tilemap[a]={url:b,data:c,format:d};this._resolveURL(b,this._cache.tilemap[a])},addBinary:function(a,b){this._cache.binary[a]=b},addBitmapData:function(a,b,c){b.key=a;void 0===c&&(c=new Phaser.FrameData,c.addFrame(b.textureFrame));this._cache.bitmapData[a]={data:b,frameData:c};return b},addBitmapFont:function(a,b,c,d,e,f,g){c={url:b,data:c,font:null,base:new PIXI.BaseTexture(c)};void 0===f&&(f=0);
void 0===g&&(g=0);c.font="json"===e?Phaser.LoaderParser.jsonBitmapFont(d,c.base,f,g):Phaser.LoaderParser.xmlBitmapFont(d,c.base,f,g);this._cache.bitmapFont[a]=c;this._resolveURL(b,c)},addJSON:function(a,b,c){this._cache.json[a]={url:b,data:c};this._resolveURL(b,this._cache.json[a])},addXML:function(a,b,c){this._cache.xml[a]={url:b,data:c};this._resolveURL(b,this._cache.xml[a])},addVideo:function(a,b,c,d){this._cache.video[a]={url:b,data:c,isBlob:d,locked:!0};this._resolveURL(b,this._cache.video[a])},
addShader:function(a,b,c){this._cache.shader[a]={url:b,data:c};this._resolveURL(b,this._cache.shader[a])},addRenderTexture:function(a,b){this._cache.renderTexture[a]={texture:b,frame:new Phaser.Frame(0,0,0,b.width,b.height,"","")}},addSpriteSheet:function(a,b,c,d,e,f,g,h){void 0===f&&(f=-1);void 0===g&&(g=0);void 0===h&&(h=0);c={key:a,url:b,data:c,frameWidth:d,frameHeight:e,margin:g,spacing:h,base:new PIXI.BaseTexture(c),frameData:Phaser.AnimationParser.spriteSheet(this.game,c,d,e,f,g,h)};this._cache.image[a]=
c;this._resolveURL(b,c)},addTextureAtlas:function(a,b,c,d,e){c={key:a,url:b,data:c,base:new PIXI.BaseTexture(c)};e===Phaser.Loader.TEXTURE_ATLAS_XML_STARLING?c.frameData=Phaser.AnimationParser.XMLData(this.game,d,a):e===Phaser.Loader.TEXTURE_ATLAS_JSON_PYXEL?c.frameData=Phaser.AnimationParser.JSONDataPyxel(this.game,d,a):Array.isArray(d.frames)?c.frameData=Phaser.AnimationParser.JSONData(this.game,d,a):c.frameData=Phaser.AnimationParser.JSONDataHash(this.game,d,a);this._cache.image[a]=c;this._resolveURL(b,
c)},reloadSound:function(a){var b=this,c=this.getSound(a);c&&(c.data.src=c.url,c.data.addEventListener("canplaythrough",function(){return b.reloadSoundComplete(a)},!1),c.data.load())},reloadSoundComplete:function(a){var b=this.getSound(a);b&&(b.locked=!1,this.onSoundUnlock.dispatch(a))},updateSound:function(a,b,c){(a=this.getSound(a))&&(a[b]=c)},decodedSound:function(a,b){var c=this.getSound(a);c.data=b;c.decoded=!0;c.isDecoding=!1},isSoundDecoded:function(a){if(a=this.getItem(a,Phaser.Cache.SOUND,
"isSoundDecoded"))return a.decoded},isSoundReady:function(a){if(a=this.getItem(a,Phaser.Cache.SOUND,"isSoundDecoded"))return a.decoded&&!this.game.sound.touchLocked},checkKey:function(a,b){return this._cacheMap[a][b]?!0:!1},checkURL:function(a){return this._urlMap[this._resolveURL(a)]?!0:!1},checkCanvasKey:function(a){return this.checkKey(Phaser.Cache.CANVAS,a)},checkImageKey:function(a){return this.checkKey(Phaser.Cache.IMAGE,a)},checkTextureKey:function(a){return this.checkKey(Phaser.Cache.TEXTURE,
a)},checkSoundKey:function(a){return this.checkKey(Phaser.Cache.SOUND,a)},checkTextKey:function(a){return this.checkKey(Phaser.Cache.TEXT,a)},checkPhysicsKey:function(a){return this.checkKey(Phaser.Cache.PHYSICS,a)},checkTilemapKey:function(a){return this.checkKey(Phaser.Cache.TILEMAP,a)},checkBinaryKey:function(a){return this.checkKey(Phaser.Cache.BINARY,a)},checkBitmapDataKey:function(a){return this.checkKey(Phaser.Cache.BITMAPDATA,a)},checkBitmapFontKey:function(a){return this.checkKey(Phaser.Cache.BITMAPFONT,
a)},checkJSONKey:function(a){return this.checkKey(Phaser.Cache.JSON,a)},checkXMLKey:function(a){return this.checkKey(Phaser.Cache.XML,a)},checkVideoKey:function(a){return this.checkKey(Phaser.Cache.VIDEO,a)},checkShaderKey:function(a){return this.checkKey(Phaser.Cache.SHADER,a)},checkRenderTextureKey:function(a){return this.checkKey(Phaser.Cache.RENDER_TEXTURE,a)},getItem:function(a,b,c,d){if(this.checkKey(b,a))return void 0===d?this._cacheMap[b][a]:this._cacheMap[b][a][d];c&&console.warn("Phaser.Cache."+
c+': Key "'+a+'" not found in Cache.');return null},getCanvas:function(a){return this.getItem(a,Phaser.Cache.CANVAS,"getCanvas","canvas")},getImage:function(a,b){if(void 0===a||null===a)a="__default";void 0===b&&(b=!1);var c=this.getItem(a,Phaser.Cache.IMAGE,"getImage");null===c&&(c=this.getItem("__missing",Phaser.Cache.IMAGE,"getImage"));return b?c:c.data},getTextureFrame:function(a){return this.getItem(a,Phaser.Cache.TEXTURE,"getTextureFrame","frame")},getSound:function(a){return this.getItem(a,
Phaser.Cache.SOUND,"getSound")},getSoundData:function(a){return this.getItem(a,Phaser.Cache.SOUND,"getSoundData","data")},getText:function(a){return this.getItem(a,Phaser.Cache.TEXT,"getText","data")},getPhysicsData:function(a,b,c){var d=this.getItem(a,Phaser.Cache.PHYSICS,"getPhysicsData","data");if(null===d||void 0===b||null===b)return d;if(d[b])if((b=d[b])&&c){for(var e in b)if(e=b[e],e.fixtureKey===c)return e;console.warn('Phaser.Cache.getPhysicsData: Could not find given fixtureKey: "'+c+" in "+
a+'"')}else return b;else console.warn('Phaser.Cache.getPhysicsData: Invalid key/object: "'+a+" / "+b+'"');return null},getTilemapData:function(a){return this.getItem(a,Phaser.Cache.TILEMAP,"getTilemapData")},getBinary:function(a){return this.getItem(a,Phaser.Cache.BINARY,"getBinary")},getBitmapData:function(a){return this.getItem(a,Phaser.Cache.BITMAPDATA,"getBitmapData","data")},getBitmapFont:function(a){return this.getItem(a,Phaser.Cache.BITMAPFONT,"getBitmapFont")},getJSON:function(a,b){var c=
this.getItem(a,Phaser.Cache.JSON,"getJSON","data");return c?b?Phaser.Utils.extend(!0,Array.isArray(c)?[]:{},c):c:null},getXML:function(a){return this.getItem(a,Phaser.Cache.XML,"getXML","data")},getVideo:function(a){return this.getItem(a,Phaser.Cache.VIDEO,"getVideo")},getShader:function(a){return this.getItem(a,Phaser.Cache.SHADER,"getShader","data")},getRenderTexture:function(a){return this.getItem(a,Phaser.Cache.RENDER_TEXTURE,"getRenderTexture")},getBaseTexture:function(a,b){void 0===b&&(b=Phaser.Cache.IMAGE);
return this.getItem(a,b,"getBaseTexture","base")},getFrame:function(a,b){void 0===b&&(b=Phaser.Cache.IMAGE);return this.getItem(a,b,"getFrame","frame")},getFrameCount:function(a,b){var c=this.getFrameData(a,b);return c?c.total:0},getFrameData:function(a,b){void 0===b&&(b=Phaser.Cache.IMAGE);return this.getItem(a,b,"getFrameData","frameData")},hasFrameData:function(a,b){void 0===b&&(b=Phaser.Cache.IMAGE);return null!==this.getItem(a,b,"","frameData")},updateFrameData:function(a,b,c){void 0===c&&(c=
Phaser.Cache.IMAGE);this._cacheMap[c][a]&&(this._cacheMap[c][a].frameData=b)},getFrameByIndex:function(a,b,c){return(a=this.getFrameData(a,c))?a.getFrame(b):null},getFrameByName:function(a,b,c){return(a=this.getFrameData(a,c))?a.getFrameByName(b):null},getURL:function(a){if(a=this._resolveURL(a))return this._urlMap[a];console.warn('Phaser.Cache.getUrl: Invalid url: "'+a+'" or Cache.autoResolveURL was false');return null},getKeys:function(a){void 0===a&&(a=Phaser.Cache.IMAGE);var b=[];if(this._cacheMap[a])for(var c in this._cacheMap[a])"__default"!==
c&&"__missing"!==c&&b.push(c);return b},removeCanvas:function(a){delete this._cache.canvas[a]},removeImage:function(a,b){void 0===b&&(b=!0);var c=this.getImage(a,!0);b&&c.base&&c.base.destroy();delete this._cache.image[a]},removeSound:function(a){delete this._cache.sound[a]},removeText:function(a){delete this._cache.text[a]},removePhysics:function(a){delete this._cache.physics[a]},removeTilemap:function(a){delete this._cache.tilemap[a]},removeBinary:function(a){delete this._cache.binary[a]},removeBitmapData:function(a){delete this._cache.bitmapData[a]},
removeBitmapFont:function(a){delete this._cache.bitmapFont[a]},removeJSON:function(a){delete this._cache.json[a]},removeXML:function(a){delete this._cache.xml[a]},removeVideo:function(a){delete this._cache.video[a]},removeShader:function(a){delete this._cache.shader[a]},removeRenderTexture:function(a){delete this._cache.renderTexture[a]},removeSpriteSheet:function(a){delete this._cache.spriteSheet[a]},removeTextureAtlas:function(a){delete this._cache.atlas[a]},clearGLTextures:function(){for(var a in this._cache.image)this._cache.image[a].base._glTextures=
[]},_resolveURL:function(a,b){if(!this.autoResolveURL)return null;this._urlResolver.src=this.game.load.baseURL+a;this._urlTemp=this._urlResolver.src;this._urlResolver.src="";b&&(this._urlMap[this._urlTemp]=b);return this._urlTemp},destroy:function(){for(var a=0;a<this._cacheMap.length;a++){var b=this._cacheMap[a],c;for(c in b)"__default"!==c&&"__missing"!==c&&(b[c].destroy&&b[c].destroy(),delete b[c])}this._urlTemp=this._urlResolver=this._urlMap=null}};Phaser.Cache.prototype.constructor=Phaser.Cache;
Phaser.Loader=function(a){this.game=a;this.cache=a.cache;this.hasLoaded=this.isLoading=this.resetLocked=!1;this.preloadSprite=null;this.crossOrigin=!1;this.path=this.baseURL="";this.headers={requestedWith:!1,json:"application/json",xml:"application/xml"};this.onLoadStart=new Phaser.Signal;this.onLoadComplete=new Phaser.Signal;this.onPackComplete=new Phaser.Signal;this.onFileStart=new Phaser.Signal;this.onFileComplete=new Phaser.Signal;this.onFileError=new Phaser.Signal;this._warnedAboutXDomainRequest=
this.useXDomainRequest=!1;this.enableParallel=!0;this.maxParallelDownloads=4;this._withSyncPointDepth=0;this._fileList=[];this._flightQueue=[];this._processingHead=0;this._fileLoadStarted=!1;this._loadedFileCount=this._loadedPackCount=this._totalFileCount=this._totalPackCount=0};Phaser.Loader.TEXTURE_ATLAS_JSON_ARRAY=0;Phaser.Loader.TEXTURE_ATLAS_JSON_HASH=1;Phaser.Loader.TEXTURE_ATLAS_XML_STARLING=2;Phaser.Loader.PHYSICS_LIME_CORONA_JSON=3;Phaser.Loader.PHYSICS_PHASER_JSON=4;
Phaser.Loader.TEXTURE_ATLAS_JSON_PYXEL=5;
Phaser.Loader.prototype={setPreloadSprite:function(a,b){b=b||0;this.preloadSprite={sprite:a,direction:b,width:a.width,height:a.height,rect:null};this.preloadSprite.rect=0===b?new Phaser.Rectangle(0,0,1,a.height):new Phaser.Rectangle(0,0,a.width,1);a.crop(this.preloadSprite.rect);a.visible=!0},resize:function(){this.preloadSprite&&this.preloadSprite.height!==this.preloadSprite.sprite.height&&(this.preloadSprite.rect.height=this.preloadSprite.sprite.height)},checkKeyExists:function(a,b){return-1<this.getAssetIndex(a,
b)},getAssetIndex:function(a,b){for(var c=-1,d=0;d<this._fileList.length;d++){var e=this._fileList[d];if(e.type===a&&e.key===b&&(c=d,!e.loaded&&!e.loading))break}return c},getAsset:function(a,b){var c=this.getAssetIndex(a,b);return-1<c?{index:c,file:this._fileList[c]}:!1},reset:function(a,b){void 0===b&&(b=!1);this.resetLocked||(a&&(this.preloadSprite=null),this.isLoading=!1,this._processingHead=0,this._fileList.length=0,this._flightQueue.length=0,this._fileLoadStarted=!1,this._loadedFileCount=this._loadedPackCount=
this._totalPackCount=this._totalFileCount=0,b&&(this.onLoadStart.removeAll(),this.onLoadComplete.removeAll(),this.onPackComplete.removeAll(),this.onFileStart.removeAll(),this.onFileComplete.removeAll(),this.onFileError.removeAll()))},addToFileList:function(a,b,c,d,e,f){void 0===e&&(e=!1);if(void 0===b||""===b)return console.warn("Phaser.Loader: Invalid or no key given of type "+a),this;if(void 0===c||null===c)if(f)c=b+f;else return console.warn("Phaser.Loader: No URL given for file type: "+a+" key: "+
b),this;c={type:a,key:b,path:this.path,url:c,syncPoint:0<this._withSyncPointDepth,data:null,loading:!1,loaded:!1,error:!1};if(d)for(var g in d)c[g]=d[g];a=this.getAssetIndex(a,b);e&&-1<a?(e=this._fileList[a],e.loading||e.loaded?(this._fileList.push(c),this._totalFileCount++):this._fileList[a]=c):-1===a&&(this._fileList.push(c),this._totalFileCount++);return this},replaceInFileList:function(a,b,c,d){return this.addToFileList(a,b,c,d,!0)},pack:function(a,b,c,d){void 0===b&&(b=null);void 0===c&&(c=null);
void 0===d&&(d=null);if(!b&&!c)return console.warn("Phaser.Loader.pack - Both url and data are null. One must be set."),this;a={type:"packfile",key:a,url:b,path:this.path,syncPoint:!0,data:null,loading:!1,loaded:!1,error:!1,callbackContext:d};c&&("string"===typeof c&&(c=JSON.parse(c)),a.data=c||{},a.loaded=!0);for(c=0;c<this._fileList.length+1;c++)if(b=this._fileList[c],!b||!b.loaded&&!b.loading&&"packfile"!==b.type){this._fileList.splice(c,0,a);this._totalPackCount++;break}return this},image:function(a,
b,c){return this.addToFileList("image",a,b,void 0,c,".png")},images:function(a,b){if(Array.isArray(b))for(var c=0;c<a.length;c++)this.image(a[c],b[c]);else for(c=0;c<a.length;c++)this.image(a[c]);return this},text:function(a,b,c){return this.addToFileList("text",a,b,void 0,c,".txt")},json:function(a,b,c){return this.addToFileList("json",a,b,void 0,c,".json")},shader:function(a,b,c){return this.addToFileList("shader",a,b,void 0,c,".frag")},xml:function(a,b,c){return this.addToFileList("xml",a,b,void 0,
c,".xml")},script:function(a,b,c,d){void 0===c&&(c=!1);!1!==c&&void 0===d&&(d=this);return this.addToFileList("script",a,b,{syncPoint:!0,callback:c,callbackContext:d},!1,".js")},binary:function(a,b,c,d){void 0===c&&(c=!1);!1!==c&&void 0===d&&(d=c);return this.addToFileList("binary",a,b,{callback:c,callbackContext:d},!1,".bin")},spritesheet:function(a,b,c,d,e,f,g){void 0===e&&(e=-1);void 0===f&&(f=0);void 0===g&&(g=0);return this.addToFileList("spritesheet",a,b,{frameWidth:c,frameHeight:d,frameMax:e,
margin:f,spacing:g},!1,".png")},audio:function(a,b,c){if(this.game.sound.noAudio)return this;void 0===c&&(c=!0);"string"===typeof b&&(b=[b]);return this.addToFileList("audio",a,b,{buffer:null,autoDecode:c})},audioSprite:function(a,b,c,d,e){if(this.game.sound.noAudio)return this;void 0===c&&(c=null);void 0===d&&(d=null);void 0===e&&(e=!0);this.audio(a,b,e);c?this.json(a+"-audioatlas",c):d?("string"===typeof d&&(d=JSON.parse(d)),this.cache.addJSON(a+"-audioatlas","",d)):console.warn("Phaser.Loader.audiosprite - You must specify either a jsonURL or provide a jsonData object");
return this},audiosprite:function(a,b,c,d,e){return this.audioSprite(a,b,c,d,e)},video:function(a,b,c,d){void 0===c&&(c=this.game.device.firefox?"loadeddata":"canplaythrough");void 0===d&&(d=!1);"string"===typeof b&&(b=[b]);return this.addToFileList("video",a,b,{buffer:null,asBlob:d,loadEvent:c})},tilemap:function(a,b,c,d){void 0===b&&(b=null);void 0===c&&(c=null);void 0===d&&(d=Phaser.Tilemap.CSV);b||c||(b=d===Phaser.Tilemap.CSV?a+".csv":a+".json");if(c){switch(d){case Phaser.Tilemap.TILED_JSON:"string"===
typeof c&&(c=JSON.parse(c))}this.cache.addTilemap(a,null,c,d)}else this.addToFileList("tilemap",a,b,{format:d});return this},physics:function(a,b,c,d){void 0===b&&(b=null);void 0===c&&(c=null);void 0===d&&(d=Phaser.Physics.LIME_CORONA_JSON);b||c||(b=a+".json");c?("string"===typeof c&&(c=JSON.parse(c)),this.cache.addPhysicsData(a,null,c,d)):this.addToFileList("physics",a,b,{format:d});return this},bitmapFont:function(a,b,c,d,e,f){if(void 0===b||null===b)b=a+".png";void 0===c&&(c=null);void 0===d&&
(d=null);null===c&&null===d&&(c=a+".xml");void 0===e&&(e=0);void 0===f&&(f=0);if(c)this.addToFileList("bitmapfont",a,b,{atlasURL:c,xSpacing:e,ySpacing:f});else if("string"===typeof d){var g,h;try{g=JSON.parse(d)}catch(k){h=this.parseXml(d)}if(!h&&!g)throw Error("Phaser.Loader. Invalid Bitmap Font atlas given");this.addToFileList("bitmapfont",a,b,{atlasURL:null,atlasData:g||h,atlasType:g?"json":"xml",xSpacing:e,ySpacing:f})}return this},atlasJSONArray:function(a,b,c,d){return this.atlas(a,b,c,d,Phaser.Loader.TEXTURE_ATLAS_JSON_ARRAY)},
atlasJSONHash:function(a,b,c,d){return this.atlas(a,b,c,d,Phaser.Loader.TEXTURE_ATLAS_JSON_HASH)},atlasXML:function(a,b,c,d){void 0===c&&(c=null);void 0===d&&(d=null);c||d||(c=a+".xml");return this.atlas(a,b,c,d,Phaser.Loader.TEXTURE_ATLAS_XML_STARLING)},atlas:function(a,b,c,d,e){if(void 0===b||null===b)b=a+".png";void 0===c&&(c=null);void 0===d&&(d=null);void 0===e&&(e=Phaser.Loader.TEXTURE_ATLAS_JSON_ARRAY);c||d||(c=e===Phaser.Loader.TEXTURE_ATLAS_XML_STARLING?a+".xml":a+".json");if(c)this.addToFileList("textureatlas",
a,b,{atlasURL:c,format:e});else{switch(e){case Phaser.Loader.TEXTURE_ATLAS_JSON_ARRAY:"string"===typeof d&&(d=JSON.parse(d));break;case Phaser.Loader.TEXTURE_ATLAS_XML_STARLING:if("string"===typeof d){c=this.parseXml(d);if(!c)throw Error("Phaser.Loader. Invalid Texture Atlas XML given");d=c}}this.addToFileList("textureatlas",a,b,{atlasURL:null,atlasData:d,format:e})}return this},withSyncPoint:function(a,b){this._withSyncPointDepth++;try{a.call(b||this,this)}finally{this._withSyncPointDepth--}return this},
addSyncPoint:function(a,b){var c=this.getAsset(a,b);c&&(c.file.syncPoint=!0);return this},removeFile:function(a,b){var c=this.getAsset(a,b);c&&(c.loaded||c.loading||this._fileList.splice(c.index,1))},removeAll:function(){this._fileList.length=0;this._flightQueue.length=0},start:function(){this.isLoading||(this.hasLoaded=!1,this.isLoading=!0,this.updateProgress(),this.processLoadQueue())},processLoadQueue:function(){if(this.isLoading){for(var a=0;a<this._flightQueue.length;a++){var b=this._flightQueue[a];
if(b.loaded||b.error)this._flightQueue.splice(a,1),a--,b.loading=!1,b.requestUrl=null,b.requestObject=null,b.error&&this.onFileError.dispatch(b.key,b),"packfile"!==b.type?(this._loadedFileCount++,this.onFileComplete.dispatch(this.progress,b.key,!b.error,this._loadedFileCount,this._totalFileCount)):"packfile"===b.type&&b.error&&(this._loadedPackCount++,this.onPackComplete.dispatch(b.key,!b.error,this._loadedPackCount,this._totalPackCount))}for(var c=!1,d=this.enableParallel?Phaser.Math.clamp(this.maxParallelDownloads,
1,12):1,a=this._processingHead;a<this._fileList.length&&!(b=this._fileList[a],"packfile"===b.type&&!b.error&&b.loaded&&a===this._processingHead&&(this.processPack(b),this._loadedPackCount++,this.onPackComplete.dispatch(b.key,!b.error,this._loadedPackCount,this._totalPackCount)),b.loaded||b.error?a===this._processingHead&&(this._processingHead=a+1):!b.loading&&this._flightQueue.length<d&&("packfile"!==b.type||b.data?c||(this._fileLoadStarted||(this._fileLoadStarted=!0,this.onLoadStart.dispatch()),
this._flightQueue.push(b),b.loading=!0,this.onFileStart.dispatch(this.progress,b.key,b.url),this.loadFile(b)):(this._flightQueue.push(b),b.loading=!0,this.loadFile(b))),!b.loaded&&b.syncPoint&&(c=!0),this._flightQueue.length>=d||c&&this._loadedPackCount===this._totalPackCount);a++);this.updateProgress();if(this._processingHead>=this._fileList.length)this.finishedLoading();else if(!this._flightQueue.length){console.warn("Phaser.Loader - aborting: processing queue empty, loading may have stalled");
var e=this;setTimeout(function(){e.finishedLoading(!0)},2E3)}}else console.warn("Phaser.Loader - active loading canceled / reset"),this.finishedLoading(!0)},finishedLoading:function(a){this.hasLoaded||(this.hasLoaded=!0,this.isLoading=!1,a||this._fileLoadStarted||(this._fileLoadStarted=!0,this.onLoadStart.dispatch()),this.onLoadComplete.dispatch(),this.game.state.loadComplete(),this.reset())},asyncComplete:function(a,b){void 0===b&&(b="");a.loaded=!0;a.error=!!b;b&&(a.errorMessage=b,console.warn("Phaser.Loader - "+
a.type+"["+a.key+"]: "+b));this.processLoadQueue()},processPack:function(a){var b=a.data[a.key];if(b)for(var c=0;c<b.length;c++){var d=b[c];switch(d.type){case "image":this.image(d.key,d.url,d.overwrite);break;case "text":this.text(d.key,d.url,d.overwrite);break;case "json":this.json(d.key,d.url,d.overwrite);break;case "xml":this.xml(d.key,d.url,d.overwrite);break;case "script":this.script(d.key,d.url,d.callback,a.callbackContext||this);break;case "binary":this.binary(d.key,d.url,d.callback,a.callbackContext||
this);break;case "spritesheet":this.spritesheet(d.key,d.url,d.frameWidth,d.frameHeight,d.frameMax,d.margin,d.spacing);break;case "video":this.video(d.key,d.urls);break;case "audio":this.audio(d.key,d.urls,d.autoDecode);break;case "audiosprite":this.audiosprite(d.key,d.urls,d.jsonURL,d.jsonData,d.autoDecode);break;case "tilemap":this.tilemap(d.key,d.url,d.data,Phaser.Tilemap[d.format]);break;case "physics":this.physics(d.key,d.url,d.data,Phaser.Loader[d.format]);break;case "bitmapFont":this.bitmapFont(d.key,
d.textureURL,d.atlasURL,d.atlasData,d.xSpacing,d.ySpacing);break;case "atlasJSONArray":this.atlasJSONArray(d.key,d.textureURL,d.atlasURL,d.atlasData);break;case "atlasJSONHash":this.atlasJSONHash(d.key,d.textureURL,d.atlasURL,d.atlasData);break;case "atlasXML":this.atlasXML(d.key,d.textureURL,d.atlasURL,d.atlasData);break;case "atlas":this.atlas(d.key,d.textureURL,d.atlasURL,d.atlasData,Phaser.Loader[d.format]);break;case "shader":this.shader(d.key,d.url,d.overwrite)}}else console.warn("Phaser.Loader - "+
a.key+": pack has data, but not for pack key")},transformUrl:function(a,b){return a?a.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/)?a:this.baseURL+b.path+a:!1},loadFile:function(a){switch(a.type){case "packfile":this.xhrLoad(a,this.transformUrl(a.url,a),"text",this.fileComplete);break;case "image":case "spritesheet":case "textureatlas":case "bitmapfont":this.loadImageTag(a);break;case "audio":a.url=this.getAudioURL(a.url);a.url?this.game.sound.usingWebAudio?this.xhrLoad(a,this.transformUrl(a.url,
a),"arraybuffer",this.fileComplete):this.game.sound.usingAudioTag&&this.loadAudioTag(a):this.fileError(a,null,"No supported audio URL specified or device does not have audio playback support");break;case "video":a.url=this.getVideoURL(a.url);a.url?a.asBlob?this.xhrLoad(a,this.transformUrl(a.url,a),"blob",this.fileComplete):this.loadVideoTag(a):this.fileError(a,null,"No supported video URL specified or device does not have video playback support");break;case "json":this.xhrLoad(a,this.transformUrl(a.url,
a),"text",this.jsonLoadComplete);break;case "xml":this.xhrLoad(a,this.transformUrl(a.url,a),"text",this.xmlLoadComplete);break;case "tilemap":a.format===Phaser.Tilemap.TILED_JSON?this.xhrLoad(a,this.transformUrl(a.url,a),"text",this.jsonLoadComplete):a.format===Phaser.Tilemap.CSV?this.xhrLoad(a,this.transformUrl(a.url,a),"text",this.csvLoadComplete):this.asyncComplete(a,"invalid Tilemap format: "+a.format);break;case "text":case "script":case "shader":case "physics":this.xhrLoad(a,this.transformUrl(a.url,
a),"text",this.fileComplete);break;case "binary":this.xhrLoad(a,this.transformUrl(a.url,a),"arraybuffer",this.fileComplete)}},loadImageTag:function(a){var b=this;a.data=new Image;a.data.name=a.key;this.crossOrigin&&(a.data.crossOrigin=this.crossOrigin);a.data.onload=function(){a.data.onload&&(a.data.onload=null,a.data.onerror=null,b.fileComplete(a))};a.data.onerror=function(){a.data.onload&&(a.data.onload=null,a.data.onerror=null,b.fileError(a))};a.data.src=this.transformUrl(a.url,a);a.data.complete&&
a.data.width&&a.data.height&&(a.data.onload=null,a.data.onerror=null,this.fileComplete(a))},loadVideoTag:function(a){var b=this;a.data=document.createElement("video");a.data.name=a.key;a.data.controls=!1;a.data.autoplay=!1;var c=function(){a.data.removeEventListener(a.loadEvent,c,!1);a.data.onerror=null;a.data.canplay=!0;Phaser.GAMES[b.game.id].load.fileComplete(a)};a.data.onerror=function(){a.data.removeEventListener(a.loadEvent,c,!1);a.data.onerror=null;a.data.canplay=!1;b.fileError(a)};a.data.addEventListener(a.loadEvent,
c,!1);a.data.src=this.transformUrl(a.url,a);a.data.load()},loadAudioTag:function(a){var b=this;if(this.game.sound.touchLocked)a.data=new Audio,a.data.name=a.key,a.data.preload="auto",a.data.src=this.transformUrl(a.url,a),this.fileComplete(a);else{a.data=new Audio;a.data.name=a.key;var c=function(){a.data.removeEventListener("canplaythrough",c,!1);a.data.onerror=null;b.fileComplete(a)};a.data.onerror=function(){a.data.removeEventListener("canplaythrough",c,!1);a.data.onerror=null;b.fileError(a)};a.data.preload=
"auto";a.data.src=this.transformUrl(a.url,a);a.data.addEventListener("canplaythrough",c,!1);a.data.load()}},xhrLoad:function(a,b,c,d,e){if(this.useXDomainRequest&&window.XDomainRequest)this.xhrLoadWithXDR(a,b,c,d,e);else{var f=new XMLHttpRequest;f.open("GET",b,!0);f.responseType=c;!1!==this.headers.requestedWith&&f.setRequestHeader("X-Requested-With",this.headers.requestedWith);this.headers[a.type]&&f.setRequestHeader("Accept",this.headers[a.type]);e=e||this.fileError;var g=this;f.onload=function(){try{return 4===
f.readyState&&400<=f.status&&599>=f.status?e.call(g,a,f):d.call(g,a,f)}catch(b){g.hasLoaded?window.console&&console.error(b):g.asyncComplete(a,b.message||"Exception")}};f.onerror=function(){try{return e.call(g,a,f)}catch(b){g.hasLoaded?window.console&&console.error(b):g.asyncComplete(a,b.message||"Exception")}};a.requestObject=f;a.requestUrl=b;f.send()}},xhrLoadWithXDR:function(a,b,c,d,e){this._warnedAboutXDomainRequest||this.game.device.ie&&!(10<=this.game.device.ieVersion)||(this._warnedAboutXDomainRequest=
!0,console.warn("Phaser.Loader - using XDomainRequest outside of IE 9"));var f=new window.XDomainRequest;f.open("GET",b,!0);f.responseType=c;f.timeout=3E3;e=e||this.fileError;var g=this;f.onerror=function(){try{return e.call(g,a,f)}catch(b){g.asyncComplete(a,b.message||"Exception")}};f.ontimeout=function(){try{return e.call(g,a,f)}catch(b){g.asyncComplete(a,b.message||"Exception")}};f.onprogress=function(){};f.onload=function(){try{return 4===f.readyState&&400<=f.status&&599>=f.status?e.call(g,a,
f):d.call(g,a,f)}catch(b){g.asyncComplete(a,b.message||"Exception")}};a.requestObject=f;a.requestUrl=b;setTimeout(function(){f.send()},0)},getVideoURL:function(a){for(var b=0;b<a.length;b++){var c=a[b],d;if(c.uri){if(d=c.type,c=c.uri,this.game.device.canPlayVideo(d))return c}else{if(0===c.indexOf("blob:")||0===c.indexOf("data:"))return c;0<=c.indexOf("?")&&(c=c.substr(0,c.indexOf("?")));d=c.substr((Math.max(0,c.lastIndexOf("."))||Infinity)+1).toLowerCase();if(this.game.device.canPlayVideo(d))return a[b]}}return null},
getAudioURL:function(a){if(this.game.sound.noAudio)return null;for(var b=0;b<a.length;b++){var c=a[b],d;if(c.uri){if(d=c.type,c=c.uri,this.game.device.canPlayAudio(d))return c}else{if(0===c.indexOf("blob:")||0===c.indexOf("data:"))return c;0<=c.indexOf("?")&&(c=c.substr(0,c.indexOf("?")));d=c.substr((Math.max(0,c.lastIndexOf("."))||Infinity)+1).toLowerCase();if(this.game.device.canPlayAudio(d))return a[b]}}return null},fileError:function(a,b,c){var d="error loading asset from URL "+(a.requestUrl||
this.transformUrl(a.url,a));!c&&b&&(c=b.status);c&&(d=d+" ("+c+")");this.asyncComplete(a,d)},fileComplete:function(a,b){var c=!0;switch(a.type){case "packfile":var d=JSON.parse(b.responseText);a.data=d||{};break;case "image":this.cache.addImage(a.key,a.url,a.data);break;case "spritesheet":this.cache.addSpriteSheet(a.key,a.url,a.data,a.frameWidth,a.frameHeight,a.frameMax,a.margin,a.spacing);break;case "textureatlas":if(null==a.atlasURL)this.cache.addTextureAtlas(a.key,a.url,a.data,a.atlasData,a.format);
else if(c=!1,a.format===Phaser.Loader.TEXTURE_ATLAS_JSON_ARRAY||a.format===Phaser.Loader.TEXTURE_ATLAS_JSON_HASH||a.format===Phaser.Loader.TEXTURE_ATLAS_JSON_PYXEL)this.xhrLoad(a,this.transformUrl(a.atlasURL,a),"text",this.jsonLoadComplete);else if(a.format===Phaser.Loader.TEXTURE_ATLAS_XML_STARLING)this.xhrLoad(a,this.transformUrl(a.atlasURL,a),"text",this.xmlLoadComplete);else throw Error("Phaser.Loader. Invalid Texture Atlas format: "+a.format);break;case "bitmapfont":a.atlasURL?(c=!1,this.xhrLoad(a,
this.transformUrl(a.atlasURL,a),"text",function(a,b){var c;try{c=JSON.parse(b.responseText)}catch(d){}c?(a.atlasType="json",this.jsonLoadComplete(a,b)):(a.atlasType="xml",this.xmlLoadComplete(a,b))})):this.cache.addBitmapFont(a.key,a.url,a.data,a.atlasData,a.atlasType,a.xSpacing,a.ySpacing);break;case "video":if(a.asBlob)try{a.data=b.response}catch(e){throw Error("Phaser.Loader. Unable to parse video file as Blob: "+a.key);}this.cache.addVideo(a.key,a.url,a.data,a.asBlob);break;case "audio":this.game.sound.usingWebAudio?
(a.data=b.response,this.cache.addSound(a.key,a.url,a.data,!0,!1),a.autoDecode&&this.game.sound.decode(a.key)):this.cache.addSound(a.key,a.url,a.data,!1,!0);break;case "text":a.data=b.responseText;this.cache.addText(a.key,a.url,a.data);break;case "shader":a.data=b.responseText;this.cache.addShader(a.key,a.url,a.data);break;case "physics":d=JSON.parse(b.responseText);this.cache.addPhysicsData(a.key,a.url,d,a.format);break;case "script":a.data=document.createElement("script");a.data.language="javascript";
a.data.type="text/javascript";a.data.defer=!1;a.data.text=b.responseText;document.head.appendChild(a.data);a.callback&&(a.data=a.callback.call(a.callbackContext,a.key,b.responseText));break;case "binary":a.data=a.callback?a.callback.call(a.callbackContext,a.key,b.response):b.response,this.cache.addBinary(a.key,a.data)}c&&this.asyncComplete(a)},jsonLoadComplete:function(a,b){var c=JSON.parse(b.responseText);"tilemap"===a.type?this.cache.addTilemap(a.key,a.url,c,a.format):"bitmapfont"===a.type?this.cache.addBitmapFont(a.key,
a.url,a.data,c,a.atlasType,a.xSpacing,a.ySpacing):"json"===a.type?this.cache.addJSON(a.key,a.url,c):this.cache.addTextureAtlas(a.key,a.url,a.data,c,a.format);this.asyncComplete(a)},csvLoadComplete:function(a,b){this.cache.addTilemap(a.key,a.url,b.responseText,a.format);this.asyncComplete(a)},xmlLoadComplete:function(a,b){var c=this.parseXml(b.responseText);c?("bitmapfont"===a.type?this.cache.addBitmapFont(a.key,a.url,a.data,c,a.atlasType,a.xSpacing,a.ySpacing):"textureatlas"===a.type?this.cache.addTextureAtlas(a.key,
a.url,a.data,c,a.format):"xml"===a.type&&this.cache.addXML(a.key,a.url,c),this.asyncComplete(a)):(console.warn("Phaser.Loader - "+a.key+": invalid XML ("+(b.responseType||b.contentType)+")"),this.asyncComplete(a,"invalid XML"))},parseXml:function(a){var b;try{window.DOMParser?b=(new DOMParser).parseFromString(a,"text/xml"):(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a))}catch(c){b=null}return b&&b.documentElement&&!b.getElementsByTagName("parsererror").length?b:null},updateProgress:function(){this.preloadSprite&&
(0===this.preloadSprite.direction?this.preloadSprite.rect.width=Math.floor(this.preloadSprite.width/100*this.progress):this.preloadSprite.rect.height=Math.floor(this.preloadSprite.height/100*this.progress),this.preloadSprite.sprite?this.preloadSprite.sprite.updateCrop():this.preloadSprite=null)},totalLoadedFiles:function(){return this._loadedFileCount},totalQueuedFiles:function(){return this._totalFileCount-this._loadedFileCount},totalLoadedPacks:function(){return this._totalPackCount},totalQueuedPacks:function(){return this._totalPackCount-
this._loadedPackCount}};Object.defineProperty(Phaser.Loader.prototype,"progressFloat",{get:function(){return Phaser.Math.clamp(this._loadedFileCount/this._totalFileCount*100||0,0,100)}});Object.defineProperty(Phaser.Loader.prototype,"progress",{get:function(){return Math.round(this.progressFloat)}});Phaser.Loader.prototype.constructor=Phaser.Loader;
Phaser.LoaderParser={bitmapFont:function(a,b,c,d){return this.xmlBitmapFont(a,b,c,d)},xmlBitmapFont:function(a,b,c,d){var e={},f=a.getElementsByTagName("info")[0],g=a.getElementsByTagName("common")[0];e.font=f.getAttribute("face");e.size=parseInt(f.getAttribute("size"),10);e.lineHeight=parseInt(g.getAttribute("lineHeight"),10)+d;e.chars={};f=a.getElementsByTagName("char");for(d=0;d<f.length;d++)g=parseInt(f[d].getAttribute("id"),10),e.chars[g]={x:parseInt(f[d].getAttribute("x"),10),y:parseInt(f[d].getAttribute("y"),
10),width:parseInt(f[d].getAttribute("width"),10),height:parseInt(f[d].getAttribute("height"),10),xOffset:parseInt(f[d].getAttribute("xoffset"),10),yOffset:parseInt(f[d].getAttribute("yoffset"),10),xAdvance:parseInt(f[d].getAttribute("xadvance"),10)+c,kerning:{}};a=a.getElementsByTagName("kerning");for(d=0;d<a.length;d++)c=parseInt(a[d].getAttribute("first"),10),f=parseInt(a[d].getAttribute("second"),10),g=parseInt(a[d].getAttribute("amount"),10),e.chars[f].kerning[c]=g;return this.finalizeBitmapFont(b,
e)},jsonBitmapFont:function(a,b,c,d){var e={font:a.font.info._face,size:parseInt(a.font.info._size,10),lineHeight:parseInt(a.font.common._lineHeight,10)+d,chars:{}};a.font.chars["char"].forEach(function(a){var b=parseInt(a._id,10);e.chars[b]={x:parseInt(a._x,10),y:parseInt(a._y,10),width:parseInt(a._width,10),height:parseInt(a._height,10),xOffset:parseInt(a._xoffset,10),yOffset:parseInt(a._yoffset,10),xAdvance:parseInt(a._xadvance,10)+c,kerning:{}}});a.font.kernings&&a.font.kernings.kerning&&a.font.kernings.kerning.forEach(function(a){e.chars[a._second].kerning[a._first]=
parseInt(a._amount,10)});return this.finalizeBitmapFont(b,e)},finalizeBitmapFont:function(a,b){Object.keys(b.chars).forEach(function(c){c=b.chars[c];c.texture=new PIXI.Texture(a,new Phaser.Rectangle(c.x,c.y,c.width,c.height))});return b}};
Phaser.AudioSprite=function(a,b){this.game=a;this.key=b;this.config=this.game.cache.getJSON(b+"-audioatlas");this.autoplayKey=null;this.autoplay=!1;this.sounds={};for(var c in this.config.spritemap){var d=this.config.spritemap[c],e=this.game.add.sound(this.key);e.addMarker(c,d.start,d.end-d.start,null,d.loop);this.sounds[c]=e}this.config.autoplay&&(this.autoplayKey=this.config.autoplay,this.play(this.autoplayKey),this.autoplay=this.sounds[this.autoplayKey])};
Phaser.AudioSprite.prototype={play:function(a,b){void 0===b&&(b=1);return this.sounds[a].play(a,null,b)},stop:function(a){if(a)this.sounds[a].stop();else for(var b in this.sounds)this.sounds[b].stop()},get:function(a){return this.sounds[a]}};Phaser.AudioSprite.prototype.constructor=Phaser.AudioSprite;
Phaser.Sound=function(a,b,c,d,e){void 0===c&&(c=1);void 0===d&&(d=!1);void 0===e&&(e=a.sound.connectToMaster);this.game=a;this.key=this.name=b;this.loop=d;this.markers={};this.context=null;this.autoplay=!1;this.stopTime=this.position=this.durationMS=this.duration=this.currentTime=this.startTime=this.totalDuration=0;this.paused=!1;this.pausedTime=this.pausedPosition=0;this.isPlaying=!1;this.currentMarker="";this.fadeTween=null;this.allowMultiple=this.override=this.pendingPlayback=!1;this.usingWebAudio=
this.game.sound.usingWebAudio;this.usingAudioTag=this.game.sound.usingAudioTag;this._sound=this.gainNode=this.masterGainNode=this.externalNode=null;this.usingWebAudio?(this.context=this.game.sound.context,this.masterGainNode=this.game.sound.masterGain,this.gainNode=void 0===this.context.createGain?this.context.createGainNode():this.context.createGain(),this.gainNode.gain.value=c*this.game.sound.volume,e&&this.gainNode.connect(this.masterGainNode)):this.usingAudioTag&&(this.game.cache.getSound(b)&&
this.game.cache.isSoundReady(b)?(this._sound=this.game.cache.getSoundData(b),this.totalDuration=0,this._sound.duration&&(this.totalDuration=this._sound.duration)):this.game.cache.onSoundUnlock.add(this.soundHasUnlocked,this));this.onDecoded=new Phaser.Signal;this.onPlay=new Phaser.Signal;this.onPause=new Phaser.Signal;this.onResume=new Phaser.Signal;this.onLoop=new Phaser.Signal;this.onStop=new Phaser.Signal;this.onMute=new Phaser.Signal;this.onMarkerComplete=new Phaser.Signal;this.onFadeComplete=
new Phaser.Signal;this._volume=c;this._buffer=null;this._muted=!1;this._tempLoop=this._muteVolume=this._tempPause=this._tempVolume=this._tempPosition=this._tempMarker=0;this._onDecodedEventDispatched=this._paused=!1};
Phaser.Sound.prototype={soundHasUnlocked:function(a){a===this.key&&(this._sound=this.game.cache.getSoundData(this.key),this.totalDuration=this._sound.duration)},addMarker:function(a,b,c,d,e){if(void 0===c||null===c)c=1;if(void 0===d||null===d)d=1;void 0===e&&(e=!1);this.markers[a]={name:a,start:b,stop:b+c,volume:d,duration:c,durationMS:1E3*c,loop:e}},removeMarker:function(a){delete this.markers[a]},onEndedHandler:function(){this._sound.onended=null;this.isPlaying=!1;this.currentTime=this.durationMS;
this.stop()},update:function(){this.game.cache.checkSoundKey(this.key)?(this.isDecoded&&!this._onDecodedEventDispatched&&(this.onDecoded.dispatch(this),this._onDecodedEventDispatched=!0),this.pendingPlayback&&this.game.cache.isSoundReady(this.key)&&(this.pendingPlayback=!1,this.play(this._tempMarker,this._tempPosition,this._tempVolume,this._tempLoop)),this.isPlaying&&(this.currentTime=this.game.time.time-this.startTime,this.currentTime>=this.durationMS&&(this.usingWebAudio?this.loop?(this.onLoop.dispatch(this),
this.isPlaying=!1,""===this.currentMarker?(this.currentTime=0,this.startTime=this.game.time.time,this.isPlaying=!0):(this.onMarkerComplete.dispatch(this.currentMarker,this),this.play(this.currentMarker,0,this.volume,!0,!0))):""!==this.currentMarker&&this.stop():this.loop?(this.onLoop.dispatch(this),""===this.currentMarker&&(this.currentTime=0,this.startTime=this.game.time.time),this.isPlaying=!1,this.play(this.currentMarker,0,this.volume,!0,!0)):this.stop()))):this.destroy()},loopFull:function(a){return this.play(null,
0,a,!0)},play:function(a,b,c,d,e){if(void 0===a||!1===a||null===a)a="";void 0===e&&(e=!0);if(this.isPlaying&&!this.allowMultiple&&!e&&!this.override)return this;if(this._sound&&this.isPlaying&&!this.allowMultiple&&(this.override||e)){if(this.usingWebAudio){if(void 0===this._sound.stop)this._sound.noteOff(0);else try{this._sound.stop(0)}catch(f){}this.externalNode?this._sound.disconnect(this.externalNode):this.gainNode&&this._sound.disconnect(this.gainNode)}else this.usingAudioTag&&(this._sound.pause(),
this._sound.currentTime=0);this.isPlaying=!1}if(""===a&&0<Object.keys(this.markers).length)return this;if(""!==a)if(this.markers[a])this.currentMarker=a,this.position=this.markers[a].start,this.volume=this.markers[a].volume,this.loop=this.markers[a].loop,this.duration=this.markers[a].duration,this.durationMS=this.markers[a].durationMS,"undefined"!==typeof c&&(this.volume=c),"undefined"!==typeof d&&(this.loop=d),this._tempMarker=a,this._tempPosition=this.position,this._tempVolume=this.volume,this._tempLoop=
this.loop;else return console.warn("Phaser.Sound.play: audio marker "+a+" doesn't exist"),this;else b=b||0,void 0===c&&(c=this._volume),void 0===d&&(d=this.loop),this.position=Math.max(0,b),this.volume=c,this.loop=d,this.durationMS=this.duration=0,this._tempMarker=a,this._tempPosition=b,this._tempVolume=c,this._tempLoop=d;this.usingWebAudio?this.game.cache.isSoundDecoded(this.key)?(this._sound=this.context.createBufferSource(),this.externalNode?this._sound.connect(this.externalNode):this._sound.connect(this.gainNode),
this._buffer=this.game.cache.getSoundData(this.key),this._sound.buffer=this._buffer,this.loop&&""===a&&(this._sound.loop=!0),this.loop||""!==a||(this._sound.onended=this.onEndedHandler.bind(this)),this.totalDuration=this._sound.buffer.duration,0===this.duration&&(this.duration=this.totalDuration,this.durationMS=Math.ceil(1E3*this.totalDuration)),void 0===this._sound.start?this._sound.noteGrainOn(0,this.position,this.duration):this.loop&&""===a?this._sound.start(0,0):this._sound.start(0,this.position,
this.duration),this.isPlaying=!0,this.startTime=this.game.time.time,this.currentTime=0,this.stopTime=this.startTime+this.durationMS,this.onPlay.dispatch(this)):(this.pendingPlayback=!0,this.game.cache.getSound(this.key)&&!1===this.game.cache.getSound(this.key).isDecoding&&this.game.sound.decode(this.key,this)):this.game.cache.getSound(this.key)&&this.game.cache.getSound(this.key).locked?(this.game.cache.reloadSound(this.key),this.pendingPlayback=!0):this._sound&&(this.game.device.cocoonJS||4===this._sound.readyState)?
(this._sound.play(),this.totalDuration=this._sound.duration,0===this.duration&&(this.duration=this.totalDuration,this.durationMS=1E3*this.totalDuration),this._sound.currentTime=this.position,this._sound.muted=this._muted,this._sound.volume=this._muted||this.game.sound.mute?0:this._volume,this.isPlaying=!0,this.startTime=this.game.time.time,this.currentTime=0,this.stopTime=this.startTime+this.durationMS,this.onPlay.dispatch(this)):this.pendingPlayback=!0;return this},restart:function(a,b,c,d){void 0===
d&&(d=!1);this.play(a||"",b||0,c||1,d,!0)},pause:function(){this.isPlaying&&this._sound&&(this.paused=!0,this.pausedPosition=this.currentTime,this.pausedTime=this.game.time.time,this._tempPause=this._sound.currentTime,this.onPause.dispatch(this),this.stop())},resume:function(){if(this.paused&&this._sound){if(this.usingWebAudio){var a=Math.max(0,this.position+this.pausedPosition/1E3);this._sound=this.context.createBufferSource();this._sound.buffer=this._buffer;this.externalNode?this._sound.connect(this.externalNode):
this._sound.connect(this.gainNode);this.loop&&(this._sound.loop=!0);this.loop||""!==this.currentMarker||(this._sound.onended=this.onEndedHandler.bind(this));var b=this.duration-this.pausedPosition/1E3;void 0===this._sound.start?this._sound.noteGrainOn(0,a,b):this.loop&&this.game.device.chrome?42===this.game.device.chromeVersion?this._sound.start(0):this._sound.start(0,a):this._sound.start(0,a,b)}else this._sound.currentTime=this._tempPause,this._sound.play();this.isPlaying=!0;this.paused=!1;this.startTime+=
this.game.time.time-this.pausedTime;this.onResume.dispatch(this)}},stop:function(){if(this.isPlaying&&this._sound)if(this.usingWebAudio){if(void 0===this._sound.stop)this._sound.noteOff(0);else try{this._sound.stop(0)}catch(b){}this.externalNode?this._sound.disconnect(this.externalNode):this.gainNode&&this._sound.disconnect(this.gainNode)}else this.usingAudioTag&&(this._sound.pause(),this._sound.currentTime=0);this.isPlaying=this.pendingPlayback=!1;if(!this.paused){var a=this.currentMarker;""!==this.currentMarker&&
this.onMarkerComplete.dispatch(this.currentMarker,this);this.currentMarker="";null!==this.fadeTween&&this.fadeTween.stop();this.onStop.dispatch(this,a)}},fadeIn:function(a,b,c){void 0===b&&(b=!1);void 0===c&&(c=this.currentMarker);this.paused||(this.play(c,0,0,b),this.fadeTo(a,1))},fadeOut:function(a){this.fadeTo(a,0)},fadeTo:function(a,b){this.isPlaying&&!this.paused&&b!==this.volume&&(void 0===a&&(a=1E3),void 0===b?console.warn("Phaser.Sound.fadeTo: No Volume Specified."):(this.fadeTween=this.game.add.tween(this).to({volume:b},
a,Phaser.Easing.Linear.None,!0),this.fadeTween.onComplete.add(this.fadeComplete,this)))},fadeComplete:function(){this.onFadeComplete.dispatch(this,this.volume);0===this.volume&&this.stop()},updateGlobalVolume:function(a){this.usingAudioTag&&this._sound&&(this._sound.volume=a*this._volume)},destroy:function(a){void 0===a&&(a=!0);this.stop();a?this.game.sound.remove(this):(this.markers={},this.externalNode=this._buffer=this.context=null,this.onDecoded.dispose(),this.onPlay.dispose(),this.onPause.dispose(),
this.onResume.dispose(),this.onLoop.dispose(),this.onStop.dispose(),this.onMute.dispose(),this.onMarkerComplete.dispose())}};Phaser.Sound.prototype.constructor=Phaser.Sound;Object.defineProperty(Phaser.Sound.prototype,"isDecoding",{get:function(){return this.game.cache.getSound(this.key).isDecoding}});Object.defineProperty(Phaser.Sound.prototype,"isDecoded",{get:function(){return this.game.cache.isSoundDecoded(this.key)}});
Object.defineProperty(Phaser.Sound.prototype,"mute",{get:function(){return this._muted||this.game.sound.mute},set:function(a){a=a||!1;a!==this._muted&&(a?(this._muted=!0,this._muteVolume=this._tempVolume,this.usingWebAudio?this.gainNode.gain.value=0:this.usingAudioTag&&this._sound&&(this._sound.volume=0)):(this._muted=!1,this.usingWebAudio?this.gainNode.gain.value=this._muteVolume:this.usingAudioTag&&this._sound&&(this._sound.volume=this._muteVolume)),this.onMute.dispatch(this))}});
Object.defineProperty(Phaser.Sound.prototype,"volume",{get:function(){return this._volume},set:function(a){this.game.device.firefox&&this.usingAudioTag&&(a=this.game.math.clamp(a,0,1));this._muted?this._muteVolume=a:(this._volume=this._tempVolume=a,this.usingWebAudio?this.gainNode.gain.value=a:this.usingAudioTag&&this._sound&&(this._sound.volume=a))}});
Phaser.SoundManager=function(a){this.game=a;this.onSoundDecode=new Phaser.Signal;this.onVolumeChange=new Phaser.Signal;this.onMute=new Phaser.Signal;this.onUnMute=new Phaser.Signal;this.context=null;this.noAudio=this.usingAudioTag=this.usingWebAudio=!1;this.connectToMaster=!0;this.touchLocked=!1;this.channels=32;this.muteOnPause=!0;this._muted=this._codeMuted=!1;this._unlockSource=null;this._volume=1;this._sounds=[];this._watchList=new Phaser.ArraySet;this._watching=!1;this._watchContext=this._watchCallback=
null};
Phaser.SoundManager.prototype={boot:function(){this.game.device.iOS&&!1===this.game.device.webAudio&&(this.channels=1);if(window.PhaserGlobal){if(!0===window.PhaserGlobal.disableAudio){this.noAudio=!0;this.touchLocked=!1;return}if(!0===window.PhaserGlobal.disableWebAudio){this.usingAudioTag=!0;this.touchLocked=!1;return}}if(window.PhaserGlobal&&window.PhaserGlobal.audioContext)this.context=window.PhaserGlobal.audioContext;else if(window.AudioContext)try{this.context=new window.AudioContext}catch(a){this.context=null,
this.touchLocked=this.usingWebAudio=!1}else if(window.webkitAudioContext)try{this.context=new window.webkitAudioContext}catch(a){this.context=null,this.touchLocked=this.usingWebAudio=!1}if(null===this.context){if(void 0===window.Audio){this.noAudio=!0;return}this.usingAudioTag=!0}else this.usingWebAudio=!0,this.masterGain=void 0===this.context.createGain?this.context.createGainNode():this.context.createGain(),this.masterGain.gain.value=1,this.masterGain.connect(this.context.destination);this.noAudio||
(!this.game.device.cocoonJS&&this.game.device.iOS||window.PhaserGlobal&&window.PhaserGlobal.fakeiOSTouchLock)&&this.setTouchLock()},setTouchLock:function(){this.noAudio||window.PhaserGlobal&&!0===window.PhaserGlobal.disableAudio||(8<this.game.device.iOSVersion?this.game.input.touch.addTouchLockCallback(this.unlock,this,!0):this.game.input.touch.addTouchLockCallback(this.unlock,this),this.touchLocked=!0)},unlock:function(){if(this.noAudio||!this.touchLocked||null!==this._unlockSource)return!0;if(this.usingAudioTag)this.touchLocked=
!1,this._unlockSource=null;else if(this.usingWebAudio){var a=this.context.createBuffer(1,1,22050);this._unlockSource=this.context.createBufferSource();this._unlockSource.buffer=a;this._unlockSource.connect(this.context.destination);void 0===this._unlockSource.start?this._unlockSource.noteOn(0):this._unlockSource.start(0)}return!0},stopAll:function(){if(!this.noAudio)for(var a=0;a<this._sounds.length;a++)this._sounds[a]&&this._sounds[a].stop()},pauseAll:function(){if(!this.noAudio)for(var a=0;a<this._sounds.length;a++)this._sounds[a]&&
this._sounds[a].pause()},resumeAll:function(){if(!this.noAudio)for(var a=0;a<this._sounds.length;a++)this._sounds[a]&&this._sounds[a].resume()},decode:function(a,b){b=b||null;var c=this.game.cache.getSoundData(a);if(c&&!1===this.game.cache.isSoundDecoded(a)){this.game.cache.updateSound(a,"isDecoding",!0);var d=this;try{this.context.decodeAudioData(c,function(c){c&&(d.game.cache.decodedSound(a,c),d.onSoundDecode.dispatch(a,b))})}catch(e){}}},setDecodedCallback:function(a,b,c){"string"===typeof a&&
(a=[a]);this._watchList.reset();for(var d=0;d<a.length;d++)a[d]instanceof Phaser.Sound?this.game.cache.isSoundDecoded(a[d].key)||this._watchList.add(a[d].key):this.game.cache.isSoundDecoded(a[d])||this._watchList.add(a[d]);0===this._watchList.total?(this._watching=!1,b.call(c)):(this._watching=!0,this._watchCallback=b,this._watchContext=c)},update:function(){if(!this.noAudio){!this.touchLocked||null===this._unlockSource||this._unlockSource.playbackState!==this._unlockSource.PLAYING_STATE&&this._unlockSource.playbackState!==
this._unlockSource.FINISHED_STATE||(this.touchLocked=!1,this._unlockSource=null);for(var a=0;a<this._sounds.length;a++)this._sounds[a].update();if(this._watching){for(a=this._watchList.first;a;)this.game.cache.isSoundDecoded(a)&&this._watchList.remove(a),a=this._watchList.next;0===this._watchList.total&&(this._watching=!1,this._watchCallback.call(this._watchContext))}}},add:function(a,b,c,d){void 0===b&&(b=1);void 0===c&&(c=!1);void 0===d&&(d=this.connectToMaster);a=new Phaser.Sound(this.game,a,b,
c,d);this._sounds.push(a);return a},addSprite:function(a){return new Phaser.AudioSprite(this.game,a)},remove:function(a){for(var b=this._sounds.length;b--;)if(this._sounds[b]===a)return this._sounds[b].destroy(!1),this._sounds.splice(b,1),!0;return!1},removeByKey:function(a){for(var b=this._sounds.length,c=0;b--;)this._sounds[b].key===a&&(this._sounds[b].destroy(!1),this._sounds.splice(b,1),c++);return c},play:function(a,b,c){if(!this.noAudio)return a=this.add(a,b,c),a.play(),a},setMute:function(){if(!this._muted){this._muted=
!0;this.usingWebAudio&&(this._muteVolume=this.masterGain.gain.value,this.masterGain.gain.value=0);for(var a=0;a<this._sounds.length;a++)this._sounds[a].usingAudioTag&&(this._sounds[a].mute=!0);this.onMute.dispatch()}},unsetMute:function(){if(this._muted&&!this._codeMuted){this._muted=!1;this.usingWebAudio&&(this.masterGain.gain.value=this._muteVolume);for(var a=0;a<this._sounds.length;a++)this._sounds[a].usingAudioTag&&(this._sounds[a].mute=!1);this.onUnMute.dispatch()}},destroy:function(){this.stopAll();
for(var a=0;a<this._sounds.length;a++)this._sounds[a]&&this._sounds[a].destroy();this._sounds=[];this.onSoundDecode.dispose();this.context&&(window.PhaserGlobal?window.PhaserGlobal.audioContext=this.context:this.context.close&&this.context.close())}};Phaser.SoundManager.prototype.constructor=Phaser.SoundManager;
Object.defineProperty(Phaser.SoundManager.prototype,"mute",{get:function(){return this._muted},set:function(a){a?this._muted||(this._codeMuted=!0,this.setMute()):this._muted&&(this._codeMuted=!1,this.unsetMute())}});
Object.defineProperty(Phaser.SoundManager.prototype,"volume",{get:function(){return this._volume},set:function(a){0>a?a=0:1<a&&(a=1);if(this._volume!==a){this._volume=a;if(this.usingWebAudio)this.masterGain.gain.value=a;else for(var b=0;b<this._sounds.length;b++)this._sounds[b].usingAudioTag&&this._sounds[b].updateGlobalVolume(a);this.onVolumeChange.dispatch(a)}}});
Phaser.ScaleManager=function(a,b,c){this.game=a;this.dom=Phaser.DOM;this.grid=null;this.height=this.width=0;this.maxHeight=this.minHeight=this.maxWidth=this.minWidth=null;this.offset=new Phaser.Point;this._pageAlignVertically=this._pageAlignHorizontally=this.incorrectOrientation=this.forcePortrait=this.forceLandscape=!1;this.onOrientationChange=new Phaser.Signal;this.enterIncorrectOrientation=new Phaser.Signal;this.leaveIncorrectOrientation=new Phaser.Signal;this.hasPhaserSetFullScreen=!1;this._createdFullScreenTarget=
this.fullScreenTarget=null;this.onFullScreenInit=new Phaser.Signal;this.onFullScreenChange=new Phaser.Signal;this.onFullScreenError=new Phaser.Signal;this.screenOrientation=this.dom.getScreenOrientation();this.scaleFactor=new Phaser.Point(1,1);this.scaleFactorInversed=new Phaser.Point(1,1);this.margin={left:0,top:0,right:0,bottom:0,x:0,y:0};this.bounds=new Phaser.Rectangle;this.sourceAspectRatio=this.aspectRatio=0;this.event=null;this.windowConstraints={right:"layout",bottom:""};this.compatibility=
{supportsFullScreen:!1,orientationFallback:null,noMargins:!1,scrollTo:null,forceMinimumDocumentHeight:!1,canExpandParent:!0,clickTrampoline:""};this._fullScreenScaleMode=this._scaleMode=Phaser.ScaleManager.NO_SCALE;this.parentIsWindow=!1;this.parentNode=null;this.parentScaleFactor=new Phaser.Point(1,1);this.trackParentInterval=2E3;this.onSizeChange=new Phaser.Signal;this._fullScreenRestore=this._pendingScaleMode=this.onResizeContext=this.onResize=null;this._gameSize=new Phaser.Rectangle;this._userScaleFactor=
new Phaser.Point(1,1);this._userScaleTrim=new Phaser.Point(0,0);this._updateThrottle=this._lastUpdate=0;this._updateThrottleReset=100;this._parentBounds=new Phaser.Rectangle;this._tempBounds=new Phaser.Rectangle;this._lastReportedCanvasSize=new Phaser.Rectangle;this._lastReportedGameSize=new Phaser.Rectangle;this._booted=!1;a.config&&this.parseConfig(a.config);this.setupScale(b,c)};Phaser.ScaleManager.EXACT_FIT=0;Phaser.ScaleManager.NO_SCALE=1;Phaser.ScaleManager.SHOW_ALL=2;
Phaser.ScaleManager.RESIZE=3;Phaser.ScaleManager.USER_SCALE=4;
Phaser.ScaleManager.prototype={boot:function(){var a=this.compatibility;a.supportsFullScreen=this.game.device.fullscreen&&!this.game.device.cocoonJS;this.game.device.iPad||this.game.device.webApp||this.game.device.desktop||(a.scrollTo=this.game.device.android&&!this.game.device.chrome?new Phaser.Point(0,1):new Phaser.Point(0,0));this.game.device.desktop?(a.orientationFallback="screen",a.clickTrampoline="when-not-mouse"):(a.orientationFallback="",a.clickTrampoline="");var b=this;this._orientationChange=
function(a){return b.orientationChange(a)};this._windowResize=function(a){return b.windowResize(a)};window.addEventListener("orientationchange",this._orientationChange,!1);window.addEventListener("resize",this._windowResize,!1);this.compatibility.supportsFullScreen&&(this._fullScreenChange=function(a){return b.fullScreenChange(a)},this._fullScreenError=function(a){return b.fullScreenError(a)},document.addEventListener("webkitfullscreenchange",this._fullScreenChange,!1),document.addEventListener("mozfullscreenchange",
this._fullScreenChange,!1),document.addEventListener("MSFullscreenChange",this._fullScreenChange,!1),document.addEventListener("fullscreenchange",this._fullScreenChange,!1),document.addEventListener("webkitfullscreenerror",this._fullScreenError,!1),document.addEventListener("mozfullscreenerror",this._fullScreenError,!1),document.addEventListener("MSFullscreenError",this._fullScreenError,!1),document.addEventListener("fullscreenerror",this._fullScreenError,!1));this.game.onResume.add(this._gameResumed,
this);this.dom.getOffset(this.game.canvas,this.offset);this.bounds.setTo(this.offset.x,this.offset.y,this.width,this.height);this.setGameSize(this.game.width,this.game.height);this.screenOrientation=this.dom.getScreenOrientation(this.compatibility.orientationFallback);Phaser.FlexGrid&&(this.grid=new Phaser.FlexGrid(this,this.width,this.height));this._booted=!0;null!==this._pendingScaleMode&&(this.scaleMode=this._pendingScaleMode,this._pendingScaleMode=null)},parseConfig:function(a){void 0!==a.scaleMode&&
(this._booted?this.scaleMode=a.scaleMode:this._pendingScaleMode=a.scaleMode);void 0!==a.fullScreenScaleMode&&(this.fullScreenScaleMode=a.fullScreenScaleMode);a.fullScreenTarget&&(this.fullScreenTarget=a.fullScreenTarget)},setupScale:function(a,b){var c,d=new Phaser.Rectangle;""!==this.game.parent&&("string"===typeof this.game.parent?c=document.getElementById(this.game.parent):this.game.parent&&1===this.game.parent.nodeType&&(c=this.game.parent));c?(this.parentNode=c,this.parentIsWindow=!1,this.getParentBounds(this._parentBounds),
d.width=this._parentBounds.width,d.height=this._parentBounds.height,this.offset.set(this._parentBounds.x,this._parentBounds.y)):(this.parentNode=null,this.parentIsWindow=!0,d.width=this.dom.visualBounds.width,d.height=this.dom.visualBounds.height,this.offset.set(0,0));var e=c=0;"number"===typeof a?c=a:(this.parentScaleFactor.x=parseInt(a,10)/100,c=d.width*this.parentScaleFactor.x);"number"===typeof b?e=b:(this.parentScaleFactor.y=parseInt(b,10)/100,e=d.height*this.parentScaleFactor.y);c=Math.floor(c);
e=Math.floor(e);this._gameSize.setTo(0,0,c,e);this.updateDimensions(c,e,!1)},_gameResumed:function(){this.queueUpdate(!0)},setGameSize:function(a,b){this._gameSize.setTo(0,0,a,b);this.currentScaleMode!==Phaser.ScaleManager.RESIZE&&this.updateDimensions(a,b,!0);this.queueUpdate(!0)},setUserScale:function(a,b,c,d){this._userScaleFactor.setTo(a,b);this._userScaleTrim.setTo(c|0,d|0);this.queueUpdate(!0)},setResizeCallback:function(a,b){this.onResize=a;this.onResizeContext=b},signalSizeChange:function(){if(!Phaser.Rectangle.sameDimensions(this,
this._lastReportedCanvasSize)||!Phaser.Rectangle.sameDimensions(this.game,this._lastReportedGameSize)){var a=this.width,b=this.height;this._lastReportedCanvasSize.setTo(0,0,a,b);this._lastReportedGameSize.setTo(0,0,this.game.width,this.game.height);if(this.grid)this.grid.onResize(a,b);this.onSizeChange.dispatch(this,a,b);this.currentScaleMode===Phaser.ScaleManager.RESIZE&&(this.game.state.resize(a,b),this.game.load.resize(a,b))}},setMinMax:function(a,b,c,d){this.minWidth=a;this.minHeight=b;"undefined"!==
typeof c&&(this.maxWidth=c);"undefined"!==typeof d&&(this.maxHeight=d)},preUpdate:function(){if(!(this.game.time.time<this._lastUpdate+this._updateThrottle)){var a=this._updateThrottle;this._updateThrottleReset=400<=a?0:100;this.dom.getOffset(this.game.canvas,this.offset);var b=this._parentBounds.width,c=this._parentBounds.height,d=this.getParentBounds(this._parentBounds),b=d.width!==b||d.height!==c,c=this.updateOrientationState();if(b||c)this.onResize&&this.onResize.call(this.onResizeContext,this,
d),this.updateLayout(),this.signalSizeChange();d=2*this._updateThrottle;this._updateThrottle<a&&(d=Math.min(a,this._updateThrottleReset));this._updateThrottle=Phaser.Math.clamp(d,25,this.trackParentInterval);this._lastUpdate=this.game.time.time}},pauseUpdate:function(){this.preUpdate();this._updateThrottle=this.trackParentInterval},updateDimensions:function(a,b,c){this.width=a*this.parentScaleFactor.x;this.height=b*this.parentScaleFactor.y;this.game.width=this.width;this.game.height=this.height;this.sourceAspectRatio=
this.width/this.height;this.updateScalingAndBounds();c&&(this.game.renderer.resize(this.width,this.height),this.game.camera.setSize(this.width,this.height),this.game.world.resize(this.width,this.height))},updateScalingAndBounds:function(){this.scaleFactor.x=this.game.width/this.width;this.scaleFactor.y=this.game.height/this.height;this.scaleFactorInversed.x=this.width/this.game.width;this.scaleFactorInversed.y=this.height/this.game.height;this.aspectRatio=this.width/this.height;this.game.canvas&&
this.dom.getOffset(this.game.canvas,this.offset);this.bounds.setTo(this.offset.x,this.offset.y,this.width,this.height);this.game.input&&this.game.input.scale&&this.game.input.scale.setTo(this.scaleFactor.x,this.scaleFactor.y)},forceOrientation:function(a,b){void 0===b&&(b=!1);this.forceLandscape=a;this.forcePortrait=b;this.queueUpdate(!0)},classifyOrientation:function(a){return"portrait-primary"===a||"portrait-secondary"===a?"portrait":"landscape-primary"===a||"landscape-secondary"===a?"landscape":
null},updateOrientationState:function(){var a=this.screenOrientation,b=this.incorrectOrientation;this.screenOrientation=this.dom.getScreenOrientation(this.compatibility.orientationFallback);this.incorrectOrientation=this.forceLandscape&&!this.isLandscape||this.forcePortrait&&!this.isPortrait;var c=a!==this.screenOrientation,d=b!==this.incorrectOrientation;d&&(this.incorrectOrientation?this.enterIncorrectOrientation.dispatch():this.leaveIncorrectOrientation.dispatch());(c||d)&&this.onOrientationChange.dispatch(this,
a,b);return c||d},orientationChange:function(a){this.event=a;this.queueUpdate(!0)},windowResize:function(a){this.event=a;this.queueUpdate(!0)},scrollTop:function(){var a=this.compatibility.scrollTo;a&&window.scrollTo(a.x,a.y)},refresh:function(){this.scrollTop();this.queueUpdate(!0)},updateLayout:function(){var a=this.currentScaleMode;a===Phaser.ScaleManager.RESIZE?this.reflowGame():(this.scrollTop(),this.compatibility.forceMinimumDocumentHeight&&(document.documentElement.style.minHeight=window.innerHeight+
"px"),this.incorrectOrientation?this.setMaximum():a===Phaser.ScaleManager.EXACT_FIT?this.setExactFit():a===Phaser.ScaleManager.SHOW_ALL?(!this.isFullScreen&&this.boundingParent&&this.compatibility.canExpandParent&&(this.setShowAll(!0),this.resetCanvas()),this.setShowAll()):a===Phaser.ScaleManager.NO_SCALE?(this.width=this.game.width,this.height=this.game.height):a===Phaser.ScaleManager.USER_SCALE&&(this.width=this.game.width*this._userScaleFactor.x-this._userScaleTrim.x,this.height=this.game.height*
this._userScaleFactor.y-this._userScaleTrim.y),this.compatibility.canExpandParent||a!==Phaser.ScaleManager.SHOW_ALL&&a!==Phaser.ScaleManager.USER_SCALE||(a=this.getParentBounds(this._tempBounds),this.width=Math.min(this.width,a.width),this.height=Math.min(this.height,a.height)),this.width|=0,this.height|=0,this.reflowCanvas())},getParentBounds:function(a){a=a||new Phaser.Rectangle;var b=this.boundingParent,c=this.dom.visualBounds,d=this.dom.layoutBounds;if(b){var e=b.getBoundingClientRect(),b=b.offsetParent?
b.offsetParent.getBoundingClientRect():b.getBoundingClientRect();a.setTo(e.left-b.left,e.top-b.top,e.width,e.height);e=this.windowConstraints;e.right&&(b="layout"===e.right?d:c,a.right=Math.min(a.right,b.width));e.bottom&&(b="layout"===e.bottom?d:c,a.bottom=Math.min(a.bottom,b.height))}else a.setTo(0,0,c.width,c.height);a.setTo(Math.round(a.x),Math.round(a.y),Math.round(a.width),Math.round(a.height));return a},alignCanvas:function(a,b){var c=this.getParentBounds(this._tempBounds),d=this.game.canvas,
e=this.margin;if(a){e.left=e.right=0;var f=d.getBoundingClientRect();if(this.width<c.width&&!this.incorrectOrientation){var g=f.left-c.x,h=c.width/2-this.width/2,h=Math.max(h,0);e.left=Math.round(h-g)}d.style.marginLeft=e.left+"px";0!==e.left&&(e.right=-(c.width-f.width-e.left),d.style.marginRight=e.right+"px")}b&&(e.top=e.bottom=0,f=d.getBoundingClientRect(),this.height<c.height&&!this.incorrectOrientation&&(g=f.top-c.y,h=c.height/2-this.height/2,h=Math.max(h,0),e.top=Math.round(h-g)),d.style.marginTop=
e.top+"px",0!==e.top&&(e.bottom=-(c.height-f.height-e.top),d.style.marginBottom=e.bottom+"px"));e.x=e.left;e.y=e.top},reflowGame:function(){this.resetCanvas("","");var a=this.getParentBounds(this._tempBounds);this.updateDimensions(a.width,a.height,!0)},reflowCanvas:function(){this.incorrectOrientation||(this.width=Phaser.Math.clamp(this.width,this.minWidth||0,this.maxWidth||this.width),this.height=Phaser.Math.clamp(this.height,this.minHeight||0,this.maxHeight||this.height));this.resetCanvas();this.compatibility.noMargins||
(this.isFullScreen&&this._createdFullScreenTarget?this.alignCanvas(!0,!0):this.alignCanvas(this.pageAlignHorizontally,this.pageAlignVertically));this.updateScalingAndBounds()},resetCanvas:function(a,b){void 0===a&&(a=this.width+"px");void 0===b&&(b=this.height+"px");var c=this.game.canvas;this.compatibility.noMargins||(c.style.marginLeft="",c.style.marginTop="",c.style.marginRight="",c.style.marginBottom="");c.style.width=a;c.style.height=b},queueUpdate:function(a){a&&(this._parentBounds.width=0,
this._parentBounds.height=0);this._updateThrottle=this._updateThrottleReset},reset:function(a){a&&this.grid&&this.grid.reset()},setMaximum:function(){this.width=this.dom.visualBounds.width;this.height=this.dom.visualBounds.height},setShowAll:function(a){var b=this.getParentBounds(this._tempBounds),c=b.width,b=b.height;a=a?Math.max(b/this.game.height,c/this.game.width):Math.min(b/this.game.height,c/this.game.width);this.width=Math.round(this.game.width*a);this.height=Math.round(this.game.height*a)},
setExactFit:function(){var a=this.getParentBounds(this._tempBounds);this.width=a.width;this.height=a.height;this.isFullScreen||(this.maxWidth&&(this.width=Math.min(this.width,this.maxWidth)),this.maxHeight&&(this.height=Math.min(this.height,this.maxHeight)))},createFullScreenTarget:function(){var a=document.createElement("div");a.style.margin="0";a.style.padding="0";a.style.background="#000";return a},startFullScreen:function(a,b){if(this.isFullScreen)return!1;if(this.compatibility.supportsFullScreen){if("when-not-mouse"===
this.compatibility.clickTrampoline){var c=this.game.input;if(c.activePointer&&c.activePointer!==c.mousePointer&&(b||!1!==b)){c.activePointer.addClickTrampoline("startFullScreen",this.startFullScreen,this,[a,!1]);return}}void 0!==a&&this.game.renderType===Phaser.CANVAS&&(this.game.stage.smoothed=a);c=this.fullScreenTarget;c||(this.cleanupCreatedTarget(),c=this._createdFullScreenTarget=this.createFullScreenTarget());var d={targetElement:c};this.hasPhaserSetFullScreen=!0;this.onFullScreenInit.dispatch(this,
d);this._createdFullScreenTarget&&(d=this.game.canvas,d.parentNode.insertBefore(c,d),c.appendChild(d));if(this.game.device.fullscreenKeyboard)c[this.game.device.requestFullscreen](Element.ALLOW_KEYBOARD_INPUT);else c[this.game.device.requestFullscreen]();return!0}var e=this;setTimeout(function(){e.fullScreenError()},10)},stopFullScreen:function(){if(!this.isFullScreen||!this.compatibility.supportsFullScreen)return!1;this.hasPhaserSetFullScreen=!1;document[this.game.device.cancelFullscreen]();return!0},
cleanupCreatedTarget:function(){var a=this._createdFullScreenTarget;if(a&&a.parentNode){var b=a.parentNode;b.insertBefore(this.game.canvas,a);b.removeChild(a)}this._createdFullScreenTarget=null},prepScreenMode:function(a){var b=!!this._createdFullScreenTarget,c=this._createdFullScreenTarget||this.fullScreenTarget;a?!b&&this.fullScreenScaleMode!==Phaser.ScaleManager.EXACT_FIT||c===this.game.canvas||(this._fullScreenRestore={targetWidth:c.style.width,targetHeight:c.style.height},c.style.width="100%",
c.style.height="100%"):(this._fullScreenRestore&&(c.style.width=this._fullScreenRestore.targetWidth,c.style.height=this._fullScreenRestore.targetHeight,this._fullScreenRestore=null),this.updateDimensions(this._gameSize.width,this._gameSize.height,!0),this.resetCanvas())},fullScreenChange:function(a){this.event=a;this.isFullScreen?this.prepScreenMode(!0):(this.prepScreenMode(!1),this.cleanupCreatedTarget());this.updateLayout();this.queueUpdate(!0);this.onFullScreenChange.dispatch(this,this.width,this.height)},
fullScreenError:function(a){this.event=a;this.cleanupCreatedTarget();console.warn("Phaser.ScaleManager: requestFullscreen failed or device does not support the Fullscreen API");this.onFullScreenError.dispatch(this)},scaleSprite:function(a,b,c,d){void 0===b&&(b=this.width);void 0===c&&(c=this.height);void 0===d&&(d=!1);if(!a||!a.scale)return a;a.scale.x=1;a.scale.y=1;if(0>=a.width||0>=a.height||0>=b||0>=c)return a;var e=a.height*b/a.width,f=a.width*c/a.height;(d=f>b?d:!d)?(a.width=Math.floor(b),a.height=
Math.floor(e)):(a.width=Math.floor(f),a.height=Math.floor(c));return a},destroy:function(){this.game.onResume.remove(this._gameResumed,this);window.removeEventListener("orientationchange",this._orientationChange,!1);window.removeEventListener("resize",this._windowResize,!1);this.compatibility.supportsFullScreen&&(document.removeEventListener("webkitfullscreenchange",this._fullScreenChange,!1),document.removeEventListener("mozfullscreenchange",this._fullScreenChange,!1),document.removeEventListener("MSFullscreenChange",
this._fullScreenChange,!1),document.removeEventListener("fullscreenchange",this._fullScreenChange,!1),document.removeEventListener("webkitfullscreenerror",this._fullScreenError,!1),document.removeEventListener("mozfullscreenerror",this._fullScreenError,!1),document.removeEventListener("MSFullscreenError",this._fullScreenError,!1),document.removeEventListener("fullscreenerror",this._fullScreenError,!1))}};Phaser.ScaleManager.prototype.constructor=Phaser.ScaleManager;
Object.defineProperty(Phaser.ScaleManager.prototype,"boundingParent",{get:function(){return this.parentIsWindow||this.isFullScreen&&this.hasPhaserSetFullScreen&&!this._createdFullScreenTarget?null:this.game.canvas&&this.game.canvas.parentNode||null}});
Object.defineProperty(Phaser.ScaleManager.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(a){a!==this._scaleMode&&(this.isFullScreen||(this.updateDimensions(this._gameSize.width,this._gameSize.height,!0),this.queueUpdate(!0)),this._scaleMode=a);return this._scaleMode}});
Object.defineProperty(Phaser.ScaleManager.prototype,"fullScreenScaleMode",{get:function(){return this._fullScreenScaleMode},set:function(a){a!==this._fullScreenScaleMode&&(this.isFullScreen?(this.prepScreenMode(!1),this._fullScreenScaleMode=a,this.prepScreenMode(!0),this.queueUpdate(!0)):this._fullScreenScaleMode=a);return this._fullScreenScaleMode}});Object.defineProperty(Phaser.ScaleManager.prototype,"currentScaleMode",{get:function(){return this.isFullScreen?this._fullScreenScaleMode:this._scaleMode}});
Object.defineProperty(Phaser.ScaleManager.prototype,"pageAlignHorizontally",{get:function(){return this._pageAlignHorizontally},set:function(a){a!==this._pageAlignHorizontally&&(this._pageAlignHorizontally=a,this.queueUpdate(!0))}});Object.defineProperty(Phaser.ScaleManager.prototype,"pageAlignVertically",{get:function(){return this._pageAlignVertically},set:function(a){a!==this._pageAlignVertically&&(this._pageAlignVertically=a,this.queueUpdate(!0))}});
Object.defineProperty(Phaser.ScaleManager.prototype,"isFullScreen",{get:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}});Object.defineProperty(Phaser.ScaleManager.prototype,"isPortrait",{get:function(){return"portrait"===this.classifyOrientation(this.screenOrientation)}});Object.defineProperty(Phaser.ScaleManager.prototype,"isLandscape",{get:function(){return"landscape"===this.classifyOrientation(this.screenOrientation)}});
Object.defineProperty(Phaser.ScaleManager.prototype,"isGamePortrait",{get:function(){return this.height>this.width}});Object.defineProperty(Phaser.ScaleManager.prototype,"isGameLandscape",{get:function(){return this.width>this.height}});var debugNoop=function(){};Phaser.Utils.Debug=debugNoop;
Phaser.Utils.Debug.prototype={isDisabled:!0,boot:debugNoop,preUpdate:debugNoop,reset:debugNoop,start:debugNoop,stop:debugNoop,line:debugNoop,soundInfo:debugNoop,cameraInfo:debugNoop,timer:debugNoop,pointer:debugNoop,spriteInputInfo:debugNoop,key:debugNoop,inputInfo:debugNoop,spriteBounds:debugNoop,ropeSegments:debugNoop,spriteInfo:debugNoop,spriteCoords:debugNoop,lineInfo:debugNoop,pixel:debugNoop,geom:debugNoop,rectangle:debugNoop,text:debugNoop,quadTree:debugNoop,body:debugNoop,bodyInfo:debugNoop,
box2dWorld:debugNoop,box2dBody:debugNoop};Phaser.Utils.Debug.prototype.constructor=Phaser.Utils.Debug;
Phaser.DOM={getOffset:function(a,b){b=b||new Phaser.Point;var c=a.getBoundingClientRect(),d=Phaser.DOM.scrollY,e=document.documentElement.clientTop;b.x=c.left+Phaser.DOM.scrollX-document.documentElement.clientLeft;b.y=c.top+d-e;return b},getBounds:function(a,b){void 0===b&&(b=0);return(a=a&&!a.nodeType?a[0]:a)&&1===a.nodeType?this.calibrate(a.getBoundingClientRect(),b):!1},calibrate:function(a,b){b=+b||0;var c={width:0,height:0,left:0,right:0,top:0,bottom:0};c.width=(c.right=a.right+b)-(c.left=a.left-
b);c.height=(c.bottom=a.bottom+b)-(c.top=a.top-b);return c},getAspectRatio:function(a){a=null==a?this.visualBounds:1===a.nodeType?this.getBounds(a):a;var b=a.width,c=a.height;"function"===typeof b&&(b=b.call(a));"function"===typeof c&&(c=c.call(a));return b/c},inLayoutViewport:function(a,b){var c=this.getBounds(a,b);return!!c&&0<=c.bottom&&0<=c.right&&c.top<=this.layoutBounds.width&&c.left<=this.layoutBounds.height},getScreenOrientation:function(a){var b=window.screen,c=b.orientation||b.mozOrientation||
b.msOrientation;if(c&&"string"===typeof c.type)return c.type;if("string"===typeof c)return c;if("screen"===a)return b.height>b.width?"portrait-primary":"landscape-primary";if("viewport"!==a){if("window.orientation"===a&&"number"===typeof window.orientation)return 0===window.orientation||180===window.orientation?"portrait-primary":"landscape-primary";if(window.matchMedia){if(window.matchMedia("(orientation: portrait)").matches)return"portrait-primary";if(window.matchMedia("(orientation: landscape)").matches)return"landscape-primary"}}return this.visualBounds.height>
this.visualBounds.width?"portrait-primary":"landscape-primary"},visualBounds:new Phaser.Rectangle,layoutBounds:new Phaser.Rectangle,documentBounds:new Phaser.Rectangle};
Phaser.Device.whenReady(function(a){var b=window&&"pageXOffset"in window?function(){return window.pageXOffset}:function(){return document.documentElement.scrollLeft},c=window&&"pageYOffset"in window?function(){return window.pageYOffset}:function(){return document.documentElement.scrollTop};Object.defineProperty(Phaser.DOM,"scrollX",{get:b});Object.defineProperty(Phaser.DOM,"scrollY",{get:c});Object.defineProperty(Phaser.DOM.visualBounds,"x",{get:b});Object.defineProperty(Phaser.DOM.visualBounds,"y",
{get:c});Object.defineProperty(Phaser.DOM.layoutBounds,"x",{value:0});Object.defineProperty(Phaser.DOM.layoutBounds,"y",{value:0});a.desktop&&document.documentElement.clientWidth<=window.innerWidth&&document.documentElement.clientHeight<=window.innerHeight?(a=function(){return Math.max(window.innerWidth,document.documentElement.clientWidth)},b=function(){return Math.max(window.innerHeight,document.documentElement.clientHeight)},Object.defineProperty(Phaser.DOM.visualBounds,"width",{get:a}),Object.defineProperty(Phaser.DOM.visualBounds,
"height",{get:b}),Object.defineProperty(Phaser.DOM.layoutBounds,"width",{get:a}),Object.defineProperty(Phaser.DOM.layoutBounds,"height",{get:b})):(Object.defineProperty(Phaser.DOM.visualBounds,"width",{get:function(){return window.innerWidth}}),Object.defineProperty(Phaser.DOM.visualBounds,"height",{get:function(){return window.innerHeight}}),Object.defineProperty(Phaser.DOM.layoutBounds,"width",{get:function(){var a=document.documentElement.clientWidth,b=window.innerWidth;return a<b?b:a}}),Object.defineProperty(Phaser.DOM.layoutBounds,
"height",{get:function(){var a=document.documentElement.clientHeight,b=window.innerHeight;return a<b?b:a}}));Object.defineProperty(Phaser.DOM.documentBounds,"x",{value:0});Object.defineProperty(Phaser.DOM.documentBounds,"y",{value:0});Object.defineProperty(Phaser.DOM.documentBounds,"width",{get:function(){var a=document.documentElement;return Math.max(a.clientWidth,a.offsetWidth,a.scrollWidth)}});Object.defineProperty(Phaser.DOM.documentBounds,"height",{get:function(){var a=document.documentElement;
return Math.max(a.clientHeight,a.offsetHeight,a.scrollHeight)}})},null,!0);Phaser.ArraySet=function(a){this.position=0;this.list=a||[]};
Phaser.ArraySet.prototype={add:function(a){this.exists(a)||this.list.push(a);return a},getIndex:function(a){return this.list.indexOf(a)},getByKey:function(a,b){for(var c=this.list.length;c--;)if(this.list[c][a]===b)return this.list[c];return null},exists:function(a){return-1<this.list.indexOf(a)},reset:function(){this.list.length=0},remove:function(a){var b=this.list.indexOf(a);if(-1<b)return this.list.splice(b,1),a},setAll:function(a,b){for(var c=this.list.length;c--;)this.list[c]&&(this.list[c][a]=
b)},callAll:function(a){for(var b=Array.prototype.slice.call(arguments,1),c=this.list.length;c--;)this.list[c]&&this.list[c][a]&&this.list[c][a].apply(this.list[c],b)},removeAll:function(a){void 0===a&&(a=!1);for(var b=this.list.length;b--;)if(this.list[b]){var c=this.remove(this.list[b]);a&&c.destroy()}this.position=0;this.list=[]}};Object.defineProperty(Phaser.ArraySet.prototype,"total",{get:function(){return this.list.length}});
Object.defineProperty(Phaser.ArraySet.prototype,"first",{get:function(){this.position=0;return 0<this.list.length?this.list[0]:null}});Object.defineProperty(Phaser.ArraySet.prototype,"next",{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}});Phaser.ArraySet.prototype.constructor=Phaser.ArraySet;
Phaser.ArrayUtils={getRandomItem:function(a,b,c){if(null===a)return null;void 0===b&&(b=0);void 0===c&&(c=a.length);b+=Math.floor(Math.random()*c);return void 0===a[b]?null:a[b]},removeRandomItem:function(a,b,c){if(null==a)return null;void 0===b&&(b=0);void 0===c&&(c=a.length);b+=Math.floor(Math.random()*c);return b<a.length?(a=a.splice(b,1),void 0===a[0]?null:a[0]):null},shuffle:function(a){for(var b=a.length-1;0<b;b--){var c=Math.floor(Math.random()*(b+1)),d=a[b];a[b]=a[c];a[c]=d}return a},transposeMatrix:function(a){for(var b=
a.length,c=a[0].length,d=Array(c),e=0;e<c;e++){d[e]=Array(b);for(var f=b-1;-1<f;f--)d[e][f]=a[f][e]}return d},rotateMatrix:function(a,b){"string"!==typeof b&&(b=(b%360+360)%360);if(90===b||-270===b||"rotateLeft"===b)a=Phaser.ArrayUtils.transposeMatrix(a),a=a.reverse();else if(-90===b||270===b||"rotateRight"===b)a=a.reverse(),a=Phaser.ArrayUtils.transposeMatrix(a);else if(180===Math.abs(b)||"rotate180"===b){for(var c=0;c<a.length;c++)a[c].reverse();a=a.reverse()}return a},findClosest:function(a,b){if(!b.length)return NaN;
if(1===b.length||a<b[0])return b[0];for(var c=1;b[c]<a;)c++;var d=b[c-1],c=c<b.length?b[c]:Number.POSITIVE_INFINITY;return c-a<=a-d?c:d},rotateRight:function(a){var b=a.pop();a.unshift(b);return b},rotateLeft:function(a){var b=a.shift();a.push(b);return b},rotate:function(a){var b=a.shift();a.push(b);return b},numberArray:function(a,b){for(var c=[],d=a;d<=b;d++)c.push(d);return c},numberArrayStep:function(a,b,c){if(void 0===a||null===a)a=0;if(void 0===b||null===b)b=a,a=0;void 0===c&&(c=1);var d=[];
b=Math.max(Phaser.Math.roundAwayFromZero((b-a)/(c||1)),0);for(var e=0;e<b;e++)d.push(a),a+=c;return d}};Phaser.LinkedList=function(){this.last=this.first=this.prev=this.next=null;this.total=0};
Phaser.LinkedList.prototype={add:function(a){if(0===this.total&&null===this.first&&null===this.last)return this.next=this.last=this.first=a,a.prev=this,this.total++,a;this.last.next=a;a.prev=this.last;this.last=a;this.total++;return a},reset:function(){this.prev=this.next=this.last=this.first=null;this.total=0},remove:function(a){1===this.total?(this.reset(),a.next=a.prev=null):(a===this.first?this.first=this.first.next:a===this.last&&(this.last=this.last.prev),a.prev&&(a.prev.next=a.next),a.next&&
(a.next.prev=a.prev),a.next=a.prev=null,null===this.first&&(this.last=null),this.total--)},callAll:function(a){if(this.first&&this.last){var b=this.first;do b&&b[a]&&b[a].call(b),b=b.next;while(b!==this.last.next)}}};Phaser.LinkedList.prototype.constructor=Phaser.LinkedList;Phaser.Create=function(){};
Phaser.Color={packPixel:function(a,b,c,d){return Phaser.Device.LITTLE_ENDIAN?(d<<24|c<<16|b<<8|a)>>>0:(a<<24|b<<16|c<<8|d)>>>0},unpackPixel:function(a,b,c,d){if(void 0===b||null===b)b=Phaser.Color.createColor();if(void 0===c||null===c)c=!1;if(void 0===d||null===d)d=!1;Phaser.Device.LITTLE_ENDIAN?(b.a=(a&4278190080)>>>24,b.b=(a&16711680)>>>16,b.g=(a&65280)>>>8,b.r=a&255):(b.r=(a&4278190080)>>>24,b.g=(a&16711680)>>>16,b.b=(a&65280)>>>8,b.a=a&255);b.color=a;b.rgba="rgba("+b.r+","+b.g+","+b.b+","+b.a/
255+")";c&&Phaser.Color.RGBtoHSL(b.r,b.g,b.b,b);d&&Phaser.Color.RGBtoHSV(b.r,b.g,b.b,b);return b},fromRGBA:function(a,b){b||(b=Phaser.Color.createColor());b.r=(a&4278190080)>>>24;b.g=(a&16711680)>>>16;b.b=(a&65280)>>>8;b.a=a&255;b.rgba="rgba("+b.r+","+b.g+","+b.b+","+b.a+")";return b},toRGBA:function(a,b,c,d){return a<<24|b<<16|c<<8|d},toABGR:function(a,b,c,d){return(d<<24|c<<16|b<<8|a)>>>0},RGBtoHSL:function(a,b,c,d){d||(d=Phaser.Color.createColor(a,b,c,1));a/=255;b/=255;c/=255;var e=Math.min(a,
b,c),f=Math.max(a,b,c);d.h=0;d.s=0;d.l=(f+e)/2;if(f!==e){var g=f-e;d.s=.5<d.l?g/(2-f-e):g/(f+e);f===a?d.h=(b-c)/g+(b<c?6:0):f===b?d.h=(c-a)/g+2:f===c&&(d.h=(a-b)/g+4);d.h/=6}return d},HSLtoRGB:function(a,b,c,d){d?(d.r=c,d.g=c,d.b=c):d=Phaser.Color.createColor(c,c,c);0!==b&&(b=.5>c?c*(1+b):c+b-c*b,c=2*c-b,d.r=Phaser.Color.hueToColor(c,b,a+1/3),d.g=Phaser.Color.hueToColor(c,b,a),d.b=Phaser.Color.hueToColor(c,b,a-1/3));d.r=Math.floor(255*d.r|0);d.g=Math.floor(255*d.g|0);d.b=Math.floor(255*d.b|0);Phaser.Color.updateColor(d);
return d},RGBtoHSV:function(a,b,c,d){d||(d=Phaser.Color.createColor(a,b,c,255));a/=255;b/=255;c/=255;var e=Math.min(a,b,c),f=Math.max(a,b,c),g=f-e;d.h=0;d.s=0===f?0:g/f;d.v=f;f!==e&&(f===a?d.h=(b-c)/g+(b<c?6:0):f===b?d.h=(c-a)/g+2:f===c&&(d.h=(a-b)/g+4),d.h/=6);return d},HSVtoRGB:function(a,b,c,d){void 0===d&&(d=Phaser.Color.createColor(0,0,0,1,a,b,0,c));var e,f,g,h=Math.floor(6*a),k=6*a-h;a=c*(1-b);var l=c*(1-k*b);b=c*(1-(1-k)*b);switch(h%6){case 0:e=c;f=b;g=a;break;case 1:e=l;f=c;g=a;break;case 2:e=
a;f=c;g=b;break;case 3:e=a;f=l;g=c;break;case 4:e=b;f=a;g=c;break;case 5:e=c,f=a,g=l}d.r=Math.floor(255*e);d.g=Math.floor(255*f);d.b=Math.floor(255*g);Phaser.Color.updateColor(d);return d},hueToColor:function(a,b,c){0>c&&(c+=1);1<c&&--c;return c<1/6?a+6*(b-a)*c:.5>c?b:c<2/3?a+(b-a)*(2/3-c)*6:a},createColor:function(a,b,c,d,e,f,g,h){return Phaser.Color.updateColor({r:a||0,g:b||0,b:c||0,a:d||1,h:e||0,s:f||0,l:g||0,v:h||0,color:0,color32:0,rgba:""})},updateColor:function(a){a.rgba="rgba("+a.r.toString()+
","+a.g.toString()+","+a.b.toString()+","+a.a.toString()+")";a.color=Phaser.Color.getColor(a.r,a.g,a.b);a.color32=Phaser.Color.getColor32(255*a.a,a.r,a.g,a.b);return a},getColor32:function(a,b,c,d){return a<<24|b<<16|c<<8|d},getColor:function(a,b,c){return a<<16|b<<8|c},RGBtoString:function(a,b,c,d,e){void 0===d&&(d=255);void 0===e&&(e="#");return"#"===e?"#"+(16777216+(a<<16)+(b<<8)+c).toString(16).slice(1):"0x"+Phaser.Color.componentToHex(d)+Phaser.Color.componentToHex(a)+Phaser.Color.componentToHex(b)+
Phaser.Color.componentToHex(c)},hexToRGB:function(a){if(a=Phaser.Color.hexToColor(a))return Phaser.Color.getColor32(a.a,a.r,a.g,a.b)},hexToColor:function(a,b){a=a.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,b,c,d){return b+b+c+c+d+d});var c=/^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);if(c){var d=parseInt(c[1],16),e=parseInt(c[2],16),c=parseInt(c[3],16);b?(b.r=d,b.g=e,b.b=c):b=Phaser.Color.createColor(d,e,c)}return b},webToColor:function(a,b){b||(b=Phaser.Color.createColor());
var c=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(a);c&&(b.r=parseInt(c[1],10),b.g=parseInt(c[2],10),b.b=parseInt(c[3],10),b.a=void 0!==c[4]?parseFloat(c[4]):1,Phaser.Color.updateColor(b));return b},valueToColor:function(a,b){b||(b=Phaser.Color.createColor());if("string"===typeof a){if(0===a.indexOf("rgb"))return Phaser.Color.webToColor(a,b);b.a=1;return Phaser.Color.hexToColor(a,b)}if("number"===typeof a){var c=Phaser.Color.getRGB(a);b.r=c.r;b.g=c.g;b.b=c.b;b.a=
c.a/255}return b},componentToHex:function(a){a=a.toString(16);return 1===a.length?"0"+a:a},HSVColorWheel:function(a,b){void 0===a&&(a=1);void 0===b&&(b=1);for(var c=[],d=0;359>=d;d++)c.push(Phaser.Color.HSVtoRGB(d/359,a,b));return c},HSLColorWheel:function(a,b){void 0===a&&(a=.5);void 0===b&&(b=.5);for(var c=[],d=0;359>=d;d++)c.push(Phaser.Color.HSLtoRGB(d/359,a,b));return c},interpolateColor:function(a,b,c,d,e){void 0===e&&(e=255);a=Phaser.Color.getRGB(a);b=Phaser.Color.getRGB(b);return Phaser.Color.getColor32(e,
(b.red-a.red)*d/c+a.red,(b.green-a.green)*d/c+a.green,(b.blue-a.blue)*d/c+a.blue)},interpolateColorWithRGB:function(a,b,c,d,e,f){a=Phaser.Color.getRGB(a);return Phaser.Color.getColor((b-a.red)*f/e+a.red,(c-a.green)*f/e+a.green,(d-a.blue)*f/e+a.blue)},interpolateRGB:function(a,b,c,d,e,f,g,h){return Phaser.Color.getColor((d-a)*h/g+a,(e-b)*h/g+b,(f-c)*h/g+c)},getRandomColor:function(a,b,c){void 0===a&&(a=0);void 0===b&&(b=255);void 0===c&&(c=255);return 255<b||a>b?Phaser.Color.getColor(255,255,255):
Phaser.Color.getColor32(c,a+Math.round(Math.random()*(b-a)),a+Math.round(Math.random()*(b-a)),a+Math.round(Math.random()*(b-a)))},getRGB:function(a){return 16777215<a?{alpha:a>>>24,red:a>>16&255,green:a>>8&255,blue:a&255,a:a>>>24,r:a>>16&255,g:a>>8&255,b:a&255}:{alpha:255,red:a>>16&255,green:a>>8&255,blue:a&255,a:255,r:a>>16&255,g:a>>8&255,b:a&255}},getWebRGB:function(a){if("object"===typeof a)return"rgba("+a.r.toString()+","+a.g.toString()+","+a.b.toString()+","+(a.a/255).toString()+")";a=Phaser.Color.getRGB(a);
return"rgba("+a.r.toString()+","+a.g.toString()+","+a.b.toString()+","+(a.a/255).toString()+")"},getAlpha:function(a){return a>>>24},getAlphaFloat:function(a){return(a>>>24)/255},getRed:function(a){return a>>16&255},getGreen:function(a){return a>>8&255},getBlue:function(a){return a&255},blendNormal:function(a){return a},blendLighten:function(a,b){return b>a?b:a},blendDarken:function(a,b){return b>a?a:b},blendMultiply:function(a,b){return a*b/255},blendAverage:function(a,b){return(a+b)/2},blendAdd:function(a,
b){return Math.min(255,a+b)},blendSubtract:function(a,b){return Math.max(0,a+b-255)},blendDifference:function(a,b){return Math.abs(a-b)},blendNegation:function(a,b){return 255-Math.abs(255-a-b)},blendScreen:function(a,b){return 255-((255-a)*(255-b)>>8)},blendExclusion:function(a,b){return a+b-2*a*b/255},blendOverlay:function(a,b){return 128>b?2*a*b/255:255-2*(255-a)*(255-b)/255},blendSoftLight:function(a,b){return 128>b?b/255*((a>>1)+64)*2:255-2*(255-((a>>1)+64))*(255-b)/255},blendHardLight:function(a,
b){return Phaser.Color.blendOverlay(b,a)},blendColorDodge:function(a,b){return 255===b?b:Math.min(255,(a<<8)/(255-b))},blendColorBurn:function(a,b){return 0===b?b:Math.max(0,255-(255-a<<8)/b)},blendLinearDodge:function(a,b){return Phaser.Color.blendAdd(a,b)},blendLinearBurn:function(a,b){return Phaser.Color.blendSubtract(a,b)},blendLinearLight:function(a,b){return 128>b?Phaser.Color.blendLinearBurn(a,2*b):Phaser.Color.blendLinearDodge(a,2*(b-128))},blendVividLight:function(a,b){return 128>b?Phaser.Color.blendColorBurn(a,
2*b):Phaser.Color.blendColorDodge(a,2*(b-128))},blendPinLight:function(a,b){return 128>b?Phaser.Color.blendDarken(a,2*b):Phaser.Color.blendLighten(a,2*(b-128))},blendHardMix:function(a,b){return 128>Phaser.Color.blendVividLight(a,b)?0:255},blendReflect:function(a,b){return 255===b?b:Math.min(255,a*a/(255-b))},blendGlow:function(a,b){return Phaser.Color.blendReflect(b,a)},blendPhoenix:function(a,b){return Math.min(a,b)-Math.max(a,b)+255}};
Phaser.Physics=function(a,b){b=b||{};this.game=a;this.config=b;this.matter=this.chipmunk=this.box2d=this.ninja=this.p2=this.arcade=null;this.parseConfig()};Phaser.Physics.ARCADE=0;Phaser.Physics.P2JS=1;Phaser.Physics.NINJA=2;Phaser.Physics.BOX2D=3;Phaser.Physics.CHIPMUNK=4;Phaser.Physics.MATTERJS=5;
Phaser.Physics.prototype={parseConfig:function(){this.config.hasOwnProperty("arcade")&&!0!==this.config.arcade||!Phaser.Physics.hasOwnProperty("Arcade")||(this.arcade=new Phaser.Physics.Arcade(this.game));this.config.hasOwnProperty("ninja")&&!0===this.config.ninja&&Phaser.Physics.hasOwnProperty("Ninja")&&(this.ninja=new Phaser.Physics.Ninja(this.game));this.config.hasOwnProperty("p2")&&!0===this.config.p2&&Phaser.Physics.hasOwnProperty("P2")&&(this.p2=new Phaser.Physics.P2(this.game,this.config));
this.config.hasOwnProperty("box2d")&&!0===this.config.box2d&&Phaser.Physics.hasOwnProperty("BOX2D")&&(this.box2d=new Phaser.Physics.BOX2D(this.game,this.config));this.config.hasOwnProperty("matter")&&!0===this.config.matter&&Phaser.Physics.hasOwnProperty("Matter")&&(this.matter=new Phaser.Physics.Matter(this.game,this.config))},startSystem:function(a){a===Phaser.Physics.ARCADE?this.arcade=new Phaser.Physics.Arcade(this.game):a===Phaser.Physics.P2JS?null===this.p2?this.p2=new Phaser.Physics.P2(this.game,
this.config):this.p2.reset():a===Phaser.Physics.NINJA?this.ninja=new Phaser.Physics.Ninja(this.game):a===Phaser.Physics.BOX2D?null===this.box2d?this.box2d=new Phaser.Physics.Box2D(this.game,this.config):this.box2d.reset():a===Phaser.Physics.MATTERJS&&(null===this.matter?this.matter=new Phaser.Physics.Matter(this.game,this.config):this.matter.reset())},enable:function(a,b,c){void 0===b&&(b=Phaser.Physics.ARCADE);void 0===c&&(c=!1);b===Phaser.Physics.ARCADE?this.arcade.enable(a):b===Phaser.Physics.P2JS&&
this.p2?this.p2.enable(a,c):b===Phaser.Physics.NINJA&&this.ninja?this.ninja.enableAABB(a):b===Phaser.Physics.BOX2D&&this.box2d?this.box2d.enable(a):b===Phaser.Physics.MATTERJS&&this.matter?this.matter.enable(a):console.warn(a.key+" is attempting to enable a physics body using an unknown physics system.")},preUpdate:function(){this.p2&&this.p2.preUpdate();this.box2d&&this.box2d.preUpdate();this.matter&&this.matter.preUpdate()},update:function(){this.p2&&this.p2.update();this.box2d&&this.box2d.update();
this.matter&&this.matter.update()},setBoundsToWorld:function(){this.arcade&&this.arcade.setBoundsToWorld();this.ninja&&this.ninja.setBoundsToWorld();this.p2&&this.p2.setBoundsToWorld();this.box2d&&this.box2d.setBoundsToWorld();this.matter&&this.matter.setBoundsToWorld()},clear:function(){this.p2&&this.p2.clear();this.box2d&&this.box2d.clear();this.matter&&this.matter.clear()},reset:function(){this.p2&&this.p2.reset();this.box2d&&this.box2d.reset();this.matter&&this.matter.reset()},destroy:function(){this.p2&&
this.p2.destroy();this.box2d&&this.box2d.destroy();this.matter&&this.matter.destroy();this.matter=this.box2d=this.p2=this.ninja=this.arcade=null}};Phaser.Physics.prototype.constructor=Phaser.Physics;Phaser.Particles=function(a){this.game=a;this.emitters={};this.ID=0};Phaser.Particles.prototype={add:function(a){return this.emitters[a.name]=a},remove:function(a){delete this.emitters[a.name]},update:function(){for(var a in this.emitters)this.emitters[a].exists&&this.emitters[a].update()}};
Phaser.Particles.prototype.constructor=Phaser.Particles;
Phaser.Creature=function(a,b,c,d,e,f){void 0===f&&(f="default");this.type=Phaser.CREATURE;if(a.cache.checkJSONKey(e)){e=a.cache.getJSON(e);this._creature=new Creature(e);this.animation=new CreatureAnimation(e,f,this._creature);this.manager=new CreatureManager(this._creature);this.timeDelta=.05;this.texture="string"===typeof d?new PIXI.Texture(a.cache.getBaseTexture(d)):d;PIXI.DisplayObjectContainer.call(this);this.dirty=!0;this.blendMode=PIXI.blendModes.NORMAL;this.creatureBoundsMin=new Phaser.Point;
this.creatureBoundsMax=new Phaser.Point;d=this.manager.target_creature;this.vertices=new PIXI.Float32Array(2*d.total_num_pts);this.uvs=new PIXI.Float32Array(2*d.total_num_pts);this.indices=new PIXI.Uint16Array(d.global_indices.length);for(e=0;e<this.indices.length;e++)this.indices[e]=d.global_indices[e];this.colors=new PIXI.Float32Array([1,1,1,1]);this.updateRenderData(d.global_pts,d.global_uvs);this.manager.AddAnimation(this.animation);this.manager.SetActiveAnimationName(f,!1);Phaser.Component.Core.init.call(this,
a,b,c)}else console.warn("Phaser.Creature: Invalid mesh key given. Not found in Phaser.Cache")};Phaser.Creature.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);Phaser.Creature.prototype.constructor=Phaser.Creature;Phaser.Component.Core.install.call(Phaser.Creature.prototype,"Angle AutoCull BringToTop Destroy FixedToCamera LifeSpan Reset".split(" "));Phaser.Creature.prototype.preUpdateInWorld=Phaser.Component.InWorld.preUpdate;Phaser.Creature.prototype.preUpdateCore=Phaser.Component.Core.preUpdate;
Phaser.Creature.prototype.preUpdate=function(){if(!this.preUpdateInWorld())return!1;this.manager.Update(this.timeDelta);this.updateData();return this.preUpdateCore()};
Phaser.Creature.prototype._initWebGL=function(a){a=a.gl;this._vertexBuffer=a.createBuffer();this._indexBuffer=a.createBuffer();this._uvBuffer=a.createBuffer();this._colorBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this._vertexBuffer);a.bufferData(a.ARRAY_BUFFER,this.vertices,a.DYNAMIC_DRAW);a.bindBuffer(a.ARRAY_BUFFER,this._uvBuffer);a.bufferData(a.ARRAY_BUFFER,this.uvs,a.DYNAMIC_DRAW);a.bindBuffer(a.ARRAY_BUFFER,this._colorBuffer);a.bufferData(a.ARRAY_BUFFER,this.colors,a.STATIC_DRAW);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,
this._indexBuffer);a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indices,a.STATIC_DRAW)};Phaser.Creature.prototype._renderWebGL=function(a){!this.visible||0>=this.alpha||(a.spriteBatch.stop(),this._vertexBuffer||this._initWebGL(a),a.shaderManager.setShader(a.shaderManager.stripShader),this._renderCreature(a),a.spriteBatch.start())};
Phaser.Creature.prototype._renderCreature=function(a){var b=a.gl,c=a.projection,d=a.offset,e=a.shaderManager.stripShader;a.blendModeManager.setBlendMode(this.blendMode);b.uniformMatrix3fv(e.translationMatrix,!1,this.worldTransform.toArray(!0));b.uniform2f(e.projectionVector,c.x,-c.y);b.uniform2f(e.offsetVector,-d.x,-d.y);b.uniform1f(e.alpha,this.worldAlpha);this.dirty?(this.dirty=!1,b.bindBuffer(b.ARRAY_BUFFER,this._vertexBuffer),b.bufferData(b.ARRAY_BUFFER,this.vertices,b.DYNAMIC_DRAW),b.vertexAttribPointer(e.aVertexPosition,
2,b.FLOAT,!1,0,0),b.bindBuffer(b.ARRAY_BUFFER,this._uvBuffer),b.bufferData(b.ARRAY_BUFFER,this.uvs,b.DYNAMIC_DRAW),b.vertexAttribPointer(e.aTextureCoord,2,b.FLOAT,!1,0,0),b.activeTexture(b.TEXTURE0),this.texture.baseTexture._dirty[b.id]?a.renderer.updateTexture(this.texture.baseTexture):b.bindTexture(b.TEXTURE_2D,this.texture.baseTexture._glTextures[b.id]),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this._indexBuffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.indices,b.STATIC_DRAW)):(b.bindBuffer(b.ARRAY_BUFFER,
this._vertexBuffer),b.bufferSubData(b.ARRAY_BUFFER,0,this.vertices),b.vertexAttribPointer(e.aVertexPosition,2,b.FLOAT,!1,0,0),b.bindBuffer(b.ARRAY_BUFFER,this._uvBuffer),b.vertexAttribPointer(e.aTextureCoord,2,b.FLOAT,!1,0,0),b.activeTexture(b.TEXTURE0),this.texture.baseTexture._dirty[b.id]?a.renderer.updateTexture(this.texture.baseTexture):b.bindTexture(b.TEXTURE_2D,this.texture.baseTexture._glTextures[b.id]),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this._indexBuffer));b.drawElements(b.TRIANGLES,this.indices.length,
b.UNSIGNED_SHORT,0)};Phaser.Creature.prototype.updateCreatureBounds=function(){var a=this.manager.target_creature;a.ComputeBoundaryMinMax();this.creatureBoundsMin.set(a.boundary_min[0],-a.boundary_min[1]);this.creatureBoundsMax.set(a.boundary_max[0],-a.boundary_max[1]);this.worldTransform.apply(this.creatureBoundsMin,this.creatureBoundsMin);this.worldTransform.apply(this.creatureBoundsMax,this.creatureBoundsMax)};
Phaser.Creature.prototype.updateData=function(){var a=this.manager.target_creature;this.updateRenderData(a.render_pts,a.global_uvs);this.updateCreatureBounds();this.dirty=!0};Phaser.Creature.prototype.updateRenderData=function(a,b){for(var c=this.manager.target_creature,d=0,e=0,f=0,g=0;g<c.total_num_pts;g++)this.vertices[f]=a[d],this.vertices[f+1]=-a[d+1],this.uvs[e]=b[e],this.uvs[e+1]=b[e+1],d+=3,e+=2,f+=2};
Phaser.Creature.prototype.setAnimation=function(a){this.manager.SetActiveAnimationName(a,!0)};Phaser.Creature.prototype.play=function(a){void 0===a&&(a=!1);this.loop=a;this.manager.SetIsPlaying(!0);this.manager.RunAtTime(0)};Phaser.Creature.prototype.stop=function(){this.manager.SetIsPlaying(!1)};Object.defineProperty(Phaser.Creature.prototype,"isPlaying",{get:function(){return this.manager.GetIsPlaying()},set:function(a){this.manager.SetIsPlaying(a)}});
Object.defineProperty(Phaser.Creature.prototype,"loop",{get:function(){return this.manager.should_loop},set:function(a){this.manager.SetShouldLoop(a)}});
Phaser.Video=function(a,b,c){void 0===b&&(b=null);void 0===c&&(c=null);this.game=a;this.key=b;this.height=this.width=0;this.type=Phaser.VIDEO;this.touchLocked=this.disableTextureUpload=!1;this.onPlay=new Phaser.Signal;this.onChangeSource=new Phaser.Signal;this.onComplete=new Phaser.Signal;this.onAccess=new Phaser.Signal;this.onError=new Phaser.Signal;this.onTimeout=new Phaser.Signal;this.timeout=15E3;this.videoStream=this.video=this._timeOutID=null;this.isStreaming=!1;this.retryLimit=20;this.retry=
0;this.retryInterval=500;this._retryID=null;this._autoplay=this._pending=this._paused=this._codePaused=this._muted=this._codeMuted=!1;this._playCallback=this._endCallback=null;if(b&&this.game.cache.checkVideoKey(b)){var d=this.game.cache.getVideo(b);d.isBlob?this.createVideoFromBlob(d.data):this.video=d.data;this.width=this.video.videoWidth;this.height=this.video.videoHeight}else c&&this.createVideoFromURL(c,!1);this.baseTexture=this.video&&!c?new PIXI.BaseTexture(this.video):new PIXI.BaseTexture(Phaser.Cache.DEFAULT.baseTexture.source);
this.baseTexture.forceLoaded(this.width,this.height);this.texture=new PIXI.Texture(this.baseTexture);this.textureFrame=new Phaser.Frame(0,0,0,this.width,this.height,"video");this.texture.setFrame(this.textureFrame);this.texture.valid=!1;null!==b&&this.video&&(this.texture.valid=this.video.canplay);this.snapshot=null;Phaser.BitmapData&&(this.snapshot=new Phaser.BitmapData(this.game,"",this.width,this.height));!this.game.device.cocoonJS&&(this.game.device.iOS||this.game.device.android)||window.PhaserGlobal&&
window.PhaserGlobal.fakeiOSTouchLock?this.setTouchLock():d&&(d.locked=!1)};
Phaser.Video.prototype={connectToMediaStream:function(a,b){a&&b&&(this.video=a,this.videoStream=b,this.isStreaming=!0,this.baseTexture.source=this.video,this.updateTexture(null,this.video.videoWidth,this.video.videoHeight),this.onAccess.dispatch(this));return this},startMediaStream:function(a,b,c){void 0===a&&(a=!1);void 0===b&&(b=null);void 0===c&&(c=null);if(!this.game.device.getUserMedia)return this.onError.dispatch(this,"No getUserMedia"),!1;null!==this.videoStream&&(this.videoStream.active?this.videoStream.active=
!1:this.videoStream.stop());this.removeVideoElement();this.video=document.createElement("video");this.video.setAttribute("autoplay","autoplay");null!==b&&(this.video.width=b);null!==c&&(this.video.height=c);this._timeOutID=window.setTimeout(this.getUserMediaTimeout.bind(this),this.timeout);try{navigator.getUserMedia({audio:a,video:!0},this.getUserMediaSuccess.bind(this),this.getUserMediaError.bind(this))}catch(d){this.getUserMediaError(d)}return this},getUserMediaTimeout:function(){clearTimeout(this._timeOutID);
this.onTimeout.dispatch(this)},getUserMediaError:function(a){clearTimeout(this._timeOutID);this.onError.dispatch(this,a)},getUserMediaSuccess:function(a){clearTimeout(this._timeOutID);this.videoStream=a;void 0!==this.video.mozSrcObject?this.video.mozSrcObject=a:this.video.src=window.URL&&window.URL.createObjectURL(a)||a;var b=this;this.video.onloadeddata=function(){function a(){if(0<d)if(0<b.video.videoWidth){var e=b.video.videoWidth,f=b.video.videoHeight;isNaN(b.video.videoHeight)&&(f=e/(4/3));b.video.play();
b.isStreaming=!0;b.baseTexture.source=b.video;b.updateTexture(null,e,f);b.onAccess.dispatch(b)}else window.setTimeout(a,500);else console.warn("Unable to connect to video stream. Webcam error?");d--}var d=10;a()}},createVideoFromBlob:function(a){var b=this;this.video=document.createElement("video");this.video.controls=!1;this.video.setAttribute("autoplay","autoplay");this.video.addEventListener("loadeddata",function(a){b.updateTexture(a)},!0);this.video.src=window.URL.createObjectURL(a);this.video.canplay=
!0;return this},createVideoFromURL:function(a,b){void 0===b&&(b=!1);this.texture&&(this.texture.valid=!1);this.video=document.createElement("video");this.video.controls=!1;b&&this.video.setAttribute("autoplay","autoplay");this.video.src=a;this.video.canplay=!0;this.video.load();this.retry=this.retryLimit;this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval);this.key=a;return this},updateTexture:function(a,b,c){a=!1;if(void 0===b||null===b)b=this.video.videoWidth,a=
!0;if(void 0===c||null===c)c=this.video.videoHeight;this.width=b;this.height=c;this.baseTexture.source!==this.video&&(this.baseTexture.source=this.video);this.baseTexture.forceLoaded(b,c);this.texture.frame.resize(b,c);this.texture.width=b;this.texture.height=c;this.texture.valid=!0;this.snapshot&&this.snapshot.resize(b,c);a&&null!==this.key&&(this.onChangeSource.dispatch(this,b,c),this._autoplay&&(this.video.play(),this.onPlay.dispatch(this,this.loop,this.playbackRate)))},complete:function(){this.onComplete.dispatch(this)},
play:function(a,b){void 0===a&&(a=!1);void 0===b&&(b=1);this.game.sound.onMute&&(this.game.sound.onMute.add(this.setMute,this),this.game.sound.onUnMute.add(this.unsetMute,this),this.game.sound.mute&&this.setMute());this.game.onPause.add(this.setPause,this);this.game.onResume.add(this.setResume,this);this._endCallback=this.complete.bind(this);this.video.addEventListener("ended",this._endCallback,!0);this.video.addEventListener("webkitendfullscreen",this._endCallback,!0);this.video.loop=a?"loop":"";
this.video.playbackRate=b;this.touchLocked?this._pending=!0:(this._pending=!1,null!==this.key&&(4!==this.video.readyState?(this.retry=this.retryLimit,this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval)):(this._playCallback=this.playHandler.bind(this),this.video.addEventListener("playing",this._playCallback,!0))),this.video.play(),this.onPlay.dispatch(this,a,b));return this},playHandler:function(){this.video.removeEventListener("playing",this._playCallback,!0);this.updateTexture()},
stop:function(){this.game.sound.onMute&&(this.game.sound.onMute.remove(this.setMute,this),this.game.sound.onUnMute.remove(this.unsetMute,this));this.game.onPause.remove(this.setPause,this);this.game.onResume.remove(this.setResume,this);this.isStreaming?(this.video.mozSrcObject?(this.video.mozSrcObject.stop(),this.video.src=null):(this.video.src="",this.videoStream.active?this.videoStream.active=!1:this.videoStream.getTracks?this.videoStream.getTracks().forEach(function(a){a.stop()}):this.videoStream.stop()),
this.videoStream=null,this.isStreaming=!1):(this.video.removeEventListener("ended",this._endCallback,!0),this.video.removeEventListener("webkitendfullscreen",this._endCallback,!0),this.video.removeEventListener("playing",this._playCallback,!0),this.touchLocked?this._pending=!1:this.video.pause());return this},add:function(a){if(Array.isArray(a))for(var b=0;b<a.length;b++)a[b].loadTexture&&a[b].loadTexture(this);else a.loadTexture(this);return this},addToWorld:function(a,b,c,d,e,f){e=e||1;f=f||1;a=
this.game.add.image(a,b,this);a.anchor.set(c,d);a.scale.set(e,f);return a},render:function(){!this.disableTextureUpload&&this.playing&&this.baseTexture.dirty()},setMute:function(){this._muted||(this._muted=!0,this.video.muted=!0)},unsetMute:function(){this._muted&&!this._codeMuted&&(this._muted=!1,this.video.muted=!1)},setPause:function(){this._paused||this.touchLocked||(this._paused=!0,this.video.pause())},setResume:function(){!this._paused||this._codePaused||this.touchLocked||(this._paused=!1,this.video.ended||
this.video.play())},changeSource:function(a,b){void 0===b&&(b=!0);this.texture.valid=!1;this.video.pause();this.retry=this.retryLimit;this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval);this.video.src=a;this.video.load();this._autoplay=b;b||(this.paused=!0);return this},checkVideoProgress:function(){4===this.video.readyState?this.updateTexture():(this.retry--,0<this.retry?this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval):console.warn("Phaser.Video: Unable to start downloading video in time",
this.isStreaming))},setTouchLock:function(){this.game.input.touch.addTouchLockCallback(this.unlock,this);this.touchLocked=!0},unlock:function(){this.touchLocked=!1;this.video.play();this.onPlay.dispatch(this,this.loop,this.playbackRate);if(this.key){var a=this.game.cache.getVideo(this.key);a&&!a.isBlob&&(a.locked=!1)}return!0},grab:function(a,b,c){void 0===a&&(a=!1);void 0===b&&(b=1);void 0===c&&(c=null);if(null===this.snapshot)console.warn("Video.grab cannot run because Phaser.BitmapData is unavailable");
else return a&&this.snapshot.cls(),this.snapshot.copy(this.video,0,0,this.width,this.height,0,0,this.width,this.height,0,0,0,1,1,b,c),this.snapshot},removeVideoElement:function(){if(this.video){for(this.video.parentNode&&this.video.parentNode.removeChild(this.video);this.video.hasChildNodes();)this.video.removeChild(this.video.firstChild);this.video.removeAttribute("autoplay");this.video.removeAttribute("src");this.video=null}},destroy:function(){this.stop();this.removeVideoElement();this.touchLocked&&
this.game.input.touch.removeTouchLockCallback(this.unlock,this);this._retryID&&window.clearTimeout(this._retryID)}};Object.defineProperty(Phaser.Video.prototype,"currentTime",{get:function(){return this.video?this.video.currentTime:0},set:function(a){this.video.currentTime=a}});Object.defineProperty(Phaser.Video.prototype,"duration",{get:function(){return this.video?this.video.duration:0}});
Object.defineProperty(Phaser.Video.prototype,"progress",{get:function(){return this.video?this.video.currentTime/this.video.duration:0}});Object.defineProperty(Phaser.Video.prototype,"mute",{get:function(){return this._muted},set:function(a){a?this._muted||(this._codeMuted=!0,this.setMute()):this._muted&&(this._codeMuted=!1,this.unsetMute())}});
Object.defineProperty(Phaser.Video.prototype,"paused",{get:function(){return this._paused},set:function(a){this.touchLocked||(a?this._paused||(this._codePaused=!0,this.setPause()):this._paused&&(this._codePaused=!1,this.setResume()))}});Object.defineProperty(Phaser.Video.prototype,"volume",{get:function(){return this.video?this.video.volume:1},set:function(a){0>a?a=0:1<a&&(a=1);this.video&&(this.video.volume=a)}});
Object.defineProperty(Phaser.Video.prototype,"playbackRate",{get:function(){return this.video?this.video.playbackRate:1},set:function(a){this.video&&(this.video.playbackRate=a)}});Object.defineProperty(Phaser.Video.prototype,"loop",{get:function(){return this.video?this.video.loop:!1},set:function(a){a&&this.video?this.video.loop="loop":this.video&&(this.video.loop="")}});Object.defineProperty(Phaser.Video.prototype,"playing",{get:function(){return!(this.video.paused&&this.video.ended)}});
Phaser.Video.prototype.constructor=Phaser.Video;void 0===PIXI.blendModes&&(PIXI.blendModes=Phaser.blendModes);void 0===PIXI.scaleModes&&(PIXI.scaleModes=Phaser.scaleModes);void 0===PIXI.Texture.emptyTexture&&(PIXI.Texture.emptyTexture=new PIXI.Texture(new PIXI.BaseTexture));void 0===PIXI.DisplayObject._tempMatrix&&(PIXI.DisplayObject._tempMatrix=new PIXI.Matrix);void 0===PIXI.RenderTexture.tempMatrix&&(PIXI.RenderTexture.tempMatrix=new PIXI.Matrix);
PIXI.Graphics&&void 0===PIXI.Graphics.POLY&&(PIXI.Graphics.POLY=Phaser.POLYGON,PIXI.Graphics.RECT=Phaser.RECTANGLE,PIXI.Graphics.CIRC=Phaser.CIRCLE,PIXI.Graphics.ELIP=Phaser.ELLIPSE,PIXI.Graphics.RREC=Phaser.ROUNDEDRECTANGLE);PIXI.TextureSilentFail=!0;
